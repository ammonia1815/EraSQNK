;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;主にシステム이벤트で使う関数
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;-------------------------------------------------
;IF文中で"GOTO INPUT_LOOP"を使うとエラーが出るのを回避する. 이하は놀림方のテンプレ：
;	PRINTL [0] 
;	PRINTL [1] 
;	CALL INPUT_SELECT, 2
;	IF RESULT == 0
;	ELSEIF RESULT == 1
;	ENDIF
;便利な関数だが, RESULT == 0 && ABL:Ｖ감각 >= 3 みたいな, 条件も同時についているものには向かないので注意. 
;また, [100] やめる　など, 番号を追加したい時には　INPUT_SELECT, 2, 100　とすること. 
;-------------------------------------------------
@INPUT_SELECT, ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7, ARG:8, ARG:9, ARG:10
INPUT

SELECTCASE RESULT
CASE IS < 0
	RESTART
CASE 0 TO ARG - 1, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7, ARG:8, ARG:9, ARG:10
	RETURN RESULT
ENDSELECT
RESTART

;-------------------------------------------------
;半角でARG:1文字이상ARG文字이하の文字列入力をさせて, RESULTSでかえす
;-------------------------------------------------
@INPUTS_SELECT, ARG, ARG:1
INPUTS
SELECTCASE STRLENS(RESULTS)
CASE IS < ARG:1
	IF STRLENS(RESULTS) == 0
		PRINTL 문자를 입력해주세요
	ELSE
		PRINTFORML %RESULTS%은(는) 너무 짧습니다. 반각으로 {ARG:1}～{ARG}글자로 해주세요. 
	ENDIF
	RESTART
CASE IS > ARG
	PRINTFORML %RESULTS%은(는) 너무 깁니다. 반각으로 {ARG}글자 이내로 해주세요. 
	RESTART
CASEELSE

ENDSELECT

;-------------------------------------------------
;@INPUT_SELECTのONEINPUT版
;ARGには一桁の数字を入れること
;-------------------------------------------------
@ONEINPUT_SELECT, ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7, ARG:8, ARG:9, ARG:10
#DIM MEMO_LINECOUNT
MEMO_LINECOUNT = LINECOUNT

ONEINPUT
SELECTCASE RESULT
CASE 0 TO ARG - 1, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7, ARG:8, ARG:9, ARG:10
	RETURN RESULT
ENDSELECT

CLEARLINE LINECOUNT - MEMO_LINECOUNT
RESTART

;-------------------------------------------------
;簡単な선택지を１行で記述するための関数
;例えば, CALL PRINT_SELECT, "はい", "いいえ" とすると
;	PRINTL [0] 예
;	PRINTL [1] 아니오
;	CALL INPUT_SELECT, 2
;と記述した事に等しい. 선택지の番号を飛ばしたりなどは出来ないので, あくまで単純な선택지を作りたい場合に向く
;-------------------------------------------------
@PRINT_SELECT, ARGS, ARGS:1, ARGS:2, ARGS:3, ARGS:4, ARGS:5
#DIM LCOUNT

VARSET LOCAL
FOR LCOUNT, 0, 6
	SIF ARGS:LCOUNT == ""
		BREAK

	PRINTFORML [{LCOUNT, 2}] %ARGS:LCOUNT%

	;선택지の数
	LOCAL += 1
NEXT

CALL INPUT_SELECT, LOCAL

RETURN RESULT

;-------------------------------------------------
;文字列ARGSを瞬間ではなく、若干ゆっくり表示させる関数
;TWAITで指定できる遅延시간の最小が100msのため、사용側の思惑より著しくゆっくり。
;長文に사용するときには注意すること！スキップさせろや！
;CURRENTREDRAW()を記録してREDRAWを戻そうかと思ったけど、おそらく蛇발なのでしない
;マウスクリックでTINPUTを進められればスキップもできるのにぐぬぬ
;-------------------------------------------------
@PRINTWAIT, ARGS
#DIM LCOUNT

REDRAW 0

FOR LCOUNT, 0, STRLENSU(ARGS)
	PRINTFORM %SUBSTRINGU(ARGS, LCOUNT, 1)%

	;二文字に一度止める…うーｎ
	;IF LCOUNT%2
		TWAIT 100, 0
	;ELSE
	;	PRINTL 
	;ENDIF
	CLEARLINE 1
	PRINTFORM %SUBSTRINGU(ARGS, 0, LCOUNT + 1)%
NEXT

REDRAW 1

@PRINTWAITL, ARGS
#DIM LCOUNT

REDRAW 0

FOR LCOUNT, 0, STRLENSU(ARGS)
	PRINTFORM %SUBSTRINGU(ARGS, LCOUNT, 1)%
	TWAIT 100, 1
	CLEARLINE 1
	PRINTFORM %SUBSTRINGU(ARGS, 0, LCOUNT + 1)%
NEXT
PRINTL 

REDRAW 1

@PRINTWAITW, ARGS
#DIM LCOUNT

REDRAW 0

FOR LCOUNT, 0, STRLENSU(ARGS)
	PRINTFORM %SUBSTRINGU(ARGS, LCOUNT, 1)%
	TWAIT 100, 1
	CLEARLINE 1
	PRINTFORM %SUBSTRINGU(ARGS, 0, LCOUNT + 1)%
NEXT
PRINTW 

REDRAW 1

;-------------------------------------------------
;文字列の桁数を合わせる
;RJは右詰、LJは左詰め
;-------------------------------------------------
@TEXT_RJ(ARGS, ARG)
#FUNCTIONS
SELECTCASE STRLENS(ARGS)
CASE IS >= ARG
	RETURNF ARGS
CASEELSE
	LOCALS = %BL(ARG-STRLENS(ARGS) )%%ARGS%
ENDSELECT
RETURNF LOCALS

@TEXT_LJ(ARGS, ARG)
#FUNCTIONS
SELECTCASE STRLENS(ARGS)
CASE IS >= ARG
	RETURNF ARGS
CASEELSE
	LOCALS = %ARGS%%BL(ARG-STRLENS(ARGS) )%
ENDSELECT
RETURNF LOCALS

;-------------------------------------------------
;左端にARGSを出力させるDRAWLINE
;ARGS:1に文字列を入れると、ARGS部分をARGS:1を返すスイッチにします
;-------------------------------------------------
@DRAWLINES, ARGS, ARGS:1
LOCALS = %ARGS%
IF ARGS:1 != ""
	PRINTBUTTON LOCALS, ARGS:1
ELSE
	PRINTFORM %LOCALS%
ENDIF
FOR LOCAL, 0, NUM("折り返し文字数") - STRLENS(ARGS)
	PRINTFORM -
NEXT
;自動改行
PRINTL 

;-------------------------------------------------
;複数손가락定のSETBIT, CLEARBIT, INVERTBIT
;ただし、ARG:1～ARG:2までのbit全てと、ARG:3, ARG:4, …の単体のbitに作用する
;そして, 0bitを操作できるのはARG:1のみである
;例1）LOCAL = SETBITS(LOCAL, 0, 5, 7)でLOCALの0～5bitと7bitがONになる
;例2）LOCAL = SETBITS(LOCAL, 1, 5, 0)だとLOCALの1～5bitがONになる. 0bitは変化しない
;例3）LOCAL = SETBITS(LOCAL, 2)はSETBIT LOCAL, 2 と等しい
;-------------------------------------------------
@SETBITS(ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7)
#FUNCTION
FOR LOCAL, ARG:1, MAX(ARG:1, ARG:2)+1
	SETBIT ARG, LOCAL
NEXT
FOR LOCAL, 3, 8
	SIF ARG:LOCAL
		SETBIT ARG, ARG:LOCAL
NEXT
RETURNF ARG

@CLEARBITS(ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7)
#FUNCTION
FOR LOCAL, ARG:1, MAX(ARG:1, ARG:2)+1
	CLEARBIT ARG, LOCAL
NEXT
FOR LOCAL, 3, 8
	SIF ARG:LOCAL
		CLEARBIT ARG, ARG:LOCAL
NEXT
RETURNF ARG

@INVERTBITS(ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7)
#FUNCTION
FOR LOCAL, ARG:1, MAX(ARG:1, ARG:2)+1
	INVERTBIT ARG, LOCAL
NEXT
FOR LOCAL, 3, 8
	SIF ARG:LOCAL
		INVERTBIT ARG, ARG:LOCAL
NEXT
RETURNF ARG

;-------------------------------------------------
;複数손가락定のGETBIT
;ただし、ARG:1～ARG:2までのbit全てと、ARG:3, ARG:4, …の単体のbitに作用する
;そして, 0bitを参照できるのはARG:1のみである
;例1）GETBITS(LOCAL, 0, 5, 7)でLOCALの0～5bitと7bitの和を返す
;例2）GETBITS(LOCAL, 1, 5, 0)orGETBITS(LOCAL, 1, 5)だとLOCALの1～5bitの和を返す
;具体的にはLOCAL = 2+8+32 ならGETBITS(LOCAL, 2, 4) = 8となる
;実例）GETBITS(LOCAL, 2)は大体GETBIT(LOCAL, 2) と等しい用途に用いることが出来る
;-------------------------------------------------
@GETBITS(ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7)
#FUNCTION
#DIM LCOUNT
VARSET LOCAL
FOR LCOUNT, ARG:1, MAX(ARG:1, ARG:2)+1
	SIF GETBIT(ARG, LCOUNT)
		LOCAL += POWER(2, LCOUNT)
NEXT
FOR LCOUNT, 3, 8
	SIF ARG:LCOUNT == 0
		CONTINUE
	SIF GETBIT(ARG, ARG:LCOUNT)
		LOCAL += POWER(2, ARG:LCOUNT)
NEXT
RETURNF LOCAL

;-------------------------------------------------
;複数指定のSTRCOUNT
;-------------------------------------------------
@STRCOUNTS(ARGS, ARGS:1, ARGS:2, ARGS:3, ARGS:4, ARGS:5, ARGS:6, ARGS:7, ARGS:8, ARGS:9)
#FUNCTION
#DIM LCOUNT

LOCAL = 0

FOR LCOUNT, 1, 10
	SIF ARGS:LCOUNT == ""
		BREAK
	LOCAL += STRCOUNT(ARGS, ARGS:LCOUNT)
NEXT
RETURNF LOCAL

;-------------------------------------------------
;ARGSから、文字ARGS:1とARGS:2に挟まれた部分を抜き出す
;ARGS:1やARGS:2で分割した際に、２分割になるものだけに使うと間違いがないだろう
;複数分割にされる場合には、文字列の中でARGS:1とARGS:2に挟まれた"一番左の文字列"を返す
;ちなみにARGS:2 == "" の場合にはARGS:1の右側だけを返し、
;ARGS:1 == "" の場合にはARGS:2の左側だけを返す
;-------------------------------------------------
@EXTSTR(ARGS, ARGS:1, ARGS:2)
#FUNCTIONS

VARSET LOCALS
SPLIT ARGS, ARGS:1, LOCALS
IF LOCALS:1 != ""
	ARGS = %LOCALS:1%
ELSE
	ARGS = %LOCALS%
ENDIF

VARSET LOCALS
SPLIT ARGS, ARGS:2, LOCALS

RETURNF LOCALS

;-------------------------------------------------
;식별번호を캐릭터의番号に変換する関数
;値が0を越えているのに該当キャラが居ない場合には-1を返す
;そもそも조교キャラを손가락していないマイナスの値の場合にはその値を返す
;-------------------------------------------------
@TO_NUMBER(ARG)
#FUNCTION

SELECTCASE ARG
CASE IS > 0
	LOCAL = FINDCHARA(BASE:식별번호, ARG)
CASEELSE
	LOCAL = ARG
ENDSELECT

RETURNF LOCAL

;-------------------------------------------------
;/で区切られた요정素でなる文字列ARGS中にARGS:1, ARGS:2, …が計何個あるかを返す関数
;-------------------------------------------------
@NUM_STR(ARGS, ARGS:1, ARGS:2, ARGS:3, ARGS:4, ARGS:5, ARGS:6, ARGS:7)
#FUNCTION
#DIM LCOUNT

VARSET LOCALS
;それぞれの요정素に分解
SPLIT ARGS, "/", LOCALS

LOCAL = 0

;LOCALSはLOCALS:0～LOCALS:99まで
FOR LCOUNT, 0, 100
	SIF LOCALS:LCOUNT == ""
		RETURNF LOCAL

	SELECTCASE LOCALS:LCOUNT
	CASE ARGS:1, ARGS:2, ARGS:3, ARGS:4, ARGS:5, ARGS:6, ARGS:7
		LOCAL += 1
	ENDSELECT
NEXT

RETURNF LOCAL

;-------------------------------------------------
;/で区切られた数字の요정素でなる文字列ARGS中の최대の数値を返す関数
;-------------------------------------------------
@MAX_STR(ARGS)
#FUNCTION
#DIM LCOUNT

VARSET LOCALS
;それぞれの요정素に分解
SPLIT ARGS, "/", LOCALS

;左端の요정素の数値を初期値とする
LOCAL = TOINT(LOCALS:0)

;LOCALSはLOCALS:0～LOCALS:99まで
FOR LCOUNT, 1, 100
	SIF LOCALS:LCOUNT == ""
		RETURNF LOCAL

	;文字列を数字化して比較
	SIF TOINT(LOCALS:LCOUNT) > LOCAL
		LOCAL = TOINT(LOCALS:LCOUNT)
NEXT

RETURNF LOCAL

;-------------------------------------------------
;/で区切られた数字の요정素でなる文字列ARGS中の最小の数値を返す関数
;-------------------------------------------------
@MIN_STR(ARGS)
#FUNCTION
#DIM LCOUNT

VARSET LOCALS
;それぞれの요정素に分解
SPLIT ARGS, "/", LOCALS

;左端の요정素の数値を初期値とする
LOCAL = TOINT(LOCALS:0)

;LOCALSはLOCALS:0～LOCALS:99まで
FOR LCOUNT, 1, 100
	SIF LOCALS:LCOUNT == ""
		RETURNF LOCAL

	;文字列を数字化して比較
	SIF TOINT(LOCALS:LCOUNT) < LOCAL
		LOCAL = TOINT(LOCALS:LCOUNT)
NEXT

RETURNF LOCAL

;-------------------------------------------------
;/で区切られた数字の요정素でなる文字列ARGS中の数値の総和を返す関数
;-------------------------------------------------
@SUM_STR(ARGS)
#FUNCTION
#DIM LCOUNT

VARSET LOCALS
;それぞれの요정素に分解
SPLIT ARGS, "/", LOCALS

LOCAL = 0

;LOCALSはLOCALS:0～LOCALS:99まで
FOR LCOUNT, 0, 100
	SIF LOCALS:LCOUNT == ""
		RETURNF LOCAL

	;文字列を数字化して발していく
	LOCAL += TOINT(LOCALS:LCOUNT)
NEXT

RETURNF LOCAL

;-------------------------------------------------
;/で区切られた数字の요정素でなる文字列ARGS中の各요정素に整数ARGを발す関数
;数値を減らしたい時にはARGに負の整数を代入する
;-------------------------------------------------
@ADDNUM_STR(ARGS, ARG)
#FUNCTIONS
#DIM LCOUNT

VARSET LOCALS
;それぞれの요정素に分解
SPLIT ARGS, "/", LOCALS

LOCALS = {TOINT(LOCALS) + ARG}/

;LOCALSはLOCALS:0～LOCALS:99まで
FOR LCOUNT, 1, 100
	SIF LOCALS:LCOUNT == ""
		RETURNF LOCALS

	;文字列を数字化して발していく
	LOCALS = %LOCALS%{TOINT(LOCALS:LCOUNT) + ARG}/
NEXT

RETURNF LOCALS

;-------------------------------------------------
;ある条件におけるキャラ以外の数の判定
;NUMの内部사용は禁止
;-------------------------------------------------
@NUM(ARGS, ARG)
#FUNCTION
#DIM LCOUNT

LOCAL = 0
SELECTCASE ARGS
CASE "折り返し文字数"
	RETURNF 80
CASE "목표금액"
	SIF CONFIG("ＥＡＳＹ")
		RETURNF 100000
	RETURNF 1000000
CASE "목표금액：ＮＯＲＭＡＬ"
	RETURNF 1000000
CASE "목표금액：ＥＡＳＹ"
	RETURNF 100000
CASE "턴수"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = TCVAR:ARG:150
CASE "運営가능店舗"
	LOCAL = MIN(CHARA_NUM("バイト가능")/4, 5)
CASE "所持店舗"
	LOCAL = FLAG:400
CASE "運営店舗"
	LOCAL = MIN(FLAG:400, CHARA_NUM("플로어점원")/4, 5)
CASE "所持악세사리"
	FOR LCOUNT, 1, 9
		SIF FLAG:(300 + LCOUNT*10)
			LOCAL += 1
	NEXT
CASE "未鑑定の악세사리"
	FOR LCOUNT, 320, 330
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
CASE "所持衣装"
	FOR LCOUNT, 500, 550
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
CASE "総衣装数"
	FOR LCOUNT, 500, 550
		SIF STRLENS(ITEMNAME:LCOUNT )
			LOCAL += 1
	NEXT
CASE "所持아이템"
	FOR LCOUNT, 0, 100
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
	;瓶の정액はノーカン
	SIF ITEM:정액저축량
		LOCAL -= 1
CASE "所持인센스"
	FOR LCOUNT, 40, 50
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
CASE "存在する아르카나"
	FOR LCOUNT, 230, 260
		SIF STRLENS(TALENTNAME:LCOUNT)
			LOCAL += 1
	NEXT
CASE "매각가능아이템"
	FOR LCOUNT, 0, 50
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
	SIF ITEM:사고연마의돌
		LOCAL += 1
	SIF ITEM:문드롭스
		LOCAL += 1
	FOR LCOUNT, 300, 320
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
	FOR LCOUNT, 350, 400
		SIF ITEM:LCOUNT
			LOCAL += 1
	NEXT
CASE "최대레벨"
	SELECTCASE ARG
	CASE 2 TO 5, 14, 16
		RETURNF 10
	;ＶＡ확장ＬＶは暫定10
	CASE 23, 26
		RETURNF 10
	;ＬＶは난이도で変化
	CASE 90
		IF CONFIG("ＨＡＲＤ")
			RETURNF 50
		ELSE
			RETURNF 30
		ENDIF
	CASEELSE
		RETURNF 5
	ENDSELECT
CASE "성희롱턴수"
	VARSET LOCALS
	SPLIT CSTR:MASTER:성희롱끝, "/", LOCALS
	FOR LCOUNT, 0, 100
		SIF LOCALS:LCOUNT == ""
			BREAK
		LOCAL += 1
	NEXT
CASE "성희롱"
	FOR LCOUNT, 0, 64
		SIF STRLENS(NAMES(ARGS, LCOUNT) ) == 0
			BREAK
		LOCAL += 1
	NEXT
CASE "속성"
	FOR LCOUNT, 0, 64
		SIF STRLENS(NAMES(ARGS, LCOUNT) ) == 0
			BREAK
		LOCAL += 1
	NEXT
CASE "성감대"
	FOR LCOUNT, 0, 64
		SIF STRLENS(NAMES(ARGS, LCOUNT) ) == 0
			BREAK
		LOCAL += 1
	NEXT
CASE "ＥＮＤ閲覧済"
	FOR LCOUNT, 1, 100
		SIF FLAG:(1200 + LCOUNT) >= 2
			LOCAL += 1
	NEXT
CASE "宝구슬：음핵취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:음핵 + TALENT:ARG:음호 + TALENT:ARG:애널광 + TALENT:ARG:음유 + TALENT:ARG:음탕한입술
		LOCAL *= 5
	SIF TALENT:ARG:Ｃ민감
		LOCAL /= 2
CASE "宝구슬：요도광취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:음핵 + TALENT:ARG:음호 + TALENT:ARG:애널광 + TALENT:ARG:음유 + TALENT:ARG:음탕한입술
		LOCAL *= 5
CASE "宝구슬：음호취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:음핵 + TALENT:ARG:음호 + TALENT:ARG:애널광 + TALENT:ARG:음유 + TALENT:ARG:음탕한입술
		LOCAL *= 5
	SIF TALENT:ARG:Ｖ민감
		LOCAL /= 2
CASE "宝구슬：애널광취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:음핵 + TALENT:ARG:음호 + TALENT:ARG:애널광 + TALENT:ARG:음유 + TALENT:ARG:음탕한입술
		LOCAL *= 5
	SIF TALENT:ARG:Ａ민감
		LOCAL /= 2
CASE "宝구슬：음유취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:음핵 + TALENT:ARG:음호 + TALENT:ARG:애널광 + TALENT:ARG:음유 + TALENT:ARG:음탕한입술
		LOCAL *= 5
	SIF TALENT:ARG:Ｂ민감
		LOCAL /= 2
CASE "宝구슬：음탕한입술취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:음핵 + TALENT:ARG:음호 + TALENT:ARG:애널광 + TALENT:ARG:음유 + TALENT:ARG:음탕한입술
		LOCAL *= 5
	SIF TALENT:ARG:Ｍ민감
		LOCAL /= 2
CASE "宝구슬：도착적취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 50000
CASE "宝구슬：마조취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:새드
		LOCAL = 300000
CASE "宝구슬：새드취득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	SIF TALENT:ARG:마조
		LOCAL = 300000
CASE "宝구슬：아르카나습득"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = 100000
	FOR LCOUNT, 230, 260
		SIF TALENT:ARG:LCOUNT
			LOCAL += 50000
	NEXT
	SIF TALENT:ARG:마법사
		LOCAL /= 10
CASE "아르카나습득数"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	IF TALENT:ARG:마법사 == 2
		FOR LCOUNT, 230, 260
			SIF STRLENS(TALENTNAME:LCOUNT)
				LOCAL += 1
		NEXT
	ELSE
		FOR LCOUNT, 230, 260
			SIF TALENT:ARG:LCOUNT
				LOCAL += 1
		NEXT
	ENDIF
CASE "아르카나습득가능数"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	FOR LCOUNT, 230, 260
		SELECTCASE LCOUNT
		CASE 235, 240
			SIF ARG == MASTER
				CONTINUE
		ENDSELECT
		SIF STRLENS(TALENTNAME:LCOUNT)
			LOCAL += 1
	NEXT
CASE "경험치：소질획득"
	;SIF ARG == 0 && TARGET
	;	ARG = TARGET
	;LOCAL = 200 + 200*CFLAG:ARG:5
	LOCAL = 300
CASE "다방：난교予定人数"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	LOCAL = CFLAG:ARG:32
CASE "다방の肉棒比率"
	FOR LCOUNT, 2, CHARANUM
		SIF COND("플로어점원", LCOUNT) && PENIS(LCOUNT)
			LOCAL += 1
	NEXT
	LOCAL = LOCAL * 100 / MAX(CHARA_NUM("플로어점원"), 1)
CASE "빈유の상한"
	;AAA～Ａ
	RETURNF 3
CASE "평유の상한"
	;Ｂ～Ｄ
	RETURNF 6
CASE "거유の상한"
	;ＦorＧorＨ
	RETURNF 8 + CONFIG("거유보정：컵")
CASE "폭유の상한"
	;ＩorＪorＫ
	RETURNF 11 + CONFIG("거유보정：컵")
CASE "요정の상한"
	RETURNF 75
CASE "小柄の상한"
	RETURNF 144
CASE "보통の상한"
	RETURNF 163
;날짜이벤트など특수이벤트
CASE "크리스마스트리"
	FOR LCOUNT, 2, CHARANUM
		SIF CEVENT("날짜：크리스마스트리", LCOUNT)
			LOCAL += 1
	NEXT
CASEELSE
	THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT
RETURNF LOCAL


;-------------------------------------------------
;ある条件における캐릭터의人数の判定
;-------------------------------------------------
@CHARA_NUM(ARGS)
#FUNCTION
#DIM LCOUNT

LOCAL = 0
SELECTCASE ARGS
CASE "난교참가中"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "욕구불만で난교가능"
	FOR LCOUNT, 2, CHARANUM
		SIF COND("욕구불만", LCOUNT) == 0
			CONTINUE
		SIF COND("난교가능", LCOUNT) == 0
			CONTINUE

		LOCAL += 1
	NEXT

CASE "난교가능"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "日常이벤트출연가능"
	FOR LCOUNT, 2, CHARANUM
		SIF EXP:LCOUNT:조교횟수 == 0 || COND("日常이벤트출연끝", LCOUNT)
			CONTINUE
		LOCAL += 1
	NEXT
CASE "서류작업"
	FOR LCOUNT, 2, CHARANUM
		;登場できるかどうか
		SELECTCASE NO:LCOUNT
		;머메이드は다리無いから…
		CASE 13, 37
			CONTINUE
		;아들は…誰か書いて！
		CASE 94
			CONTINUE
		ENDSELECT


		;요바이가능ぐらいが条件か
		SIF COND("요바이가능", LCOUNT) == 0
			CONTINUE

		LOCAL += 1
	NEXT
CASE "드렁크"
	FOR LCOUNT, 1, CHARANUM
		SIF STATE("드렁크", LCOUNT)
			LOCAL += 1
	NEXT
CASE "관내노출관객数"
	FOR LCOUNT, 151, 155
		SIF TFLAG:LCOUNT
			LOCAL += 1
	NEXT
CASE "온천여행가능"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
;バイト가능人数(勤務지시や妊婦など, 一時的に働けない人含む)
CASE "バイト가능"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
;フロア店員数(実際に働く予定の人数) 当然だが, バイト가능人数이하の値となる
CASE "플로어점원"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "아르카나획득가능"
	FOR LCOUNT, 1, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "출산間近"
	FOR LCOUNT, 2, CHARANUM
		SIF TALENT:LCOUNT:임신 == 3
			LOCAL += 1
	NEXT
CASE "조수가능"
	FOR LCOUNT, 2, CHARANUM
		SIF CFLAG:LCOUNT:1 >= 2
			LOCAL += 1
	NEXT
CASE "지시가능な조수"
	FOR LCOUNT, 2, CHARANUM
		SIF ABL:LCOUNT:조수
			LOCAL += 1
	NEXT
CASE "매각가능"
	FOR LCOUNT, 2, CHARANUM
		SIF CFLAG:LCOUNT:1 >= 1
			LOCAL += 1
	NEXT
CASE "하룻밤개방가능"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "하룻밤개방実行予定"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "하룻밤개방실행끝"
	FOR LCOUNT, 2, CHARANUM
		SIF COND(ARGS, LCOUNT)
			LOCAL += 1
	NEXT
CASE "控えキャラ"
	LOCAL = CHARANUM - 2
	SIF TARGET
		LOCAL -= 1
CASE "조교경험あり"
	FOR LCOUNT, 2, CHARANUM
		SIF EXP:LCOUNT:조교횟수
			LOCAL += 1
	NEXT
CASE "繰り越しキャラ"
	FOR LCOUNT, 2, CHARANUM
		LOCAL += CFLAG:LCOUNT:6
	NEXT
CASE "陥落済み"
	FOR LCOUNT, 2, CHARANUM
		SIF TALENT:LCOUNT:음란 || TALENT:LCOUNT:연모
			LOCAL += 1
	NEXT
CASE "연모음란"
	FOR LCOUNT, 2, CHARANUM
		SIF TALENT:LCOUNT:연모 || TALENT:LCOUNT:음란
			LOCAL += 1
	NEXT
;それ以外は소질
CASEELSE
	FOR LCOUNT, 2, CHARANUM
		SIF TALENT:LCOUNT:ARGS
			LOCAL += 1
	NEXT
ENDSELECT
RETURNF LOCAL

;-------------------------------------------------
;자주 사용하는 조건의 정리
;LOCALなどの사용금지! 
;ARG가ARGS을 채울지 판정함. 다만, 삽입에 관해선 @INSERT이 관리함
;소질에 대해선 "소질名"을 넣으면 기능하고, 그 소질이 없는걸 조건으로 한다면 "!소질名"로 넣기
;-------------------------------------------------
@COND(ARGS, ARG)
#FUNCTION
#DIM LCOUNT

SIF ARG < 0
	RETURNF 0
SIF ARG == 0 && TARGET
	ARG = TARGET
SELECTCASE ARGS
CASE "절정"
	SIF TEQUIP:ARG:손대중 > 0
		RETURNF 0
	;절정＆사정
	SELECTCASE ARG
	CASE TARGET
		RETURNF NOWEX:ARG:절정수합계 + NOWEX:ARG:사정
	CASE PLAYER
		RETURNF TCVAR:ARG:1
	CASEELSE
		RETURNF MAX(TCVAR:ARG:1, NOWEX:ARG:절정수합계, NOWEX:ARG:사정)
	ENDSELECT
CASE "精通"
	SIF PENIS(ARG) == 0 || EXP:ARG:사정경험 == 0
		RETURNF 0
	SIF NOWEX:ARG:사정 == EXP:ARG:사정경험
		RETURNF 1
CASE "イきそう"
	SELECTCASE ARG
	CASE PLAYER
		;절정게이지の75％이상
		SIF BASE:ARG:절정 >= MAXBASE:ARG:절정 * 3 / 4
			RETURNF 1
	CASEELSE
		SIF EX:ARG:가는것을참았다
			RETURNF 1
		;快感許容値の75％이상
		SIF BASE:ARG:성감허용치여자 >= MAXBASE:ARG:성감허용치여자 * 3 / 4
			RETURNF 1
		;절정게이지の75％이상
		SIF BASE:ARG:절정 >= MAXBASE:ARG:절정 * 3 / 4
			RETURNF 1
	ENDSELECT
CASE "こらえる"
	SIF TFLAG:7 >= 4 && NOWEX:ARG:럭셔리어스히트 == 0
		RETURNF 1
CASE "潮噴き가능"
	;여성器があることと, ある程度の요의が必須
	SIF TALENT:ARG:남자 || BASE:ARG:요의 < 1000
		RETURNF 0
	;요도삽입中は不可
	SIF INSERT("요도인서트", ARG)
		RETURNF 0

	;오줌싸개버릇などがあるなら条件緩和
	IF TALENT:ARG:오줌싸개버릇 || TEQUIP:ARG:카테터 || ABL:ARG:요도확장 >= 0
		SIF MAX(NOWEX:ARG:Ｃ절정 + NOWEX:ARG:요도절정, NOWEX:ARG:Ｖ절정, NOWEX:ARG:Ａ절정, NOWEX:ARG:Ｂ절정, NOWEX:ARG:Ｍ절정) < 2
			RETURNF 0
		SIF MAX(NOWEX:ARG:Ｃ절정 + NOWEX:ARG:요도절정, NOWEX:ARG:Ｖ절정) == 0 && MAX(NOWEX:ARG:Ａ절정, NOWEX:ARG:Ｂ절정, NOWEX:ARG:Ｍ절정) < 3
			RETURNF 0
	ELSE
		SIF MAX(NOWEX:ARG:Ｃ절정 + NOWEX:ARG:요도절정, NOWEX:ARG:Ｖ절정) < 3 || NOWEX:ARG:절정수합계 < 5
			RETURNF 0
		SIF BASE:ARG:요의 < 10000
			RETURNF 0
	ENDIF
	RETURNF 1
CASE "前回절정", "前Ｔ절정"
	SIF PREVPLAY("절정", ARG)
		RETURNF 1
CASE "에너지드레인"
	SELECTCASE ARG
	CASE PLAYER
		SIF GETBIT(TEQUIP:ARG:특수행동, 2)
			RETURNF 1
	CASEELSE
		SIF GETBIT(TEQUIP:ARG:특수행동, 2) && GETBIT(TEQUIP:PLAYER:특수행동, 2)
			RETURNF NOWEX:ARG:에너지드레인
	ENDSELECT
CASE "레벨ドレイン"
	SELECTCASE ARG
	CASE PLAYER
		SIF GETBIT(TEQUIP:ARG:특수행동, 3)
			RETURNF 1
	CASEELSE
		SIF GETBIT(TEQUIP:ARG:특수행동, 3) && GETBIT(TEQUIP:PLAYER:특수행동, 3)
			RETURNF 1
	ENDSELECT

CASE "両穴くぱぁ"
	SIF GETBIT(TEQUIP:ARG:특수행동, 4)
		RETURNF 1

CASE "절정：드래곤"
	RETURNF TFLAG:9
CASE "절정許可"
	RETURNF TCVAR:ARG:2
CASE "사정箇所변경"
	RETURNF TCVAR:ARG:4
CASE "派生前の선택커맨드"
	RETURNF SELECTCOM:4
CASE "派生前の前回선택커맨드"
	RETURNF PREVCOM:4
CASE "Ｗ넘어뜨리기主導中"
	SIF TEQUIP:ARG:Ｗ넘어뜨리기 == 1
		RETURNF 1
CASE "前回펠라"
	SELECTCASE PREVCOM
	CASE 91, 99, 140, 150
		SIF COND("前Ｔ조교자", ARG) == PLAYER && PENIS(PLAYER)
			RETURNF 1
	ENDSELECT
CASE "주인への연모"
	SIF TALENT:ARG:연모 || CEVENT("조수조교での소질変化：연모外し", ARG)
		RETURNF 1
CASE "입의 사용"
	;볼개그or촉수구욕
	SIF TEQUIP:ARG:재갈 == 1 || TEQUIP:ARG:촉수구욕
		RETURNF 0
	RETURNF 1
CASE "입淫中"
	SELECTCASE SELECTCOM
	CASE 6, 91, 99, 140, 150
		RETURNF 1
	ENDSELECT
CASE "視力"
	;아이마스크
	SIF TEQUIP:ARG:아이마스크
		RETURNF 0
	RETURNF 1
CASE "손가락 사용"
	SIF TALENT:ARG:하피 || GETBIT(TEQUIP:ARG:구속, 20)
		RETURNF 0
	RETURNF 1
CASE "다리 사용"
	SIF TALENT:ARG:라미아 || TALENT:ARG:머메이드 || GETBIT(TEQUIP:ARG:구속, 21)
		RETURNF 0
	RETURNF 1
CASE "다리が無い"
	SIF TALENT:ARG:라미아 || TALENT:ARG:머메이드
		RETURNF 1
CASE "신발の着用"
	SIF TALENT:ARG:라미아 || TALENT:ARG:머메이드 || GETBIT(TEQUIP:ARG:구속, 21)
		RETURNF 0
	SIF TALENT:ARG:동물다리 == 2 || TALENT:ARG:동물다리 == 5 || TALENT:ARG:동물다리 == 8 || TALENT:ARG:동물다리 == 11
		RETURNF 0
	RETURNF 1
CASE "뿔ハンドル"
	;악마の角だと掴み易い
	SIF TALENT:ARG:뿔 == 6
		RETURNF 1

;～자위中はTARGETのみ
CASE "Ｃ자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 0)
CASE "Ｖ자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 1)
CASE "Ａ자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 2)
CASE "Ｂ자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 3)

CASE "샤워자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 10)
CASE "Ｖ바이브자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 11)
CASE "Ａ바이브자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 12)
CASE "양구멍바이브자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 13)
CASE "오나홀자위中"
	RETURNF GETBIT(CHECK_ONANIE(SELECTCOM), 14)

CASE "로션마사지実行済"
	SIF GETBIT(TEQUIP:ARG:로션, 2)
		RETURNF 1

CASE "페니스밴드"
	SIF ITEM:페니스밴드 == 0 || CONFIG("페니스밴드필터")
		RETURNF 0
	RETURNF 1
CASE "쌍두바이브"
	RETURNF GETBIT(TEQUIP:ARG:바이브, 10)

CASE "애널비즈"
	RETURNF GETBIT(TEQUIP:ARG:애널바이브, 11)

CASE "애널플러그"
	RETURNF GETBIT(TEQUIP:ARG:관장, 9)
CASE "애널栓"
	RETURNF GETBIT(TEQUIP:ARG:관장, 9) + TEQUIP:ARG:애널바이브 + GETBIT(TEQUIP:확장벌룬, 1)
CASE "공기관장"
	RETURNF GETBIT(TEQUIP:ARG:관장, 0)
CASE "액체관장"
	RETURNF GETBIT(TEQUIP:ARG:관장, 1) + GETBIT(TEQUIP:ARG:관장, 2) + GETBIT(TEQUIP:ARG:관장, 3) + GETBIT(TEQUIP:ARG:관장, 4)
CASE "대량관장"
	RETURNF GETBIT(TEQUIP:ARG:관장, 3) + GETBIT(TEQUIP:ARG:관장, 4)
CASE "정액관장"
	RETURNF GETBIT(TEQUIP:ARG:관장, 10)
CASE "온천관장"
	RETURNF GETBIT(TEQUIP:ARG:관장, 11)

CASE "배설：危険域"
	SIF TEQUIP:ARG:관장 && BASE:ARG:배설욕 >= 8000
		RETURNF 1
CASE "배설：限界"
	SIF BASE:ARG:배설욕 >= MAXBASE:ARG:배설욕
		RETURNF 1

CASE "운명검열：애무"
	RETURNF GETBIT(TEQUIP:ARG:운명검열, 0)
CASE "운명검열：보지"
	RETURNF GETBIT(TEQUIP:ARG:운명검열, 1)
CASE "운명검열：가슴"
	RETURNF GETBIT(TEQUIP:ARG:운명검열, 2)
CASE "운명검열：키스"
	RETURNF GETBIT(TEQUIP:ARG:운명검열, 3)
CASE "운명검열：애널"
	RETURNF GETBIT(TEQUIP:ARG:운명검열, 4)
CASE "운명검열：영창"
	RETURNF GETBIT(TEQUIP:ARG:운명검열, 5)

CASE "요도사용中"
	IF ARG == TARGET
		SELECTCASE SELECTCOM
		;사용中
		CASE 83
			RETURNF 1
		CASEELSE
			SIF INSERT("요도인서트", ARG)
				RETURNF 1
		ENDSELECT
	ENDIF
CASE "焦らされ中"
	SIF TEQUIP:ARG:손대중 > 0 && BASE:ARG:절정 >= MAXBASE:ARG:절정
		RETURNF 1
CASE "사정금지中"
	IF ARG == TARGET
		SIF TEQUIP:ARG:손대중 || TEQUIP:ARG:플라트 == 1
			RETURNF 1
		SIF TEQUIP:ARG:카테터
			RETURNF 1
		SIF COND("요도사용中", ARG)
			RETURNF 1
	ENDIF
	SIF COND("Ｐ바인드弱体플래그", ARG)
		RETURNF 0
	SIF BASE:ARG:성감허용치남자 >= MAX(MAXBASE:ARG:성감허용치남자*2, MAXBASE:ARG:절정*4)
		RETURNF 0
	SIF STATE("바인드：Ｐ", ARG)
		RETURNF 1

CASE "아르카나대상"
	RETURNF TCVAR:ARG:22
CASE "아르카나영창"
	RETURNF TCVAR:ARG:23

CASE "마음에 드는 체위中"
	SIF GETBIT(TALENT:ARG:선호체위, 9)
		RETURNF 0
	SIF GETBIT(TALENT:ARG:선호체위, 19) && SELECTCOM == 80
		RETURNF 1
	IF INSERT("Ｖ인서트", ARG)
		IF GETBIT(TALENT:ARG:선호체위, 0) && INSERT("정상위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 1) && INSERT("후배위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 2) && INSERT("굴곡위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 3) && INSERT("대면좌위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 4) && INSERT("배면좌위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 5) && INSERT("기승위", ARG) && TEQUIP:ARG:넘어뜨리기 == 0
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 6) && INSERT("기승위", ARG) && TEQUIP:ARG:넘어뜨리기
			RETURNF 1
		ENDIF
	ENDIF
	IF INSERT("Ａ인서트", ARG)
		IF GETBIT(TALENT:ARG:선호체위, 10) && INSERT("정상위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 11) && INSERT("후배위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 12) && INSERT("굴곡위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 13) && INSERT("대면좌위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 14) && INSERT("배면좌위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 15) && INSERT("기승위", ARG) && TEQUIP:ARG:넘어뜨리기 == 0
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 16) && INSERT("기승위", ARG) && TEQUIP:ARG:넘어뜨리기
			RETURNF 1
		ENDIF
	ENDIF
	IF INSERT("요도인서트", ARG)
		IF GETBIT(TALENT:ARG:선호체위, 20) && INSERT("정상위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 21) && INSERT("후배위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 22) && INSERT("굴곡위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 23) && INSERT("대면좌위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 24) && INSERT("배면좌위", ARG)
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 25) && INSERT("기승위", ARG) && TEQUIP:ARG:넘어뜨리기 == 0
			RETURNF 1
		ELSEIF GETBIT(TALENT:ARG:선호체위, 26) && INSERT("기승위", ARG) && TEQUIP:ARG:넘어뜨리기
			RETURNF 1
		ENDIF
	ENDIF
;中出し後정액掻き出し이벤트で使う。ということでTARGETとPLAYERは固定
CASE "中出され量"
	IF SHOOT("질内", PLAYER)
		RETURNF EXP_GAIN(17, TARGET)
	ELSEIF SHOOT("애널", PLAYER)
		LOCAL = EXP_GAIN(18, TARGET)
	ELSE
		RETURNF 0
	ENDIF
	RETURNF LOCAL
CASE "３Ｐ"
	SIF SELECTCOM:2 >= 0
		RETURNF 1

CASE "마을"
	SIF GETBIT(TEQUIP:야외플레이, 0) || (GETBIT(TFLAG:16, 0) && SELECTCOM == 171)
		RETURNF 1
CASE "삼림"
	SIF GETBIT(TEQUIP:야외플레이, 1) || (GETBIT(TFLAG:16, 1) && SELECTCOM == 171)
		RETURNF 1
CASE "화원"
	SIF GETBIT(TEQUIP:야외플레이, 2) || (GETBIT(TFLAG:16, 2) && SELECTCOM == 171)
		RETURNF 1
CASE "강가"
	SIF GETBIT(TEQUIP:야외플레이, 3) || (GETBIT(TFLAG:16, 3) && SELECTCOM == 171)
		RETURNF 1
CASE "바다"
	SIF GETBIT(TEQUIP:야외플레이, 4) || (GETBIT(TFLAG:16, 4) && SELECTCOM == 171)
		RETURNF 1
CASE "실내"
	SIF TEQUIP:ARG:관내노출플레이 + TEQUIP:ARG:야외플레이 + TEQUIP:ARG:목욕탕플레이 == 0
		RETURNF 1
CASE "조교側"
	;封印中
	RETURNF 0

CASE "포경"
	SIF GETBIT(TALENT:ARG:페니스, 12)
		RETURNF 2
	SIF GETBIT(TALENT:ARG:페니스, 11)
		RETURNF 1
CASE "가성포경"
	SIF GETBIT(TALENT:ARG:페니스, 11)
		RETURNF 1
CASE "진성포경"
	SIF GETBIT(TALENT:ARG:페니스, 12)
		RETURNF 1
CASE "포경の皮を剥いた"
	SIF GETBIT(TALENT:ARG:페니스, 20)
		RETURNF 1

CASE "유두비대"
	SIF CONFIG(ARGS) == 0
		RETURNF 0
	SIF GETBIT(TALENT:ARG:유두, 3)
		RETURNF 3
	SIF GETBIT(TALENT:ARG:유두, 2)
		RETURNF 2
	SIF GETBIT(TALENT:ARG:유두, 1)
		RETURNF 1
	SIF GETBIT(TALENT:ARG:유두, 0)
		RETURNF 0

CASE "함몰유두"
	SIF CONFIG(ARGS) == 0
		RETURNF 0
	SIF GETBIT(TALENT:ARG:유두, 12)
		RETURNF 2
	SIF TALENT:ARG:니플피어스
		RETURNF 0
	SIF GETBIT(TALENT:ARG:유두, 11)
		RETURNF 1
CASE "가성함몰유두"
	SIF CONFIG("함몰유두") == 0
		RETURNF 0
	SIF TALENT:ARG:니플피어스
		RETURNF 0
	SIF GETBIT(TALENT:ARG:유두, 11)
		RETURNF 1
CASE "진성함몰유두"
	SIF CONFIG("함몰유두") == 0
		RETURNF 0
	SIF GETBIT(TALENT:ARG:유두, 12)
		RETURNF 1

CASE "거유륜"
	SIF CONFIG(ARGS) == 0
		RETURNF 0
	SIF GETBIT(TALENT:ARG:유두, 23)
		RETURNF 3
	SIF GETBIT(TALENT:ARG:유두, 22)
		RETURNF 2
	SIF GETBIT(TALENT:ARG:유두, 21)
		RETURNF 1
	SIF GETBIT(TALENT:ARG:유두, 20)
		RETURNF 0


CASE "바스트"
	IF COND("오토코노코", ARG)
		RETURNF BASE:ARG:바스트
	ELSE
		RETURNF BASE:ARG:바스트 + BASE:ARG:바스트의성장/10
	ENDIF
CASE "니플퍽"
	SIF CONFIG("니플퍽") == 0
		RETURNF 0
	SIF TALENT:ARG:거유 == 0
		RETURNF 0
	SIF TALENT:ARG:슬라임 || TALENT:ARG:음유
		RETURNF 1
CASE "자궁구弛緩度"
	;妊婦はNG
	SIF TALENT:ARG:임신
		RETURNF 0

	;자궁구に근육이완제or슬라임
	IF GETBIT(TEQUIP:ARG:근육이완제, 3) || TALENT:ARG:슬라임
		RETURNF 3
	;直前に자궁に삽입済み
	ELSEIF EXP_GAIN(68, ARG) || (EXP:ARG:자궁경험 >= 100 && EXP:ARG:자궁간경험 >= 10)
		RETURNF 2
	;음호で출산경험あり
	ELSEIF TALENT:ARG:음호 && TALENT:ARG:출산경험
		IF EXP:ARG:자궁경험 >= 50 && EXP:ARG:자궁간경험
			RETURNF 2
		ELSEIF EXP:ARG:자궁경험 >= 50 || (EXP:ARG:자궁경험 >= 20 && EX:ARG:Ｖ절정 >= 5)
			SIF MARK:ARG:정액각인 >= 4
				RETURNF 2
			RETURNF 1
		ENDIF
	;음호または출산경험あり
	ELSEIF TALENT:ARG:음호 || TALENT:ARG:출산경험
		IF EXP:ARG:자궁경험 >= 100 && (EXP_GAIN(68, ARG) || EXP:ARG:자궁간경험 >= 5)
			RETURNF 2
		ELSEIF EXP:ARG:자궁경험 >= 100 || (TALENT:ARG:음호 && EXP:ARG:자궁경험 >= 50 && EX:ARG:Ｖ절정 >= 10)
			SIF MARK:ARG:정액각인 >= 4
				RETURNF 2
			RETURNF 1
		ENDIF
	ENDIF
	SIF MARK:ARG:정액각인 >= 4
		RETURNF 1
CASE "몽마"
	SIF TALENT:ARG:몽마 || TALENT:ARG:상위몽마
		RETURNF 1
CASE "오토코노코"
	SIF TALENT:ARG:남자 && TALENT:ARG:오토코노코 && TALENT:ARG:장신 == 0
		RETURNF 1

CASE "着床확인"
	SIF MARK:ARG:정액각인 && BASE:ARG:태아
		RETURNF 1

CASE "안전일"
	SIF MARK:ARG:정액각인 && BASE:ARG:태아
		RETURNF 0
	SIF GETBIT(BASE:ARG:바이오리듬, 10)
		RETURNF 1
CASE "위험일"
	SIF TALENT:ARG:남자 || TALENT:ARG:임신 || TALENT:ARG:피임의부적 || TALENT:ARG:피임약복용 || TALENT:ARG:마도인형 || TALENT:ARG:슬라임
		RETURNF 0
	SIF MARK:ARG:정액각인 && BASE:ARG:태아
		RETURNF 0
	SIF GETBIT(BASE:ARG:바이오리듬, 11)
		RETURNF 1
CASE "배란中"
	SIF MARK:ARG:정액각인 && BASE:ARG:태아
		RETURNF 0
	SIF GETBIT(BASE:ARG:바이오리듬, 12)
		RETURNF 1
CASE "배란유발제사용中"
	SIF MARK:ARG:정액각인 && BASE:ARG:태아
		RETURNF 0
	SIF GETBIT(BASE:ARG:바이오리듬, 13)
		RETURNF 1
CASE "임신確実"
	SIF GETBIT(BASE:ARG:바이오리듬, 14)
		RETURNF 1
CASE "발정기"
	SIF GETBIT(BASE:ARG:바이오리듬, 20)
		RETURNF 1
CASE "태内の정액량"
	RETURNF BASE:ARG:자궁정자량+BASE:ARG:태내정액량
CASE "受精확률"
	SIF COND("임신가능", ARG) == 0 || BASE:ARG:자궁정자량 == 0 || BASE:ARG:정액의우세 == 0
		RETURNF 0
	;임신する가능性ある人は주인？
	SIF CONFIG("임신패치：주인임신가능") == 0 && ARG == MASTER
		RETURNF 0

	;だいたい排卵中の일に100ぐらいあれば임신するのが目安
	LOCAL = BASE:ARG:자궁정자량

	;種付け相手によって임신しやすさが違う（@CHECK_PREGNANTでの精子量の部分で差が出ている）
	;TO_NUMBER(BASE:ARG:정액의우세)はCOND("정액의우세", ARG)に等しい
	SELECTCASE TO_NUMBER(BASE:ARG:정액의우세)
	;촉수
	CASE -5
		;주인以外でも임신가능？
		SIF CONFIG("임신패치：주인の精子のみ")
			RETURNF 0
		;LOCAL /= 5
	;일반인相手
	CASE -4
		;주인以外でも임신가능？
		SIF CONFIG("임신패치：주인の精子のみ") || CONFIG("임신패치：조교以外で임신가능") == 0
			RETURNF 0
		;LOCAL /= 3
	;드래곤
	CASE -3
		;주인以外でも임신가능？
		SIF CONFIG("임신패치：주인の精子のみ")
			RETURNF 0
		;LOCAL /= 4
	CASE MASTER

	CASEELSE
		;주인以外でも임신가능？
		SIF CONFIG("임신패치：주인の精子のみ")
			RETURNF 0
	ENDSELECT

	;임신確実
	IF GETBIT(BASE:ARG:바이오리듬, 14)
		RETURNF 100
	;발정기
	ELSEIF GETBIT(BASE:ARG:바이오리듬, 20)
		LOCAL *= 20
	;배란유발제사용中
	ELSEIF GETBIT(BASE:ARG:바이오리듬, 13)
		LOCAL *= 15
	;배란中
	ELSEIF GETBIT(BASE:ARG:바이오리듬, 12)
		LOCAL *= 10
	;위험일
	ELSEIF GETBIT(BASE:ARG:바이오리듬, 11)
		LOCAL *= 5
	ELSE
		;안전일
		SIF GETBIT(BASE:ARG:바이오리듬, 10)
			LOCAL /= 10
	ENDIF

	LOCAL = MIN(LOCAL/10, 100)
	RETURNF LOCAL
CASE "성전환中"
	RETURNF CFLAG:ARG:4
CASE "임신가능"
	;패치不사용
	SIF CONFIG("임신패치") == 0
		RETURNF 0
	;남자or임신中or피임中or인간형
	SIF TALENT:ARG:남자 || TALENT:ARG:임신 || BASE:ARG:태아 || TALENT:ARG:피임의부적 || TALENT:ARG:피임약복용 || TALENT:ARG:마도인형
		RETURNF 0
	;名がない딸
	SIF NO:ARG == 97 && NAME:ARG == "딸"
		RETURNF 0
	RETURNF 1
CASE "피임中"
	SIF TALENT:ARG:피임의부적 || TALENT:ARG:피임약복용
		RETURNF 1

CASE "임신中"
	RETURNF BASE:ARG:태아
CASE "임신中：임신発覚直前"
	RETURNF GETBIT(BASE:ARG:태아, 6)
CASE "임신中：임신発覚済み"
	RETURNF GETBIT(BASE:ARG:태아, 7)
CASE "임신中：臨月"
	RETURNF GETBIT(BASE:ARG:태아, 8)
CASE "임신中：分娩直前"
	RETURNF GETBIT(BASE:ARG:태아, 9)
CASE "임신中：分娩"
	RETURNF GETBIT(BASE:ARG:태아, 10)
CASE "임신中：아들"
	RETURNF GETBIT(BASE:ARG:태아, 20)
CASE "임신中：各이벤트進行度"
	LOCAL = GETBITS(BASE:ARG:태아, 0, 5)
	RETURNF LOCAL

CASE "임신이벤트中"
	;임신確定, 臨月, 出産, 子育て
	SIF BASE:ARG:태아 || BASE:ARG:육아중 || TALENT:ARG:임신
		RETURNF 1
CASE "출산일"
	RETURNF CFLAG:ARG:485

CASE "육아중：아이が大きくなった"
	SIF GETBITS(BASE:ARG:육아중, 0, 5) >= 14
		RETURNF 1
CASE "육아중：育児종료"
	RETURNF GETBIT(BASE:ARG:육아중, 6)
CASE "육아중：아들"
	RETURNF GETBIT(BASE:ARG:육아중, 20)

CASE "구현가능"
	SIF TALENT:ARG:구현 && PENIS(TARGET) == 0
		RETURNF 1
CASE "유니크"
	SELECTCASE NO:ARG
	CASE 32, 34 TO 40, 44 TO 57, 94, 98
		RETURNF 1
	ENDSELECT
CASE "인외度"
	;인외度を返す
	SIF TALENT:ARG:라미아 + TALENT:ARG:머메이드 + TALENT:ARG:마도인형 + TALENT:ARG:하피 + TALENT:ARG:구지배자의자취 + TALENT:ARG:슬라임 + TALENT:ARG:팔많음
		RETURNF 3
	SIF TALENT:ARG:요정
		RETURNF 2
	SIF TALENT:ARG:뿔 + TALENT:ARG:날개 + TALENT:ARG:요호 + TALENT:ARG:동물귀 + TALENT:ARG:꼬리
		RETURNF 1
CASE "카운터の威力"

CASE "황홀확률"
	RETURNF TFLAG:91
CASE "성감대効果"
	RETURNF TFLAG:92
CASE "넘어뜨리기확률"
	RETURNF TFLAG:93
CASE "아르카나카운터"
	RETURNF TFLAG:94
CASE "카운터の強度"
	RETURNF TFLAG:96


CASE "前Ｔ조교자"
	RETURNF TFLAG:50
CASE "前Ｔ대상"
	RETURNF TFLAG:49
CASE "前Ｔと同ペア"
	SIF TFLAG:49 == TARGET && TFLAG:50 == PLAYER
		RETURNF 1
CASE "前Ｔから대상のみ변경"
	SIF TFLAG:49 != TARGET && TFLAG:50 == PLAYER
		RETURNF 1
CASE "前Ｔから조교자のみ변경"
	SIF TFLAG:49 == TARGET && TFLAG:50 != PLAYER
		RETURNF 1
CASE "連続実行"
	;前回커맨드が違うor조교中で無いなら連続とはみなさない
	SIF PREVCOM != SELECTCOM || SELECTCOM < 0 || COND("조교中", ARG) == 0
		RETURNF 0
	;連続実行の例外
	SELECTCASE SELECTCOM
	CASE 8
		SIF CHECK_COM("Ｇ스팟자극")
			RETURNF 0
	CASE 31, 201
		SIF TEQUIP:바이브 == 0
			RETURNF 0
	CASE 33, 202
		SIF TEQUIP:애널바이브 == 0
			RETURNF 0
	CASE 34, 203
		SIF TEQUIP:클리캡 == 0
			RETURNF 0
	CASE 35, 204
		SIF TEQUIP:니플캡 == 0
			RETURNF 0
	CASE 36, 205
		SIF TEQUIP:착유기 == 0
			RETURNF 0
	CASE 38
		SIF TEQUIP:샤워 == 0
			RETURNF 0
	CASE 60 TO 79
		SIF INSERT("와일드스윙")
			RETURNF 0
	CASE 136, 207
		SIF TEQUIP:관장 == 0
			RETURNF 0
	CASE 137
		SIF TEQUIP:확장벌룬 == 0
			RETURNF 0
	CASE 208
		SIF TEQUIP:촉수구욕 == 0
			RETURNF 0
	ENDSELECT
	RETURNF 1
CASE "달콤한말：成功"
	SIF SELECTCOM == 300 && CFLAG:269
		RETURNF 1
CASE "칭찬하기：成功"
	SIF SELECTCOM == 24 && TEQUIP:칭찬하기
		RETURNF 1

CASE "용간寝取られ"
	SIF CONFIG("寝取られ") == 0
		RETURNF 0
	SIF TALENT:ARG:상사상애 || MARK:ARG:용간각인
		RETURNF 1

CASE "정음에약함"
	RETURNF GETBIT(TALENT:ARG:정액에약함, 0)
CASE "질내사정에약함"
	RETURNF GETBIT(TALENT:ARG:정액에약함, 1)
CASE "장내사정에약함"
	RETURNF GETBIT(TALENT:ARG:정액에약함, 2)
CASE "유内사정에약함"
	RETURNF GETBIT(TALENT:ARG:정액에약함, 3)
CASE "요도内사정에약함"
	RETURNF GETBIT(TALENT:ARG:정액에약함, 4)

CASE "손에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 0)
CASE "입에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 1)
CASE "가슴에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 2)
CASE "다리에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 3)
CASE "♀에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 4)
CASE "키스에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 5)
CASE "엉덩이에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 6)
CASE "♂에약함"
	RETURNF GETBIT(TALENT:ARG:성감대, 7)
CASE "全て에약함"
	SIF NUM_BIT(TALENT:ARG:성감대) == NUM("성감대")
		RETURNF 1

CASE "성벽：유니크"
	RETURNF GETBIT(TALENT:ARG:성벽, 0)
CASE "성벽：강기"
	RETURNF GETBIT(TALENT:ARG:성벽, 1)
CASE "성벽：청초"
	RETURNF GETBIT(TALENT:ARG:성벽, 2)
CASE "성벽：양기"
	RETURNF GETBIT(TALENT:ARG:성벽, 3)
CASE "성벽：솔직"
	RETURNF GETBIT(TALENT:ARG:성벽, 4)
CASE "성벽：음기"
	RETURNF GETBIT(TALENT:ARG:성벽, 5)
CASE "성벽：내성적"
	RETURNF GETBIT(TALENT:ARG:성벽, 6)
CASE "성벽：겁쟁이"
	RETURNF GETBIT(TALENT:ARG:성벽, 7)
CASE "성벽：새드"
	RETURNF GETBIT(TALENT:ARG:성벽, 8)
CASE "성벽：마조"
	RETURNF GETBIT(TALENT:ARG:성벽, 9)
CASE "성벽：교만"
	RETURNF GETBIT(TALENT:ARG:성벽, 10)
CASE "성벽：쿨"
	RETURNF GETBIT(TALENT:ARG:성벽, 11)
CASE "성벽：부끄럼쟁이"
	RETURNF GETBIT(TALENT:ARG:성벽, 12)
CASE "성벽：광기"
	RETURNF GETBIT(TALENT:ARG:성벽, 13)
CASE "성벽：응석받이"
	RETURNF GETBIT(TALENT:ARG:성벽, 14)
CASE "성벽：현명함"
	RETURNF GETBIT(TALENT:ARG:성벽, 15)
CASE "성벽：미련함"
	RETURNF GETBIT(TALENT:ARG:성벽, 16)
CASE "성벽：에로"
	RETURNF GETBIT(TALENT:ARG:성벽, 17)
CASE "성벽：로리"
	RETURNF GETBIT(TALENT:ARG:성벽, 18)
CASE "성벽：소녀"
	RETURNF GETBIT(TALENT:ARG:성벽, 19)
CASE "성벽：로리할머니"
	RETURNF GETBIT(TALENT:ARG:성벽, 20)
CASE "성벽：언니"
	RETURNF GETBIT(TALENT:ARG:성벽, 21)
CASE "성벽：어른"
	RETURNF GETBIT(TALENT:ARG:성벽, 22)
CASE "성벽：빈유"
	RETURNF GETBIT(TALENT:ARG:성벽, 23)
CASE "성벽：거유"
	RETURNF GETBIT(TALENT:ARG:성벽, 24)
CASE "성벽：동물"
	RETURNF GETBIT(TALENT:ARG:성벽, 25)
CASE "성벽：악마"
	RETURNF GETBIT(TALENT:ARG:성벽, 26)
CASE "성벽：타천사"
	RETURNF GETBIT(TALENT:ARG:성벽, 27)
CASE "성벽：천사"
	RETURNF GETBIT(TALENT:ARG:성벽, 28)
CASE "성벽：요정"
	RETURNF GETBIT(TALENT:ARG:성벽, 29)
CASE "성벽：마법사"
	RETURNF GETBIT(TALENT:ARG:성벽, 30)
CASE "성벽：인외"
	RETURNF GETBIT(TALENT:ARG:성벽, 31)
CASE "성벽：인간형"
	RETURNF GETBIT(TALENT:ARG:성벽, 32)
CASE "성벽：장사"
	RETURNF GETBIT(TALENT:ARG:성벽, 33)
CASE "성벽：기품"
	RETURNF GETBIT(TALENT:ARG:성벽, 34)
CASE "성벽：조야"
	RETURNF GETBIT(TALENT:ARG:성벽, 35)
CASE "성벽：오토코노코"
	RETURNF GETBIT(TALENT:ARG:성벽, 36)
CASE "성벽：근친"
	RETURNF GETBIT(TALENT:ARG:성벽, 37)
CASE "성벽：쇼타"
	RETURNF GETBIT(TALENT:ARG:성벽, 38)
CASE "성벽：갈색피부"
	RETURNF GETBIT(TALENT:ARG:성벽, 39)
CASE "성벽：흰피부"
	RETURNF GETBIT(TALENT:ARG:성벽, 40)
CASE "성벽：파란피부"
	RETURNF GETBIT(TALENT:ARG:성벽, 41)
CASE "성벽：겨드랑이"
	RETURNF GETBIT(TALENT:ARG:성벽, 42)
CASE "성벽：엉덩이"
	RETURNF GETBIT(TALENT:ARG:성벽, 43)
CASE "성벽：요도"
	RETURNF GETBIT(TALENT:ARG:성벽, 44)
CASE "성벽：냄새페티시"
	RETURNF GETBIT(TALENT:ARG:성벽, 45)

;조교지식"
CASE "애무・봉사지식"
	RETURNF GETBIT(TALENT:ARG:조교지식, 0)
CASE "教え上手"
	RETURNF GETBIT(TALENT:ARG:조교지식, 1)
CASE "ＳＭ지식"
	RETURNF GETBIT(TALENT:ARG:조교지식, 2)
CASE "Ａ조교지식"
	RETURNF GETBIT(TALENT:ARG:조교지식, 3)
CASE "성기확장지식"
	RETURNF GETBIT(TALENT:ARG:조교지식, 4)
CASE "도구使い"
	RETURNF GETBIT(TALENT:ARG:조교지식, 5)
CASE "노출지식"
	RETURNF GETBIT(TALENT:ARG:조교지식, 6)

CASE "낮"
	SIF TIME == 0
		RETURNF 1
CASE "밤"
	SIF TIME == 1
		RETURNF 1

CASE "조교종료가능"
	SIF CONFIG("조교컨피그모드")
		RETURNF 0
	SIF CONFIG("ＨＡＲＤ") == 0 || TEQUIP:넘어뜨리기 == 0
		RETURNF 1
	IF TEQUIP:Ｗ넘어뜨리기 && TARGET:1
		SIF COND("만족", TARGET) && COND("만족", TARGET:1)
			RETURNF 1
	ELSEIF COND("만족", TARGET) || BASE:체력 < 1000 || BASE:기력 == 0 || BASE:정력 == 0
		RETURNF 1
	ENDIF
;誰を조교대상に選んで조교に入ったか、などで参照できる
CASE "第一대상"
	RETURNF GETBITS(FLAG:99, 0, 6)
CASE "조교中"
	RETURNF GETBIT(FLAG:99, 10)
CASE "主導権없음"
	RETURNF GETBIT(FLAG:99, 11)
CASE "하룻밤개방中"
	RETURNF GETBIT(FLAG:99, 12)
CASE "キャラメイク中"
	RETURNF GETBIT(FLAG:99, 13)

CASE "만족"
	RETURNF CFLAG:ARG:99
CASE "체력限界"
	RETURNF GETBIT(CFLAG:ARG:99, 0)
CASE "성욕만족"
	RETURNF GETBIT(CFLAG:ARG:99, 1) + GETBIT(CFLAG:ARG:99, 2)
CASE "성욕대만족"
	RETURNF GETBIT(CFLAG:ARG:99, 2)
CASE "정액욕만족"
	RETURNF GETBIT(CFLAG:ARG:99, 3) + GETBIT(CFLAG:ARG:99, 4)
CASE "정액욕대만족"
	RETURNF GETBIT(CFLAG:ARG:99, 4)
CASE "아침이벤트"
	RETURNF CFLAG:ARG:90
CASE "밤이벤트"
	RETURNF CFLAG:ARG:91
CASE "조교後이벤트"
	RETURNF CFLAG:ARG:92

CASE "손一杯"
	RETURNF GETBIT(CFLAG:ARG:95, 0)
CASE "다방출연끝"
	RETURNF GETBIT(CFLAG:ARG:95, 1)
CASE "하룻밤개방실행끝"
	RETURNF GETBIT(CFLAG:ARG:95, 2)
CASE "同衾이벤트"
	RETURNF GETBIT(CFLAG:ARG:95, 3)
CASE "日常이벤트출연끝"
	RETURNF GETBIT(CFLAG:ARG:95, 4)
CASE "난교참가끝"
	RETURNF GETBIT(CFLAG:ARG:95, 5)
CASE "다방挨拶済み"
	RETURNF GETBIT(CFLAG:ARG:95, 6)
CASE "다방挨拶まだ"
	SIF GETBIT(CFLAG:ARG:95, 6) == 0
		RETURNF 1

CASE "一緒に寝た"
	RETURNF CFLAG:ARG:96
CASE "前回조교일"
	RETURNF CFLAG:ARG:97
CASE "조교공백기간"
	SIF CFLAG:ARG:97 == 0 || DAY - CFLAG:ARG:97 - 1 < 0
		RETURNF 0
	;前日に相手にした場合は空白は０になるべきだろう
	RETURNF DAY - CFLAG:ARG:97 - 1


;条件を緩く
CASE "요바이가능"
	;상사상애による요바이制限有り
	SIF CONFIG("상사상애：요바이제한") && TALENT:MASTER:상사상애 && TALENT:ARG:상사상애 == 0
		RETURNF 0
	SIF TALENT:ARG:Ｖ손상 || TALENT:ARG:Ａ손상
		RETURNF 0
	SIF (TALENT:ARG:연모 || TALENT:ARG:음란 || ABL:ARG:순종+ABL:ARG:욕망+MAX(ABL:ARG:Ｖ감각, ABL:ARG:Ａ감각)+ABL:ARG:봉사정신 > 10) && BASE:ARG:체력 >= 500
		RETURNF 1
CASE "아침기습가능"
	;상사상애による요바이制限有りだと아침기습も禁止
	SIF CONFIG("상사상애：요바이제한") && TALENT:MASTER:상사상애 && TALENT:ARG:상사상애 == 0
		RETURNF 0
	SIF TALENT:ARG:Ｖ손상 || TALENT:ARG:Ａ손상
		RETURNF 0
	SIF (TALENT:ARG:연모 || TALENT:ARG:음란 || ABL:ARG:욕망 >= 3) && BASE:ARG:체력 >= 800
		RETURNF 1

CASE "몽마化가능"
	SIF TALENT:ARG:몽마 || TALENT:ARG:상위몽마 || TALENT:ARG:권속 || TALENT:ARG:마왕의조각
		RETURNF 0
	SELECTCASE ARG
	CASE TARGET
		SIF CONFIG("대상の몽마化：男")
			RETURNF 1
		SIF CONFIG("대상の몽마化") && TALENT:ARG:남자 == 0
			RETURNF 1
	CASE ASSI, PLAYER, MASTER
		SIF CONFIG("주인・조수の몽마化：男")
			RETURNF 1
		SIF CONFIG("주인・조수の몽마化") && TALENT:ARG:남자 == 0
			RETURNF 1
	ENDSELECT

CASE "매각가능플래그"
	RETURNF GETBIT(CFLAG:ARG:1, 0)
CASE "조수가능플래그"
	RETURNF GETBIT(CFLAG:ARG:1, 1)

CASE "매각가능"
	;여행に行く予定や호접지몽の最中だと무리
	SIF CFLAG:ARG:70 || BASE:ARG:호접지몽
		RETURNF 0
	RETURNF GETBIT(CFLAG:ARG:1, 0)
CASE "조수가능"
	RETURNF GETBIT(CFLAG:ARG:1, 1)

CASE "온천여행同行가능"
	SIF TALENT:ARG:연모 + TALENT:ARG:음란 && (TALENT:ARG:처녀 == 0 || (TALENT:ARG:처녀 && TALENT:ARG:상사상애) )
		RETURNF 1
CASE "온천여행가능"
	SIF FLAG:60 || ITEM:호접지몽 || DAYEV("金曜", "ゲーム内") == 0 || TEXTS("시간") != "밤" || MONEY < 3000 || ARG <= 0
		RETURNF 0
	SIF TALENT:ARG:연모 + TALENT:ARG:음란 && (TALENT:ARG:처녀 == 0 || (TALENT:ARG:처녀 && TALENT:ARG:상사상애) )
		RETURNF 1

CASE "一言이벤트中"
	RETURNF GETBIT(FLAG:23, 10)
CASE "성희롱종료"
	RETURNF GETBIT(FLAG:23, 11)

CASE "外出許可"
	;여행に行く予定だと무리
	SIF CFLAG:ARG:70
		RETURNF 0
	RETURNF CFLAG:ARG:49

CASE "하룻밤개방가능"
	;여행に行く予定だと무리
	SIF CFLAG:ARG:70
		RETURNF 0
	;怪我があるとダメ
	SIF TALENT:ARG:Ｖ손상 || TALENT:ARG:Ａ손상
		RETURNF 0
	SIF CFLAG:ARG:49
		RETURNF 1
	;요정はサイズ的に…
	;SIF TALENT:ARG:요정
	;	RETURNF 0
	SIF TALENT:ARG:호색 == 0 && ABL:ARG:순종 < 4 && MARK:ARG:굴복각인 < 3 && MARK:ARG:정액각인 == 0
		RETURNF 0
	;SIF (TALENT:ARG:처녀 || TALENT:ARG:남자) && (TALENT:ARG:Ａ처녀 || ABL:ARG:Ａ감각 < 3)
	;	RETURNF 0

	;どちらかの穴を使えるor女性相手ができないとダメ
	SIF COND("베테랑：섹스", ARG) == 0 && COND("하룻밤개방：女상대", ARG) == 0
		RETURNF 0

	SIF TALENT:ARG:호색 || TALENT:ARG:음란 || ABL:ARG:노출벽 >= 3
		RETURNF 1
;これがONだと実際に夜に이벤트発生します
CASE "하룻밤개방実行予定"
	;여행に行く予定だと무리
	SIF CFLAG:ARG:70
		RETURNF 0
	SIF COND("同衾이벤트", ARG)
		RETURNF 0
	;怪我があるとダメ
	SIF TALENT:ARG:Ｖ손상 || TALENT:ARG:Ａ손상
		RETURNF 0
	;どちらかの穴を使えないとダメ
	IF COND("베테랑：Ｖ섹스", ARG) && COND("身嗜み：Ｖ독점", ARG) == 0
	ELSEIF COND("베테랑：Ａ섹스", ARG) && COND("身嗜み：Ａ독점", ARG) == 0
	;女性が相手にできるならＯＫ
	ELSEIF COND("하룻밤개방：女상대", ARG)
	ELSE
		RETURNF 0
	ENDIF
	;욕구불만も条件の一部
	IF TALENT:ARG:음란 || (MARK:ARG:정액각인 && TALENT:ARG:남자 == 0)
		SIF COND("임신中：臨月", ARG) || COND("임신中：分娩直前", ARG) || COND("임신中：分娩", ARG)
			RETURNF 0
		SIF BASE:ARG:욕구불만 + TALENT:ARG:호색*5 + COND("조교공백기간", ARG) < 15
			RETURNF 0
	ELSE
		SIF COND("임신이벤트中", ARG)
			RETURNF 0
		SIF BASE:ARG:욕구불만 + TALENT:ARG:호색*5 < 15
			RETURNF 0
		SIF COND("태内の정액량", ARG) >= 10000
			RETURNF 0
	ENDIF
	SELECTCASE CFLAG:ARG:49
	;外出させない
	CASE 0
		RETURNF 0
	;好きに外出させる
	CASE 1
		RETURNF 1
	;피임中のみ許可する
	CASE 2
		SIF TALENT:ARG:피임의부적 || TALENT:ARG:피임약복용
			RETURNF 1
		RETURNF 0
	;안전일or피임中に限り許可する
	CASE 3
		SIF TALENT:ARG:피임의부적 || TALENT:ARG:피임약복용 || COND("안전일", ARG)
			RETURNF 1
		RETURNF 0
	;危険日や発情中の日に限り許可する
	CASE 4
		SIF TALENT:ARG:피임의부적 || TALENT:ARG:피임약복용
			RETURNF 0
		SIF COND("위험일", ARG) || COND("배란中", ARG) || COND("배란유발제사용中", ARG) || COND("임신確実", ARG) || COND("발정기", ARG)
			RETURNF 1
		RETURNF 0
	ENDSELECT

CASE "욕구불만"
	SELECTCASE BASE:ARG:욕구불만
	CASE 30
		RETURNF 2
	CASE IS >= 15
		RETURNF 1
	ENDSELECT
CASE "ご無沙汰"
	SIF EXP:ARG:조교횟수 == 0
		RETURNF 0
	SELECTCASE COND("조교공백기간", ARG)
	CASE IS >= MAX(CHARANUM - 1, 14)
		RETURNF 1
	ENDSELECT

CASE "油断"
	SIF 100*BASE:ARG:웨스트/BASE:ARG:신장 >= 40
		RETURNF 1
CASE "スリム"
	SIF 100*BASE:ARG:웨스트/BASE:ARG:신장 <= 36
		RETURNF 1

CASE "큰엉덩이"
	;힙サイズの鑑定については신장比と웨스트比両方で判定する
	;신장比では100*힙/신장の値で(細い, 普通, 큰엉덩이, 폭엉덩이, 초엉덩이) = (50이하, 51～53, 54～56, 57～59, 60이상)
	;웨스트比では100*웨스트/힙で(細い, 普通, 大きい, 폭엉덩이, 초엉덩이) = (74이상, 73～70, 69～66, 65～62、61이하)
	;ちなみに큰엉덩이については両方の判定法で小さい方を선택する

	;신장が0の事は無いが念のため
	SIF BASE:ARG:신장 == 0
		RETURNF 0

	;とりあえず힙サイズがＳ이하だと큰엉덩이の資格無し
	SELECTCASE BASE:ARG:힙
	CASE IS <= 86
		SIF TALENT:ARG:작은몸집 == 0 && TALENT:ARG:요정 == 0
			RETURNF 0
	ENDSELECT

	SELECTCASE 100*BASE:ARG:힙/BASE:ARG:신장
	;초엉덩이
	CASE IS >= 60
		LOCAL = 3
	;왕엉덩이
	CASE IS >= 57
		LOCAL = 2
	;큰엉덩이
	CASE IS >= 54
		LOCAL = 1
	;보통
	CASE IS >= 51
		LOCAL = 0
	;가늘음
	CASEELSE
		RETURNF 0
	ENDSELECT

	SELECTCASE 100 * BASE:ARG:웨스트 / BASE:ARG:힙
	;초엉덩이
	CASE IS <= 61
		RETURNF LIMIT(LOCAL, 1, 3)
	;왕엉덩이
	CASE IS <= 65
		RETURNF LIMIT(LOCAL, 1, 2)
	;큰엉덩이
	CASE IS <= 69
		RETURNF MIN(LOCAL, 1)
	;その他
	CASEELSE
		RETURNF 0
	ENDSELECT
CASE "작은엉덩이"
	;힙サイズの鑑定については신장比と웨스트比両方で判定する
	;신장比では100*힙/신장の値で(細い, 보통, 큰엉덩이, 왕엉덩이) = (50이하, 51～53, 54～56, 57이상)
	;웨스트比では100*웨스트/힙で(細い, 보통, 大きい, 왕엉덩이) = (74이상, 73～70, 69～66, 65이하)
	;작은엉덩이についてはどちらかが満たしているなら작은엉덩이とみなす

	;신장が0の事は無いが念のため
	SIF BASE:ARG:신장 == 0
		RETURNF 0

	;とりあえず힙サイズがＭ이상だと작은엉덩이の資格無し
	SELECTCASE BASE:ARG:힙
	CASE IS >= 87
		RETURNF 0
	ENDSELECT

	SELECTCASE 100*BASE:ARG:힙/BASE:ARG:신장
	;큰엉덩이이상
	CASE IS >= 54
		RETURNF 0
	;보통
	CASE 51 TO 53
		LOCAL = 0
	;가늘음
	CASEELSE
		LOCAL = 1
	ENDSELECT

	SELECTCASE 100 * BASE:ARG:웨스트 / BASE:ARG:힙
	;큰엉덩이이상
	CASE IS <= 69
		RETURNF 0
	;보통이하
	CASE 70 TO 73
		RETURNF LOCAL
	;가늘음
	CASEELSE
		RETURNF 1
	ENDSELECT
CASE "음모"
	RETURNF BASE:ARG:음모/100
CASE "겨털"
	RETURNF BASE:ARG:겨털/100
CASE "음모の설정"
	IF GETBIT(FLAG:207, 3)
		SIF AGE(ARG) >= 4
			RETURNF 1
	ELSEIF GETBIT(FLAG:207, 2)
		SIF AGE(ARG) >= 3
			RETURNF 1
	ELSEIF GETBIT(FLAG:207, 1)
		SIF AGE(ARG) >= 2
			RETURNF 1
	ELSEIF GETBIT(FLAG:207, 0)
		RETURNF 1
	ENDIF

CASE "身嗜み：음모"
	IF GETBIT(CFLAG:ARG:368, 1)
		RETURNF 3
	ELSEIF GETBIT(CFLAG:ARG:368, 2)
		RETURNF 5
	ELSEIF GETBIT(CFLAG:ARG:368, 3)
		RETURNF 7
	ENDIF
CASE "身嗜み：겨털"
	IF GETBIT(CFLAG:ARG:368, 6)
		RETURNF 3
	ELSEIF GETBIT(CFLAG:ARG:368, 7)
		RETURNF 7
	ENDIF
CASE "身嗜み：Ｖ확장"
	SIF TALENT:ARG:남자
		RETURNF 0
	IF GETBIT(CFLAG:ARG:368, 11)
		RETURNF 1
	ELSEIF GETBIT(CFLAG:ARG:368, 12)
		RETURNF 2
	ELSEIF GETBIT(CFLAG:ARG:368, 13)
		RETURNF 3
	ELSEIF GETBIT(CFLAG:ARG:368, 14)
		RETURNF 4
	ENDIF
CASE "身嗜み：Ａ확장"
	IF GETBIT(CFLAG:ARG:368, 16)
		RETURNF 1
	ELSEIF GETBIT(CFLAG:ARG:368, 17)
		RETURNF 2
	ELSEIF GETBIT(CFLAG:ARG:368, 18)
		RETURNF 3
	ELSEIF GETBIT(CFLAG:ARG:368, 19)
		RETURNF 4
	ENDIF
CASE "身嗜み：Ａ準備"
	IF GETBIT(CFLAG:ARG:368, 21)
		RETURNF 1
	ELSEIF GETBIT(CFLAG:ARG:368, 22)
		RETURNF 2
	ELSEIF GETBIT(CFLAG:ARG:368, 23)
		RETURNF 3
	ENDIF
CASE "身嗜み：장세척"
	SIF GETBIT(CFLAG:ARG:368, 21) || GETBIT(CFLAG:ARG:368, 23)
		RETURNF 1
CASE "身嗜み：Ａ로션"
	SIF GETBIT(CFLAG:ARG:368, 22) || GETBIT(CFLAG:ARG:368, 23)
		RETURNF 1
CASE "身嗜み：Ｐ準備"
	SIF PENIS(ARG) == 0
		RETURNF 0
	IF GETBIT(CFLAG:ARG:368, 26)
		RETURNF 1
	ENDIF
CASE "身嗜み：Ｐ청소"
	SIF PENIS(ARG) == 0
		RETURNF 0
	SIF GETBIT(CFLAG:ARG:368, 26) == 0 && COND("진성포경", ARG) == 0
		RETURNF 1
CASE "Ｐ불결"
	SIF PENIS(ARG) == 0
		RETURNF 0
	SIF GETBIT(BASE:ARG:노폐물, 0)
		RETURNF 1
CASE "身嗜み：Ｖ準備"
	IF GETBIT(CFLAG:ARG:368, 28)
		RETURNF 1
	ENDIF
CASE "身嗜み：Ｖ掃除"
	SIF TALENT:ARG:남자
		RETURNF 0
	SIF GETBIT(CFLAG:ARG:368, 28) == 0
		RETURNF 1
CASE "Ｖ불결"
	SIF TALENT:ARG:남자
		RETURNF 0
	SIF GETBIT(BASE:ARG:노폐물, 1)
		RETURNF 1
;服装については, 今のところ페니스があるなら無視
CASE "身嗜み：복장"
	SIF PENIS(ARG)
		RETURNF 0
	IF GETBIT(CFLAG:ARG:368, 31)
		RETURNF 1
	ENDIF
CASE "身嗜み：노팬티"
	SIF PENIS(ARG)
		RETURNF 0
	SIF GETBIT(CFLAG:ARG:368, 31)
		RETURNF 1
CASE "身嗜み：요도확장"
	SIF GETBIT(CFLAG:ARG:368, 36)
		RETURNF 1
CASE "身嗜み：성행위の제한"
	SELECTCASE GETBITS(CFLAG:ARG:368, 41, 45)
	CASE 0
		RETURNF 0
	;1p41～1p45と等しいのは一箇所だけ独占している状態の判定に用いる
	CASE 1p41
		RETURNF 1
	CASE 1p42
		RETURNF 2
	CASE 1p43
		RETURNF 3
	CASE 1p44
		RETURNF 4
	CASE 1p45
		RETURNF 5
	CASE 1p41 + 1p42 + 1p43 + 1p44 + 1p45
		RETURNF 100
	CASEELSE
		RETURNF 6
	ENDSELECT
CASE "身嗜み：Ｖ독점"
	SIF TALENT:ARG:남자
		RETURNF 0
	SIF GETBIT(CFLAG:ARG:368, 41)
		RETURNF 1
CASE "身嗜み：Ａ독점"
	SIF GETBIT(CFLAG:ARG:368, 42)
		RETURNF 1
CASE "身嗜み：입독점"
	SIF GETBIT(CFLAG:ARG:368, 43)
		RETURNF 1
CASE "身嗜み：키스독점"
	SIF GETBIT(CFLAG:ARG:368, 44)
		RETURNF 1
CASE "身嗜み：Ｐ독점"
	SIF PENIS(ARG) == 0
		RETURNF 0
	SIF GETBIT(CFLAG:ARG:368, 45)
		RETURNF 1
CASE "身嗜み：完全독점"
	SIF COND("身嗜み：성행위の제한", ARG) == 100
		RETURNF 1

;자위커맨드の実行中は無視する
CASE "身嗜み：성욕の관리"
	SELECTCASE GETBITS(CFLAG:ARG:368, 46, 50)
	CASE 0
		RETURNF 0
	;1p46～1p50と等しいのは一箇所だけ独占している状態の判定に用いる
	CASE 1p46
		RETURNF 1
	CASE 1p47
		RETURNF 2
	CASE 1p48
		RETURNF 3
	CASE 1p49
		RETURNF 4
	CASE 1p50
		RETURNF 5
	CASE 1p46 + 1p47 + 1p48 + 1p49 + 1p50
		RETURNF 100
	CASEELSE
		RETURNF 6
	ENDSELECT
CASE "身嗜み：자위금지"
	SIF GETBIT(CFLAG:ARG:368, 46)
		RETURNF 1

CASE "베테랑：섹스"
	SIF COND("베테랑：Ｖ섹스", ARG) || COND("베테랑：Ａ섹스", ARG)
		RETURNF 1
CASE "베테랑：Ｖ섹스"
	SIF TALENT:ARG:남자 || TALENT:ARG:처녀 || TALENT:ARG:Ｖ손상
		RETURNF 0
	SIF EXP:ARG:Ｖ경험 < 50 || EXP:ARG:Ｖ성교경험 < 20 || EXP:ARG:허리사용경험 < 20 || ABL:ARG:Ｖ감각 < 2
		RETURNF 0
	;요정は巨根を受け入れられるくらい拡張が進んでないとダメ
	SIF TALENT:ARG:요정 && ABL:ARG:Ｖ확장 < 2
		RETURNF 0
	SIF COND("하룻밤개방中", ARG) && COND("身嗜み：Ｖ독점", ARG)
		RETURNF 0
	IF TALENT:ARG:음호
		SIF TALENT:ARG:애널광 == 0
			RETURNF 4
		SIF ABL:ARG:Ｖ감각 > ABL:ARG:Ａ감각
			RETURNF 3
		RETURNF 2
	ENDIF
	RETURNF 1
CASE "베테랑：Ａ섹스"
	SIF TALENT:ARG:Ａ처녀 || TALENT:ARG:Ａ손상 || ABL:ARG:Ａ확장 < 2
		RETURNF 0
	SIF EXP:ARG:Ａ경험 < 50 || EXP:ARG:Ａ성교경험 < 20 || EXP:ARG:허리사용경험 < 20 || ABL:ARG:Ａ감각 < 2
		RETURNF 0
	SIF COND("하룻밤개방中", ARG) && COND("身嗜み：Ａ독점", ARG)
		RETURNF 0
	;요정は巨根を受け入れられるくらい拡張が進んでないとダメ
	SIF TALENT:ARG:요정 && ABL:ARG:Ａ확장 < 2
		RETURNF 0
	IF TALENT:ARG:애널광
		SIF TALENT:ARG:음호 == 0
			RETURNF 4
		SIF ABL:ARG:Ａ감각 > ABL:ARG:Ｖ감각
			RETURNF 3
		RETURNF 2
	ENDIF
	RETURNF 1

CASE "애널性向"
	SIF COND("베테랑：Ａ섹스", ARG) >= 3
		RETURNF 1
;ＶＡ섹스両方とも무리なときにのみ参照する
;これが1だと女性の相手もする。2だと女性の相手しかしない
CASE "하룻밤개방：女상대"
	SIF TALENT:ARG:남성혐오
		RETURNF 2
	;페니스で相手する場合
	IF PENIS(ARG)
		SIF TALENT:ARG:동정
			RETURNF 0
		;まぁ경험は無くても良いだろ
		;SIF EXP:ARG:Ｖ삽입경험 < 20 || EXP:ARG:허리사용경험 < 20
		;	RETURNF 0
		SIF COND("身嗜み：Ｐ독점", ARG)
			RETURNF 0
		SIF TALENT:ARG:남자 && ABL:ARG:ＢＬ끼 < 3
			RETURNF 2
		;まぁ…ホモ섹스はまだ早いという事にしておこう
		SIF TALENT:ARG:남자 && COND("오토코노코", ARG) == 0
			RETURNF 2
	ELSE
		SIF ABL:ARG:레즈끼 < 3
			RETURNF 0
	ENDIF
	RETURNF 1


CASE "最新비디오の価格"
	RETURNF CFLAG:ARG:65

CASE "인기：ＡＶ"
	SIF GETBIT(TALENT:ARG:인기, 1)
		RETURNF 1
	;直近３本の価格が$5, 000이상or１０作이상に出演して最高額が$10, 000越え
	SIF MIN(CFLAG:ARG:63, CFLAG:ARG:64, CFLAG:ARG:65) >= 5000 && (CFLAG:ARG:60 >= 10 || CFLAG:ARG:61 >= 10000)
		RETURNF 1
CASE "인기：다방"
	SIF GETBIT(TALENT:ARG:인기, 2)
		RETURNF 1
	;今までの実績が30이상
	SIF CFLAG:ARG:30 >= 30
		RETURNF 1

;체력と정력を회복する
CASE "건강해지는약"
	SIF BASE:ARG:체력 < MAXBASE:ARG:체력 || BASE:ARG:정력 < MAXBASE:ARG:정력 || BASE:ARG:스톡 < MAXBASE:ARG:스톡
		RETURNF 1
;女を후타나리にしたり、戻したりする
CASE "후타나리약"
	SIF TALENT:ARG:남자 == 0
		RETURNF 1
;모유체질にするor陥没유두を治す
CASE "파란드롭스"
	SIF TALENT:ARG:남자 || COND("임신이벤트中", ARG)
		RETURNF 0
	SIF TALENT:ARG:모유체질 == 0 || COND("함몰유두", ARG)
		RETURNF 1
;처녀膜が再生するor모유체질を喪失する
CASE "빨간드롭스"
	SIF TALENT:ARG:남자 || COND("임신이벤트中", ARG)
		RETURNF 0
	SIF TALENT:ARG:처녀 == 0 || TALENT:ARG:모유체질
		RETURNF 1
;성전환させる
CASE "검은드롭스"
	SIF COND("임신이벤트中", ARG)
		RETURNF 0
	RETURNF 1
;怪我などを治す
CASE "하얀드롭스"
	SIF TALENT:ARG:Ｖ손상 || TALENT:ARG:Ａ손상 || TALENT:ARG:오줌싸개버릇
		RETURNF 1

CASE "거근약"
	SIF PENIS(ARG) == 0
		RETURNF 0
	IF TALENT:ARG:용의혈통
		SIF GETBIT(TALENT:ARG:페니스, 5)
			RETURNF 0
	ELSE
		SIF GETBIT(TALENT:ARG:페니스, 3)
			RETURNF 0
	ENDIF
	RETURNF 1
CASE "축근약"
	SIF PENIS(ARG) == 0 || GETBIT(TALENT:ARG:페니스, 1)
		RETURNF 0
	RETURNF 1
CASE "박피약"
	SIF PENIS(ARG) == 0 || GETBITS(TALENT:ARG:페니스, 11, 12) == 0
		RETURNF 0
	RETURNF 1
CASE "신피약"
	SIF PENIS(ARG) == 0 || GETBIT(TALENT:ARG:페니스, 12)
		RETURNF 0
	RETURNF 1
CASE "풍유환"
	SIF TALENT:ARG:남자 || TALENT:ARG:거유 >= 3
		RETURNF 0
	RETURNF 1
CASE "축유환"
	SIF TALENT:ARG:남자 || TALENT:ARG:빈유
		RETURNF 0
	RETURNF 1
CASE "거인의약"
	SIF TALENT:ARG:장신 || TALENT:ARG:요정
		RETURNF 0
	SIF TALENT:ARG:오토코노코 && TALENT:ARG:작은몸집 == 0
		RETURNF 0
	RETURNF 1
CASE "소인의약"
	SIF TALENT:ARG:작은몸집 || TALENT:ARG:요정
		RETURNF 0
	RETURNF 1
CASE "무지개의약"
	RETURNF 1
CASE "풍둔약"
	SIF TALENT:ARG:요정 || AGE(ARG) == 1 || TALENT:ARG:남자 || BASE:ARG:신장 == 0
		RETURNF 0
	SIF TALENT:ARG:큰엉덩이 >= 3
		RETURNF 0
	RETURNF 1
CASE "축둔약"
	SIF TALENT:ARG:요정 || AGE(ARG) == 1 || TALENT:ARG:남자 || BASE:ARG:신장 == 0
		RETURNF 0
	SIF TALENT:ARG:작은엉덩이
		RETURNF 0
	RETURNF 1
CASE "정액각인刻印가능"
	SIF TALENT:ARG:남자 || COND("임신이벤트中", ARG)
		RETURNF 0
	;とりあえず今のところは４画まで
	SIF MARK:ARG:정액각인 >= 4
		RETURNF 0
	RETURNF 1

CASE "연모취득가능"
	;호감도が2500이상, 순종が3이상かつ봉사쾌락경험500이상で연모
	SIF ABL:ARG:순종 < 3 || TALENT:ARG:연모 || MARK:ARG:반발각인
		RETURNF 0
	SIF CFLAG:ARG:2 >= 2500 && (CFLAG:ARG:2 - 2500)/5 + EXP:ARG:봉사쾌락경험 >= 500
		RETURNF 1
	SIF CONFIG("ＥＡＳＹ") && CFLAG:ARG:2 >= 2000 && (CFLAG:ARG:2 - 2000)/5 + EXP:ARG:봉사쾌락경험 >= 300
		RETURNF 1
CASE "음란취득가능"
	;욕망が3이상, 절정경험や정액경험などの合計が1000이상, 자위중독と정액중독の合計3이상, 今回の절정数が10이상で음란
	SIF ABL:ARG:욕망 < 3 || TALENT:ARG:음란 || EX:ARG:절정수합계 < 10
		RETURNF 0
	SIF EXP:ARG:절정경험*10 + EXP:ARG:사정경험*10 + EXP:ARG:자위경험 + EXP:ARG:정액경험 + EXP:ARG:이상경험*100 >= 1000 && ABL:ARG:자위중독 + ABL:ARG:정액중독 >= 3
		RETURNF 1
CASE "음핵취득불가능"
	RETURNF (JUEL:ARG:쾌Ｃ < NUM("宝구슬：음핵취득", ARG) ) + (ABL:ARG:욕망 < 4 || ABL:ARG:Ｃ감각 < 4)*4 + (EX:ARG:Ｃ절정 < 20)*32 + TALENT:ARG:음핵*64
CASE "요도광취득불가능"
	RETURNF (JUEL:ARG:쾌Ｃ < NUM("宝구슬：요도광취득", ARG) ) + (ABL:ARG:욕망 < 4)*4 + (EX:ARG:요도절정 < 10)*32 + TALENT:ARG:요도광*64
CASE "음호취득불가능"
	RETURNF (JUEL:ARG:쾌Ｖ < NUM("宝구슬：음호취득", ARG) ) + (ABL:ARG:욕망 < 4 || ABL:ARG:Ｖ감각 < 4)*4 + (EX:ARG:Ｖ절정 < 20)*32 + TALENT:ARG:음호*64
CASE "애널광취득불가능"
	RETURNF (JUEL:ARG:쾌Ａ < NUM("宝구슬：애널광취득", ARG) ) + (ABL:ARG:욕망 < 4 || ABL:ARG:Ａ감각 < 4)*4 + (EX:ARG:Ａ절정 < 20)*32 + TALENT:ARG:애널광*64
CASE "음유취득불가능"
	RETURNF (JUEL:ARG:쾌Ｂ < NUM("宝구슬：음유취득", ARG) ) + (ABL:ARG:욕망 < 4 || ABL:ARG:Ｂ감각 < 4)*4 + (EX:ARG:Ｂ절정 < 20)*32 + TALENT:ARG:음유*64
CASE "음탕한입술취득불가능"
	RETURNF (JUEL:ARG:쾌Ｍ < NUM("宝구슬：음탕한입술취득", ARG) ) + (ABL:ARG:욕망 < 4 || ABL:ARG:Ｍ감각 < 4)*4 + (EX:ARG:Ｍ절정 < 20)*32 + TALENT:ARG:음탕한입술*64

CASE "아르카나획득가능"
	;大마법사は覚えるまでも無い
	SIF TALENT:ARG:마법사 == 2
		RETURNF 0
	;覚えられる아르카나が無いとダメ
	SIF NUM("아르카나습득数", ARG) >= NUM("아르카나습득가능数", ARG)
		RETURNF 0
	RETURNF 1
CASE "아르카나습득가능"
	SIF COND("아르카나획득가능", ARG) == 0
		RETURNF 0
	;습득의 구슬が無いとダメ
	SIF JUEL:ARG:습득 < NUM("宝구슬：아르카나습득", ARG)
		RETURNF 0
	RETURNF 1
CASE "도착적취득불가능"
	RETURNF  (JUEL:욕정 < NUM("宝구슬：도착적취득", ARG) ) + (EXP_GAIN(30) + EXP_GAIN(32) + EXP_GAIN(36) < 200)*2 + (ABL:노출벽 + ABL:마조끼 + ABL:새드끼 < 9)*4 + TALENT:도착적*64
CASE "마조취득불가능"
	RETURNF (JUEL:욕정 < NUM("宝구슬：마조취득", ARG) ) + (EXP:고통쾌락경험 < 400 && EXP:긴박경험 < 800)*2 + (ABL:마조끼 < 5)*4 + TALENT:마조*64
CASE "새드취득불가능"
	RETURNF (JUEL:욕정 < NUM("宝구슬：새드취득", ARG) ) + (EXP:가학쾌락경험 < 1000)*2 + (ABL:새드끼 < 5)*4 + TALENT:새드*64

CASE "소질획득가능"
	SIF EXP:경험치 < NUM("경험치：소질획득")
		RETURNF 0
	RETURNF 1

CASE "子持ち"
	FOR LCOUNT, 1, CHARANUM
		SIF TO_NUMBER(BASE:LCOUNT:모친) == ARG || TO_NUMBER(BASE:LCOUNT:부친) == ARG
			RETURNF 1
	NEXT
CASE "子持ち：모친"
	FOR LCOUNT, 1, CHARANUM
		SIF TO_NUMBER(BASE:LCOUNT:모친) == ARG
			RETURNF 1
	NEXT
CASE "子持ち：부친"
	FOR LCOUNT, 1, CHARANUM
		SIF TO_NUMBER(BASE:LCOUNT:부친) == ARG
			RETURNF 1
	NEXT

CASE "子孫"
	RETURNF NO:ARG == 95 || NO:ARG == 97
CASE "성장성"
	RETURNF !COND("성장끝", ARG) && !GETBIT(CFLAG:ARG:484, 0)
CASE "성장기"
	RETURNF COND("子孫", ARG) && GETBIT(CFLAG:ARG:484, 0) && !GETBIT(CFLAG:ARG:484, 1)
CASE "성장가능"
	RETURNF COND("성장기", ARG) && EXP:ARG:경험치 > 1000
CASE "성장끝"
	RETURNF !COND("子孫", ARG) || GETBIT(CFLAG:ARG:484, 1)

CASE "권속"
	LOCAL = TO_NUMBER(TALENT:ARG:권속)
	RETURNF LOCAL
CASE "부친", "모친", "정액의우세", "태아의부친", "호접지몽"
	LOCAL = TO_NUMBER(BASE:ARG:ARGS)
	RETURNF LOCAL
CASE "근친"
	IF COND("子孫", ARG)
		SIF COND("부친", ARG) == MASTER || COND("모친", ARG) == MASTER
			RETURNF 1
	ELSE
		SELECTCASE MIN(NO:MASTER, NO:ARG)
		CASE 0
			;SIF MAX(NO:MASTER, NO:ARG) == 98
			;	RETURNF 1
		CASE 38
			SIF MAX(NO:MASTER, NO:ARG) == 39 || MAX(NO:MASTER, NO:ARG) == 40
				RETURNF 1
		CASE 39
			SIF MAX(NO:MASTER, NO:ARG) == 40
				RETURNF 1
		CASE 48
			SIF MAX(NO:MASTER, NO:ARG) == 50
				RETURNF 1
		CASE 56
			SIF MAX(NO:MASTER, NO:ARG) == 57
				RETURNF 1
		ENDSELECT
		;유니크じゃないキャラは保留
		;SIF NAMES("종족", NO:MASTER, CFLAG:MASTER:8) == "리리스" && NAMES("종족", NO:ARG, CFLAG:ARG:8) == "리림"
			;RETURNF 1
		;SIF NAMES("종족", NO:MASTER, CFLAG:MASTER:8) == "리림" && NAMES("종족", NO:ARG, CFLAG:ARG:8) == "리리스"
			;RETURNF 1
	ENDIF

;各種플래그(이상경험判定などで使う)
CASE "처녀상실플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 0)
CASE "처녀탈취플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 1)
CASE "동정喪失플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 2)
CASE "동정狩り플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 3)
CASE "청소펠라플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 4)
CASE "Ａ청소펠라플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 5)
CASE "자위플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 6)
CASE "청소컨닐링구스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 7)
CASE "자궁責め플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 8)
CASE "Ａ봉사플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 9)
CASE "바늘다루기플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 10)
CASE "제모플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 11)
CASE "Ｐ바인드弱体플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 12)
CASE "자궁삽입플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 13)
CASE "쓱쓱닦기플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 14)
CASE "클리피어스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 15)
CASE "라비아피어스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 16)
CASE "니플피어스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 17)
CASE "배꼽피어스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 18)
CASE "피어스ＯＮ플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 19)
CASE "鎮痛麻酔플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 20)
CASE "바텀을노출させた"
	RETURNF GETBIT(TCVAR:ARG:10, 21)
CASE "Ａ처녀상실플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 22)
CASE "Ａ처녀탈취플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 23)
CASE "모유마시기플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 24)
CASE "飲尿플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 25)
CASE "ながら자위플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 26)
CASE "스팽킹섹스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 27)
CASE "マーキング플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 28)
CASE "うっかり자궁삽입플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 29)
CASE "겨드랑이핥기플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 30)
CASE "겨드랑이見せ플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 31)
CASE "질내욕뇨플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 32)
CASE "자궁内욕뇨플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 33)
CASE "온천관장플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 34)
CASE "유内욕뇨플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 35)
CASE "딥스로트플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 36)
CASE "삽입前폭발플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 37)
CASE "구현化ＯＮ플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 38)
CASE "구현化ＯＦＦ플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 39)
CASE "요도성감플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 40)
CASE "방광内욕뇨플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 41)
CASE "추가키스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 42)
CASE "청소Ａ핥기플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 43)
CASE "尿청소펠라플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 44)
CASE "尿청소컨닐링구스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 45)
CASE "치구청소펠라플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 46)
CASE "치구청소컨닐링구스플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 47)
CASE "발핥기플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 48)
CASE "受精확인플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 49)
CASE "몽마化플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 50)
CASE "성전환플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 51)
CASE "호접지몽플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 52)
CASE "締め付け플래그"
	RETURNF GETBIT(TCVAR:ARG:10, 53)


;난교이벤트…基本的には요바이아침기습가능な上で、この条件を見る
CASE "난교참가中"
	SIF COND("난교참가끝", ARG) == 0
		RETURNF 0
	SIF ARG == TARGET || ARG == TARGET:1 || ARG == TARGET:2
		RETURNF 1

CASE "난교가능"
	SIF COND("난교참가끝", ARG)
		RETURNF 0
	SIF TALENT:ARG:Ｖ손상 || TALENT:ARG:Ａ손상 || MARK:ARG:반발각인 || BASE:ARG:체력 < 800 || EXP:ARG:조교횟수 == 0
		RETURNF 0
	;욕구불만か호색か음란かご無沙汰が필요
	SIF BASE:ARG:욕구불만 == 0 && TALENT:ARG:호색 == 0 && TALENT:ARG:음란 == 0 && COND("ご無沙汰", ARG) == 0
		RETURNF 0
	;参加条件
	IF COND("베테랑：Ｖ섹스", ARG) && ABL:ARG:Ｖ확장 + TALENT:ARG:음호 >= SIZE("페니스", MASTER)
	ELSEIF COND("베테랑：Ａ섹스", ARG) && ABL:ARG:Ａ확장 + TALENT:ARG:애널광 >= SIZE("페니스", MASTER)
	ELSEIF ABL:ARG:봉사정신 >= 3
	ELSE
		RETURNF 0
	ENDIF
	SIF TALENT:ARG:망신 || TALENT:ARG:연모 || TALENT:ARG:음란 || TALENT:ARG:호색 || COND("욕구불만", ARG)
		RETURNF 1

;相性체크
CASE "상성☆"
	SIF TARGET <= 0 || ARG <= 0
		RETURNF 0
	SIF MIN(RELATION:ARG:(NO:TARGET), RELATION:(NO:ARG) ) >= 200
		RETURNF 1
CASE "상성◎"
	SIF TARGET <= 0 || ARG <= 0
		RETURNF 0
	SIF MIN(RELATION:ARG:(NO:TARGET), RELATION:(NO:ARG) ) >= 150
		RETURNF 1
CASE "상성○"
	SIF TARGET <= 0 || ARG <= 0
		RETURNF 0
	SIF MIN(RELATION:ARG:(NO:TARGET), RELATION:(NO:ARG) ) >= 120
		RETURNF 1

;主に하룻밤개방での襲撃傾向に사용
CASE "強姦Ｐ"
	LOCAL = TALENT:ARG:조야*2 + TALENT:ARG:장사 + TALENT:ARG:꿋꿋함 + TALENT:ARG:교만 + TALENT:ARG:강기 + TALENT:ARG:새드*3 + (ABL:ARG:새드끼 + 1)/2

	;욕구불만に寄る보정有り
	LOCAL += BASE:ARG:욕구불만/3
	RETURNF LOCAL
CASE "和姦Ｐ"
	LOCAL = TALENT:ARG:내성적 + TALENT:ARG:보수적 + TALENT:ARG:양기*2 + TALENT:ARG:고무*2 + TALENT:매혹*2 + TALENT:ARG:헌신*5 + ABL:ARG:봉사정신
	RETURNF LOCAL
CASE "肉便器Ｐ"
	LOCAL = TALENT:ARG:도착적*3 + TALENT:ARG:마조*5 + ABL:ARG:마조끼

	;욕구불만に寄る보정大
	IF TALENT:ARG:도착적 && TALENT:ARG:마조
		LOCAL += BASE:ARG:욕구불만
	ELSEIF (TALENT:ARG:도착적 || TALENT:ARG:마조) && ABL:ARG:마조끼 >= 3
		LOCAL += BASE:ARG:욕구불만/2
	ENDIF
	RETURNF LOCAL

;다방があるとして, 店員候補になれるかどうかの条件
CASE "バイト가능"
	;연모or순종4LV
	SIF TALENT:ARG:연모 == 0 && ABL:ARG:순종 < 4
		RETURNF 0
	;반발각인、妊婦はダメ
	SIF MARK:ARG:반발각인 || TALENT:ARG:임신 || TALENT:ARG:사족보행
		RETURNF 0
	;男の店員については오토코노코はOK。컨피그でショタ가능にしてるならそっちもOK
	IF TALENT:ARG:남자
		SIF COND("오토코노코", ARG)
			RETURNF 1
		SIF CONFIG("쇼타메이드") && GETBIT(BASE:ARG:속성, 38)
			RETURNF 1
		RETURNF 0
	ENDIF
	RETURNF 1

;上の条件を満たしているキャラが実際にその일バイトできるかの判定
CASE "플로어점원"
	SIF NUM("所持店舗") == 0
		RETURNF 0
	;여행に行く予定や호접지몽の最中だと무리
	SIF CFLAG:ARG:70 || BASE:ARG:호접지몽
		RETURNF 0
	;バイトをさせない설정or同衾中でもだめ
	SIF CFLAG:ARG:31 == 99 || COND("同衾이벤트", ARG)
		RETURNF 0
	SIF COND("バイト가능", ARG)
		RETURNF 1

CASE "출연가능な점원"
	SIF COND("플로어점원", ARG) && COND("다방출연끝", ARG) == 0
		RETURNF 1
CASE "다방：난교"
	;소질や경험的な부정条件
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 || TALENT:ARG:처녀 + TALENT:ARG:남자 + TALENT:ARG:요정
		RETURNF 0
	SIF TALENT:처녀 && ABL:Ａ감각 < 3
		RETURNF 0
	SIF MIN(ABL:ARG:욕망, ABL:ARG:정액중독, BASE:ARG:욕구불만) < 5
		RETURNF 0
	SIF CFLAG:ARG:31 == 0
		RETURNF 1
CASE "다방：섹스"
	IF COND("다방：Ｖ섹스", ARG) || COND("다방：Ａ섹스", ARG) || COND("다방：인서트", ARG)
		SIF CFLAG:ARG:31 == 0
			RETURNF 1
	ENDIF
CASE "다방：Ｖ섹스"
	SIF COND("身嗜み：Ｖ독점", ARG)
		RETURNF 0
	;소질や경험的な부정条件
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && ABL:ARG:욕망 < 4
		RETURNF 0
	SIF TALENT:ARG:남자 || TALENT:ARG:처녀 || EXP:ARG:Ｖ성교경험 < 20
		RETURNF 0
	SIF MIN(ABL:ARG:욕망, ABL:ARG:Ｖ감각, ABL:ARG:정액중독) < 3
		RETURNF 0
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && BASE:ARG:욕구불만 < 3
		RETURNF 0
	SIF CFLAG:ARG:31 == 0
		RETURNF 1
CASE "다방：Ａ섹스"
	SIF COND("身嗜み：Ａ독점", ARG)
		RETURNF 0
	;소질や경험的な부정条件
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && ABL:ARG:욕망 < 4
		RETURNF 0
	SIF EXP:ARG:Ａ성교경험 < 20
		RETURNF 0
	IF TALENT:ARG:남자
		SIF COND("오토코노코", ARG) == 0 || ABL:ARG:ＢＬ끼 < 3 || TALENT:ARG:애널광 == 0
			RETURNF 0
	ENDIF
	SIF MIN(ABL:ARG:욕망, ABL:ARG:Ａ감각, ABL:ARG:정액중독) < 3
		RETURNF 0
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && BASE:ARG:욕구불만 < 3
		RETURNF 0
	SIF CFLAG:ARG:31 == 0
		RETURNF 1
CASE "다방：인서트"
	SIF COND("身嗜み：Ｐ독점", ARG)
		RETURNF 0
	;소질や경험的な부정条件
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && ABL:ARG:욕망 < 4
		RETURNF 0
	SIF TALENT:ARG:동정 || TALENT:ARG:요정
		RETURNF 0
	SIF PENIS(ARG) == 0 && TALENT:ARG:구현 == 0
		RETURNF 0
	IF TALENT:ARG:남자 == 0
		SIF ABL:ARG:레즈끼 < 3
			RETURNF 0
	ENDIF
	SIF ABL:ARG:욕망 < 3
		RETURNF 0
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && BASE:ARG:욕구불만 < 3
		RETURNF 0
	SIF CFLAG:ARG:31 == 0
		RETURNF 1
CASE "다방：펠라"
	SIF COND("身嗜み：입독점", ARG)
		RETURNF 0
	;소질や경험的な부정条件
	SIF TALENT:ARG:요정 || MIN(ABL:ARG:욕망, ABL:ARG:정액중독) < 2
		RETURNF 0
	SIF TALENT:ARG:호색 + TALENT:ARG:음란 == 0 && BASE:ARG:욕구불만 < 2
		RETURNF 0
	SIF CFLAG:ARG:31 <= 1
		RETURNF 1
CASE "다방：おさわり"
	SIF CFLAG:ARG:31 <= 2
		RETURNF 1
CASE "다방：パンチラ"
	SIF CFLAG:ARG:31 <= 3
		RETURNF 1
CASE "다방：Ｈな事금지"
	SIF CFLAG:ARG:31 == 10
		RETURNF 1

CASE "제복：스커트"
	RETURNF GETBITS(FLAG:401, 0, 4)
CASE "제복：웨이트리스"
	RETURNF GETBIT(FLAG:401, 0)
CASE "제복：메이드복"
	RETURNF GETBIT(FLAG:401, 1)
CASE "제복：무녀풍"
	RETURNF GETBIT(FLAG:401, 2)
CASE "제복：바니"
	RETURNF GETBIT(FLAG:401, 5)
CASE "제복：미니스커트"
	RETURNF GETBIT(FLAG:401, 10)
CASE "제복：ロング"
	RETURNF GETBIT(FLAG:401, 11)
CASE "제복：파스너"
	RETURNF GETBIT(FLAG:401, 20)
CASE "제복：캣가터"
	RETURNF GETBIT(FLAG:401, 30)

;탐색이벤트
CASE "탐색：遭遇回避"
	SIF TALENT:ARG:겁쟁이 || TALENT:ARG:내성적 || TALENT:ARG:보수적
		RETURNF 1
CASE "탐색：遭遇증가"
	SIF TALENT:ARG:교만 || TALENT:ARG:강기 || TALENT:ARG:양기
		RETURNF 1
CASE "탐색：罠解除"
	SIF TALENT:ARG:냉정 || TALENT:ARG:현명함
		RETURNF 15
CASE "탐색：罠誘発"
	SIF TALENT:ARG:미련함 && TALENT:ARG:호기심
		RETURNF 3
CASE "탐색：財宝発見"
	SIF TALENT:ARG:호기심 || TALENT:ARG:동물귀
		RETURNF 1
CASE "탐색：財宝見逃し"
	SIF TALENT:ARG:보수적
		RETURNF 1
CASE "탐색：階段発見"
	SIF TALENT:ARG:호기심 || TALENT:ARG:현명함
		RETURNF 1
CASE "탐색：회복"
	SIF TALENT:ARG:치료 || TALENT:ARG:로긴 || TALENT:ARG:마법사 >= 2
		RETURNF 1
CASE "탐색：戦闘補助"
	RETURNF PALAM_EXPLORER("조수공격력", ARG) + PALAM_EXPLORER("아르카나補助", ARG)
CASE "탐색：상태異常無効"
	SIF TALENT:ARG:아르스이사 || TALENT:ARG:마법사 >= 2
		RETURNF 1
CASE "탐색：상태異常無効持ちが居る"
	SIF TALENT:PLAYER:아르스이사 || TALENT:PLAYER:마법사 >= 2
		RETURNF 1
	IF PLAYER == MASTER && ASSI
		SIF TALENT:ASSI:아르스이사 || TALENT:ASSI:마법사 >= 2
			RETURNF 1
	ENDIF

;날짜이벤트など특수이벤트
CASE "크리스마스트리"
	SIF CEVENT("날짜：크리스마스트리", ARG)
		RETURNF 1

;종족や캐릭터의判定用
;구상セレクタを考慮する際にはCFLAG:209の値を添えること
CASE "Ｃ당신"
	SIF NO:ARG == 0
		RETURNF 1
CASE "Ｃナイトメア"
	SIF NO:ARG == 1 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃアスモデ"
	SIF NO:ARG == 1 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃリリス"
	SIF NO:ARG == 1 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ서큐버스"
	SIF NO:ARG == 1
		RETURNF 1
CASE "Ｃ서큐버스１"
	SIF NO:ARG == 1 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ서큐버스２"
	SIF NO:ARG == 1 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃアルプ"
	SIF NO:ARG == 2 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃリリム"
	SIF NO:ARG == 2 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ임프"
	SIF NO:ARG == 2
		RETURNF 1

CASE "Ｃアルラウネ"
	SIF NO:ARG == 3 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ스코그스라"
	SIF NO:ARG == 3 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ드라이어드"
	SIF NO:ARG == 3
		RETURNF 1
CASE "Ｃ드라이어드１"
	SIF NO:ARG == 3 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ드라이어드２"
	SIF NO:ARG == 3 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃリャナンシー"
	SIF NO:ARG == 4 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ티타니아"
	SIF NO:ARG == 4 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ픽시"
	SIF NO:ARG == 4
		RETURNF 1
CASE "Ｃ픽시１"
	SIF NO:ARG == 4 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ픽시２"
	SIF NO:ARG == 4 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ픽시３"
	SIF NO:ARG == 4 && CFLAG:ARG:209 == 3
		RETURNF 1

CASE "Ｃウンディーネ"
	SIF NO:ARG == 5 && CFLAG:ARG:8 == 1
		RETURNF 1
CASE "Ｃエアリアル"
	SIF NO:ARG == 5 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ실프"
	SIF NO:ARG == 5
		RETURNF 1

CASE "Ｃケットシー"
	SIF NO:ARG == 6 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃスフィンクス"
	SIF NO:ARG == 6 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ네코마타"
	SIF NO:ARG == 6
		RETURNF 1

CASE "Ｃ케르베로스"
	SIF NO:ARG == 7 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ워울프"
	SIF NO:ARG == 7
		RETURNF 1
CASE "Ｃ워울프１"
	SIF NO:ARG == 7 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ워울프２"
	SIF NO:ARG == 7 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ워울프３"
	SIF NO:ARG == 7 && CFLAG:ARG:209 == 3
		RETURNF 1

CASE "Ｃ밴시"
	SIF NO:ARG == 8 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ알바스타"
	SIF NO:ARG == 8 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ빌리져"
	SIF NO:ARG == 8
		RETURNF 1
CASE "Ｃ빌리져１"
	SIF NO:ARG == 8 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ빌리져２"
	SIF NO:ARG == 8 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "ＣＶ밴시"
	SIF NO:ARG == 9 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "ＣＶ알바스타"
	SIF NO:ARG == 9 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "ＣＶ빌리져"
	SIF NO:ARG == 9
		RETURNF 1
CASE "ＣＶ빌리져１"
	SIF NO:ARG == 9 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "ＣＶ빌리져２"
	SIF NO:ARG == 9 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃメリュジーヌ"
	SIF NO:ARG == 10 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ에키드나"
	SIF NO:ARG == 10 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ라미아"
	SIF NO:ARG == 10
		RETURNF 1
CASE "Ｃ라미아１"
	SIF NO:ARG == 10 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ라미아２"
	SIF NO:ARG == 10 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃ세이렌"
	SIF NO:ARG == 11 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ모리안"
	SIF NO:ARG == 11 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ하피"
	SIF NO:ARG == 11
		RETURNF 1
CASE "Ｃ하피１"
	SIF NO:ARG == 11 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ하피２"
	SIF NO:ARG == 11 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃサラマンダー"
	SIF NO:ARG == 12 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ뷔브르"
	SIF NO:ARG == 12 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ리저드맨"
	SIF NO:ARG == 12
		RETURNF 1
CASE "Ｃ리저드맨１"
	SIF NO:ARG == 12 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ리저드맨２"
	SIF NO:ARG == 12 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃ레비아탄"
	SIF NO:ARG == 13 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ머메이드"
	SIF NO:ARG == 13
		RETURNF 1

CASE "Ｃ다키니"
	SIF NO:ARG == 14 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ아프사라스"
	SIF NO:ARG == 14
		RETURNF 1

CASE "Ｃカリュブディス"
	SIF NO:ARG == 15 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ스큘라"
	SIF NO:ARG == 15
		RETURNF 1
CASE "Ｃ스큘라１", "Ｃ長編스큘라"
	SIF NO:ARG == 15 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ스큘라２", "Ｃ短編스큘라"
	SIF NO:ARG == 15 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃダッキ"
	SIF NO:ARG == 16 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃタマモ"
	SIF NO:ARG == 16 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ쿠즈노하"
	SIF NO:ARG == 16
		RETURNF 1

CASE "Ｃエンプーサ"
	SIF NO:ARG == 17 && CFLAG:ARG:8 == 1
		RETURNF 1
CASE "Ｃマイェストレ"
	SIF NO:ARG == 17 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃクィーンメイブ"
	SIF NO:ARG == 17
		RETURNF 1
CASE "Ｃクィーンメイブ１"
	SIF NO:ARG == 17 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃクィーンメイブ２"
	SIF NO:ARG == 17 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃナシュジェアスダ"
	SIF NO:ARG == 18 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃシェロブ"
	SIF NO:ARG == 18 && CFLAG:ARG:8 == 3
		RETURNF 1
CASE "Ｃ알케니"
	SIF NO:ARG == 18
		RETURNF 1

CASE "Ｃ윗치"
	SIF NO:ARG == 19
		RETURNF 1

CASE "Ｃガブリエル"
	SIF NO:ARG == 20 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ엔젤"
	SIF NO:ARG == 20
		RETURNF 1

CASE "Ｃ루시펠"
	SIF NO:ARG == 21
		RETURNF 1

CASE "Ｃハツメ"
	SIF NO:ARG == 22 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ쿠노이치"
	SIF NO:ARG == 22
		RETURNF 1
CASE "Ｃ쿠노이치１"
	SIF NO:ARG == 22 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ쿠노이치２"
	SIF NO:ARG == 22 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃ화이트래빗"
	SIF NO:ARG == 23
		RETURNF 1

CASE "Ｃ살로메"
	SIF NO:ARG == 24
		RETURNF 1
CASE "Ｃ살로메１"
	SIF NO:ARG == 24 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ살로메２"
	SIF NO:ARG == 24 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃカーミラ"
	SIF NO:ARG == 25 && CFLAG:ARG:8 == 2
		RETURNF 1
CASE "Ｃ뱀파이어"
	SIF NO:ARG == 25
		RETURNF 1
CASE "Ｃ뱀파이어１"
	SIF NO:ARG == 25 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ뱀파이어２"
	SIF NO:ARG == 25 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ뱀파이어３"
	SIF NO:ARG == 25 && CFLAG:ARG:209 == 3
		RETURNF 1

CASE "Ｃ드라군"
	SIF NO:ARG == 26
		RETURNF 1

CASE "Ｃ프로페테스"
	SIF NO:ARG == 27
		RETURNF 1

CASE "Ｃ솔저"
	SIF NO:ARG == 28
		RETURNF 1

CASE "Ｃ슬라임"
	SIF NO:ARG == 29
		RETURNF 1

CASE "Ｃバイコーン"
	SIF NO:ARG == 30 && CFLAG:ARG:8 == 1
		RETURNF 1
CASE "Ｃ유니콘"
	SIF NO:ARG == 30
		RETURNF 1
CASE "Ｃ유니콘１"
	SIF NO:ARG == 30 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ유니콘２"
	SIF NO:ARG == 30 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃ고블린"
	SIF NO:ARG == 31
		RETURNF 1
CASE "Ｃ고블린１"
	SIF NO:ARG == 31 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ고블린２"
	SIF NO:ARG == 31 && CFLAG:ARG:209 == 2
		RETURNF 1

CASE "Ｃ마샤"
	SIF NO:ARG == 32
		RETURNF 1

CASE "Ｃマモン"
	SIF NO:ARG == 33 && CFLAG:ARG:8 == 4
		RETURNF 1
CASE "Ｃ미믹"
	SIF NO:ARG == 33
		RETURNF 1
CASE "Ｃ스투나"
	SIF NO:ARG == 34
		RETURNF 1
CASE "Ｃ멜로나"
	SIF NO:ARG == 35
		RETURNF 1
CASE "Ｃセルマ"
	SIF NO:ARG == 36
		RETURNF 1
CASE "Ｃ프레데리카"
	SIF NO:ARG == 37
		RETURNF 1
CASE "Ｃ에스프라나"
	SIF NO:ARG == 38
		RETURNF 1
CASE "Ｃ리즈・라즈"
	SIF NO:ARG == 39
		RETURNF 1
CASE "Ｃ롯코・바롯코"
	SIF NO:ARG == 40
		RETURNF 1
CASE "Ｃ자바워크"
	SIF NO:ARG == 41
		RETURNF 1
CASE "Ｃ번더스내치"
	SIF NO:ARG == 42
		RETURNF 1
CASE "Ｃ번더스내치１"
	SIF NO:ARG == 42 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ번더스내치２"
	SIF NO:ARG == 42 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ쟈브쟈브"
	SIF NO:ARG == 43
		RETURNF 1
CASE "Ｃ린"
	SIF NO:ARG == 44
		RETURNF 1
CASE "Ｃ린１"
	SIF NO:ARG == 44 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ린２"
	SIF NO:ARG == 44 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ린３"
	SIF NO:ARG == 44 && CFLAG:ARG:209 == 3
		RETURNF 1

CASE "Ｃクリスティン"
	SIF NO:ARG == 45
		RETURNF 1
CASE "Ｃ클라라"
	SIF NO:ARG == 46
		RETURNF 1
CASE "Ｃ베르나도트"
	SIF NO:ARG == 47
		RETURNF 1
CASE "Ｃ에스트"
	SIF NO:ARG == 48
		RETURNF 1
CASE "Ｃ핌블베트"
	SIF NO:ARG == 49
		RETURNF 1
CASE "Ｃ스텔라"
	SIF NO:ARG == 50
		RETURNF 1
CASE "Ｃオリビア"
	SIF NO:ARG == 51
		RETURNF 1
CASE "Ｃ루빗사"
	SIF NO:ARG == 52
		RETURNF 1
CASE "Ｃファミリア"
	SIF NO:ARG == 53
		RETURNF 1
CASE "Ｃ메르야"
	SIF NO:ARG == 54
		RETURNF 1
CASE "Ｃ소녀"
	SIF NO:ARG == 55
		RETURNF 1
CASE "Ｃサフィ"
	SIF NO:ARG == 56
		RETURNF 1
CASE "Ｃ흑사피"
	SIF NO:ARG == 57
		RETURNF 1
CASE "Ｃ마치헤어"
	SIF NO:ARG == 58
		RETURNF 1
CASE "Ｃ돌로레스"
	SIF NO:ARG == 59
		RETURNF 1
CASE "Ｃ허니비"
	SIF NO:ARG == 60
		RETURNF 1
CASE "Ｃ허니비１"
	SIF NO:ARG == 60 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ허니비２"
	SIF NO:ARG == 60 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ발키리"
	SIF NO:ARG == 61
		RETURNF 1
CASE "Ｃ랄스"
	SIF NO:ARG == 94
		RETURNF 1
CASE "Ｃ랄스１"
	SIF NO:ARG == 94 && CFLAG:ARG:209 == 1
		RETURNF 1
CASE "Ｃ랄스２"
	SIF NO:ARG == 94 && CFLAG:ARG:209 == 2
		RETURNF 1
CASE "Ｃ아들"
	SIF NO:ARG == 95
		RETURNF 1
CASE "Ｃアイゼクト"
	SIF NO:ARG == 96
		RETURNF 1
CASE "Ｃ딸"
	SIF NO:ARG == 97
		RETURNF 1
CASE "Ｃ딸１９"
	SIF NO:ARG == 97 && CFLAG:ARG:209 == 19
		RETURNF 1
CASE "Ｃ딸２２"
	SIF NO:ARG == 97 && CFLAG:ARG:209 == 22
		RETURNF 1
CASE "Ｃ딸３３"
	SIF NO:ARG == 97 && CFLAG:ARG:209 == 33
		RETURNF 1
CASE "Ｃ딸８５７"
	SIF NO:ARG == 97 && CFLAG:ARG:209 == 857
		RETURNF 1

CASE "엔딩선택가능"
	;온천に行く予定or호접지몽実行中は不可
	SIF FLAG:60 || ITEM:호접지몽
		RETURNF 0
	;목표금액CLEARのENDなら日数関係なし
	SIF MONEY >= NUM("목표금액")
		RETURNF 1
	;周回でのDAY初期化を止めたので、BADEND条件の日数は90+周回数*30日とする
	SIF DAY >= 90 + (30 * FLAG:4)
		RETURNF 1
CASEELSE
	IF STRLENS(ARGS) == 0
		RETURNF 0
	ELSEIF SUBSTRING(ARGS, 0, 1) == "!"
		ARGS = %SUBSTRING(ARGS, 1, STRLENS(ARGS) )%
		RETURNF !(TALENT:ARG:ARGS)
	;バグ炙り出しのために、あえて参照前には소질かどうかを調べない
	ELSE
		RETURNF TALENT:ARG:ARGS
	ENDIF
ENDSELECT
RETURNF 0

;-------------------------------------------------
;上のCONDの条件の組み合わせに耐えるキャラを選出する
;ただし, TARGETは除外する
;-------------------------------------------------
@FIND_COND(ARGS:0, ARGS:1, ARGS:2, ARGS:3)
#FUNCTION
#DIM LCOUNT
;該当する캐릭터의人数
#DIM NUM_FIND

VARSET LOCAL
NUM_FIND = 0

FOR LCOUNT, 2, CHARANUM
	SIF LCOUNT == TARGET
		CONTINUE
	SIF ARGS:0 != "" && COND(ARGS:0, LCOUNT) == 0
		CONTINUE
	SIF ARGS:1 != "" && COND(ARGS:1, LCOUNT) == 0
		CONTINUE
	SIF ARGS:2 != "" && COND(ARGS:2, LCOUNT) == 0
		CONTINUE
	SIF ARGS:3 != "" && COND(ARGS:3, LCOUNT) == 0
		CONTINUE

	NUM_FIND += 1

	SIF RAND:NUM_FIND == 0
		LOCAL = LCOUNT
NEXT
RETURNF LOCAL

;-------------------------------------------------
;頻繁に使う条件のまとめ その２
;ARGのARGSが何か, 文字列で返す
;-------------------------------------------------
@CONDS(ARGS, ARG)
#FUNCTIONS
#DIM LCOUNT

VARSET LOCALS

SIF ARG == 0 && TARGET
	ARG = TARGET

SELECTCASE ARGS
CASE "정액의우세", "태아의부친"
	LOCAL = COND(ARGS, ARG)
	SELECTCASE LOCAL
	CASE IS > 0
		IF LOCAL == MASTER
			LOCALS = %CALLNAME:LOCAL%
		ELSE
			LOCALS = [{LOCAL}]%CALLNAME:LOCAL%
		ENDIF
	CASE -1
		LOCALS = 매각された몽마
	CASE -2
		LOCALS = ミランダの娼婦
	CASE -3
		LOCALS = 드래곤
	CASE -4
		LOCALS = 見知らぬ相手
	CASE -5
		LOCALS = 촉수
	CASEELSE
		LOCALS = 定義されていない相手（バグです！これを見た人は報告してください）
	ENDSELECT
CASE "하룻밤개방での襲撃傾向"
	IF COND("強姦Ｐ", ARG) >= MAX(COND("和姦Ｐ", ARG), COND("肉便器Ｐ", ARG) )
		LOCALS = 強姦
	ELSEIF COND("和姦Ｐ", ARG) >= COND("肉便器Ｐ", ARG)
		LOCALS = 和姦
	ELSE
		LOCALS = 肉便器
	ENDIF

CASE "요도확장度"
	;どっちの요도か
	IF PENIS(ARG)
		LOCALS = %CSTR:ARG:4%
	ELSE
		LOCALS = %CSTR:ARG:3%
	ENDIF
CASE "Ｖ요도の初期확장度"
	LOCALS = 10/10/10/10/10/10/10/10/10/10/
	SIF TALENT:ARG:요정
		LOCALS = %ADDNUM_STR(LOCALS, -5)%
	SIF TALENT:ARG:마도인형
		LOCALS = %ADDNUM_STR(LOCALS, 2)%
	SIF TALENT:ARG:슬라임
		LOCALS = %ADDNUM_STR(LOCALS, 10)%

CASE "Ｐ요도の初期확장度"
	LOCALS = 5/5/5/5/5/5/5/5/5/5/
	SIF TALENT:ARG:요정
		LOCALS = %ADDNUM_STR(LOCALS, -2)%
	SIF TALENT:ARG:마도인형
		LOCALS = %ADDNUM_STR(LOCALS, 1)%
	SIF TALENT:ARG:슬라임
		LOCALS = %ADDNUM_STR(LOCALS, 5)%


CASE "조교지식"
	SELECTCASE TALENT:ARG:조교지식
	CASE 1p0
		LOCALS = 애무・봉사지식
	CASE 1p1
		LOCALS = 지도능숙
	CASE 1p2
		LOCALS = ＳＭ지식
	CASE 1p3
		LOCALS = Ａ조교지식
	CASE 1p4
		LOCALS = 성기확장지식
	CASE 1p5
		LOCALS = 도구놀림
	CASE 1p6
		LOCALS = 노출지식
	ENDSELECT
CASE "기분"
	SELECTCASE MARK:ARG:기분
	CASE 1
		LOCALS = 상황살핌
	CASE 2
		LOCALS = 의욕없음
	CASE 3
		LOCALS = 최악
	CASEELSE
		LOCALS = 보통
	ENDSELECT
CASE "사용인센스"
	SELECTCASE GETBITS(TEQUIP:MASTER:인센스, 4, 9)
	CASE 1p4
		LOCALS = 재스민
	CASE 1p5
		LOCALS = 라벤더
	CASE 1p6
		LOCALS = 머스크
	CASE 1p7
		LOCALS = 샌들우드
	CASE 1p8
		LOCALS = 로즈마리
	CASE 1p9
		LOCALS = 프랭킨센스
	CASEELSE
		LOCALS = 
	ENDSELECT
CASE "피부색"
	SELECTCASE TALENT:ARG:피부색
	CASE 1
		LOCALS = 갈색
	CASE 2
		LOCALS = 흰피부
	CASE 3
		LOCALS = 청색
	CASEELSE
		LOCALS = 보통
	ENDSELECT
CASE "体型"
	;まずは요정や小柄かどうかで大きく分け, 웨스트, 힙, 가슴 크기で細かく分ける
	;웨스트の太さについては100*웨스트/신장の値で(細い, 보통, 太い, 肥満) = (36이하, 37～39, 40～49, 50이상)
	;힙の大きさについては100*힙/신장の値で(細い, 보통, 大きい) = (50이하, 51～53, 54이상)
	;COND("큰엉덩이")とCOND("작은엉덩이")で힙判定も
	IF TALENT:ARG:남자 && COND("오토코노코", ARG) == 0
		LOCALS = 남자
	ELSEIF TALENT:ARG:요정
		LOCALS = 요정
	ELSEIF TALENT:ARG:작은몸집 || AGE(ARG) == 1
		IF TALENT:ARG:거유
			LOCALS = \@ AGE(ARG) >= 2 ? トランジスタグラマー # ロリ거유 \@
		ELSEIF TALENT:ARG:빈유
			SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
			;웨스트두꺼움
			CASE IS >= 40
				LOCALS = 유아체형
			;웨스트보통이하
			CASEELSE
				IF COND("음모", ARG) == 1
					LOCALS = 납짝쿵
				ELSE
					LOCALS = 껌딱지
				ENDIF
			ENDSELECT
		ELSE
			SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
			;웨스트두꺼움
			CASE IS >= 40
				LOCALS = 유아체형
			;웨스트보통이하
			CASEELSE
				LOCALS = \@ AGE(ARG) >= 2 ? 조그만 # 発展途上 \@
			ENDSELECT
		ENDIF
	ELSE
		SELECTCASE COND("큰엉덩이", ARG)
		;초엉덩이
		CASE IS >= 3
			SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
			;웨스트두꺼움
			CASE IS >= 40
				IF TALENT:ARG:거유
					LOCALS = 超豊満
				ELSE
					LOCALS = 쭉쭉빵빵
				ENDIF
			;웨스트보통
			CASE 37 TO 39
				IF TALENT:ARG:거유
					LOCALS = 초엉덩이グラマー
				ELSE
					LOCALS = 초엉덩이
				ENDIF
			;웨스트細い
			CASEELSE
				IF TALENT:ARG:거유
					LOCALS = 슬림%TALENT_NAME(110, TALENT:ARG:거유, ARG)%
				ELSE
					LOCALS = スリム초엉덩이
				ENDIF
			ENDSELECT
		;왕엉덩이
		CASE 2
			SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
			;웨스트두꺼움
			CASE IS >= 40
				IF TALENT:ARG:거유
					LOCALS = 풍만
				ELSE
					LOCALS = 쭉쭉빵빵
				ENDIF
			;웨스트보통
			CASE 37 TO 39
				IF TALENT:ARG:거유
					LOCALS = 왕엉덩이글래머
				ELSE
					LOCALS = 왕엉덩이
				ENDIF
			;웨스트細い
			CASEELSE
				IF TALENT:ARG:거유
					LOCALS = 슬림%TALENT_NAME(110, TALENT:ARG:거유, ARG)%
				ELSE
					LOCALS = スリム폭엉덩이
				ENDIF
			ENDSELECT
		;큰엉덩이
		CASE 1
			SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
			;웨스트두꺼움
			CASE IS >= 40
				IF TALENT:ARG:거유
					LOCALS = 풍만
				ELSE
					LOCALS = 쭉쭉빵빵
				ENDIF
			;웨스트보통
			CASE 37 TO 39
				IF TALENT:ARG:거유
					LOCALS = 글래머
				ELSE
					LOCALS = 엉덩이큼
				ENDIF
			;웨스트細い
			CASEELSE
				IF TALENT:ARG:거유
					LOCALS = 슬림%TALENT_NAME(110, TALENT:ARG:거유, ARG)%
				ELSE
					LOCALS = 엉덩이큼
				ENDIF
			ENDSELECT
		CASE 0
			;힙가늘음
			IF COND("작은엉덩이", ARG)
				SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
				;웨스트두꺼움
				CASE IS >= 40
					IF TALENT:ARG:거유
						LOCALS = %TALENT_NAME(110, TALENT:ARG:거유, ARG)%
					ELSE
						LOCALS = 부주의
					ENDIF
				;웨스트보통이하
				CASEELSE
					IF TALENT:ARG:거유
						LOCALS = 슬림%TALENT_NAME(110, TALENT:ARG:거유, ARG)%
					ELSE
						LOCALS = 슬렌더
					ENDIF
				ENDSELECT
			;힙보통
			ELSE
				SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
				;웨스트두꺼움
				CASE IS >= 40
					IF TALENT:ARG:거유
						LOCALS = %TALENT_NAME(110, TALENT:ARG:거유, ARG)%
					ELSE
						LOCALS = 부주의
					ENDIF
				;웨스트보통
				CASE 37 TO 39
					IF TALENT:ARG:거유
						LOCALS = %TALENT_NAME(110, TALENT:ARG:거유, ARG)%
					ELSEIF TALENT:ARG:빈유
						LOCALS = 빈유
					ELSE
						LOCALS = 보통
					ENDIF
				;웨스트細い
				CASEELSE
					IF TALENT:ARG:거유
						LOCALS = 슬림%TALENT_NAME(110, TALENT:ARG:거유, ARG)%
					ELSE
						LOCALS = 슬렌더
					ENDIF
				ENDSELECT
			ENDIF
		ENDSELECT
	ENDIF
CASE "웨스트"
	IF TALENT:ARG:요정
		LOCALS = 요정
	ELSE
		SELECTCASE 100*BASE:ARG:웨스트/BASE:ARG:신장
		;웨스트두꺼움
		CASE IS >= 40
			LOCALS = 굵음
		;웨스트보통
		CASE 37 TO 39
			LOCALS = 보통
		;웨스트細い
		CASEELSE
			LOCALS = 가늘음
		ENDSELECT
	ENDIF
CASE "おっぱい"
	IF TALENT:ARG:남자
		LOCALS = 남자
	ELSEIF TALENT:ARG:거유 >= 3
		LOCALS = 초유
	ELSEIF TALENT:ARG:거유 == 2
		LOCALS = 폭유
	ELSEIF TALENT:ARG:거유
		LOCALS = 거유
	ELSEIF TALENT:ARG:빈유
		LOCALS = 빈유
	ELSE
		LOCALS = 평유
	ENDIF
CASE "바스트컵"
	SELECTCASE BASE:ARG:컵
	CASE IS < 0
		LOCALS = ---
	CASE IS >= 28
		LOCALS = Z
	CASEELSE
		VARSET LOCALS
		SPLIT "---, AAA, AA, Ａ, Ｂ, Ｃ, Ｄ, Ｅ, Ｆ, Ｇ, Ｈ, Ｉ, Ｊ, Ｋ, Ｌ, Ｍ, Ｎ, Ｏ, Ｐ, Ｑ, Ｒ, Ｓ, Ｔ, Ｕ, Ｖ, Ｗ, Ｘ, Ｙ, Ｚ", ", ", LOCALS
		LOCALS = %LOCALS:(BASE:ARG:컵)%
	ENDSELECT
CASE "엉덩이"
	IF TALENT:ARG:남자
		LOCALS = 
	ELSEIF TALENT:ARG:큰엉덩이 >= 3
		LOCALS = 초엉덩이
	ELSEIF TALENT:ARG:큰엉덩이 == 2
		LOCALS = 왕엉덩이
	ELSEIF TALENT:ARG:큰엉덩이
		LOCALS = 큰엉덩이
	ELSEIF TALENT:ARG:작은엉덩이
		LOCALS = 작은엉덩이
	ELSE
		LOCALS = 
	ENDIF
CASE "힙사이즈"
	SELECTCASE BASE:ARG:힙
	CASE IS <= 71
		LOCALS = XS
	CASE 72 TO 76
		LOCALS = 3S
	CASE 77 TO 81
		LOCALS = SS
	CASE 82 TO 86
		LOCALS = Ｓ
	CASE 87 TO 91
		LOCALS = Ｍ
	CASE 92 TO 96
		LOCALS = Ｌ
	CASE 97 TO 101
		LOCALS = LL
	CASE 102 TO 106
		LOCALS = 3L
	CASE 107 TO 111
		LOCALS = 4L
	CASE 112 TO 116
		LOCALS = 5L
	CASEELSE
		LOCALS = XL
	ENDSELECT
CASE "페니스사이즈"
	SELECTCASE SIZE("페니스", ARG)
	CASE 0
		LOCALS = 작음
	CASE 1
		LOCALS = 보통
	CASE 2
		LOCALS = 거근
	CASE 3
		LOCALS = 말잦이
	CASE 4
		LOCALS = 팔뚝
	CASE 5
		LOCALS = 竜並み
	CASEELSE
		LOCALS = 규격외
	ENDSELECT
CASE "もとの性別"
	IF COND("성전환中", ARG)
		IF GETBIT(CFLAG:ARG:4, 18)
			LOCALS = 여자
		ELSEIF GETBITS(CFLAG:ARG:4, 19, 20)
			LOCALS = 후타나리
		ELSE
			LOCALS = 남자
		ENDIF
	ELSEIF TALENT:ARG:여자
		LOCALS = 여자
	ELSEIF TALENT:ARG:후타나리
		LOCALS = 후타나리
	ELSE
		LOCALS = 남자
	ENDIF
CASE "動物分類"
	SELECTCASE MAX(TALENT:ARG:동물귀, TALENT:ARG:꼬리, TALENT:ARG:뿔, TALENT:ARG:날개, TALENT:ARG:동물다리)
	CASE 1
		LOCALS = 고양이
	CASE 2
		LOCALS = 늑대
	CASE 3
		LOCALS = 여우
	CASE 4
		LOCALS = 토끼
	CASE 5
		LOCALS = 말
	CASE 6
		LOCALS = 악마
	CASE 7
		LOCALS = 도마뱀
	CASE 8
		LOCALS = 자바워크
	CASE 9
		LOCALS = 오니
	CASE 10
		LOCALS = 요정
	CASE 11
		LOCALS = 하피
	CASE 12
		LOCALS = 천사
	CASEELSE
		LOCALS = 인간
	ENDSELECT
CASE "카운터"
	SELECTCASE TFLAG:90
	CASE 0
		LOCALS = 카운터없음
	CASE 1
		LOCALS = Ｖ인서트
	CASE 2
		LOCALS = Ａ인서트
	CASE 3
		LOCALS = 애무
	CASE 4
		LOCALS = 봉사
	CASE 5
		LOCALS = ＳＭ
	CASE 9
		LOCALS = 아르카나
	CASE 10
		LOCALS = 황홀
	CASE 11
		LOCALS = 넘어뜨리기
	CASE 12
		LOCALS = 스톡사용
	CASE 13
		LOCALS = 강제종료
	CASE 14
		LOCALS = 황홀에서복귀
	CASE 15
		LOCALS = 조수가한계
	ENDSELECT
CASE "카운터：強度"
	SELECTCASE TFLAG:96
	CASE 1
		LOCALS = 弱
	CASE 2
		LOCALS = 中
	CASE 3
		LOCALS = 強
	CASE 4
		LOCALS = 必殺
	CASEELSE
		LOCALS = 실패
	ENDSELECT
CASE "카운터：아르카나"
	LOCALS = %TRAINNAME:(TFLAG:97)%
CASE "체위"
	SELECTCASE GETBITS(INSERT("인서트", ARG), 0, 9)
	CASE 1p0
		LOCALS = 정상위
	CASE 1p1
		LOCALS = 후배위
	CASE 1p2
		LOCALS = 굴곡위
	CASE 1p3
		LOCALS = 대면좌위
	CASE 1p4
		LOCALS = 배면좌위
	CASE 1p5
		LOCALS = 기승위
	CASEELSE
		IF PREVPLAY("정상위", ARG)
			LOCALS = 정상위
		ELSEIF PREVPLAY("후배위", ARG)
			LOCALS = 후배위
		ELSEIF PREVPLAY("굴곡위", ARG)
			LOCALS = 굴곡위
		ELSEIF PREVPLAY("대면좌위", ARG)
			LOCALS = 대면좌위
		ELSEIF PREVPLAY("배면좌위", ARG)
			LOCALS = 배면좌위
		ELSEIF PREVPLAY("기승위", ARG)
			LOCALS = 기승위
		ENDIF
	ENDSELECT
CASE "음모", "겨털"
	SELECTCASE ARGS
	CASE "음모"
		LOCAL = BASE:ARG:음모
	CASE "겨털"
		LOCAL = BASE:ARG:겨털
	ENDSELECT
	SELECTCASE LOCAL/100
	CASE 1
		IF ARGS == "음모"
			LOCALS = 민둥산
		ELSE
			LOCALS = 무모
		ENDIF
	CASE 2
		LOCALS = 탈모처리
	CASE 3
		LOCALS = 반들반들
	CASE 4
		IF AGE(ARG) >= 3 && LOCAL%100 <= 2
			LOCALS = 면도자국
		ELSEIF AGE(ARG) >= 4
			LOCALS = 無精髭
		ELSE
			LOCALS = 갓자라남
		ENDIF
	CASE 5
		LOCALS = 손질완료
	CASE 6
		LOCALS = 내츄럴
	CASE 7
		LOCALS = 무성함
	ENDSELECT

CASE "아침の상대"
	LOCALS = %CALLNAME:FINDCHARA(CFLAG:90, COND("아침이벤트", ARG), MASTER + 1)%
CASE "밤の상대"
	LOCALS = %CALLNAME:FINDCHARA(CFLAG:91, COND("밤이벤트", ARG), MASTER + 1)%
CASE "조교後の상대"
	LOCALS = %CALLNAME:FINDCHARA(CFLAG:92, COND("조교後이벤트", ARG), MASTER + 1)%
CASE "다방：제복"
	SELECTCASE GETBITS(FLAG:401, 0, 9)
	CASE 1p0
		LOCALS = 웨이트리스
	CASE 1p1
		LOCALS = 메이드복
	CASE 1p2
		LOCALS = 무녀풍
	CASE 1p5
		LOCALS = 바니
	ENDSELECT
CASEELSE
	THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT
RETURNF LOCALS

;-------------------------------------------------
;TALENT:ARG:외견연령に体形などによる보정を加えたもの
;-------------------------------------------------
@AGE(ARG)
#FUNCTION

LOCAL = TALENT:ARG:외견연령

IF NO:ARG != 0
	;SIF TALENT:ARG:장신 && CSVTALENT(NO:ARG, 100, 0)
	;	LOCAL += 1
	SIF TALENT:ARG:작은몸집 && CSVTALENT(NO:ARG, 100, 0) == 0
		LOCAL -= 1
	SIF TALENT:ARG:유치 && CSVTALENT(NO:ARG, 132, 0) == 0
		LOCAL -= 1
ENDIF
SIF COND("성장끝", ARG) == 0
	LOCAL = 0

IF COND("오토코노코", ARG)
	LOCAL = LIMIT(LOCAL, 1, 2)
ELSE
	LOCAL = LIMIT(LOCAL, 1, 4)
ENDIF

RETURNF LOCAL

;-------------------------------------------------
;ARG:1～ARG:4の캐릭터의相性をARGだけ加算する(ARGが負の値なら減算)
;ちょっとした이벤트なら+1～+2で良いでしょう
;協力して何かを行ったぐらいで+5とか、+10は一大이벤트ぐらいです
;-------------------------------------------------
@CHANGE_RELATION, ARG, ARG:1, ARG:2, ARG:3, ARG:4
#DIM LCOUNT
#DIM LCOUNT2

;PRINTFORML ARG:1 = {ARG:1}, ARG:2 = {ARG:2}, ARG:3 = {ARG:3}, ARG:4 = {ARG:4}
;PRINTL 

FOR LCOUNT, 1, 5
	SIF ARG:LCOUNT <= 0
		CONTINUE
	FOR LCOUNT2, 1, 5
		SIF LCOUNT == LCOUNT2
			CONTINUE
		SIF ARG:LCOUNT2 <= 0
			CONTINUE
		;RELATIONの初期値は０なので、その場合には100にする
		SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) == 0
			RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 100

		;PRINTFORM RELATION:{ARG:LCOUNT}:{NO:(ARG:LCOUNT2)} = {RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) )} → 
		RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) += ARG
		;PRINTFORML {RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) )}

		;MAXは200
		SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) > 200
			RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 200
	NEXT
NEXT

;-------------------------------------------------
;@CHANGE_RELATIONの数値指定版。
;ARGSには○、◎、☆が入り、それぞれ相性を120,150,200にする
;-------------------------------------------------
@CHANGE_RELATION_MARK, ARGS, ARG, ARG:1, ARG:2, ARG:3
#DIM LCOUNT
#DIM LCOUNT2

;PRINTFORML ARG:0 = {ARG:0}, ARG:1 = {ARG:1}, ARG:2 = {ARG:2}, ARG:3 = {ARG:3}
;PRINTL 

FOR LCOUNT, 0, 4
	SIF ARG:LCOUNT <= 0
		CONTINUE
	FOR LCOUNT2, 0, 4
		SIF LCOUNT == LCOUNT2
			CONTINUE
		SIF ARG:LCOUNT2 <= 0
			CONTINUE
		;RELATIONの初期値は０なので、その場合には100にする
		SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) == 0
			RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 100

		;PRINTFORM RELATION:{ARG:LCOUNT}:{NO:(ARG:LCOUNT2)} = {RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) )} → 

		SELECTCASE ARGS
		CASE "○"
			SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) < 120
				RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 120
		CASE "◎"
			SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) < 150
				RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 150
		CASE "☆"
			SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) < 200
				RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 200
		ENDSELECT

		;PRINTFORML {RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) )}

		;MAXは200
		SIF RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) > 200
			RELATION:(ARG:LCOUNT):(NO:(ARG:LCOUNT2) ) = 200
	NEXT
NEXT

;-------------------------------------------------
;主に現実の날짜を参照する이벤트全般の判定をする
;ARGS:1には"現実のみ"、"ゲーム内"などが代入される
;-------------------------------------------------
@DAYEV(ARGS, ARGS:1)
#FUNCTION

;現実の年
#DIM RYEAR
;現実の날짜時刻
#DIM MONTH_DAY
;現実の日(曜日計算でのみ사용)
#DIM RDAY
;現実の時刻
#DIM RTIME
;現実の曜日
#DIM WEEKDAY


GETTIME

RYEAR = (RESULT / 10000000000000) % 10000
;現実の날짜時刻が02/05の4時ならMONTH_DAY = 20504
MONTH_DAY = (RESULT / 10000000) % 1000000
;現実の日
RDAY = (RESULT / 1000000000) % 100
;現実の시간0～23
RTIME = MONTH_DAY%100

;曜日の算出（1-2月の時は計算式が別）
SELECTCASE MONTH_DAY/10000
CASE 1, 2
	WEEKDAY = (RYEAR - 1 + (RYEAR - 1)/4 - (RYEAR - 1)/100 + (RYEAR - 1)/400 + (13*(MONTH_DAY/10000 + 12) + 8)/5 + RDAY)%7
CASEELSE
	WEEKDAY = (RYEAR + RYEAR/4 - RYEAR/100 + RYEAR/400 + (13*MONTH_DAY/10000 + 8)/5 + RDAY)%7
ENDSELECT

;それぞれの이벤트日は다음날の深夜まではＯＫとする
SELECTCASE ARGS
;날짜이벤트
CASE "정월"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 101
		RETURNF 1
	SIF MONTH_DAY >= 10100 && MONTH_DAY <= 10203
		RETURNF 1
CASE "발렌타인前日"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 114
		RETURNF 1
	SIF MONTH_DAY >= 21300 && MONTH_DAY <= 21323
		RETURNF 1
CASE "발렌타인"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 115
		RETURNF 1
	SIF MONTH_DAY >= 21400 && MONTH_DAY <= 21503
		RETURNF 1
CASE "발렌타인다음날"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 116
		RETURNF 1
	SIF MONTH_DAY >= 21504 && MONTH_DAY <= 21603
		RETURNF 1
CASE "화이트데이"
	;１年目は無し
	SIF FLAG:872 < 2
		RETURNF 0
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 5
		RETURNF 1
	SIF MONTH_DAY >= 31400 && MONTH_DAY <= 31503
		RETURNF 1
CASE "바다의날"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 46
		RETURNF 1
	SIF MONTH_DAY >= 71600 && MONTH_DAY <= 71703
		RETURNF 1
CASE "할로윈"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 80
		RETURNF 1
	SIF MONTH_DAY >= 103100 && MONTH_DAY <= 110103
		RETURNF 1
CASE "크리스마스일주일전"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 91
		RETURNF 1
	SIF MONTH_DAY >= 121800 && MONTH_DAY <= 121903
		RETURNF 1
CASE "크리스마스"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 98
		RETURNF 1
	;サービスで24と25両方ＯＫ
	SIF MONTH_DAY >= 122400 && MONTH_DAY <= 122603
		RETURNF 1
CASE "크리스마스다음날"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 == 99
		RETURNF 1
	SIF MONTH_DAY >= 122604 && MONTH_DAY <= 122703
		RETURNF 1
CASE "크리스마스주간"
	SIF ARGS:1 != "現実のみ" && CONFIG("날짜고정이벤트재현") && FLAG:871 >= 91 && FLAG:871 <= 99
		RETURNF 1
	SIF MONTH_DAY >= 121800 && MONTH_DAY <= 122703
		RETURNF 1

;시간区分
CASE "早朝"
	SIF RTIME >= 4 && RTIME <= 5
		RETURNF 1
CASE "아침"
	SIF RTIME >= 4 && RTIME <= 10
		RETURNF 1
CASE "낮"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF TIME == 0
			RETURNF 1
	CASEELSE
		SIF RTIME >= 11 && RTIME <= 14
			RETURNF 1
	ENDSELECT
CASE "昼下がり"
	SIF RTIME == 13
		RETURNF 1
CASE "夕方"
	SIF RTIME >= 17 && RTIME <= 20
		RETURNF 1
CASE "밤"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF TIME
			RETURNF 1
	CASEELSE
		SIF RTIME >= 20 && RTIME <= 23
			RETURNF 1
	ENDSELECT
CASE "深夜"
	SIF RTIME < 23
		RTIME += 24
	SIF RTIME >= 23 && RTIME <= 27
		RETURNF 1

;季節の詳細
CASE "봄"
	SIF MONTH_DAY >= 30100 && MONTH_DAY <= 53124
		RETURNF 1

CASE "초여름"
	SIF MONTH_DAY >= 51000 && MONTH_DAY <= 60924
		RETURNF 1
CASE "여름"
	SIF MONTH_DAY >= 60100 && MONTH_DAY <= 83124
		RETURNF 1

CASE "초가을"
	SIF MONTH_DAY >= 80800 && MONTH_DAY <= 90624
		RETURNF 1
CASE "가을"
	SIF MONTH_DAY >= 90100 && MONTH_DAY <= 113124
		RETURNF 1
CASE "늦가을"
	SIF MONTH_DAY >= 110100 && MONTH_DAY <= 120924
		RETURNF 1

CASE "겨울"
	SIF MONTH_DAY < 120100
		RTIME += 120000
	SIF MONTH_DAY >= 120100 && MONTH_DAY <= 143124
		RETURNF 1

;曜日判定
CASE "日曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 0
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 0
			RETURNF 1
	ENDSELECT
CASE "月曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 1
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 1
			RETURNF 1
	ENDSELECT
CASE "火曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 2
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 2
			RETURNF 1
	ENDSELECT
CASE "水曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 3
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 3
			RETURNF 1
	ENDSELECT
CASE "木曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 4
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 4
			RETURNF 1
	ENDSELECT
CASE "金曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 5
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 5
			RETURNF 1
	ENDSELECT
CASE "土曜"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 6
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 6
			RETURNF 1
	ENDSELECT
CASE "週末"
	SELECTCASE ARGS:1
	CASE "ゲーム内"
		SIF (DAY - 1)%7 == 0 || (DAY - 1)%7 == 6
			RETURNF 1
	CASEELSE
		SIF WEEKDAY == 0 || WEEKDAY == 6
			RETURNF 1
	ENDSELECT
CASE ""
;비워둠
CASEELSE
	THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT

RETURNF 0

;-------------------------------------------------
;キャラごとの날짜이벤트の発生を判定する
;-------------------------------------------------
@CDAYEV(ARGS, ARG)
#FUNCTION

SIF ARG == 0 && TARGET
	ARG = TARGET
SIF ARGS == ""
	ARGS = %TEXTS("날짜対応이벤트")%

;今日が指定した날짜이벤트の日でないなら発生しない
SIF DAYEV(ARGS) == 0
	RETURNF 0

;TRYFORMにできないので力技
SELECTCASE NO:ARG
CASE 16
	SELECTCASE CFLAG:ARG:209
	CASE 1
		SIF IS_DAYEV_K16_1(ARGS, ARG)
			RETURNF 1
	ENDSELECT
CASE 25
	SELECTCASE CFLAG:ARG:209
	CASE 2
		SIF IS_DAYEV_K25_2(ARGS, ARG)
			RETURNF 1
	ENDSELECT
ENDSELECT
RETURNF 0


;-------------------------------------------------
;CSVTALENTの調整版
;ARGには캐릭터의番号, ARG:1には参照したいTALENTの番号を入れる
;-------------------------------------------------
@CSVTALENT_EX(ARG, ARG:1)
#FUNCTION

VARSET LOCAL

SELECTCASE ARG:1
;CSV以外で記述する소질
CASE 3, 52, 59, 73, 180 TO 185
	LOCAL = MAX(SET_EXTALENT(TALENTNAME:(ARG:1), ARG), CSVTALENT(NO:ARG, ARG:1) )
CASEELSE
	LOCAL = CSVTALENT(NO:ARG, ARG:1)
ENDSELECT

RETURNF LOCAL

;-------------------------------------------------
;ARGS:0～の内のどれかを等확률で返す
;＿は何も出力しない선택とする
;-------------------------------------------------
@TEXTR(ARGS:0, ARGS:1, ARGS:2, ARGS:3, ARGS:4, ARGS:5, ARGS:6, ARGS:7, ARGS:8, ARGS:9, ARGS:10, ARGS:11, ARGS:12, ARGS:13, ARGS:14, ARGS:15, ARGS:16, ARGS:17, ARGS:18, ARGS:19)
#FUNCTIONS
#DIM LCOUNT
LOCALS = %ARGS:0%
FOR LCOUNT, 1, 20
	SIF ARGS:LCOUNT == ""
		BREAK
	SIF RAND:(LCOUNT + 1) == 0
		LOCALS = %ARGS:LCOUNT%
NEXT
SIF LOCALS == "＿"
	LOCALS = 
RETURNF LOCALS


;-------------------------------------------------
;특수な書式の文字列ARGSを読める文章に直す
;行や命令は_で区切る事。そしてLOCALSは99までなので손加減してくれ
;CASEを増やして、そのうち文字列を別作成しないで済むようにしたい
;FLAG:5で操作することができる。
;0bit WAITを打ち消し、WをPRINTLに変換する
;-------------------------------------------------
@PRINT_STR, ARGS, ARGS:1
#DIM LCOUNT

VARSET LOCALS

;文字列を分解する
SPLIT ARGS, "_", LOCALS

FOR LCOUNT, 0, 100
	;특수な操作
	SELECTCASE LOCALS:LCOUNT
	CASE ""
		BREAK
	CASE "CALLNAME:TARGET"
		PRINTFORM %CALLNAME:TARGET%
		CONTINUE
	CASE "CALLNAME:PLAYER"
		PRINTFORM %CALLNAME:PLAYER%
		CONTINUE
	CASE "CALLNAME:ASSI"
		PRINTFORM %CALLNAME:ASSI%
		CONTINUE
	CASE "CALLNAME:MASTER"
		PRINTFORM %CALLNAME:MASTER%
		CONTINUE
	CASE "BUTTON"
		;次の文字をボタンにする
		LCOUNT += 1
		PRINTBUTTON LOCALS:LCOUNT, LOCALS:LCOUNT
		RESETCOLOR
		CONTINUE
	CASE "改行", "L"
		PRINTL 
		RESETCOLOR
		CONTINUE
	CASE "W"
		IF GETBIT(FLAG:5, 0)
			PRINTL 
		ELSE
			PRINTW 
		ENDIF
		RESETCOLOR
		CONTINUE
	CASE "WAIT"
		SIF GETBIT(FLAG:5, 0) == 0
			WAIT
		RESETCOLOR
		CONTINUE
	CASE "FORCEWAIT"
		FORCEWAIT
		RESETCOLOR
		CONTINUE
	CASE "H", "ハート"
		CALL HEARTMARK
		RESETCOLOR
		CONTINUE
	CASE "쇼킹핑크", "핑크", "하트핑크", "빨강", "홍색", "황색", "暗황색", "노랑", "초록", "파랑", "물색", "暗회색", "회색", "明회색", "하양"
		SETCOLOR DEF_COLOR(LOCALS:LCOUNT)
		CONTINUE
	ENDSELECT

	PRINTFORM %LOCALS:LCOUNT%
	RESETCOLOR
NEXT


;-------------------------------------------------
;ARGSに손가락定した色ARGをつけて出力する
;-------------------------------------------------
@PRINT_COLORTEXT, ARGS, ARG
LASTWORD = %ARGS%
SETCOLOR ARG
PRINTFORM %ARGS%
RESETCOLOR
;-------------------------------------------------
;PRINT_COLORTEXTの改行版
;-------------------------------------------------
@PRINTL_COLORTEXT, ARGS, ARG
LASTWORD = %ARGS%
SETCOLOR ARG
PRINTFORML %ARGS%
RESETCOLOR
;-------------------------------------------------
;PRINT_COLORTEXTのウェイトあり版
;-------------------------------------------------
@PRINTW_COLORTEXT, ARGS, ARG
LASTWORD = %ARGS%
SETCOLOR ARG
PRINTFORMW %ARGS%
RESETCOLOR

;-------------------------------------------------
;条件分岐用のRAND
;ARGには最低分岐数を入れる
;nを正の整数とすると RANDIF(n, TALENT:강기, ABL:욕망 >= 3) は、
;RAND:(n + LIMIT(TALENT:강기, 0, 1) + (ABL:욕망 >= 3) ) == 0 に等しい
;主に, IF TALENT:교만 && RANDIF(2, TALENT:강기, ABL:욕망 >= 3) 等のように用いる
;-------------------------------------------------
@RANDIF(ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7, ARG:8, ARG:9)
#FUNCTION
#DIM LCOUNT
SIF ARG <= 0
	RETURNF 0

LOCAL = ARG
FOR LCOUNT, 1, 10
	SIF ARG:LCOUNT > 0
		LOCAL += 1
NEXT
SIF RAND:LOCAL == 0
	RETURNF 1
RETURNF 0

;-------------------------------------------------
;ARGが0이하なら0を返すRAND
;-------------------------------------------------
@RANDN(ARG)
#FUNCTION
SIF ARG <= 0
	RETURNF 0
LOCAL = RAND:ARG
RETURNF LOCAL

;-------------------------------------------------
;ゲーム内の날짜、午前午後、現実시간の체크タイミングによって同じ数値を返すRAND
;FLAG:13は現実시간に応じて値が変わり、SHOP画面と조교中の１ターンごとに取得します
;ARG:1に一つ확률に影響の出る変数を入れることが出来るので工夫してください
;性質上、適当に使うのは非推奨。死に分岐ができるぞ！
;-------------------------------------------------
@RANDF(ARG, ARG:1)
#FUNCTION

SIF ARG <= 1
	RETURNF 0

;ARG:1を10倍して2乗させるので상한を設ける
ARG:1 %= 10000000

LOCAL = (POWER(FLAG:13 + (DAY*2 + TIME + ARG:1)*10, 2) / 100) % 1000000000000

RETURNF LOCAL%ARG

@GET_REALTIMEFORFLAG
SIF FLAG:13 == 0 || COND("조교中")
	FLAG:13 = GETMILLISECOND() % 1000000000

;一言이벤트中はSHOP画面では変更しない
SIF FLAG:23
	RETURN 0

SIF CSTR:MASTER:성희롱중 == ""
	FLAG:13 = GETMILLISECOND() % 1000000000

;-------------------------------------------------
;ARG:1人プレイの時に、キャラ番号ARGが同キャラがいる場合でもRAND分岐で同じものを選ばないようにするために使う
;-------------------------------------------------
@RAND_MULTI(ARG, ARG:1)
#FUNCTION
#DIM LCOUNT

LOCAL = RANDF(ARG:1, NO:ARG)

FOR LCOUNT, 0, ARG:1
	SIF ARG != TARGET:LCOUNT
		CONTINUE

	LOCAL = (LOCAL + LCOUNT) % ARG:1
	BREAK
NEXT

RETURNF LOCAL

;-------------------------------------------------
;主に未読を체크しながらランダム分岐させる関数試作
;結局文字列だと物凄い長さになりそうなので、とりあえずFLAGを1つ使う予定の方式で作成
;ARGには何分の一で分岐するかの値を代入(ツリー全てが既読の際にはRAND:ARG == 0で発生するようになる）、
;ARG:1に체크に用いるFLAG、ARG:2に分岐ツリーの一番下で使うビット、
;ARG:3に分岐ツリーの一番上で使うビット、ARG:4にその선택지を読むことでONになるビットを入れる
;ただし、ARG:4が ARG:2 + ARG - 1 に等しい場合には省略してよい（どうせARG:4には0が代入されることはない）
;-------------------------------------------------
@RANDCHK(ARG, ARG:1, ARG:2, ARG:3, ARG:4)
#FUNCTION
#DIM LCOUNT
;ARG:4이하の선택지で、選ばれていないものの数
#DIM NUM_SELECT

SIF ARG:4 == 0
	ARG:4 = ARG:2 + ARG - 1

;まずツリー全部のビットフラグがＯＮだった場合の値の総和を出す
LOCAL = 0
NUM_SELECT = 0

FOR LCOUNT, ARG:2, ARG:3 + 1
	LOCAL += POWER(2, LCOUNT)
	SIF LCOUNT <= ARG:4 && GETBIT(ARG:1, LCOUNT) == 0
		NUM_SELECT += 1
NEXT

;PRINTFORML ARG:4 = {ARG:4}, NUM_SELECT = {NUM_SELECT}

;ARG:4が선택済み
IF GETBIT(ARG:1, ARG:4)
	;すべて선택済みならRAND:ARG == 0 に委ねる
	IF GETBITS(ARG:1, ARG:2, ARG:3) == LOCAL
		SIF RAND:ARG == 0
			RETURNF 1
		RETURNF 0
	;それ以外…つまり、ARG:4は선택されているが、ARG:2～ARG:3の内で選ばれていないものがある
	ELSE
		RETURNF 0
	ENDIF
;ARG:4はまだ選ばれていない
ELSE
	;ARG:4以外がすべて선택されているなら、この선택지を実行
	IF GETBITS(ARG:1, ARG:2, ARG:3) == LOCAL - POWER(2, ARG:4)
		RETURNF 1
	;ARG:4と、他いくつかが선택されていない
	ELSE
		;NUM_SELECTに、これ이하のツリーでの선택されていない数が入ってるのでそれを使う
		SIF RAND:NUM_SELECT == 0
			RETURNF 1
		RETURNF 0
	ENDIF
ENDIF

RETURNF 0

;-------------------------------------------------
;地の文調整用
;-------------------------------------------------
@TEXT_CONJ(ARGS)
#FUNCTIONS
IF ARGS == "す"
	LOCALS = 고
ELSEIF ARGS == "む"
	LOCALS = 고
ELSEIF ARGS == "る"
	LOCALS = 고
ENDIF
RETURNF LOCALS

;-------------------------------------------------
;ARGを(ARG:1 / 100)倍する
;A = MULTIPLY(A, 150)　は　TIMES A, 1.50　と等しい. 
;A = MULTIPLY(A, B)　でB <= 0ならば計算結果はマイナスでなくA*1/100とする. 
;-------------------------------------------------
@MULTIPLY(ARG, ARG:1)
#FUNCTION
;0이하の数をかけたときには ARG:1 = 1 とする
SIF ARG:1 <= 0
	ARG:1 = 1
LOCAL = ARG * ARG:1 / 100
RETURNF LOCAL

;-------------------------------------------------
;ARGを(100/ARG:1)倍する
;A = DIVIDE(A, 150)　は　TIMES A, 0.66　と大体等しく, A = A * 100 / 150　と等しい
;A = DIVIDE(A, B)　でB <= 0ならば計算結果は無限やマイナスでなくAのままとなる. 
;-------------------------------------------------
@DIVIDE(ARG, ARG:1)
#FUNCTION
;0이하の数では割れない
SIF ARG:1 <= 0
	RETURNF ARG
LOCAL = ARG * 100 / ARG:1
RETURNF LOCAL


;-------------------------------------------------
;3桁ごとにカンマの入った소지금表示
;ARG:1には桁を揃える최대치を定めても良い
;-------------------------------------------------
@MONEY_C(ARG, ARG:1)
#FUNCTIONS
VARSET LOCALS
FOR LOCAL, 0, 10
	LOCALS = {ARG%1000}%LOCALS%
	IF ARG/1000
		SELECTCASE ARG%1000
		CASE IS < 10
			LOCALS = ,00%LOCALS%
		CASE IS < 100
			LOCALS = ,0%LOCALS%
		CASEELSE
			LOCALS = ,%LOCALS%
		ENDSELECT
		ARG /= 1000
	ELSE
		BREAK
	ENDIF
NEXT
IF ARG:1
	FOR LOCAL, 0, 10
		LOCALS:1 = {ARG:1%1000}%LOCALS:1%
		IF ARG:1/1000
			SELECTCASE ARG:1%1000
			CASE IS < 10
				LOCALS:1 = ,00%LOCALS:1%
			CASE IS < 100
				LOCALS:1 = ,0%LOCALS:1%
			CASEELSE
				LOCALS:1 = ,%LOCALS:1%
			ENDSELECT
			ARG:1 /= 1000
		ELSE
			BREAK
		ENDIF
	NEXT
	LOCALS = $%BL(STRLENS(LOCALS:1) - STRLENS(LOCALS))%%LOCALS%
ELSE
	LOCALS = $%LOCALS%
ENDIF
RETURNF LOCALS
;-------------------------------------------------
;半角スペースの出力
;-------------------------------------------------
@BL(ARG)
#FUNCTIONS
LOCALS = 
SIF ARG <= 0
	RETURNF LOCALS
FOR LOCAL, 0, ARG
	LOCALS += " "
NEXT
RETURNF LOCALS

;-------------------------------------------------
;色々플래그を考慮したDELCHARA
;캐릭터번호ARGのキャラを削除する
;eramakerの命令DELCHARAと異なりTARGETとASSIを保つ
;-------------------------------------------------
@DELETE_CHARA, ARG

DELCHARA ARG

;TARGETとASSIの番号調整
IF ARG == TARGET
	TARGET = 0
ELSEIF ARG < TARGET
	TARGET -= 1
ENDIF
IF ARG == ASSI
	ASSI = 0
ELSEIF ARG < ASSI
	ASSI -= 1
ENDIF

;-------------------------------------------------
;色々플래그を考慮した캐릭터번호の交換関数
;캐릭터번호ARGとARG:1のキャラを交換する
;Emueraの命令SWAPCHARAと異なりTARGETとASSIを保つ
;-------------------------------------------------
@SWAP_CHARA, ARG, ARG:1
;TARGETとASSIの番号調整
SELECTCASE TARGET
CASE 0
CASE ARG
	TARGET = ARG:1
CASE ARG:1
	TARGET = ARG
ENDSELECT
SELECTCASE ASSI
CASE 0
CASE ARG
	ASSI = ARG:1
CASE ARG:1
	ASSI = ARG
ENDSELECT

SWAPCHARA ARG, ARG:1

;-------------------------------------------------
;Emueraの命令SORTCHARAのＳＱＮ対応版
;ARGSにはソートの条件, ARGS:1には昇順か降順のどちらかが入る
;-------------------------------------------------
@SORT_CHARA, ARGS, ARGS:1
#DIM LCOUNT

;도플갱어당신を一時的に消す
CALL DELETE_CHARA, 0
;MASTERを주인に설정
MASTER = 0

SELECTCASE ARGS:1
CASE "昇順"
	SELECTCASE ARGS
	CASE "加入順"
		SORTCHARA BASE:식별번호
	CASE "캐릭터번호"
		SORTCHARA
	CASE "호감도"
		SORTCHARA CFLAG:2
	CASE "最後に상대した날짜"
		SORTCHARA CFLAG:97
	CASE "ＬＶ"
		SORTCHARA ABL:ＬＶ
	CASE "評価ポイント"
		SORTCHARA CFLAG:44
	CASE "신장"
		SORTCHARA BASE:신장
	CASE "가슴 크기"
		SORTCHARA BASE:바스트
	CASEELSE
		THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
	ENDSELECT
CASEELSE
	SELECTCASE ARGS
	CASE "加入順"
		SORTCHARA BASE:식별번호, BACK
	CASE "캐릭터번호"
		SORTCHARA BACK
	CASE "호감도"
		SORTCHARA CFLAG:2, BACK
	CASE "最後に상대した날짜"
		SORTCHARA CFLAG:97, BACK
	CASE "ＬＶ"
		SORTCHARA ABL:ＬＶ, BACK
	CASE "評価ポイント"
		SORTCHARA CFLAG:44, BACK
	CASE "신장"
		SORTCHARA BASE:신장, BACK
	CASE "가슴 크기"
		SORTCHARA BASE:바스트, BACK
	CASEELSE
		THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
	ENDSELECT
ENDSELECT

;도플갱어당신を復帰
ADDCHARA 93
;番号を도플갱어당신が[0]番になるように揃える
FOR LCOUNT, 1, CHARANUM
	LOCAL = CHARANUM - LCOUNT
	LOCAL:1 = LOCAL - 1
	CALL SWAP_CHARA, LOCAL, LOCAL:1
NEXT

;MASTERを주인に설정
MASTER = 1

;-------------------------------------------------
;数値によって変化する소질を加味したTALENTNAME
;ARGには소질番号, ARG:1にはその値, ARG:2には参照するキャラが代入される
;-------------------------------------------------
@TALENT_NAME(ARG, ARG:1, ARG:2)
#FUNCTIONS
#DIM LCOUNT

VARSET LOCALS
LOCALS = %TALENTNAME:ARG%
SIF ARG:2 == 0 && TARGET
	ARG:2 = TARGET
SELECTCASE ARG
;再生처녀
CASE 0
	SIF ARG:1 == 2
		LOCALS = %TALENTNAME:0%(재생)
CASE 2
	IF GETBIT(ARG:1, 5)
		LOCALS = 竜並
	ELSEIF GETBIT(ARG:1, 4)
		LOCALS = 腕並
	ELSEIF GETBIT(ARG:1, 3)
		LOCALS = 말잦이
	ELSEIF GETBIT(ARG:1, 2)
		LOCALS = 거근
	ELSEIF GETBIT(ARG:1, 1)
		LOCALS = 왜소
	ELSEIF GETBIT(ARG:1, 0)
		LOCALS = 보통
	ENDIF
	IF GETBIT(ARG:1, 12)
		LOCALS = %LOCALS%(진성)
	ELSEIF GETBIT(ARG:1, 11)
		LOCALS = %LOCALS%(가성)
	ELSE
		LOCALS = %LOCALS%(벗겨냄)
	ENDIF
	SIF TALENT:(ARG:2):용의혈통
		LOCALS = %LOCALS%%UNI("드래곤")%
CASE 3
	IF TALENT:(ARG:2):남자 == 0
		SELECTCASE ARG:1
		CASE 1
			LOCALS = 로리
		CASE 2
			IF TALENT:(ARG:2):작은몸집 && (NO:(ARG:2) == 16 || NO:(ARG:2) == 22 || NO:(ARG:2) == 47)
				LOCALS = ロリババア
			ELSE
				LOCALS = 소녀
			ENDIF
		CASE 3
			LOCALS = 언니
		CASE 4
			LOCALS = 어른
		ENDSELECT
	ENDIF
CASE 8
	LOCALS = 
	SIF COND("유두비대", ARG:2)
		LOCALS = %LOCALS%[유두비대\@ COND("유두비대", ARG:2) >= 2 ? LV{COND("유두비대", ARG:2)} # \@]
	IF COND("진성함몰유두", ARG:2)
		LOCALS = %LOCALS%[함몰유두(진성)]
	ELSEIF COND("가성함몰유두", ARG:2)
		LOCALS = %LOCALS%[함몰유두(가성)]
	ENDIF
	SIF COND("거유륜", ARG:2)
		LOCALS = %LOCALS%[거유륜\@ COND("거유륜", ARG:2) >= 2 ? LV{COND("거유륜", ARG:2)} # \@]

	LOCALS = %SUBSTRING(LOCALS, 1, STRLENS(LOCALS) - 2)%
CASE 49
	SELECTCASE ARG:1
	CASE 1p0
		LOCALS = 정음에약함
	CASE 1p1
		LOCALS = 질내사정에약함
	CASE 1p2
		LOCALS = 장내사정에약함
	CASE 1p3
		LOCALS = 유내사정에약함
	;CASE 1p4
	;	LOCALS = 정액정액세례에약함
	ENDSELECT
CASE 110
	SELECTCASE ARG:1
	CASE 2
		LOCALS = 폭유
	CASE IS >= 3
		LOCALS = 초유
	ENDSELECT
CASE 121
	SIF ARG:1 == 1
		LOCALS = %LOCALS%(천연)
CASE 122
	SIF COND("오토코노코", ARG:2)
		LOCALS = 오토코노코
CASE 126
	IF GETBITS(ARG:1, 1, 2)
		LOCALS = 인기(
		SIF GETBIT(ARG:1, 1)
			LOCALS = %LOCALS%ＡＶ＆
		SIF GETBIT(ARG:1, 2)
			LOCALS = %LOCALS%다방＆
		LOCALS = %SUBSTRING(LOCALS, 0, STRLENS(LOCALS) - 2)%)
	ENDIF
CASE 135
	SIF ARG:1 == 2
		LOCALS = 임월
	SIF ARG:1 == 3
		LOCALS = 출산임박
CASE 139
	SELECTCASE ARG:1
	CASE 2
		LOCALS = 왕엉덩이
	CASE IS >= 3
		LOCALS = 초엉덩이
	ENDSELECT
CASE 151
	SIF ARG:1 == 2
		LOCALS = 대마법사
;날개or날개
CASE 161
	SIF (ARG:1 == 10 || ARG:1 == 12)
		LOCALS = 날개
CASE 163
	SIF ARG:1 == 8
		LOCALS = 파충류다리
	SIF ARG:1 == 11
		LOCALS = 맹금다리
CASE 164
	SELECTCASE ARG:1
	CASE 1
		LOCALS = 갈색
	CASE 2
		LOCALS = 흰피부
	CASE 3
		LOCALS = 청색
	ENDSELECT
;귀모양
CASE 167
	LOCALS = 엘프귀
CASE 185
	SELECTCASE ARG:1
	CASE 1p0
		LOCALS = %LOCALS%(애무・봉사)
	CASE 1p1
		LOCALS = %LOCALS%(지도능숙)
	CASE 1p2
		LOCALS = %LOCALS%(ＳＭ)
	CASE 1p3
		LOCALS = %LOCALS%(애널)
	CASE 1p4
		LOCALS = %LOCALS%(성기확장)
	CASE 1p5
		LOCALS = %LOCALS%(도구)
	CASE 1p6
		LOCALS = %LOCALS%(노출플레이)
	ENDSELECT
CASE 73, 180 TO 189, 193
	LOCALS = %TALENTNAME:ARG%LV{ARG:1}
CASE 194
	FOR LCOUNT, 0, 10
		LOCAL = POWER(2, LCOUNT)
		IF ARG:1 & LOCAL
			SIF STRLENS(LOCALS)
				LOCALS += ", "

			SELECTCASE LOCAL
			CASE 1p0
				LOCALS += "손"
			CASE 1p1
				LOCALS += "입"
			CASE 1p2
				LOCALS += "가슴"
			CASE 1p3
				LOCALS += "다리"
			CASE 1p4
				LOCALS += "♀"
			CASE 1p5
				LOCALS += "입술"
			CASE 1p6
				LOCALS += "엉덩이"
			ENDSELECT
		ENDIF
	NEXT
	SIF ARG:1 == 1p0 + 1p1 + 1p2 + 1p3 + 1p4 + 1p5 + 1p6
		LOCALS = 모두
	LOCALS += "에 약함"
CASE 197
	LOCALS = 
	SIF GETBIT(ARG:1, 0)
		LOCALS += "[정상위]"
	SIF GETBIT(ARG:1, 1)
		LOCALS += "[후배위]"
	SIF GETBIT(ARG:1, 2)
		LOCALS += "[굴곡위]"
	SIF GETBIT(ARG:1, 3)
		LOCALS += "[대면좌위]"
	SIF GETBIT(ARG:1, 4)
		LOCALS += "[배면좌위]"
	SIF GETBIT(ARG:1, 5)
		LOCALS += "[봉사기승위]"
	SIF GETBIT(ARG:1, 6)
		LOCALS += "[넘어뜨리기기승위]"
	SIF GETBIT(ARG:1, 9)
		LOCALS += "[특별히 없음]"
	SIF GETBIT(ARG:1, 10)
		LOCALS += "[Ａ정상위]"
	SIF GETBIT(ARG:1, 11)
		LOCALS += "[Ａ후배위]"
	SIF GETBIT(ARG:1, 12)
		LOCALS += "[Ａ굴곡위]"
	SIF GETBIT(ARG:1, 13)
		LOCALS += "[Ａ대면좌위]"
	SIF GETBIT(ARG:1, 14)
		LOCALS += "[Ａ배면좌위]"
	SIF GETBIT(ARG:1, 15)
		LOCALS += "[Ａ봉사기승위]"
	SIF GETBIT(ARG:1, 16)
		LOCALS += "[넘어뜨리기Ａ기승위]"
	SIF GETBIT(ARG:1, 19)
		LOCALS += "[에이스오브스페이드]"

	LOCALS = %SUBSTRING(LOCALS, 1, STRLENS(LOCALS) - 2)%

CASE 201
	SIF ARG:1 == 2
		LOCALS = 엘더서큐버스
CASE 202
	LOCAL = COND("권속", ARG:2)
	SELECTCASE LOCAL
	CASE IS > 0
		LOCALS = %NAME:LOCAL%の권속
	ENDSELECT
CASE 220
	SIF PENIS(ARG:2)
		LOCALS = 페니스피어스
CASE 240
	SELECTCASE ARG:1
	CASE 2
		LOCALS = 트레일루트
	CASE 3
		LOCALS = 꼬리감기
	CASE 4
		LOCALS = 퀸즈본디지
	CASE 5
		LOCALS = 와인딩웹
	CASE 6
		LOCALS = 파워바인드
	CASE 7
		LOCALS = 페트로아이즈
	CASE 8
		LOCALS = 바인드코드
	CASE 9
		LOCALS = 원더트립
	ENDSELECT
CASE 243
	SELECTCASE ARG:1
	CASE 2
		LOCALS = 분신
	CASE 3
		LOCALS = 分裂
	ENDSELECT
ENDSELECT
RETURNF LOCALS

;-------------------------------------------------
;비디오로 촬영한 내용의 판정
;-------------------------------------------------
@VIDEO(ARGS)
#FUNCTION
;LOCAL에만 0이상의 값을 대입하든 "커맨드번호==LOCAL", LOCAL:1에도 값을 대입하든 "LOCAL이상でLOCAL:1이하"의 커맨드라면 1을 반환함
LOCAL = -1
LOCAL:1 = - 1
SELECTCASE ARGS
CASE "처녀상실"
	RETURNF GETBIT(CFLAG:69, 10)
CASE "분유"
	RETURNF GETBIT(CFLAG:69, 11)
CASE "절정방뇨"
	RETURNF GETBIT(CFLAG:69, 12)
CASE "관장"
	LOCAL = 136
CASE "역레이프"
	LOCAL = 120
CASE "역애널"
	LOCAL = 126
CASE "섹스"
	LOCAL = 60
	LOCAL:1 = 69
CASE "Ａ섹스"
	LOCAL = 70
	LOCAL:1 = 79
CASE "피스트"
	LOCAL = 141
	LOCAL:1 = 143
CASE "용간"
	LOCAL = 304
	LOCAL:1 = 305
CASEELSE
	FOR LOCAL:2, 11, 21
		SIF FLAG:(LOCAL:2) >= 0 && ARGS == TRAINNAME:(FLAG:(LOCAL:2))
			RETURNF 1
	NEXT
ENDSELECT
IF LOCAL >= 0
	FOR LOCAL:2, 11, 21
		SIF FLAG:(LOCAL:2) >= LOCAL && FLAG:(LOCAL:2) <= MAX(LOCAL, LOCAL:1)
			RETURNF 1
	NEXT
ENDIF
RETURNF 0

;ARGでONとなっているビットの数
@NUM_BIT(ARG)
#FUNCTION
LOCAL:1 = 0
FOR LOCAL, 0, 64
	SIF GETBIT(ARG, LOCAL)
		LOCAL:1 += 1
NEXT
RETURNF LOCAL:1

;페니스의 명칭
@PENISNAME(ARG)
#FUNCTIONS
;소유주가 PLAYER
IF TALENT:ARG:후타나리 || TALENT:ARG:남자
	RESULTS = 페니스
ELSE
	RESULTS = 페니스밴드
ENDIF
RETURNF RESULTS

;하트마크!!  잠깐, 하트마크는 일시정지 ;<-폰트마다 달라서 폰트적용한다고 이러는듯?
@HEART()
#FUNCTIONS
CHKFONT "ＭＳ ゴシック"
;IF RESULT
;	;UNICODE 0x2764
;	;SETFONT "Lucida Sans Unicode"
;	UNICODE 0x2665
;ELSE
	RESULTS = ♪
;ENDIF
RETURNF RESULTS

;-------------------------------------------------
;ハートマークの出力…구상텍스트には組み込みにくいが, はっきりとしたハートマーク
;-------------------------------------------------
;Lucida Sans Unicode は大きめだが, 下の文章をかなり消してしまうんですよねぇ
@HEARTMARK
GETFONT
CHKFONT "Times New Roman"
SIF RESULT
	SETFONT "Times New Roman"
PRINTFORM %UNICODE(0x2665)%
SETFONT RESULTS

;구상の最後の時などに適している
@HEARTMARK_E
GETFONT
CHKFONT "Times New Roman"
SIF RESULT
	SETFONT "Times New Roman"
PRINTFORM %UNICODE(0x2665)%
SETFONT RESULTS
PRINTFORMW 」

;改行版
@HEARTMARK_L
GETFONT
CHKFONT "Times New Roman"
SIF RESULT
	SETFONT "Times New Roman"
PRINTFORM %UNICODE(0x2665)%
SETFONT RESULTS
PRINTFORML 」

@HEARTMARK_W
GETFONT
CHKFONT "Times New Roman"
SIF RESULT
	SETFONT "Times New Roman"
PRINTFORMW %UNICODE(0x2665)%
SETFONT RESULTS

;-------------------------------------------------
;ダミーカラーの설정
;SETCOLOR SETCOLOR_DUMMY()　と使う
;元の文字と微妙に違う色の文字にすることでGPI+特有の文字のズレを解消する（ただし工夫や力技必須）
;()の中に値1～127を入れるとさらに微妙に別の色として扱えるが, 10程度を超えると目に見えて違う色になってくる
;-------------------------------------------------
@SETCOLOR_DUMMY(ARG)
#FUNCTION
;RESULTの保持
LOCAL = RESULT
;현재のカラーの保持
GETCOLOR
LOCAL:1 = RESULT
RESETCOLOR

;デフォルトカラーの取得
GETCOLOR
IF ARG < 0 || ARG > 127
	LOCAL:2 = RESULT
ELSEIF RESULT%256 >= 255 - ARG
	LOCAL:2 = RESULT-(1+ARG)
ELSE
	LOCAL:2 = RESULT+(1+ARG)
ENDIF

;カラーの復元
SETCOLOR LOCAL:1
;RESULTの復元
RESULT = LOCAL

RETURNF LOCAL:2


;-------------------------------------------------
;色の설정
;-------------------------------------------------
@DEF_COLOR(ARGS)
#FUNCTION
SELECTCASE ARGS
CASE "쇼킹핑크"
	RETURNF 0xEF0EEF
CASE "핑크", "ピンク"
	RETURNF 0xEF857C
CASE "하트핑크"
	RETURNF 0xFFC0CB
CASE "빨강", "赤"
	RETURNF 0xEF5445
CASE "홍색", "紅"
	RETURNF 0xB815B8
CASE "황색"
	RETURNF 0xEFD540
CASE "暗황색"
	RETURNF 0xC4C400
CASE "노랑"
	RETURNF 0xFFFF00
CASE "초록"
	RETURNF 0x70E02C
CASE "파랑"
	RETURNF 0x4470EF
CASE "물색"
	RETURNF 0xB0CCEF
CASE "暗회색"
	RETURNF 0x404040
CASE "회색"
	RETURNF 0x707070
CASE "明회색"
	RETURNF 0xA0A0A0
CASE "하양"
	RETURNF 0xE3E3E3
CASEELSE
	THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT

;-------------------------------------------------
;BARの色付き等一括版
;ぱ. さん作のぱにめーしょんを参考にさせていただきました
;ARGSにどの게이지かを지시
;ARGにバーにする変数, ARG:1に최대치, ARG:2に文字列としての長さ が入る
;-------------------------------------------------
@PRINT_BAR, ARGS, ARG, ARG:1, ARG:2

SIF ARG < 0
	ARG = 0
SIF ARG:1 < 0
	ARG:1 = 0

PRINTPLAINFORM [

GETFONT
CHKFONT "ＭＳ ゴシック"
SIF RESULT
	SETFONT "ＭＳ ゴシック"

VARSET LOCAL
VARSET LOCALS
;色と記号の설정
IF CONFIG("画面표시：カラーバー")
	SELECTCASE ARGS
	CASE "ＰＡＬＡＭ절정"
		LOCAL = DEF_COLOR("쇼킹핑크")
	CASE "ＰＡＬＡＭ"
		LOCAL = ((DEF_COLOR("하양")/65536)/10*(10-MIN(10, GET_PALAMLV(ARG))))*65536
		LOCAL += (((DEF_COLOR("하양")/256)%256)/10*(10-MIN(10, GET_PALAMLV(ARG))))*256
		LOCAL += ((DEF_COLOR("하양")%256)/10*(10-MIN(10, GET_PALAMLV(ARG))))
		LOCAL += ((DEF_COLOR("핑크")/65536)/10*MIN(10, GET_PALAMLV(ARG)))*65536
		LOCAL += (((DEF_COLOR("핑크")/256)%256)/10*MIN(10, GET_PALAMLV(ARG)))*256
		LOCAL += ((DEF_COLOR("핑크")%256)/10*MIN(10, GET_PALAMLV(ARG)))
	CASE "황색게이지"
		LOCAL = DEF_COLOR("황색")
	CASE "백색게이지"
		LOCAL = DEF_COLOR("하양")
	CASE "복숭아색게이지"
		LOCAL = DEF_COLOR("핑크")
	CASE "감소게이지"
		SELECTCASE ARG * 100 / ARG:1
		CASE IS >= 75
			LOCAL = DEF_COLOR("초록")
		CASE IS >= 50
			LOCAL = DEF_COLOR("파랑")
		CASE IS >= 25
			LOCAL = DEF_COLOR("황색")
		CASE IS >= 1
			LOCAL = DEF_COLOR("홍색")
		CASEELSE
			LOCAL = DEF_COLOR("회색")
		ENDSELECT
	CASE "溜め게이지"
		SELECTCASE ARG * 100 / ARG:1
		CASE IS >= 100
			LOCAL = DEF_COLOR("핑크")
		CASE IS >= 50
			LOCAL = DEF_COLOR("황색")
		CASEELSE
			LOCAL = DEF_COLOR("파랑")
		ENDSELECT
	CASEELSE
		THROW %GAMEBASE_YEAR%버젼 BUG : "%ARGS%" 를 찾을 수 없습니다.
	ENDSELECT

	SETCOLOR LOCAL
	;バーの背景色
	IF CONFIG("画面표시：バー背景없음")
		LOCAL:1 = 0x000000
	ELSE
		LOCAL:1 = (MAX(30, (LOCAL/65536)/5)*65536 + MAX(30, ((LOCAL/256)%256)/5)*256 + MAX(30, (LOCAL%256)/5) )
	ENDIF

	LOCALS = %UNICODE(0x2587)%
	LOCALS:1 = %LOCALS%
ELSE
	IF CONFIG("画面상성：バーのグラフ표시")
		LOCALS = %UNICODE(0x2587)%
	ELSE
		LOCALS = *
	ENDIF
	IF CONFIG("画面표시：バー背景없음")
		LOCALS:1 = %BL(1)%
	ELSE
		LOCALS:1 = .
	ENDIF
ENDIF

;PALAM形式のバーの최대치の算出
SELECTCASE ARGS
CASE "ＰＡＬＡＭ", "ＰＡＬＡＭ절정"
	IF GET_PALAMLV(ARG) >= 16
		ARG:1 = PALAM_LV(16)
	ELSE
		ARG:1 = PALAM_LV(GET_PALAMLV(ARG) + 1) - PALAM_LV(GET_PALAMLV(ARG) )
		ARG -= PALAM_LV(GET_PALAMLV(ARG) )
	ENDIF
ENDSELECT

SELECTCASE ARG
CASE IS <= 0
	SIF CONFIG("画面표시：カラーバー")
		SETCOLOR LOCAL:1
	PRINTPLAINFORM %LOCALS:1 * ARG:2%
CASE IS >= ARG:1
	SELECTCASE ARGS
	CASE "황색게이지", "백색게이지", "복숭아색게이지", "ＰＡＬＡＭ"
		SIF ARG:2 >= 3
			LOCALS:2 = MAX
	ENDSELECT
	FOR LOCAL, 0, ARG:2
		IF LOCALS:2 != "" && LOCAL == ARG:2/2 - STRLENS(LOCALS:2)/2
			SETFONT RESULTS

			PRINTPLAINFORM %LOCALS:2%

			CHKFONT "ＭＳ ゴシック"
			SIF RESULT
				SETFONT "ＭＳ ゴシック"

			LOCAL += STRLENS(LOCALS:2) - 1
		ELSE
			PRINTPLAINFORM %LOCALS%
		ENDIF
	NEXT
CASEELSE
	FOR LOCAL, 0, ARG:2
		SELECTCASE LOCAL
		CASE (ARG*ARG:2 - ARG:2 + ARG:1) / ARG:1
			SIF CONFIG("画面표시：カラーバー")
				SETCOLOR LOCAL:1
			LOCALS = %LOCALS:1%
		ENDSELECT
		PRINTPLAINFORM %LOCALS%
	NEXT
ENDSELECT
RESETCOLOR

SETFONT RESULTS

PRINTPLAINFORM ]



;-------------------------------------------------
;@PICKUP…２人이상の몽마を使って描写する時の関数群
;GETCHARA, FINDCHARAとの違いは、"TARGETを除いた、조교경험のあるキャラから指定されたタイプの一人をランダムで選ぶ"ところ。
;-------------------------------------------------
;몽마が２人이상で、特定の몽마１～２人を구상に絡ませる時
;この関数のARG(いて欲しい캐릭터의番号)が손가락定されている時には, 居るなら登録番号を, いないなら0を返します. 
;特に指定がなければ(ARG == 0)、ランダムで三人を選びます。
;また、ARG:1にも数を代入すればRESULT:1に望みの캐릭터의番号が返る
@PICKUP_NO, ARG, ARG:1
#DIM LCOUNT
;該当する캐릭터의人数
#DIM NUM_FIND, 3

VARSET RESULT
VARSET LOCAL
VARSET NUM_FIND

;손가락定された몽마がいるかどうか체크します
FOR LCOUNT, 2, CHARANUM
	;MASTERの時や, まだ조교を行っていない時は処理を飛ばします
	SIF LCOUNT == MASTER || LCOUNT == TARGET || EXP:LCOUNT:조교횟수 == 0
		CONTINUE

	;몽마がいた場合, RESULTにその몽마の登録番号を保存します
	IF (ARG == ARG:1 && ARG > 0 && NO:LCOUNT == ARG) || ARG == 0
		NUM_FIND:2 += 1
		IF RESULT == 0
			RESULT = LCOUNT
		ELSEIF RESULT:1 == 0
			RESULT:1 = LCOUNT
		ELSEIF RAND:(NUM_FIND:2) <= 1
			IF RAND:2
				RESULT = LCOUNT
			ELSE
				RESULT:1 = LCOUNT
			ENDIF
		ENDIF
	ELSEIF NO:LCOUNT == ARG
		NUM_FIND += 1
		SIF RAND:NUM_FIND == 0
			RESULT = LCOUNT
	ELSEIF NO:LCOUNT == ARG:1
		NUM_FIND:1 += 1
		SIF RAND:(NUM_FIND:1) == 0
			RESULT:1 = LCOUNT
	ENDIF
NEXT
RETURN RESULT

;-------------------------------------------------
;캐릭터의中から特定の소질を持ったキャラをピックアップする関数
;二人손가락定の時には, それぞれの希望소질を손가락定する. 
;例：장신二人손가락定なら, PICKUP_TALENT, 99, 99 , 거유と빈유なら, PICKUP_TALENT, 109, 110
;-------------------------------------------------
@PICKUP_TALENT, ARG, ARG:1
VARSET RESULT
VARSET LOCAL
;손가락定された몽마がいるかどうか체크します
FOR LOCAL, 2, CHARANUM
	;MASTERの時や, まだ조교を行っていない時は処理を飛ばします
	IF LOCAL == MASTER || LOCAL == TARGET || EXP:LOCAL:조교횟수 == 0
		CONTINUE
	;몽마がいた場合, RESULTにその몽마の登録番号を保存します
	ELSE
		IF TALENT:LOCAL:ARG
			LOCAL:1 += 1
			SIF RAND:(LOCAL:1) == 0 || RESULT == RESULT:1
				RESULT = LOCAL
		ENDIF
		IF TALENT:LOCAL:(ARG:1)
			LOCAL:2 += 1
			;一人の二部門制覇は避ける
			IF RESULT > 0 && RESULT:1 > 0 && LOCAL == RESULT
			ELSE
				SIF RAND:(LOCAL:2) == 0
					RESULT:1 = LOCAL
			ENDIF
		ENDIF
	ENDIF
NEXT
RETURN RESULT


;-------------------------------------------------
;성전환이벤트
;-------------------------------------------------
@CHANGE_SEX, ARG
;男は女に, 女or후타나리は男に
;바이오리듬リセット
BASE:ARG:바이오리듬 = 0
;作られた후타나리は여자
IF TALENT:ARG:후타나리 == 2
	TALENT:ARG:후타나리 = 0
	TALENT:ARG:여자 = 1
ENDIF

IF CFLAG:ARG:4
	TALENT:ARG:여자 = 0
	TALENT:ARG:후타나리 = 0
	TALENT:ARG:남자 = 0

	SIF GETBIT(CFLAG:ARG:4, 0)
		TALENT:ARG:처녀 = 1
	SIF GETBIT(CFLAG:ARG:4, 1)
		TALENT:ARG:처녀 = 2

	;男にも濡れやすさの変化をつける試み
	;SIF GETBIT(CFLAG:ARG:4, 2)
	;	TALENT:ARG:젖기쉬움 = 1
	;SIF GETBIT(CFLAG:ARG:4, 3)
	;	TALENT:ARG:젖기어려움 = 1

	SIF GETBIT(CFLAG:ARG:4, 4)
		TALENT:ARG:Ｖ손상 = 1
	SIF GETBIT(CFLAG:ARG:4, 5)
		TALENT:ARG:Ｖ손상 = 2
	SIF GETBIT(CFLAG:ARG:4, 6)
		TALENT:ARG:Ｖ손상 = 3
	SIF GETBIT(CFLAG:ARG:4, 7)
		TALENT:ARG:지루 = 1
	SIF GETBIT(CFLAG:ARG:4, 8)
		TALENT:ARG:지루 = 2
	SIF GETBIT(CFLAG:ARG:4, 9)
		TALENT:ARG:음호 = 1
	SIF GETBIT(CFLAG:ARG:4, 10)
		TALENT:ARG:오토코노코 = 1

	IF GETBIT(CFLAG:ARG:4, 11) && TALENT:ARG:장신 == 0
		CALL CALC, "장신化", ARG
	ELSEIF GETBIT(CFLAG:ARG:4, 12) && TALENT:ARG:작은몸집 == 0
		CALL CALC, "小柄化", ARG
	ELSEIF TALENT:ARG:장신 || TALENT:ARG:작은몸집
		CALL CALC, "보통体型化", ARG
	ENDIF

	SIF GETBIT(CFLAG:ARG:4, 13)
		TALENT:ARG:Ｖ둔감 = 1
	SIF GETBIT(CFLAG:ARG:4, 14)
		TALENT:ARG:Ｖ민감 = 1
	SIF GETBIT(CFLAG:ARG:4, 15)
		TALENT:ARG:빈유 = 1
	SIF GETBIT(CFLAG:ARG:4, 16)
		TALENT:ARG:거유 = 1
	SIF GETBIT(CFLAG:ARG:4, 17)
		TALENT:ARG:거유 = 2
	SIF GETBIT(CFLAG:ARG:4, 18)
		TALENT:ARG:여자 = 1
	SIF GETBIT(CFLAG:ARG:4, 19)
		TALENT:ARG:후타나리 = 1
	SIF GETBIT(CFLAG:ARG:4, 20)
		TALENT:ARG:후타나리 = 2
	SIF GETBIT(CFLAG:ARG:4, 21)
		TALENT:ARG:남자 = 1
	SIF GETBIT(CFLAG:ARG:4, 22)
		TALENT:ARG:모유체질 = 1
	SIF GETBIT(CFLAG:ARG:4, 23)
		TALENT:ARG:모유체질 = 2
	SIF GETBIT(CFLAG:ARG:4, 24)
		TALENT:ARG:조루 = 1
	SIF GETBIT(CFLAG:ARG:4, 25)
		TALENT:ARG:조루 = 2
	SIF GETBIT(CFLAG:ARG:4, 26)
		TALENT:ARG:동정 = 1

	IF TALENT:ARG:빈유
		CALL CALC, "빈유化", ARG
	ELSEIF TALENT:ARG:거유 == 1
		CALL CALC, "거유化", ARG
	ELSEIF TALENT:ARG:거유 >= 2
		CALL CALC, "폭유化", ARG
	ELSEIF TALENT:ARG:남자
		CALL CALC, "男乳化", ARG
	ELSE
		CALL CALC, "평유化", ARG
	ENDIF
	CFLAG:ARG:4 = 0
ELSE
	;CFLAG:ARG:4に性別반전前の情報を記録
	SELECTCASE TALENT:ARG:처녀
	CASE 1
		SETBIT CFLAG:ARG:4, 0
	CASE IS >= 2
		SETBIT CFLAG:ARG:4, 1
	ENDSELECT

	;男にも濡れやすさの変化をつける試み
	;SIF TALENT:ARG:젖기쉬움
	;	SETBIT CFLAG:ARG:4, 2
	;SIF TALENT:ARG:젖기어려움
	;	SETBIT CFLAG:ARG:4, 3

	SELECTCASE TALENT:ARG:Ｖ손상
	CASE 1
		SETBIT CFLAG:ARG:4, 4
	CASE 2
		SETBIT CFLAG:ARG:4, 5
	CASE IS >= 3
		SETBIT CFLAG:ARG:4, 6
	ENDSELECT

	SELECTCASE TALENT:ARG:지루
	CASE 1
		SETBIT CFLAG:ARG:4, 7
	CASE IS >= 2
		SETBIT CFLAG:ARG:4, 8
	ENDSELECT

	SIF TALENT:ARG:음호
		SETBIT CFLAG:ARG:4, 9
	SIF TALENT:ARG:오토코노코
		SETBIT CFLAG:ARG:4, 10
	SIF TALENT:ARG:장신
		SETBIT CFLAG:ARG:4, 11
	SIF TALENT:ARG:작은몸집
		SETBIT CFLAG:ARG:4, 12
	SIF TALENT:ARG:Ｖ둔감
		SETBIT CFLAG:ARG:4, 13
	SIF TALENT:ARG:Ｖ민감
		SETBIT CFLAG:ARG:4, 14
	SIF TALENT:ARG:빈유
		SETBIT CFLAG:ARG:4, 15

	SELECTCASE TALENT:ARG:거유
	CASE 1
		SETBIT CFLAG:ARG:4, 16
	CASE IS >= 2
		SETBIT CFLAG:ARG:4, 17
	ENDSELECT

	SIF TALENT:ARG:여자
		SETBIT CFLAG:ARG:4, 18

	SELECTCASE TALENT:ARG:후타나리
	CASE 1
		SETBIT CFLAG:ARG:4, 19
	CASE IS >= 2
		SETBIT CFLAG:ARG:4, 20
	ENDSELECT

	SIF TALENT:ARG:남자
		SETBIT CFLAG:ARG:4, 21

	SELECTCASE TALENT:ARG:모유체질
	CASE 1
		SETBIT CFLAG:ARG:4, 22
	CASE IS >= 2
		SETBIT CFLAG:ARG:4, 23
	ENDSELECT

	SELECTCASE TALENT:ARG:조루
	CASE 1
		SETBIT CFLAG:ARG:4, 24
	CASE IS >= 2
		SETBIT CFLAG:ARG:4, 25
	ENDSELECT

	SIF TALENT:ARG:동정
		SETBIT CFLAG:ARG:4, 26

	IF TALENT:ARG:남자
		TALENT:ARG:남자 = 0
		TALENT:ARG:여자 = 1
		;이하は, 여성化보너스
		IF ABL:ARG:욕망 >= 3
			TALENT:ARG:Ｖ민감 = RAND:2
			TALENT:ARG:젖기쉬움 = RAND:2
		ENDIF

		;가슴 크기
		IF RAND:4 == 0
			CALL CALC, "빈유化", ARG
			SIF RAND:3 == 0
				CALL CALC, "小柄化", ARG
		ELSEIF RAND:2
			CALL CALC, "거유化", ARG
		ELSE
			CALL CALC, "평유化", ARG
		ENDIF
		;처녀はサービス! w
		IF EXP:ARG:Ｖ경험 == 0
			TALENT:ARG:처녀 = 1
		ELSE
			TALENT:ARG:처녀 = 2
		ENDIF
	ELSE
		TALENT:ARG:여자 = 0
		TALENT:ARG:후타나리 = 0
		TALENT:ARG:남자 = 1
		CALL CALC, "男乳化", ARG
	ENDIF
ENDIF

;性別特有のありえない소질の消去
IF TALENT:ARG:남자
	FOR LOCAL, 0, 300
		SIF CALCF("여자特有の소질", LOCAL)
			TALENT:ARG:LOCAL = 0
	NEXT
ELSEIF TALENT:ARG:여자
	FOR LOCAL, 0, 300
		SIF CALCF("남자特有の소질", LOCAL)
			TALENT:ARG:LOCAL = 0
	NEXT
ENDIF

CALL CALC, "선호체위", ARG
CALL SETFLAG, "성전환플래그", ARG
CALL EXP50_CHECK, ARG

IF CONFIG("페니스상세설정") && ARG == MASTER && PENIS(ARG) && TALENT:ARG:페니스 == 0
	PRINTFORML 성별의 변화에 따라 %CALLNAME:MASTER%의 다리 사이에 변화가 일어나고 있습니다…
	CALL SETCONFIG, "페니스상세설정：주인"
ENDIF

;-------------------------------------------------
;横に長すぎる선택지ARGSをスクロール表示させる関数
;はっきり言って目が痛くなるのでボツ
;-------------------------------------------------
@INPUT_SCROLL, ARGS, ARG
#DIM LCOUNT

SIF ARG == 0
	ARG = NUM("折り返し文字数")

IF STRLENS(ARGS) <= ARG
	PRINTFORML %ARGS%
	INPUT
	RETURN RESULT
ENDIF

REDRAW 0

VARSET LOCALS

FOR LCOUNT, 0, STRLENS(ARGS)
	LOCALS:(LCOUNT%2) = %SUBSTRING(ARGS, LCOUNT*2)%%ARGS%
	LOCALS:(LCOUNT%2) = %SUBSTRING(LOCALS:(LCOUNT%2), 0, ARG)%

	SIF LOCALS == LOCALS:1
		CONTINUE

	PRINTFORM %LOCALS:(LCOUNT%2)%

	TINPUT 110, 9999, 0, ""

	SELECTCASE RESULT
	CASE 9999
		CLEARLINE 2
	CASEELSE
		REDRAW 1
		RETURN RESULT
	ENDSELECT
NEXT
RESTART

