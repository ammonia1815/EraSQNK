;-------------------------------------------------
;各種플래그を설정する関数
;LOCALSは基本的にSPLITのみで使う
;-------------------------------------------------
@SETFLAG, ARGS, ARG, ARG:1, ARG:2
#DIM LCOUNT
#DIM LCOUNT2
#DIM MEMO_LINECOUNT
#DIM DYNAMIC MEMO, 10
#DIMS DYNAMIC MEMOS, 10

MEMO_LINECOUNT = LINECOUNT

SELECTCASE ARGS
;どこの절정かで記録するものを取捨선택。まだ開発中
CASE "절정の記録"
	SIF ARG < 0
		RETURN 0
	SIF ARG == 0 && TARGET
		ARG = TARGET

;主人のセクハラの記録
CASE "성희롱이력"
	SIF ARG < 0
		RETURN 0

	VARSET LOCALS
	;記録を分解する
	SPLIT CSTR:MASTER:성희롱이력, "/", LOCALS
	;今回の物を先頭にする
	CSTR:MASTER:성희롱이력 = %NAMES("성희롱", ARG)%/

	;記録は100回まで。つまり過去の悪行は消える
	FOR LCOUNT, 0, 100
		SIF LOCALS:LCOUNT == ""
			BREAK

		CSTR:MASTER:성희롱이력 = %CSTR:MASTER:성희롱이력%%LOCALS:LCOUNT%/

		SIF STRLENS(CSTR:MASTER:성희롱이력) > 1950
			BREAK
	NEXT

	;현재進行形の성희롱이력も作成。これは성희롱이력と異なり今回선택の物が後ろに付く
	CSTR:MASTER:성희롱중 = %CSTR:MASTER:성희롱중%%NAMES("성희롱", ARG)%/

	;確認用
	;PRINTFORMW CSTR:MASTER:성희롱중 = %CSTR:MASTER:성희롱중%
	;PRINTFORMW CSTR:MASTER:성희롱이력 = %CSTR:MASTER:성희롱이력%

;ARG:1がARG:2のARG（種別）を受け入れた
;"Ｖ受け入れ페니스", 3, TARGET, PLAYER　ならTARGETがPLAYERの大きさ3の페니스を受け入れた場合となる
;関数の書式変更の가능性ある感じだ…
CASE "Ｖ受け入れ페니스", "Ｖ受け入れ바이브", "Ｖ受け入れ피스트", "Ｖ受け入れ플러그"
	;ARG:2はマイナスの値を取り得る
	SIF ARG < 0 || ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	SIF ARG:2 == 0 && PLAYER
		ARG:2 = PLAYER

	;入れた人をMEMOSで記録
	SELECTCASE ARG:2
	CASE -3
		MEMOS = 드래곤
	CASE -4
		MEMOS = 일반인
	CASE -5
		MEMOS = 촉수
	CASE IS < 0
		RETURN 0
	CASEELSE
		IF BASE:(ARG:2):식별번호
			MEMOS = %TOSTR(BASE:(ARG:2):식별번호)%
		ELSE
			MEMOS = 일반인
		ENDIF
	ENDSELECT

	;受け入れたもの：{大きさ}＠入れた人＃{날짜}＊{回数}
	SELECTCASE ARGS
	CASE "Ｖ受け入れ페니스"
		MEMOS = 페니스：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	CASE "Ｖ受け入れ바이브"
		MEMOS = 바이브：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	CASE "Ｖ受け入れ피스트"
		MEMOS = フィスト：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	CASE "Ｖ受け入れ플러그"
		MEMOS = 플러그：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	ENDSELECT

	VARSET LOCALS

	;記録を分解する
	SPLIT CSTR:(ARG:1):V수용이력, "/", LOCALS

	;MEMOS:9に一旦記録する
	MEMOS:9 = 

	;記録は최대80種程度（加算が起きたものは先頭に来る。つまり昔の相手との記録は消える）
	FOR LCOUNT, 0, 80
		SIF LOCALS:LCOUNT == ""
			BREAK

		;今回と同じ상대のものかどうか
		IF MEMOS != "" && MEMOS == SUBSTRING(LOCALS:LCOUNT, 0, STRLENS(MEMOS) )
			;～＊回数 となっているので"回数"部分を抜き出して、１を加算する
			LOCALS:LCOUNT = %MEMOS%%TOSTR(TOINT(EXTSTR(LOCALS:LCOUNT, "＊") ) + 1)%

			;MEMOSは加算して用済みなので初期化
			MEMOS = 

			;記録する文字列を再構築
			MEMOS:9 = %LOCALS:LCOUNT%/%MEMOS:9%
		ELSE
			MEMOS:9 = %MEMOS:9%%LOCALS:LCOUNT%/
		ENDIF
		SIF STRLENS(MEMOS:9) > 1950
			BREAK
	NEXT

	;初めての상대ならMEMOSは文字列が入っている
	SIF MEMOS != ""
		MEMOS:9 = %MEMOS%1/%MEMOS:9%

	CSTR:(ARG:1):V수용이력 = %MEMOS:9%

	;確認用
	;PRINTFORML CSTR:V수용이력 = %CSTR:(ARG:1):V수용이력%

CASE "Ａ受け入れ페니스", "Ａ受け入れ바이브", "Ａ受け入れ피스트", "Ａ受け入れ플러그"
	;ARG:2はマイナスの値を取り得る
	SIF ARG < 0 || ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	SIF ARG:2 == 0 && PLAYER
		ARG:2 = PLAYER

	;入れた人をMEMOSで記録
	SELECTCASE ARG:2
	CASE -3
		MEMOS = 드래곤
	CASE -4
		MEMOS = 일반인
	CASE -5
		MEMOS = 촉수
	CASE IS < 0
		RETURN 0
	CASEELSE
		IF BASE:(ARG:2):식별번호
			MEMOS = %TOSTR(BASE:(ARG:2):식별번호)%
		ELSE
			MEMOS = 일반인
		ENDIF
	ENDSELECT

	;受け入れたもの：{大きさ}＠入れた人＃{날짜}＊{回数}
	SELECTCASE ARGS
	CASE "Ａ受け入れ페니스"
		MEMOS = 페니스：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	CASE "Ａ受け入れ바이브"
		MEMOS = 바이브：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	CASE "Ａ受け入れ피스트"
		MEMOS = フィスト：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	CASE "Ａ受け入れ플러그"
		MEMOS = 플러그：%TOSTR(ARG)%＠%MEMOS%＃%TOSTR(DAY)%＊
	ENDSELECT

	VARSET LOCALS

	;記録を分解する
	SPLIT CSTR:(ARG:1):A수용이력, "/", LOCALS

	;MEMOS:9に一旦記録する
	MEMOS:9 = 

	;記録は최대80種程度（加算が起きたものは先頭に来る。つまり昔の相手との記録は消える）
	FOR LCOUNT, 0, 80
		SIF LOCALS:LCOUNT == ""
			BREAK

		;今回と同じ상대のものかどうか
		IF MEMOS != "" && MEMOS == SUBSTRING(LOCALS:LCOUNT, 0, STRLENS(MEMOS) )
			;～＊回数 となっているので"回数"部分を抜き出して、１を加算する
			LOCALS:LCOUNT = %MEMOS%%TOSTR(TOINT(EXTSTR(LOCALS:LCOUNT, "＊") ) + 1)%

			;MEMOSは加算して用済みなので初期化
			MEMOS = 

			;記録する文字列を再構築
			MEMOS:9 = %LOCALS:LCOUNT%/%MEMOS:9%
		ELSE
			MEMOS:9 = %MEMOS:9%%LOCALS:LCOUNT%/
		ENDIF
		SIF STRLENS(MEMOS:9) > 1950
			BREAK
	NEXT

	;初めての상대ならMEMOSは文字列が入っている
	SIF MEMOS != ""
		MEMOS:9 = %MEMOS%1/%MEMOS:9%

	CSTR:(ARG:1):A수용이력 = %MEMOS:9%

	;確認用
	;PRINTFORML CSTR:A수용이력 = %CSTR:(ARG:1):A수용이력%

;ARG:1がARG:2にARGの量だけ내사정等された
CASE "질내정액경험", "장내정액경험", "정음경험", "유内정액경험", "방광정액경험", "정액정액세례경험"
	;ARG:2はマイナスの値を取り得る
	SIF ARG < 0 || ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	SIF ARG:2 == 0 && PLAYER
		ARG:2 = PLAYER

	IF ARG:1 == ARG:2
		PRINTFORM 접수와 공격이 같은 사람입니다！미안합니다만 에러 보고를 부탁합니다……
		FORCEWAIT
	ENDIF

	;정액の種別. MEMOに정액ごとの경험倍率（드래곤の사정は人の１０倍）, MEMOSに種類を代入する
	MEMO = 1
	SELECTCASE ARG:2
	CASE -3
		MEMOS = 드래곤
		MEMO = 10
	CASE -4
		MEMOS = 일반인
	CASE -5
		MEMOS = 촉수
		MEMO = 5
	CASE IS < 0
		RETURN 0
	CASEELSE
		IF BASE:(ARG:2):식별번호
			MEMOS = %TOSTR(BASE:(ARG:2):식별번호)%
		ELSE
			MEMOS = 일반인
		ENDIF
	ENDSELECT


	;정액の量をMEMO:1に代入する(ここではARG <= 7まで)
	MEMO:1 = 3
	FOR LCOUNT, 1, 7
		SIF ARG == LCOUNT
			BREAK
		MEMO:1 = (MEMO:1 * 3 / 2) + 1
	NEXT
	;@SIMULATE_TRAIN_COMなどによりARGに著しく大きい数が入ってくる場合の処理
	SIF ARG >= 8
		MEMO:1 = MULTIPLY(MEMO:1, 100 + (ARG - 7)*10)


	MEMO:1 *= MEMO
	MEMO:1 = MULTIPLY(MEMO:1, 100 + RAND:51)

	;조교中なら主人に注いだ정액량or
	IF COND("조교中", ARG)
		SIF ARG:1 == TARGET || ARG:1 == ASSI
			EX:(ARG:1):절대착정량 += MEMO:1
		SIF ARG:1 == MASTER && (ARG:2 == TARGET || ARG:2 == ASSI)
			EX:(ARG:2):주인에대한절대사정량 += MEMO:1
	ENDIF

	;PRINTFORML MEMOS = %MEMOS%, ARG = {ARG}, MEMO = {MEMO}, MEMO:1 = {MEMO:1}

	VARSET LOCALS

	SELECTCASE ARGS
	CASE "질내정액경험"
		EXP:(ARG:1):질내정액경험 += ARG * MEMO
		SIF TALENT:(ARG:1):임신
			BASE:(ARG:1):태아의영양 += ARG * MEMO

		;임신用判定
		CALL CHECK_PREGNANT, ARG:1, ARG * MEMO, MEMOS

		IF COND("조교中")
			CALL ADD_STAIN, ARG:1, "Ｖ", "정액"
			EX:(ARG:1):Ｖ내사정 += 1
			NOWEX:(ARG:1):Ｖ내사정 += 1
			;액체추가のソース
			SIF ARG:1 != MASTER
				SOURCE:(ARG:1):액체추가 += ARG * 100 * MEMO
		ENDIF

		;記録を分解する
		SPLIT CSTR:(ARG:1):11, "/", LOCALS
	CASE "장내정액경험"
		EXP:(ARG:1):장내정액경험 += ARG * MEMO

		IF COND("조교中")
			CALL ADD_STAIN, ARG:1, "Ａ", "정액"
			EX:(ARG:1):Ａ내사정 += 1
			NOWEX:(ARG:1):Ａ내사정 += 1
			;액체추가のソース
			SIF ARG:1 != MASTER
				SOURCE:(ARG:1):Ａ액체추가 += ARG * 200 * MEMO
		ENDIF

		;記録を分解する
		SPLIT CSTR:(ARG:1):12, "/", LOCALS
	CASE "정음경험"
		EXP:(ARG:1):정음경험 += ARG * MEMO

		IF COND("조교中")
			CALL ADD_STAIN, ARG:1, "Ｍ", "정액"
			EX:(ARG:1):구내사정 += 1
			NOWEX:(ARG:1):구내사정 += 1
		ENDIF
		;記録を分解する
		SPLIT CSTR:(ARG:1):13, "/", LOCALS
	CASE "유内정액경험"
		EXP:(ARG:1):유내정액경험 += ARG * MEMO

		IF COND("조교中")
			CALL ADD_STAIN, ARG:1, "Ｂ", "정액"
			EX:(ARG:1):유내사정 += 1
			NOWEX:(ARG:1):유내사정 += 1
		ENDIF
		;記録を分解する
		SPLIT CSTR:(ARG:1):14, "/", LOCALS
	CASE "방광정액경험"
		EXP:(ARG:1):방광정액경험 += ARG * MEMO

		IF COND("조교中")
			EX:(ARG:1):요도내사정 += 1
			NOWEX:(ARG:1):요도내사정 += 1
			BASE:(ARG:1):요의 += ARG * 500 * MEMO
		ENDIF
		;記録を分解する
		SPLIT CSTR:(ARG:1):15, "/", LOCALS
	;まだ無し
	CASE "정액정액세례경험"
		RETURN 1
	ENDSELECT

	MEMOS = %MEMOS%：

	;MEMOS:9に一旦記録する
	MEMOS:9 = 

	;記録は３０人まで（加算が起きたものは先頭に来る. つまり30人越しになった상대との記録は消える）
	FOR LCOUNT, 0, 30
		SIF LOCALS:LCOUNT == ""
			BREAK
		;今回と同じ상대のものかどうか
		IF MEMOS != "" && MEMOS == SUBSTRING(LOCALS:LCOUNT, 0, STRLENS(MEMOS) )
			;상대：量 となっているので"量"部分を抜き出して, 今回の数値を加算する
			LOCALS:LCOUNT = %MEMOS%%TOSTR(TOINT(EXTSTR(LOCALS:LCOUNT, "：") ) + MEMO:1)%

			;MEMOSは加算して用済みなので初期化
			MEMOS = 

			;記録する文字列を再構築
			MEMOS:9 = %LOCALS:LCOUNT%/%MEMOS:9%
		ELSE
			MEMOS:9 = %MEMOS:9%%LOCALS:LCOUNT%/
		ENDIF
	NEXT

	;初めての상대ならMEMOSは文字列が入っている
	SIF MEMOS != ""
		MEMOS:9 = %MEMOS%%TOSTR(MEMO:1)%/%MEMOS:9%

	SELECTCASE ARGS
	CASE "질내정액경험"
		CSTR:(ARG:1):11 = %MEMOS:9%
	CASE "장내정액경험"
		CSTR:(ARG:1):12 = %MEMOS:9%
	CASE "정음경험"
		CSTR:(ARG:1):13 = %MEMOS:9%
	CASE "유内정액경험"
		CSTR:(ARG:1):14 = %MEMOS:9%
	CASE "방광정액경험"
		CSTR:(ARG:1):15 = %MEMOS:9%
	ENDSELECT

	;確認用
	;PRINTFORML CSTR:11 = %CSTR:(ARG:1):11%
	;PRINTFORML CSTR:12 = %CSTR:(ARG:1):12%
	;PRINTFORML CSTR:13 = %CSTR:(ARG:1):13%
	;PRINTFORML CSTR:14 = %CSTR:(ARG:1):14%
	;PRINTFORMW CSTR:15 = %CSTR:(ARG:1):15%


CASE "선호체위"
	SIF ARG < 0 || ARG:1 < 0
		RETURN 0

	;CSTR:2を使用する

	VARSET LOCALS
	;それぞれの요정素に分解。記録しておける요정素数の최대치は90個(CSTRは全角で約1000文字ぐらいまで)
	SPLIT CSTR:2, "/", LOCALS
	;一旦CSTR:2を初期化
	CSTR:2 = 

	;感度が上がるとコロコロ変わるだけになりがちなので、変化する최대치は３とする
	ARG:1 = LIMIT(RAND:(ARG:1)/2, 1, 3)

	;記録された요정素を, 今回増える分だけ先に消去しておく
	FOR LCOUNT, 0, 90 - ARG:1
		CSTR:2 = %CSTR:2%%LOCALS:LCOUNT%/
	NEXT

	SELECTCASE ARG
	CASE 65, 75
		IF TEQUIP:넘어뜨리기
			FOR LCOUNT, 0, ARG:1
				CSTR:2 = 넘어뜨리기%TRAINNAME:ARG%/%CSTR:2%
			NEXT
		ELSE
			FOR LCOUNT, 0, ARG:1
				CSTR:2 = %TRAINNAME:ARG%/%CSTR:2%
			NEXT
		ENDIF
	CASE 83
		IF TEQUIP:넘어뜨리기
			FOR LCOUNT, 0, ARG:1
				CSTR:2 = 넘어뜨리기기승위/%CSTR:2%
			NEXT
		ELSE
			FOR LCOUNT, 0, ARG:1
				CSTR:2 = %TRAINNAME:ARG%/%CSTR:2%
			NEXT
		ENDIF
	CASEELSE
		FOR LCOUNT, 0, ARG:1
			CSTR:2 = %TRAINNAME:ARG%/%CSTR:2%
		NEXT
	ENDSELECT

CASE "페니스観察"
	SIF ARG < 0 || ARG:1 < 0
		RETURN 0
	;ARGに페니스があるか
	SIF PENIS(ARG) == 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET

	;初경험
	IF CSTR:(ARG:1):1 == ""
		CSTR:(ARG:1):1 = %CSTR:(ARG:1):1%%TOSTR(BASE:ARG:식별번호)%/
		RETURN 1
	ENDIF

	VARSET LOCALS
	;すでにARGの페니스を観察済みかを調べる
	SPLIT CSTR:(ARG:1):1, "/", LOCALS

	;一旦CSTR:1を初期化
	CSTR:(ARG:1):1 = 

	;観察済みなら１にする
	LOCAL = 0

	FOR LCOUNT, 0, 100
		SIF LOCALS:LCOUNT == ""
			BREAK

		;観察済みだった
		SIF TOINT(LOCALS:LCOUNT) == BASE:ARG:식별번호
			LOCAL = 1
		;観察済みの페니스の持ち主が관내に居る？
		SIF TO_NUMBER(TOINT(LOCALS:LCOUNT) ) > 0
			CSTR:(ARG:1):1 = %CSTR:(ARG:1):1%%LOCALS:LCOUNT%/
	NEXT

	SIF LOCAL == 0
		CSTR:(ARG:1):1 = %CSTR:(ARG:1):1%%TOSTR(BASE:ARG:식별번호)%/
CASE "포경の皮を剥く"
	;ARGに仮性包茎の페니스があるか
	SIF COND("가성포경", ARG) == 0
		RETURN 0
	SETBIT TALENT:ARG:페니스, 20
CASE "포경の皮を戻す"
	CLEARBIT TALENT:ARG:페니스, 20
CASE "레벨리미터"
	ABL:MASTER:ＬＶ = LIMIT(FLAG:255, 1, NUM("최대레벨", 90) )

	SIF CONFIG("레벨리미터") == 0
		RETURN 0

	IF CONFIG("레벨리미터") <= FLAG:255
		ABL:MASTER:ＬＶ = CONFIG("레벨리미터")
	ELSEIF TARGET <= 0
		RETURN 0
	ELSEIF CONFIG("레벨리미터：－10ＬＶ")
		ABL:MASTER:ＬＶ = LIMIT(ABL:ＬＶ - 10, 1, ABL:MASTER:ＬＶ)
	ELSEIF CONFIG("레벨리미터：－５ＬＶ")
		ABL:MASTER:ＬＶ = LIMIT(ABL:ＬＶ - 5, 1, ABL:MASTER:ＬＶ)
	ELSEIF CONFIG("레벨리미터：상대に合わせる")
		ABL:MASTER:ＬＶ = LIMIT(ABL:ＬＶ, 1, ABL:MASTER:ＬＶ)
	ELSEIF CONFIG("레벨리미터：＋５ＬＶ")
		ABL:MASTER:ＬＶ = LIMIT(ABL:ＬＶ + 5, 1, ABL:MASTER:ＬＶ)
	ELSEIF CONFIG("레벨리미터：＋10ＬＶ")
		ABL:MASTER:ＬＶ = LIMIT(ABL:ＬＶ + 10, 1, ABL:MASTER:ＬＶ)
	ENDIF
CASE "식별번호"
	SIF BASE:ARG:식별번호
		RETURN 0
	FOR LCOUNT, 0, 100
		LOCAL = GETTIME()
		;同じ番号が出ないようにウェイトをつける
		SIF FINDCHARA(BASE:식별번호, LOCAL) < 0
			BREAK
		TWAIT 1, 1
	NEXT
	BASE:ARG:식별번호 = LOCAL
CASE "안전위험일判定"
	SIF CONFIG("임신패치") == 0
		RETURN 0
	;主にBASE:바이오리듬で管理する
	;0～5bit	周期일数などで使用
	;10bit		안전일
	;11bit		위험일
	;12bit		排卵中（超危険状態）
	;13bit		배란유발제사용中
	;14bit		임신確実(백발백중持ちに내사정された)
	;20bit		발정중

	VARSET LOCAL
	VARSET LOCALS
	FOR LCOUNT, 1, CHARANUM
		;슬라임や남자に生理周期はない
		IF TALENT:LCOUNT:슬라임 || TALENT:LCOUNT:남자 || TALENT:LCOUNT:마도인형
			BASE:LCOUNT:바이오리듬 = 0
			CONTINUE
		ENDIF

		;임신などの理由で바이오리듬を一旦リセットされていた人の処理
		IF BASE:LCOUNT:바이오리듬 == 0
			BASE:LCOUNT:바이오리듬 = (ABS(BASE:LCOUNT:생일%10 - DAY%10 + 10) % 10) + 1
		;他の人は바이오리듬を１進める(たまに周期がずれる)
		ELSEIF TIME == 0
			SELECTCASE GETBITS(BASE:LCOUNT:바이오리듬, 0, 5)
			CASE 1 TO 3
				BASE:LCOUNT:바이오리듬 += 1
			CASE 4 TO 9
				SIF RAND:10
					BASE:LCOUNT:바이오리듬 += 1
			CASE 10
				SIF RAND:10
					BASE:LCOUNT:바이오리듬 -= 9
			ENDSELECT
		ENDIF

		;발정중以外の플래그はここでリセット
		BASE:LCOUNT:바이오리듬 = CLEARBITS(BASE:LCOUNT:바이오리듬, 10, 19)

		;임신できない人は바이오리듬を動かすだけ
		;IF COND("임신가능", LCOUNT) == 0
		;	BASE:LCOUNT:바이오리듬 = CLEARBITS(BASE:LCOUNT:바이오리듬, 10, 60)
		;	CONTINUE
		;ENDIF

		SELECTCASE GETBITS(BASE:LCOUNT:바이오리듬, 0, 5)
		;위험일開始
		CASE 1
			SETBIT BASE:LCOUNT:바이오리듬, 11
			;동물귀の人は발정기かも？
			;쟈브쟈브も発情するぞ! (いつも発情してるという事なので, 위험일だと발정기)
			;쟈브쟈브の아이だって発情するぞ! 
			IF TALENT:LCOUNT:발정체질
				SETBIT BASE:LCOUNT:바이오리듬, 20
				LOCALS = %LOCALS% [{LCOUNT}]%조사처리(CALLNAME:LCOUNT,"과")%
			ELSEIF TALENT:LCOUNT:동물귀
				SELECTCASE ABS(BASE:LCOUNT:생일%40 - DAY%40 + 40) % 40
				CASE 20 TO 29
					SETBIT BASE:LCOUNT:바이오리듬, 20
					LOCALS = %LOCALS% [{LCOUNT}]%조사처리(CALLNAME:LCOUNT,"과")%
				ENDSELECT
			ENDIF
		;위험일中일
		CASE 2
			SETBIT BASE:LCOUNT:바이오리듬, 11
		;排卵일, またの名を超위험일. 卵子の寿命は1일なので위험일はこれにて終了
		CASE 3
			SETBIT BASE:LCOUNT:바이오리듬, 11
			SETBIT BASE:LCOUNT:바이오리듬, 12
		;안전일
		CASE 4 TO 7
			SETBIT BASE:LCOUNT:바이오리듬, 10
		ENDSELECT

		;발정중플래그ＯＮなのに위험일でないなら발정기終了
		IF COND("발정기", LCOUNT) && GETBIT(BASE:LCOUNT:바이오리듬, 11) == 0
			CLEARBIT BASE:LCOUNT:바이오리듬, 20
			LOCALS:1 = %LOCALS:1% [{LCOUNT}]%조사처리(CALLNAME:LCOUNT,"과")%
		ENDIF
		;避妊している場合には発情状態とか以外は無視
		SIF COND("피임中", LCOUNT)
			BASE:LCOUNT:바이오리듬 = CLEARBITS(BASE:LCOUNT:바이오리듬, 10, 19)
	NEXT
	IF COND("낮")
		IF STRLENS(LOCALS)
			SETCOLOR DEF_COLOR("하트핑크")
			PRINTFORMW %SUBSTRING(LOCALS, 0, STRLENS(LOCALS) - 2)%하지만발정기에 들어갔다！
			RESETCOLOR
		ENDIF
		SIF STRLENS(LOCALS:1)
			PRINTFORMW %SUBSTRING(LOCALS:1, 0, STRLENS(LOCALS:1) - 2)%의발정기하지만 끝났습니다
	ENDIF
CASE "避妊"
	BASE:ARG:태아 = 0
	BASE:ARG:태내정액량 += BASE:ARG:자궁정자량
	BASE:ARG:자궁정자량 = 0
	BASE:ARG:정액의우세 = 0

;ARGがARG:1のおしっこを飲む
CASE "飲尿"
	IF ARG:1 == 0
		SELECTCASE ARG
		CASE TARGET
			ARG:1 = PLAYER
		CASEELSE
			ARG:1 = TARGET
		ENDSELECT
	ENDIF

	IF PENIS(ARG:1)
		STAIN:(ARG:1):Ｐ = SET_STAIN(STAIN:(ARG:1):Ｐ, "尿")
	ELSE
		STAIN:(ARG:1):Ｖ = SET_STAIN(STAIN:(ARG:1):Ｖ, "尿")
	ENDIF
	STAIN:ARG:Ｍ = SET_STAIN(STAIN:ARG:Ｍ, "尿")

	TEQUIP:(ARG:1):이뇨제 = 0
	BASE:(ARG:1):요의 = 0
	NOWEX:(ARG:1):방뇨 += 1
	SIF SELECTCOM != 144
		EX:(ARG:1):방뇨 += 1
	EXP:(ARG:1):성수경험 += 1
	EXP:ARG:음뇨경험 += 1

	;飲尿フラグ
	SETBIT TCVAR:ARG:10, 25

;청소３種はARGがARG:1を청소する
CASE "청소펠라"
	IF ARG:1 == 0
		SELECTCASE ARG
		CASE TARGET
			ARG:1 = PLAYER
		CASEELSE
			ARG:1 = TARGET
		ENDSELECT
	ENDIF

	;청소펠라フラグ
	SETBIT TCVAR:ARG:10, 4

	;Ａ청소펠라フラグ
	SIF CHECK_STAIN(STAIN:(ARG:1):Ｐ, "Ａ") && EXP_GAIN(16, ARG:1)
		SETBIT TCVAR:ARG:10, 5

	;尿청소펠라フラグ
	SIF CHECK_STAIN(STAIN:(ARG:1):Ｐ, "尿") && PREVEX("방뇨", ARG:1)
		SETBIT TCVAR:ARG:10, 44

	;펠라경험は他で得ているだろうがボーナスで更に１追加
	EXP:ARG:펠라경험 += 1
	EXP:ARG:청소펠라경험 += 1
	SIF CHECK_STAIN(STAIN:(ARG:1):Ｐ, "정액")
		EXP:ARG:정액경험 += 1

	;ARGの입⇔ARG:1のＰの汚れが移動
	CALL EQ_STAIN, ARG, ARG:1, 0, 2

	;PRINTFORML CHECK_STAIN(STAIN:(ARG:1):Ｐ, "Ｐ치구") = {CHECK_STAIN(STAIN:(ARG:1):Ｐ, "Ｐ치구")}
	;その後ARG:1のＰの汚れリセット…Ｐ치구があると挙動が複雑
	IF CHECK_STAIN(STAIN:(ARG:1):Ｐ, "Ｐ치구")
		IF (ARG == PLAYER && CHECK_COM("치구청소펠라", 4) ) || (ARG == TARGET && CHECK_COM("치구청소펠라", 91) )
			EXP:ARG:청소펠라경험 += 1
			SETBIT TCVAR:ARG:10, 46
			CALL RESET_STAIN_EX, "Ｐ", ARG:1
		ELSE
			CALL RESET_STAIN_EX, "Ｐ", ARG:1
			STAIN:(ARG:1):Ｐ = SET_STAIN(STAIN:(ARG:1):Ｐ, "Ｐ치구")
		ENDIF
	ELSE
		CALL RESET_STAIN_EX, "Ｐ", ARG:1
	ENDIF

	;PRINTFORML CHECK_STAIN(STAIN:(ARG:1):Ｐ, "Ｐ치구") = {CHECK_STAIN(STAIN:(ARG:1):Ｐ, "Ｐ치구")}

	PALAM:(ARG:1):Ｐ윤 += 500

CASE "청소컨닐링구스"
	IF ARG:1 == 0
		SELECTCASE ARG
		CASE TARGET
			ARG:1 = PLAYER
		CASEELSE
			ARG:1 = TARGET
		ENDSELECT
	ENDIF

	;청소컨닐링구스フラグ
	SETBIT TCVAR:ARG:10, 7

	;尿청소컨닐링구스フラグ
	SIF CHECK_STAIN(STAIN:(ARG:1):Ｖ, "尿") && PREVEX("방뇨", ARG:1)
		SETBIT TCVAR:ARG:10, 45

	;커닐링구스경험は他で得ているだろうがボーナスで更に１追加
	EXP:ARG:커닐링구스경험 += 1
	EXP:ARG:청소쿤니경험 += 1
	SIF CHECK_STAIN(STAIN:(ARG:1):Ｖ, "정액")
		EXP:ARG:정액경험 += 1

	;ARGの입⇔ARG:1のＶの汚れが移動
	CALL EQ_STAIN, ARG, ARG:1, 0, 3

	;PRINTFORML CHECK_STAIN(STAIN:(ARG:1):Ｖ, "Ｖ치구") = {CHECK_STAIN(STAIN:(ARG:1):Ｖ, "Ｖ치구")}
	;その後ARG:1のＶの汚れリセット…Ｖ치구があると挙動が複雑
	IF CHECK_STAIN(STAIN:(ARG:1):Ｖ, "Ｖ치구")
		IF (ARG == PLAYER && CHECK_COM("치구청소컨닐링구스", 1) ) || (ARG == TARGET && CHECK_COM("치구청소컨닐링구스", 98) )
			EXP:ARG:청소쿤니경험 += 1
			SETBIT TCVAR:ARG:10, 47
			CALL RESET_STAIN_EX, "Ｖ", ARG:1
		ELSE
			CALL RESET_STAIN_EX, "Ｖ", ARG:1
			STAIN:(ARG:1):Ｖ = SET_STAIN(STAIN:(ARG:1):Ｖ, "Ｖ치구")
		ENDIF
	ELSE
		CALL RESET_STAIN_EX, "Ｖ", ARG:1
	ENDIF

	;PRINTFORML CHECK_STAIN(STAIN:(ARG:1):Ｖ, "Ｖ치구") = {CHECK_STAIN(STAIN:(ARG:1):Ｖ, "Ｖ치구")}

CASE "청소Ａ핥기"
	IF ARG:1 == 0
		SELECTCASE ARG
		CASE TARGET
			ARG:1 = PLAYER
		CASEELSE
			ARG:1 = TARGET
		ENDSELECT
	ENDIF

	;청소Ａ舐めフラグ
	SETBIT TCVAR:ARG:10, 43

	;A핥기경험は他で得ているだろうがボーナスで更に１追加
	EXP:ARG:A핥기경험 += 1
	EXP:ARG:청소A핥기경험 += 1
	SIF CHECK_STAIN(STAIN:(ARG:1):Ａ, "정액")
		EXP:ARG:정액경험 += 1

	;ARGの입⇔ARG:1のＡの汚れが移動
	CALL EQ_STAIN, ARG, ARG:1, 0, 4
	;その後ARG:1のＡの汚れリセット
	CALL RESET_STAIN_EX, "Ａ", ARG:1

CASE "모유마시기"
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	STAIN:(ARG:1):Ｂ = SET_STAIN(STAIN:(ARG:1):Ｂ, "모유")
	STAIN:ARG:Ｍ = SET_STAIN(STAIN:ARG:Ｍ, "모유")
	CALL EQ_STAIN, ARG, ARG:1, 0, 5
	IF CALCF("Ｂ발정", ARG:1)
		BASE:(ARG:1):분유 = MAX(BASE:(ARG:1):분유 - 5000, 0)
	ELSE
		BASE:(ARG:1):분유 = MAX(BASE:(ARG:1):분유 - 2000, 0)
	ENDIF
	EXP:(ARG:1):수유경험 += 1
	EXP:ARG:음유경험 += 1
	;아이は경험치獲得
	IF COND("성장가능", ARG)
		EXP:ARG:경험치 += 2
		SIF CALCF("Ｂ발정", ARG:1)
			EXP:ARG:경험치 += 3
	ENDIF
	CALL SETFLAG, "모유마시기플래그", ARG
	;정력も회복
	IF MAXBASE:ARG:정력 > BASE:ARG:정력
		LOCAL = 1 + TALENT:(ARG:1):흡정체질 + TALENT:(ARG:1):상위몽마
		SIF CALCF("Ｂ발정", ARG:1)
			LOCAL += 2

		BASE:ARG:정력 = MIN(BASE:ARG:정력 + LOCAL, MAXBASE:ARG:정력)
		PRINTFORML 정력+{LOCAL} (%CALLNAME:ARG%)
	ENDIF
CASE "同衾이벤트"
	SETBIT CFLAG:95, 3
	SETBIT CFLAG:MASTER:95, 3
CASE "Ｗ넘어뜨리기"
	;조교자が主人でない場合には禁止とする
	SIF TEQUIP:Ｗ넘어뜨리기 || TARGET:1 <= 0 || PLAYER != MASTER
		RETURN 0

	TEQUIP:넘어뜨리기 = 1
	TEQUIP:(TARGET:1):넘어뜨리기 = 1
	;Ｗ押し倒され状態（アクティブな方が1）
	TEQUIP:Ｗ넘어뜨리기 = 1
	TEQUIP:(TARGET:1):Ｗ넘어뜨리기 = 2
	;TARGET:1の前回커맨드に相当
	PREVCOM:1 = -1
	;조수が参加したら撮影は止めちゃう
	SIF TARGET:1 == ASSI
		TEQUIP:비디오카메라 = 0
CASE "Ｗ넘어뜨리기解除"
	SIF TARGET:1 <= 0
		RETURN 0
	CVARSET TEQUIP, 30, 0
	CVARSET TEQUIP, 32, 0
	SIF INSERT("인서트상대", TARGET:1) == PLAYER
		CALL RESET_INSERT, TARGET:1, PLAYER
	;비젼使用時(ASSIについては비젼使用中はTARGET != ASSI かつ TARGET:1 != ASSI)
	IF CEVENT("消滅予定")
		SWAP SELECTCOM, SELECTCOM:1
		SWAP PREVCOM:1, PREVCOM:1
		SWAP TARGET, TARGET:1
		DELCHARA TARGET:1
		TARGET:1 = ASSI
	ELSEIF CEVENT("消滅予定", TARGET:1)
		DELCHARA TARGET:1
		TARGET:1 = ASSI
	ENDIF
	SELECTCOM:1 = -1
	PREVCOM:1 = -1
CASE "사정＆절정체크"
	LOCAL = PLAYER
	PLAYER = ARG
	;손대중されてる？
	TEQUIP:ARG:손대중 = MAX(TEQUIP:ARG:손대중 - 1, 0)

	SIF TFLAG:90 >= 1 && TFLAG:90 <= 9
		TCVAR:ARG:2 = 1

	;사정を堪えられる快感を算出
	BASE:ARG:성감허용치남자 += TCVAR:ARG:101

	;손대중状態
	IF TEQUIP:ARG:손대중 > 0
		TCVAR:ARG:1 = 0
	ELSEIF COND("사정금지中", ARG)
		TCVAR:ARG:1 = 0
	ELSE
		TCVAR:ARG:1 = CALCF("절정", ARG)
	ENDIF

	SIF COND("절정", ARG) == 0
		TCVAR:ARG:3 = 0

	;TARGETとTARGET:1(これはＷ넘어뜨리기の時)の절정フラグ
	IF COND("절정", ARG)
		TCVAR:ARG:5 = CALCF("절정の原因", TARGET, SELECTCOM)
		;二人で넘어뜨리기た時の조수に対する사정플래그
		TCVAR:ARG:6 = CALCF("절정の原因", TARGET:1, SELECTCOM:1)
	ENDIF
	PLAYER = LOCAL
CASE "사정＆절정이벤트플래그"
	LOCALS = 
	IF SHOOT("정액세례")
		LOCALS = 절정：정액세례
	ELSEIF SHOOT("보온병")
		LOCALS = 절정：보온병
	ELSEIF SHOOT("다리")
		LOCALS = 절정：다리
	ELSEIF SHOOT("스마타")
		LOCALS = 절정：스마타
	ELSEIF SHOOT("입")
		LOCALS = 절정：입
	ELSEIF SHOOT("가슴")
		LOCALS = 절정：가슴
	ELSEIF SHOOT("손")
		LOCALS = 절정：손
	ELSEIF SHOOT("Ｖ내사정")
		LOCALS = 절정：Ｖ내사정
	ELSEIF SHOOT("Ａ내사정")
		LOCALS = 절정：Ａ내사정
	ELSEIF SHOOT("키스")
		LOCALS = 절정：키스
	ELSEIF SHOOT("안면기승")
		LOCALS = 절정：안면기승
	ELSEIF SHOOT("파후파후")
		LOCALS = 절정：파후파후
	ELSEIF SHOOT("역컨닐링구스")
		LOCALS = 절정：역컨닐링구스
	ELSEIF SHOOT("역레이프")
		LOCALS = 절정：역레이프
	ELSEIF SHOOT("역애널")
		LOCALS = 절정：역애널
	ELSEIF SHOOT("애널봉사")
		LOCALS = 절정：애널봉사
	ELSEIF SHOOT("조수")
		LOCALS = 절정：조수
	ELSEIF SHOOT("조교자가여자")
		LOCALS = 절정：조교자가여자
	ENDIF

	SIF LOCALS != ""
		CALL SET_EV, TARGET, LOCALS
CASE "봉사嗜虐判定"
	;TCVAR:29の値によって봉사or嗜虐快楽を決める
	;0bit弱봉사, 1bit봉사, 2bit弱嗜虐, 3bit嗜虐
	SELECTCASE ARG
	CASE 6, 177
		SETBIT TCVAR:29, 0
	CASE 1, 4, 9, 11, 144, 145
		SIF TEQUIP:넘어뜨리기
			SETBIT TCVAR:29, 3
	CASE 95, 121, 126
		IF TEQUIP:넘어뜨리기
			SETBIT TCVAR:29, 3
		ELSE
			SETBIT TCVAR:29, 0
			SETBIT TCVAR:29, 2
		ENDIF
	CASE 65, 75, 80, 90 TO 107, 120, 125, 150
		IF TEQUIP:넘어뜨리기
			SETBIT TCVAR:29, 2
		ELSE
			SETBIT TCVAR:29, 1
		ENDIF
	CASE 15, 176, 178, 280
		SETBIT TCVAR:29, 2
	CASE 122, 127, 140
		SETBIT TCVAR:29, 0
	CASE 138
		SIF CHECK_COM("입内방뇨") && CHECK("입内방뇨")
			SETBIT TCVAR:29, 1
	ENDSELECT
CASE "배설"
	IF COND("액체관장") + COND("정액관장")
		IF COND("애널栓")
			PRINTFORM 항문 마개를 뽑힌 %조사처리(CALLNAME:TARGET,"는")%
			SELECTCASE BASE:배설물
			CASE 0
				PRINTFORML , 주입된 액체를 %TEXTR("장내의", "지독한")% 냄새와 함께 항문에서 흩뿌렸다. 
			CASE IS <= 2
				PRINTFORML , \@ COND("온천관장") ? 대량의 소변 # 관장액 \@으로 부드러워진 장내의 오물을 항문에서 흩뿌렸다. 
			CASE IS <= 6
				PRINTFORML , 장내에 쌓인\@ CHECK_STAIN(STAIN:Ａ, "정액") ?  정액섞인 # \@ 대량의 오물을 엄청난 기세로 항문에서 흩뿌렸다. 
			CASEELSE
				PRINTFORML 관장의 자극으로\@ CHECK_STAIN(STAIN:Ａ, "정액") ?  정액섞인 # \@ 부드러운 대변을 대량으로 배설하고, 그뒤에 변비기운으로 단단해진 오물을 방귀와 함게 항문에서 작은 산을 만들정도로 뽑아내었다. 
			ENDSELECT
		ENDIF
		SELECTCASE MIN(ABL:마조끼, (ABL:노출벽 + 1)/2)
		CASE 0
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 고통과 치욕이 섞인 표정을 짓고있다…
		CASE 1
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% \@ PLAYER == MASTER && TALENT:연모 ? 사랑하는 사람 # 사람 \@ 앞에서하는 배설행위에 치욕을 느끼면서도, 작은 달성감을 느끼고있는 것같다…
		CASE 2
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 부끄러워하면서도, 해방감에 안도한 표정을 짓고있다…
		CASE 3
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")%, 항문을 통해 지나가는 배설물의 감각에 때때로 음란한 신음을 내고있다…
		CASE 4
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")%, 황홀해하면서 \@ PLAYER == MASTER && TALENT:연모 ? 사랑하는 사람 # 사람 \@ 앞에서하는 배설에 의한 치욕과 해방감을 동시에 즐기고있다…
		CASE IS >= 5
			PRINTFORML %조사처리(CALLNAME:TARGET,"는")%, 배설감과 수치심을 뼛속깊이 맛보고있다. 
			IF TALENT:남자 || INSERT("Ｖ인서트") || RAND:2
				PRINTFORMW 그 표정은 쾌감에 느슨하게 풀려, 항문에서 오물을 배출하는 해방감이 흘러넘치고있다…
			ELSE
				PRINTFORMW 그 표정은 쾌감에 느슨하게 풀려, 항문에서 오물을 배출하는 것과 동시에, 질구에서도 애액을 뚝뚝 흘리고 있다…
			ENDIF
		ENDSELECT
		;배설플래그
		IF COND("정액관장")
			NOWEX:배설 = 1
		ELSE
			NOWEX:배설 = COND("액체관장")
		ENDIF
		EX:배설 += NOWEX:배설
	ELSE
		PRINTFORMW 마개를 뽑자, %CALLNAME:TARGET%의 애널에서 요란한 방귀 소리가 났다…
	ENDIF
	TEQUIP:애널바이브 = 0
	CLEARBIT TEQUIP:확장벌룬, 1
	TEQUIP:관장 = 0
	PALAM:Ａ윤 /= 2
	BASE:배설욕 = 0
	BASE:배설물 = 0
	;汚れリセット
	STAIN:Ａ = SET_STAIN(0, "Ａ")
CASE "조교자교대"
	;MASTERとASSIを交代する
	;本格的に交代したならポジション解消
	IF ARG
		;前Ｔ조교자はリセット
		TFLAG:50 = 0
		CVARSET TEQUIP, 1, 0
		CVARSET TEQUIP, 69, 0
	ENDIF
	;どちらかが조수ならASSIPLAYのスイッチ반전
	SIF PLAYER == ASSI || PLAYER:1 == ASSI
		INVERTBIT ASSIPLAY, 0
	;조교開始時にPLAYER = MASTER、PLAYER:1 = ASSIとなっており、これは不変
	SWAP PLAYER, PLAYER:1
	SWAP SELECTCOM, SELECTCOM:2
	SWAP PREVCOM, PREVCOM:2
;TARGETとTARGET:1を交換する。TARGET:1が居ないならASSIと交換する
CASE "대상교대"
	;TARGETとTARGET:1(通常は조수)を交代する。交代したならポジション解消
	;前Ｔ대상はリセット
	TFLAG:49 = 0

	;현재TARGET:1が조교자側なら、その役に成り代わるTARGETに役割を譲る
	SELECTCASE TARGET:1
	CASE PLAYER
		PLAYER = TARGET
	CASE PLAYER:1
		PLAYER:1 = TARGET
	ENDSELECT

	;片方が조수ならば、조수の立場も交換
	SELECTCASE ASSI
	CASE TARGET
		ASSI = TARGET:1
	CASE TARGET:1
		ASSI = TARGET
	ENDSELECT

	;Ｗ넘어뜨리기の立場交換
	SIF TEQUIP:Ｗ넘어뜨리기
		SWAP TEQUIP:Ｗ넘어뜨리기, TEQUIP:(TARGET:1):Ｗ넘어뜨리기

	SWAP TARGET, TARGET:1

	IF TEQUIP:Ｗ넘어뜨리기 == 0
		;インサートフラグ解除
		CVARSET TEQUIP, 20, 0
		CVARSET TEQUIP, 21, 0
		CVARSET TEQUIP, 22, 0
	ENDIF
	CVARSET TEQUIP, 69, 0

	;前回実行커맨드を入れ替え
	SWAP SELECTCOM, SELECTCOM:1
	SWAP PREVCOM, PREVCOM:1
	;３Ｐ解消
	SWAP SELECTCOM:2, SELECTCOM:3
	SWAP PREVCOM:2, PREVCOM:3

CASE "요도확장"
	;ARGに삽입されるものの大きさが代入されている
	;요도확장度の요정素によって異なる挙動が起きる
	SIF CSTR:3 == "" || CSTR:4 == "" || ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	;最小の요정素이하の太さなら확장は起きない
	SIF ARG <= MIN_STR(CONDS("요도확장度", ARG:1) )
		RETURN 0

	
	;LOCALは확장する進行度
	IF COND("조교中", ARG:1)
		SELECTCASE ABL:PLAYER:기교
		CASE IS >= 7
			LOCAL = 3
		CASE IS >= 4
			LOCAL = 2
		CASEELSE
			LOCAL = 1
		ENDSELECT

		;TALENT:확장적정や조교지식(性器拡張)があると拡張するのが格段に楽
		;조교지식によるボーナス
		SELECTCASE TALENT_NAME(185, TALENT:PLAYER:조교지식, PLAYER)
		CASE "조교지식(성기확장)"
			LOCAL += 4
		ENDSELECT

		;連続実行
		SIF PREVCOM == SELECTCOM
			LOCAL = LOCAL*3 + 1

	ELSE
		SELECTCASE ABL:(ARG:1):기교
		CASE IS >= 7
			LOCAL = 3
		CASE IS >= 4
			LOCAL = 2
		CASEELSE
			LOCAL = 1
		ENDSELECT

		SELECTCASE TALENT_NAME(185, TALENT:(ARG:1):조교지식, ARG:1)
		CASE "조교지식(성기확장)"
			LOCAL += 4
		ENDSELECT
	ENDIF

	;요도확장の壁にぶつかると확장する速度が急速に鈍化
	SELECTCASE CALCF("요도径", ARG:1)
	CASE IS >= CALCF("요도확장の限界", ARG:1)*6/5
		RETURN 0
	CASE IS >= CALCF("요도확장の限界", ARG:1)
		LOCAL /= 4
	CASE IS >= CALCF("요도확장の壁", ARG:1)
		LOCAL /= 2
	CASEELSE
		SIF TALENT:(ARG:1):확장적정
			LOCAL += 3
	ENDSELECT

	SIF CONFIG("요도を확장하기쉬움")
		LOCAL = 1 + LOCAL*3

	SIF LOCAL <= 0
		RETURN 0

	VARSET LOCALS
	;どっちの요도か
	IF PENIS(ARG:1)
		;それぞれの요정素に分解
		SPLIT CSTR:(ARG:1):4, "/", LOCALS
	ELSE
		;それぞれの요정素に分解
		SPLIT CSTR:(ARG:1):3, "/", LOCALS
	ENDIF

	FOR LCOUNT2, 0, LOCAL
		;LOCALSはLOCALS:0～LOCALS:9まで
		FOR LCOUNT, 0, 10
			;文字列を数字化して比較
			SIF TOINT(LOCALS:LCOUNT) > MIN_STR(CONDS("요도확장度", ARG:1) )
				CONTINUE
			SIF ARG <= TOINT(LOCALS:LCOUNT)
				CONTINUE

			LOCALS:LCOUNT = {ARG}
			BREAK
		NEXT
	NEXT

	EXP:(ARG:1):요도확장경험 += 1

	;どっちの요도か
	IF PENIS(ARG:1)
		CSTR:(ARG:1):4 = 
		FOR LCOUNT, 0, 10
			CSTR:(ARG:1):4 = %CSTR:(ARG:1):4%%LOCALS:LCOUNT%/
		NEXT
	ELSE
		CSTR:(ARG:1):3 = 
		FOR LCOUNT, 0, 10
			CSTR:(ARG:1):3 = %CSTR:(ARG:1):3%%LOCALS:LCOUNT%/
		NEXT
	ENDIF

CASE "Ｖ확장", "Ａ확장"
	;ARGに삽입されるものの大きさ, ARG:1に硬さが代入されている

	VARSET LOCAL
	;조교지식による보너스(손상しづらくなる)
	SELECTCASE TALENT_NAME(185, TALENT:PLAYER:조교지식, PLAYER)
	CASE "조교지식(성기확장)"
		LOCAL -= 1
	ENDSELECT

	;まずは손상を見る
	SELECTCASE ARGS
	CASE "Ｖ확장"
		LOCAL += ARG - ABL:Ｖ확장 - 1
		IF ARG:1 <= 2 || TALENT:슬라임 || SELECTCOM == 106 || CUP:고통 < 3000 || (SELECTCOM == 304 && TEQUIP:넘어뜨리기)
		ELSEIF TALENT:Ｖ손상 < LOCAL
			SIF EXP:Ｖ손상경험 < LOCAL
				EXP:Ｖ손상경험 = LOCAL

			TALENT:Ｖ손상 = LOCAL
			;무드激減
			TFLAG:33 -= 30 * LOCAL
		ENDIF
	CASE "Ａ확장"
		LOCAL += ARG - ABL:Ａ확장 - 1
		IF ARG:1 <= 2 || TALENT:슬라임 || SELECTCOM == 107 || CUP:고통 < 3000 || (SELECTCOM == 305 && TEQUIP:넘어뜨리기)
		ELSEIF TALENT:Ａ손상 < LOCAL
			SIF EXP:Ａ손상경험 < LOCAL
				EXP:Ａ손상경험 = LOCAL

			TALENT:Ａ손상 = LOCAL
			;무드激減
			TFLAG:33 -= 30 * LOCAL
		ENDIF
	ENDSELECT

	;続いて확장경험の獲得
	SIF ARG < 2 - TALENT:요정
		RETURN 0

	SELECTCASE ARGS
	CASE "Ｖ확장"
		LOCAL:1 = ARG - ABL:Ｖ확장
		;EXP:Ｖ확장경험が0-4なら5, 5-19なら20,…と返す
		LOCAL:2 = EXP_LV(GET_EXP_LV(EXP:Ｖ확장경험) + 1)
		LOCAL:3 = 53
	CASE "Ａ확장"
		LOCAL:1 = ARG - ABL:Ａ확장
		LOCAL:2 = EXP_LV(GET_EXP_LV(EXP:Ａ확장경험) + 1)
		LOCAL:3 = 57
	ENDSELECT

	;삽입するものの大きさ-확장ＬＶを見る. 値が大きいほど확장경험増加量が多い
	;なお, (삽입するものの大きさ-확장ＬＶ)が１이하の場合で삽입するものが부드러운 時(硬さが２이하)は확장경험増加は１まで
	SELECTCASE LOCAL:1
	CASE IS <= -2
		IF ARG >= 4
			LOCAL = 1
		ELSE
			RETURN 0
		ENDIF
	CASE -1
		IF ARG >= 3
			LOCAL = 1
		ELSE
			RETURN 0
		ENDIF
	CASE 0
		LOCAL = 1
	CASE 1
		;四捨五入
		LOCAL = (LOCAL:2 + 5)/10
		;삽입するものの硬さ
		SELECTCASE ARG:1
		CASE 1
			LOCAL = 1
		CASE 2
			LOCAL = MIN(LOCAL, 2)
		ENDSELECT
	CASE 2
		LOCAL = (LOCAL:2 + 1)/3
	CASE IS >= 3
		LOCAL = LOCAL:2
	ENDSELECT

	;硬い場合には大きさがかなり関係する
	SIF ARG:1 >= 3
		LOCAL = MAX(LOCAL, ARG)

	LOCAL = LIMIT(LOCAL, 1, 20)

	;大きく上がるのは一度の조교で一度だけ
	;基本的には入れるものの大きさの절대치に依存する
	IF EXP_GAIN(LOCAL:3)
		;大きさごとに, ２度目以降の上昇時に上げられる확장경험の최대치が決まっている
		;(大きさ, 상한) = (1, 1), (2, 5), (3, 20), …, (n, EXP_LV(n - 1) )
		SIF EXP:(LOCAL:3) >= MAX(EXP_LV(ARG - 1), 1) && ARG <= 2 - TALENT:요정
			RETURN 0

		SELECTCASE LOCAL:1
		CASE IS <= -1
			IF ARG >= 3 && ARG:1 >= 3
				LOCAL = 1
			ELSE
				RETURN 0
			ENDIF
		CASE 0, 1
			IF ARG:1 >= 3
				LOCAL = MAX(LOCAL/2, 1)
			ELSE
				LOCAL /= 2
			ENDIF
		CASE IS >= 2
			;삽입するものの硬さ
			SELECTCASE ARG:1
			CASE 1
				LOCAL = 1
			CASE 2
				LOCAL = MIN(LOCAL, 2)
			ENDSELECT
		ENDSELECT

		;(大きさのＬＶ, 상한) = (1, 1), (2, 2), (3, 5), (4, 10), (5, 20), …, (n, 5n)
		SELECTCASE ARG
		CASE 1
			LOCAL = MIN(LOCAL, 1)
		CASE 2
			LOCAL = MIN(LOCAL, 2)
		CASE 3
			LOCAL = MIN(LOCAL, 5)
		CASE 4
			LOCAL = MIN(LOCAL, 10)
		CASEELSE
			LOCAL = MIN(LOCAL, ARG*4)
		ENDSELECT
	ENDIF

	;조교지식による경험獲得の보너스
	SELECTCASE TALENT_NAME(185, TALENT:PLAYER:조교지식, PLAYER)
	CASE "조교지식(성기확장)"
		LOCAL *= 2
	ENDSELECT

	;확장경험増加
	EXP:(LOCAL:3) += LOCAL
CASE "Ｐ윤変動処理"
	SIF ARG == 0 && PLAYER > 0
		ARG = PLAYER
	SIF PENIS(ARG) == 0
		RETURN 0
	;인서트中の増減量獲得は@COMF60内の@FLAG_INSERTIONで行う
	;인서트以外だと3000ぐらいが限度
	IF INSERT("삽입中", ARG) == 0
		SELECTCASE SELECTCOM
		;펠라
		CASE 91, 99, 140, 150
			SIF PALAM:ARG:Ｐ윤 < 3000
				CUP:ARG:Ｐ윤 += (ABL:기교 + ABL:봉사정신 + ABL:혀놀림)*100
		;스마타系
		CASE 93, 94
			SIF PALAM:ARG:Ｐ윤 < 3000
				CUP:ARG:Ｐ윤 += PALAM:Ｖ윤 / 3
		;조수를범한다
		CASE 160
			CUP:ARG:Ｐ윤 += PALAM:ASSI:Ｖ윤 / 4
		;조수펠라
		CASE 162
			SIF PALAM:ARG:Ｐ윤 < 3000
				CUP:ARG:Ｐ윤 += (ABL:ASSI:기교 + ABL:ASSI:봉사정신 + ABL:ASSI:혀놀림)*100
		;オナホ
		CASE 105
			SIF PALAM:ARG:Ｐ윤 < 3000
				CUP:ARG:Ｐ윤 += 1000
		CASEELSE
			IF COND("청소펠라플래그")
				SIF PALAM:ARG:Ｐ윤 < 3000
					CUP:ARG:Ｐ윤 += (ABL:기교 + ABL:봉사정신 + ABL:혀놀림)*100
			ELSEIF CUP:ARG:Ｐ윤 == 0
				CDOWN:ARG:Ｐ윤 += MIN(200, PALAM:ARG:Ｐ윤)
			ENDIF
		ENDSELECT
	ENDIF

	;このターンのBASE:절정増分に応じてカウパーで潤滑追加
	CUP:ARG:Ｐ윤 += 500 * TCVAR:ARG:101 / MAXBASE:ARG:절정
	IF TALENT:ARG:젖기쉬움
		CUP:ARG:Ｐ윤 = UP_PALAMLV(CUP:ARG:Ｐ윤)
	ELSEIF TALENT:ARG:젖기어려움
		CUP:ARG:Ｐ윤 = DOWN_PALAMLV(CUP:ARG:Ｐ윤)
	ENDIF

	PALAM:ARG:Ｐ윤 = LIMIT(PALAM:ARG:Ｐ윤 + CUP:ARG:Ｐ윤 - CDOWN:ARG:Ｐ윤, 0, 10000)

CASE "윤활추가"
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	SIF TALENT:(ARG:1):남자 == 0
		CUP:(ARG:1):Ｖ윤 += ARG
	CUP:(ARG:1):Ａ윤 += ARG
	SIF PENIS(ARG:1)
		CUP:(ARG:1):Ｐ윤 += ARG
CASE "조교外윤활추가"
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	SIF TALENT:(ARG:1):남자 == 0
		PALAM:(ARG:1):Ｖ윤 += ARG
	PALAM:(ARG:1):Ａ윤 += ARG
	SIF PENIS(ARG:1)
		PALAM:(ARG:1):Ｐ윤 += ARG

CASE "下着姿になる"
	CALL SET_SHIRT, ARG
	CALL SET_BODYS, ARG
	CALL SET_OUTER, ARG
	CALL SET_SOCKS, ARG
	CALL SET_GLOVE, ARG
	CALL SET_SHOES, ARG
CASE "衣装全脱ぎ"
	CALL SET_PANTIES, ARG
	CALL SET_BRA, ARG
	CALL SET_SHIRT, ARG
	CALL SET_BODYS, ARG
	CALL SET_OUTER, ARG
	CALL SET_SOCKS, ARG
	CALL SET_GLOVE, ARG
	CALL SET_SHOES, ARG
	CALL SET_OTHER, ARG
CASE "전부벗긴다"
	CALL SET_PANTIES, ARG
	CALL SET_BRA, ARG
	CALL SET_SHIRT, ARG
	CALL SET_BODYS, ARG
	CALL SET_OUTER, ARG
CASE "가슴을はだける"
	SWAP TARGET, ARG
	IF EQUIP:보디슈츠
		SIF CHECK_BODYS("はだけ可")
			CALL CALC, "보디슈츠플래그추가", SETFLAG_BODYS("はだけた")
	ENDIF
	IF EQUIP:웃옷
		SIF CHECK_SHIRT("はだけ可")
			CALL CALC, "웃옷플래그추가", SETFLAG_SHIRT("はだけた")
	ENDIF
	IF EQUIP:브래지어
		SIF CHECK_BRA("はだけ可")
			CALL CALC, "브래지어플래그추가", SETFLAG_BRA("はだけた")
	ENDIF
	SWAP TARGET, ARG
CASE "ボトムずれ直し"
	CLEARBIT EQUIP:ARG:보디슈츠, 61
	CLEARBIT EQUIP:ARG:겉옷, 61
	CLEARBIT EQUIP:ARG:팬티, 61
	TCVAR:ARG:26 = 0

CASE "바텀을脱がす", "下半身を脱がす"
	CALL SET_PANTIES, ARG
	CALL SET_BODYS, ARG
	CALL SET_OUTER, ARG

CASE "바텀을１枚ずらす"
	SWAP TARGET, ARG
	;보디슈츠, ずらしていないか파스너開けてない
	IF EQUIP:보디슈츠 && CHECK_CLO("보디슈츠노출")
		IF CHECK_BODYS("파스너閉")
			PRINTFORM %BODYS(TARGET, 1)% 다리사이의 지퍼를 내리고 
			CALL CALC, "보디슈츠플래그추가", SETFLAG_BODYS("파스너開")
		ELSE
			IF CHECK_CLO("食い込み") && RAND:2 == 0
				PRINTFORM 가랑에 먹혀든 
			ELSE
				PRINTFORM %BODYS(TARGET, 1)%의 
			ENDIF
			PRINT 가랑이 부분의 천을 밀어내고 
			CALL CALC, "보디슈츠플래그추가", SETFLAG_BODYS("ずらした")
		ENDIF
	ELSEIF EQUIP:겉옷 && CHECK_OUTER("파스너閉")
		PRINTFORM %OUTER(TARGET, 1)%의 가랑이 지퍼를 내리고 
		CALL CALC, "겉옷플래그추가", SETFLAG_OUTER("파스너開")
	;겉옷, ずらしていないか穴が無い
	ELSEIF EQUIP:겉옷 && CHECK_CLO("블루머노출")
		CALL CALC, "겉옷플래그추가", SETFLAG_OUTER("ずらした")
		IF EQUIP:팬티 && CHECK_PANTIES("ずらせる")
			PRINTFORM 팬티 째로 
			CALL CALC, "팬티플래그추가", SETFLAG_PANTIES("ずらした")
		ENDIF
		PRINTFORM %조사처리(OUTER(TARGET, 1),"를")% 끌어내리고
	;팬티스타킹(破ってない)
	ELSEIF EQUIP:겉옷 && CHECK_CLO("팬티스타킹노출")
		PRINTFORM %조사처리(OUTER(TARGET, 1),"를")% 찢고 
		CALL CALC, "겉옷플래그추가", SETFLAG_OUTER("破いた")
	;팬티, ずらしていないか파스너開けてない
	ELSEIF EQUIP:팬티 && CHECK_CLO("팬티노출")
		IF CHECK_PANTIES("파스너閉")
			PRINTFORM %PANTIES(TARGET, 1)%의 지퍼를 내리고 
			CALL CALC, "팬티플래그추가", SETFLAG_PANTIES("파스너開")
		ELSE
			IF CHECK_PANTIES("Ｔ백") && (SELECTCOM == 2 || SELECTCOM == 33 || (SELECTCOM >= 70 && SELECTCOM <= 79) )
				PRINT 엉덩이를 가린 끈을 내리고 
			ELSE
				PRINTFORM %조사처리(PANTIES(TARGET, 1),"를")% 끌어내리고
			ENDIF
			CALL CALC, "팬티플래그추가", SETFLAG_PANTIES("ずらした")
		ENDIF
	ENDIF
	SWAP TARGET, ARG
CASE "바텀을노출：텍스트有り", "바텀을노출：텍스트없음"
	SWAP TARGET, ARG
	VARSET LOCALS
	IF EQUIP:보디슈츠
		IF CHECK_BODYS("파스너閉")
			CALL CALC, "보디슈츠플래그추가", SETFLAG_BODYS("파스너開")
			LOCALS = 지퍼를 내리고 
		ELSEIF CHECK_BODYS("ずらせる") && !CHECK_BODYS("파스너開")
			CALL CALC, "보디슈츠플래그추가", SETFLAG_BODYS("ずらした")
		ENDIF
	ENDIF
	IF EQUIP:겉옷
		IF CHECK_OUTER("파스너閉")
			CALL CALC, "겉옷플래그추가", SETFLAG_OUTER("파스너開")
			LOCALS = 지퍼를 내리고 
		ELSEIF PENIS(TARGET) && !CHECK_OUTER("파스너開")
			CALL SET_OUTER, TARGET
			LOCALS = %조사처리(OUTER(TARGET, 1),"를")% 벗기고 
		ELSEIF CHECK_OUTER("ずらせる") && !CHECK_OUTER("파스너開")
			CALL CALC, "겉옷플래그추가", SETFLAG_OUTER("ずらした")
		ELSEIF CHECK_OUTER("破ける")
			CALL CALC, "겉옷플래그추가", SETFLAG_OUTER("破いた")
			LOCALS =%조사처리(OUTER(TARGET, 1),"를")% 찢고 
		ENDIF
	ENDIF
	IF EQUIP:팬티
		IF CHECK_PANTIES("파스너閉")
			CALL CALC, "팬티플래그추가", SETFLAG_PANTIES("파스너開")
			LOCALS = 지퍼를 내리고 
		ELSEIF PENIS(TARGET) && !CHECK_PANTIES("파스너開")
			CALL SET_PANTIES, TARGET
			LOCALS = %조사처리(PANTIES(TARGET, 1),"를")% 벗기고 
		ELSEIF CHECK_PANTIES("ずらせる") && !CHECK_PANTIES("파스너開")
			CALL CALC, "팬티플래그추가", SETFLAG_PANTIES("ずらした")
		ENDIF
	ENDIF

	IF ARGS == "바텀을노출：텍스트有り"
		IF LOCALS != ""
			PRINTFORM %LOCALS%
		ELSEIF RAND:2 || TALENT:남자
			PRINTFORM 사타구니를 드러내고
		ELSE
			PRINTFORM 중요한 부분을 노출시키고
		ENDIF
	ENDIF

	;"바텀을노출させた"플래그ＯＮ
	SETBIT TCVAR:10, 21

	SWAP TARGET, ARG

CASE "조교개시前Ａ"
	VARSET TCVAR:ARG:0, 0, 0, 30
	;ターン初期化
	TCVAR:ARG:150 = 0
	;前のターンの인서트などの状態初期化
	TCVAR:ARG:151 = 0
	;넘어뜨리기확률の보정を初期化
	TCVAR:ARG:152 = 0

	BASE:ARG:절정 = 0
	BASE:ARG:분유 = 0
	;가슴の大きさや음유、육아중かで보정
	IF TALENT:ARG:모유체질
		BASE:ARG:분유 = RAND:6000 + RAND:6000
		BASE:ARG:분유 += TALENT:ARG:거유 * 1000
		SIF TALENT:ARG:음유
			BASE:ARG:분유 += 1000
		SIF BASE:ARG:육아중
			BASE:ARG:분유 += 3000
	ENDIF
	BASE:ARG:촉수 = 0
	BASE:ARG:드래곤 = 0
	BASE:ARG:요의 = 500 * (RAND:10 + RAND:10)
	MAXBASE:ARG:요의 = 10000

	;綺麗にする様に지시
	IF COND("身嗜み：장세척")
		EXP:ARG:Ａ경험 += 2
		EXP:ARG:관장경험 += 1
		BASE:ARG:배설물 = 0
	ENDIF
	MAXBASE:ARG:배설욕 = LIMIT(MULTIPLY(10000, 100 + ABL:ARG:Ａ놀림*10 - ABL:ARG:Ａ확장*20), 5000, 15000)
	IF BASE:ARG:배설물
		BASE:ARG:배설욕 = MIN(MIN(500 * BASE:ARG:배설물, 5000) * (5+RAND:6) / 10, MAXBASE:ARG:배설욕 - 1000)
	ELSE
		BASE:ARG:배설욕 = 0
	ENDIF

	;包茎の皮を戻す
	CALL SETFLAG, "포경の皮を戻す", ARG

	;페니스やアソコの掃除をしてないと…
	SIF COND("Ｐ불결", ARG)
		STAIN:ARG:Ｐ = SET_STAIN(STAIN:ARG:Ｐ, "Ｐ치구")
	SIF COND("Ｖ불결", ARG)
		STAIN:ARG:Ｖ = SET_STAIN(STAIN:ARG:Ｖ, "Ｖ치구")


	BASE:ARG:성감허용치남자 = 0

	;커맨드拒否플래그＆SELECTCOMの記録リセット
	FOR LCOUNT, 0, 600
		DITEMTYPE:ARG:LCOUNT = 0
	NEXT

	SIF COND("身嗜み：Ｖ확장", ARG)
		PALAM:ARG:쾌Ｖ += RAND:(PALAM_LV(COND("身嗜み：Ｖ확장", ARG) ) ) * MIN(ABL:Ｖ감각, 5) / 5
	SIF COND("身嗜み：Ａ확장", ARG)
		PALAM:ARG:쾌Ａ += RAND:(PALAM_LV(COND("身嗜み：Ａ확장", ARG) ) ) * MIN(ABL:Ａ감각, 5) / 5

	;開始時に既に욕정＆濡れている
	LOCAL = EXP:ARG:절정경험 + BASE:ARG:욕구불만 * 20 + ABL:ARG:자위중독 * 100 + RAND:100 - RAND:100
	LOCAL -= TALENT:ARG:반항적*50 + TALENT:ARG:냉정*30 + TALENT:ARG:저항*30 + TALENT:ARG:쾌감을부정*30
	LOCAL += TALENT:ARG:쾌감에솔직*30 + TALENT:ARG:호색*50 + TALENT:ARG:음란*100 + TALENT:ARG:연모*50
	LOCAL += COND("身嗜み：Ｖ확장", ARG)*20 + COND("身嗜み：Ａ확장", ARG)*10

	SELECTCASE ABL:ARG:욕망
	CASE 2
		LOCAL += 10
	CASE 3
		LOCAL += 20
	CASE 4
		LOCAL += 40
	CASE 5
		LOCAL += 80
	ENDSELECT

	SELECTCASE CFLAG:ARG:2
	CASE IS >= 2500
		LOCAL += 300
	CASE IS >= 1500
		LOCAL += 200
	CASE IS >= 500
		LOCAL += 100
	ENDSELECT

	SIF TEQUIP:ARG:미약
		LOCAL += 30 * TEQUIP:ARG:미약

	LOCAL = LOCAL * (CFLAG:ARG:2 + 1000) / 2000

	SELECTCASE LOCAL
	;MAX 1000
	CASE IS < 3000
		LOCAL = LOCAL/3
	;MAX 2166
	CASE IS < 10000
		LOCAL = LOCAL/6 + 500
	CASEELSE
		LOCAL = LOCAL/12 + 1333
	ENDSELECT

	PALAM:ARG:욕정 += LIMIT(LOCAL, 0, 30000)

	;-------------------------------------------------
	;愛液処理(욕정)
	;-------------------------------------------------
	IF TALENT:ARG:남자 == 0
		LOCAL = 0
		;욕정の値に応じてＶ윤増加
		SELECTCASE PALAM:ARG:욕정
		;MAX100
		CASE IS < 500
			LOCAL += PALAM:ARG:욕정 / 5
		;MAX500
		CASE IS < 3000
			LOCAL += (PALAM:ARG:욕정 - 500) * 4 / 25 + 100
		;MAX3000
		CASE IS < 10000
			LOCAL += (PALAM:ARG:욕정 - 3000) * 5 / 14 + 500
		CASEELSE
			LOCAL += 3000
		ENDSELECT

		LOCAL += MARK:ARG:정액각인*100

		;바이브を入れているなら+大きさ*100
		LOCAL += COND("身嗜み：Ｖ확장", ARG) * 100

		;슬라임判定
		SIF TALENT:ARG:슬라임
			LOCAL += 3000
		;마도인형判定
		SIF TALENT:ARG:마도인형
			LOCAL += 500

		IF TALENT:ARG:젖기쉬움
			LOCAL = UP_PALAMLV(LOCAL)
		ELSEIF TALENT:ARG:젖기어려움
			LOCAL = DOWN_PALAMLV(LOCAL)
		ENDIF

		PALAM:ARG:Ｖ윤 += LIMIT(LOCAL, 0, 6000)
	ENDIF


	IF COND("身嗜み：Ａ로션", ARG) && TEQUIP:ARG:로션 == 0 && (ITEM:로션 || MONEY >= ITEMPRICE:로션)
		PALAM:ARG:Ａ윤 += 10000
		SETBIT TEQUIP:ARG:로션, 0
		IF ITEM:로션
			ITEM:로션 -= 1
		ELSE
			MONEY -= ITEMPRICE:로션
		ENDIF
		RETURN 0
	ENDIF

	;슬라임だけ보너스
	SIF TALENT:ARG:슬라임
		PALAM:ARG:Ａ윤 += LIMIT(LOCAL, 0, 6000)

	LOCAL = 0
	;いくつかの条件でＡ윤追加
	IF TALENT:ARG:장액분비체질
		;욕정の値に応じてＡ윤増加
		SELECTCASE PALAM:ARG:욕정
		CASE IS < 500
		;MAX100
		CASE IS < 3000
			LOCAL += (PALAM:ARG:욕정 - 500) / 25
		;MAX500
		CASE IS < 10000
			LOCAL += (PALAM:ARG:욕정 - 3000) * 2 / 35 + 100
		CASEELSE
			LOCAL += 500
		ENDSELECT
	ENDIF
	;애널플러그を入れているなら+大きさ*100
	LOCAL += COND("身嗜み：Ａ확장", ARG) * 100

	;슬라임
	IF TALENT:ARG:슬라임
		PALAM:ARG:Ａ윤 = MAX(LOCAL, PALAM:ARG:Ａ윤)
	ELSE
		PALAM:ARG:Ａ윤 += LIMIT(LOCAL, 0, 6000)
	ENDIF

CASE "조교개시前Ｂ"
	;開始前の경험を記憶
	CALL RESET_EXP_GAIN, ARG
	;만족체크をリセット
	CFLAG:ARG:99 = 0

	;이하はMASTERでは설정不요정
	SIF ARG == MASTER
		RETURN 0

	CALL RESET_CHOSECOM, ARG
	CALL GET_EXABL, ARG
	CALL GET_EXTALENT, ARG
	;SOURCEとCUPにかかる보정を再計算
	CALL CALC, "조교보정치", ARG
CASE "턴개시"
	VARSET NOWEX:ARG:0
	VARSET TCVAR:ARG:0, 0, 0, 30
	VARSET TCVAR:ARG:0, 0, 120, 140
	VARSET CUP:ARG:0
	VARSET SOURCE:ARG:0
	VARSET DOWNBASE:ARG:0
	VARSET UP
	;갈아입히기部分の高速化플래그消去
	TCVAR:ARG:26 = 0

	;EXPの増分表示のために、현재の値を記録
	FOR LCOUNT, 0, 100
		TCVAR:ARG:(LCOUNT + 700) = EXP:ARG:LCOUNT
	NEXT

	SIF PENIS(ARG) == 0
		CALL RESET_STAIN_EX, "Ｐ", ARG

	;특수な플레이の初期化
	;ワイルドスウィング
	SIF COND("前Ｔ조교자") != PLAYER || COND("前Ｔ대상") != TARGET
		TEQUIP:ARG:특수행동 = 0
	;二本フィスト
	SELECTCASE SELECTCOM
	CASE 141 TO 143

	CASEELSE
		CLEARBIT TEQUIP:ARG:특수행동, 1
	ENDSELECT
	;에너지드레인
	CLEARBIT TEQUIP:ARG:특수행동, 2
	;레벨ドレイン
	CLEARBIT TEQUIP:ARG:특수행동, 3
	;両穴くぱぁ
	SELECTCASE SELECTCOM
	CASE 13, 14

	CASEELSE
		CLEARBIT TEQUIP:ARG:특수행동, 4
	ENDSELECT
CASE "턴종료"
	;今回の커맨드で得たUPとNOWEXを保存し, SOURCEの合計値(TCVAR:120～139)を初期化する
	CALL SET_PREVUP, ARG
	CALL SET_PREVEX, ARG
	VARSET TCVAR:ARG:0, 0, 120, 140

	CALL SETFLAG, "속성", ARG
	CALL GET_EXTALENT, ARG
	CALL GET_EXABL2, ARG
	SIF PENIS(ARG) == 0
		CALL RESET_STAIN_EX, "Ｐ", ARG
	;ターン追加
	SIF ARG == TARGET || ARG == MASTER || SELECTCOM:1 >= 0 || SELECTCOM:2 >= 0
		TCVAR:ARG:150 += 1
	;넘어뜨리기확률보정の変動
	SIF TCVAR:ARG:152 > 0 && TEQUIP:ARG:넘어뜨리기 == 0
		TCVAR:ARG:152 -= 1
	IF CONFIG("정액관장") && (COND("정액관장", ARG) || NOWEX:ARG:Ａ내사정) && BASE:ARG:배설물 && COND("액체관장", ARG) < 2 && COND("공기관장", ARG) == 0
		BASE:ARG:배설욕 += NOWEX:ARG:Ａ내사정*500 + NOWEX:ARG:Ａ절정*200 + NOWEX:ARG:절정수합계*100
		;정액관장플래그ＯＮ
		TEQUIP:ARG:관장 = 1p10
	ENDIF
	;いまのところ, 요도확장기は取り除く
	TEQUIP:ARG:요도확장기 = 0
	;로션マッサージ
	IF GETBIT(TEQUIP:ARG:로션, 1)
		CLEARBIT TEQUIP:ARG:로션, 1
		SETBIT TEQUIP:ARG:로션, 2
	ENDIF
	;절정しているなら, 연속절정コンボ数を変化させる
	IF NOWEX:ARG:절정수합계
		PALAM:ARG:연속절정COMBO수 += (NOWEX:ARG:Ｃ절정 + NOWEX:ARG:요도절정 > 0) + (NOWEX:ARG:Ｖ절정 > 0) + (NOWEX:ARG:Ａ절정 > 0) + (NOWEX:ARG:Ｂ절정 > 0) + (NOWEX:ARG:Ｍ절정 > 0)
		PALAM:ARG:보정치 += NOWEX:ARG:절정수합계
		EX:ARG:연속절정 = MAX(EX:ARG:연속절정, PALAM:ARG:연속절정COMBO수)
	;절정しなかった場合コンボ終了
	ELSE
		PALAM:ARG:연속절정COMBO수 = 0
		PALAM:ARG:보정치 /= 2
	ENDIF
	;갈아입히기部分の高速化플래그消去
	TCVAR:ARG:26 = 0
	;このターンの인서트等の状態を記録する
	CALL SET_PREVPLAY, ARG
	VARSET NOWEX:ARG:0
	VARSET TCVAR:ARG:0, 0, 0, 30
	VARSET TCVAR:ARG:0, 0, 120, 140
	VARSET CUP:ARG:0
	VARSET SOURCE:ARG:0
	VARSET DOWNBASE:ARG:0
	VARSET UP
CASE "사정게이지"
	;LVに応じて게이지増加
	IF ARG == MASTER
		LOCAL = 10000 + (ABL:ARG:ＬＶ - 1)*1000
	ELSEIF ABL:ARG:ＬＶ > 0
		LOCAL = 10000 + (ABL:ARG:ＬＶ - 1)*1000
	ELSE
		LOCAL = 10000
	ENDIF
	;조루or지루
	IF TALENT:ARG:조루
		LOCAL = MAX(LOCAL/(TALENT:ARG:조루 + 1), 5000)
	ELSEIF TALENT:ARG:지루
		LOCAL *= TALENT:ARG:지루 + 1
	ENDIF
	;진정제
	SIF GETBIT(TEQUIP:ARG:드러그, 0)
		LOCAL += MAX(MULTIPLY(LOCAL, 40), 10000)
	SIF STATE("센시브", ARG)
		LOCAL = MIN(LOCAL/2, 10000)

	;사정게이지決定
	MAXBASE:ARG:절정 = LOCAL
	;악세사리効果（ＥＰ）
	MAXBASE:ARG:절정 = MULTIPLY(MAXBASE:ARG:절정, 100 + TALENT:ARG:ＥＰ강화)


	;사정量の決定基準…센시브状態等でない限りはだいたい１万orMAXBASE:절정. 사정게이지が増えると勿論増えていく. 
	LOCAL = MAX(MULTIPLY(MAXBASE:ARG:절정, 70), 10000)

	EJAC:ARG = MIN(LOCAL, MAXBASE:ARG:절정)
	;사정時快感許容値
	MAXBASE:ARG:성감허용치남자 = EJAC:ARG * 3
CASE "성욕게이지"
	BASE:ARG:성욕 = EX:ARG:절정수합계 + EX:ARG:사정
	SELECTCASE ABL:ARG:욕망
	CASE 0
		MAXBASE:ARG:성욕 = 0
		BASE:ARG:성욕 = 0
	CASE IS <= 2
		MAXBASE:ARG:성욕 = MAX(ABL:ARG:욕망, 1)
	CASE 3
		MAXBASE:ARG:성욕 = 3 + TALENT:ARG:호색 + TALENT:ARG:음란 + TALENT:ARG:몽마 + TALENT:ARG:상위몽마*2
	CASE 4
		MAXBASE:ARG:성욕 = 5 + TALENT:ARG:호색*2 + TALENT:ARG:음란*2 + TALENT:ARG:몽마*2 + TALENT:ARG:상위몽마*4
	CASE IS >= 5
		MAXBASE:ARG:성욕 = 7 + TALENT:ARG:호색*3 + TALENT:ARG:음란*3 + TALENT:ARG:몽마*3 + TALENT:ARG:상위몽마*6
	ENDSELECT
	MAXBASE:ARG:성욕 += MARK:ARG:정액각인*2
CASE "정액욕게이지"
	MAXBASE:ARG:정액욕 = (ABL:ARG:정액중독 + TALENT:ARG:몽마*2 + TALENT:ARG:상위몽마*4)*3 + MARK:ARG:정액각인*2
	BASE:ARG:정액욕 = EXP_GAIN(20, ARG)
	IF ABL:정액중독 + (TALENT:몽마+TALENT:상위몽마 > 0)*2 < 3
		MAXBASE:ARG:정액욕 = 0
		BASE:ARG:정액욕 = 0
	ENDIF
CASE "体勢戻し"
	;안면기승管理
	SELECTCASE SELECTCOM
	CASE 1, 9, 99, 144, 282
	;봉사系커맨드は실행치依存
	CASE 90 TO 92, 97, 105
		SIF TALENT:남자 || (TCVAR:28 < 30 && ABL:욕망 + ABL:새드끼 < 5)
			TEQUIP:안면기승 = 0
	CASE 95
		SIF PENIS(PLAYER) == 0 || (TCVAR:28 < 30 && ABL:욕망 + ABL:새드끼 < 5)
			TEQUIP:안면기승 = 0
	CASEELSE
		TEQUIP:안면기승 = 0
	ENDSELECT

	;식스나인管理
	SIF CHECK_EQUIP_69(SELECTCOM) == 0
		CVARSET TEQUIP, 69, 0

	;딥스로트管理
	SELECTCASE SELECTCOM
	CASE 91, 140, 150
		;플래그とTEQUIPが分かれているのは, 사정後などにTEQUIP:딥스로트が０となっている時でも参照するため
		SIF TEQUIP:딥스로트
			CALL SETFLAG, "딥스로트플래그", TARGET
	CASE 138
		SIF CHECK_COM("입内방뇨") && TEQUIP:딥스로트
			CALL SETFLAG, "딥스로트플래그", TARGET
	CASEELSE
		SELECTCASE TEQUIP:식스나인
		CASE 91, 150
		CASEELSE
			TEQUIP:딥스로트 = 0
		ENDSELECT
	ENDSELECT

	;인서트解除判定
	CALL CHECK_INSERT, "解除判定"

CASE "추가のSOURCE"
	VARSET LOCAL
	;레즈끼による보정
	IF PENIS(PLAYER) == 0 && ABL:ARG:레즈끼
		LOCAL = ABL:ARG:레즈끼
		SELECTCASE SELECTCOM
		CASE 120 TO 129
			LOCAL:1 = 50
		CASE 6, 80, 94, 96, 98
			LOCAL:1 = 200
		ENDSELECT
	;정액중독による보정
	ELSEIF PENIS(PLAYER) && ABL:ARG:정액중독
		LOCAL = ABL:ARG:정액중독
		SELECTCASE SELECTCOM
		CASE 120 TO 129
			LOCAL:1 = 50
		CASE 6, 90, 93 TO 100
			LOCAL:1 = 200
		CASE 65, 75, 177
			LOCAL:1 = 300
		CASE 91, 92, 140
			LOCAL:1 = 500
		ENDSELECT
	ENDIF
	IF LOCAL:1
		SELECTCASE LOCAL
		CASE 1
			SOURCE:ARG:중독충족 += LOCAL:1
			TIMES SOURCE:ARG:달성감, 1.50
			TIMES SOURCE:ARG:굴복, 1.50
		CASE 2
			SOURCE:ARG:중독충족 += LOCAL:1 * 2
			TIMES SOURCE:ARG:달성감, 2.00
			TIMES SOURCE:ARG:굴복, 2.00
		CASE 3
			SOURCE:ARG:중독충족 += LOCAL:1 * 3
			TIMES SOURCE:ARG:달성감, 2.50
			TIMES SOURCE:ARG:굴복, 2.50
		CASE 4
			SOURCE:ARG:중독충족 += LOCAL:1 * 4
			TIMES SOURCE:ARG:달성감, 3.00
			TIMES SOURCE:ARG:굴복, 3.00
		CASE 5
			SOURCE:ARG:중독충족 += LOCAL:1 * 5
			TIMES SOURCE:ARG:달성감, 3.50
			TIMES SOURCE:ARG:굴복, 3.50
		ENDSELECT
	ENDIF
;특수な行動
CASE "와일드스윙"
	IF CHECK_COM("와일드스윙", ARG)
		SETBIT TEQUIP:ARG:특수행동, 0
	ELSE
		CLEARBIT TEQUIP:ARG:특수행동, 0
	ENDIF
CASE "양손피스트"
	SETBIT TEQUIP:ARG:특수행동, 1
CASE "에너지드레인"
	SETBIT TEQUIP:ARG:특수행동, 2
CASE "레벨ドレイン"
	SETBIT TEQUIP:ARG:특수행동, 3
CASE "両穴くぱぁ"
	SETBIT TEQUIP:ARG:특수행동, 4
CASE "撃沈"
	BASE:ARG:정력 = 0
	;ASSIPLAY = 0
	;PLAYER = MASTER
	;인서트しているなら解除
	CALL RESET_INSERT, ARG
	SIF TEQUIP:ARG:Ｗ넘어뜨리기
		CALL SETFLAG, "Ｗ넘어뜨리기解除"
	TEQUIP:ARG:넘어뜨리기 = 0
	;演奏停止
	CVARSET TEQUIP, 65, 0
	IF PLAYER == ARG && SELECTCOM:2 >= 0
		TEQUIP:넘어뜨리기 = 0
		TEQUIP:식스나인 = 0
		SWAP SELECTCOM, SELECTCOM:2
		SWAP PREVCOM, PREVCOM:2
		SELECTCOM:2 = -1
	ENDIF

CASE "조수상대の연모外し개시"
;タイミングとしては, "조교커맨드のCOMABLEを체크する時(@SHOW_STATUS)"と, "커맨드を選んだ時(@EVENTCOM)"に연모が外れ, 
;@SHOW_USERCOM表示時, 커맨드の終了時(@EVENTCOMEND), 조교종료時(@EVENTEND)で復帰させます. 
	SIF CONFIG("조수상대でも연모適用") || ASSIPLAY == 0
		RETURN 0

	SIF TALENT:상사상애
		CALL SET_CEVENT, "조수조교での소질変化：상사상애外し"
	SIF TALENT:연모
		CALL SET_CEVENT, "조수조교での소질変化：연모外し"

	TALENT:상사상애 = 0
	TALENT:연모 = 0

CASE "조수상대の연모外し종료"
	SIF CONFIG("조수상대でも연모適用")
		RETURN 0

	SIF CEVENT("조수조교での소질変化：상사상애外し")
		TALENT:상사상애 = 1
	SIF CEVENT("조수조교での소질変化：연모外し")
		TALENT:연모 = 1

	CALL DEL_CEVENT_GROUP, "조수조교での소질変化"

CASE "今回조교커맨드"
	IF SELECTCOM:1 >= 0
		IF SELECTCOM:1 == 1
			STR:0 = %STR:0% ＆ 안면기승
		ELSEIF SELECTCOM:1 == 9
			STR:0 = %STR:0% ＆ 애널안면기승
		ELSEIF SELECTCOM:1 >= 90 && SELECTCOM:1 <= 119 && SELECTCOM == SELECTCOM:1
			STR:0 = Ｗ%TRAINNAME:(SELECTCOM:1)%
		ELSEIF SELECTCOM:1 == 98
			STR:0 = %STR:0% ＆ 보지봉사
		ELSEIF (SELECTCOM:1 == 126 && SELECTCOM == 120) || (SELECTCOM:1 == 120 && SELECTCOM == 126)
			STR:0 = 양구멍삽입
		;조수の行動は記述しない
		ELSEIF SELECTCOM >= 60 && SELECTCOM <= 79 && SELECTCOM:1 >= 60 && SELECTCOM:1 <= 79
		ELSE
			STR:0 = %STR:0% ＆ %TRAINNAME:(SELECTCOM:1)%
		ENDIF
	ENDIF

	;절정具合の表示
	;동시절정
	IF STRLENS(STR:9)
		STR:1 = [%STR:9%]
	;こっちは誰か一人しか절정していない
	ELSEIF STRLENS(STR:5) || STRLENS(STR:6) || STRLENS(STR:7)
		STR:1 = [%STR:5%%STR:6%%STR:7%]
	ELSE
		STR:1 = 
	ENDIF
	;不요정な文字列を初期化
	VARSET STR, "", 2, 10

	;-------------------------------------------------
	;今回の커맨드を「前回の커맨드」とする
	;-------------------------------------------------
	PREVCOM = SELECTCOM
	PREVCOM:4 = SELECTCOM:4

	;今回選んだ커맨드を記録する
	CALL SET_CHOSECOM, TARGET, SELECTCOM
	;조수も参加している場合には, 조수の前回커맨드＆선택した커맨드も記録
	CALL SET_CHOSECOM, TARGET:1, SELECTCOM:1

CASE "조교종료"
	BASE:ARG:정력 = MAX(BASE:ARG:정력, 0)
	SIF STATE("구현", ARG)
		CALL REMOVE_STATE, ARG, "구현"

	;근육이완제の効果消失
	IF GETBIT(TEQUIP:ARG:근육이완제, 0)
		IF TALENT:ARG:약독내성 || TALENT:ARG:요정
			ABL:ARG:Ａ확장 -= 1
		ELSE
			ABL:ARG:Ａ확장 -= 2
		ENDIF
		CLEARBIT TEQUIP:ARG:근육이완제, 0
		CALL GET_EXABL_A, ARG
		ABL:ARG:Ａ명기도 = ABL_A(ARG)
	ENDIF
	IF GETBIT(TEQUIP:ARG:근육이완제, 2)
		IF TALENT:ARG:약독내성 || TALENT:ARG:요정
			ABL:ARG:Ｖ확장 -= 1
		ELSE
			ABL:ARG:Ｖ확장 -= 2
		ENDIF
		CLEARBIT TEQUIP:ARG:근육이완제, 2
		CALL GET_EXABL_V, ARG
		ABL:ARG:Ｖ명기도 = ABL_V(ARG)
	ENDIF

	CALL CALC, "선호체위", ARG

;ここでの플래그は, キチンと認識しているか, がポイント
CASE "처녀상실플래그"
	SETBIT TCVAR:ARG:10, 0
CASE "처녀탈취플래그"
	SETBIT TCVAR:ARG:10, 1
CASE "동정喪失플래그"
	SETBIT TCVAR:ARG:10, 2
CASE "동정狩り플래그"
	SETBIT TCVAR:ARG:10, 3
;上のほうにある"청소펠라"内でもONになる
CASE "청소펠라플래그"
	SETBIT TCVAR:ARG:10, 4
;上のほうにある"청소펠라"内でもONになる
CASE "Ａ청소펠라플래그"
	SETBIT TCVAR:ARG:10, 5
CASE "자위플래그"
	SETBIT TCVAR:ARG:10, 6
;上のほうにある"청소컨닐링구스"内でもONになる
CASE "청소컨닐링구스플래그"
	SETBIT TCVAR:ARG:10, 7
CASE "자궁責め플래그"
	SETBIT TCVAR:ARG:10, 8
CASE "Ａ봉사플래그"
	SETBIT TCVAR:ARG:10, 9
CASE "바늘다루기플래그"
	SETBIT TCVAR:ARG:10, 10
CASE "제모플래그"
	SETBIT TCVAR:ARG:10, 11
CASE "Ｐ바인드弱体플래그"
	SETBIT TCVAR:ARG:10, 12
CASE "자궁삽입플래그"
	SETBIT TCVAR:ARG:10, 13
CASE "쓱쓱닦기플래그"
	SETBIT TCVAR:ARG:10, 14
CASE "클리피어스플래그"
	SETBIT TCVAR:ARG:10, 15
CASE "라비아피어스플래그"
	SETBIT TCVAR:ARG:10, 16
CASE "니플피어스플래그"
	SETBIT TCVAR:ARG:10, 17
CASE "배꼽피어스플래그"
	SETBIT TCVAR:ARG:10, 18
CASE "피어스ＯＮ플래그"
	SETBIT TCVAR:ARG:10, 19
CASE "鎮痛麻酔플래그"
	SETBIT TCVAR:ARG:10, 20
;これについては"바텀을노출：텍스트有り", "바텀을노출：텍스트없음"内でも同様の플래그立てを行う
CASE "바텀을노출させた"
	SETBIT TCVAR:ARG:10, 21
CASE "Ａ처녀상실플래그"
	SETBIT TCVAR:ARG:10, 22
CASE "Ａ처녀탈취플래그"
	SETBIT TCVAR:ARG:10, 23
CASE "모유마시기플래그"
	SETBIT TCVAR:ARG:10, 24
;上のほうにある"飲尿"内でもONになる
CASE "飲尿플래그"
	SETBIT TCVAR:ARG:10, 25
CASE "ながら자위플래그"
	SETBIT TCVAR:ARG:10, 26
CASE "스팽킹섹스플래그"
	SETBIT TCVAR:ARG:10, 27
CASE "マーキング플래그"
	SETBIT TCVAR:ARG:10, 28
CASE "うっかり자궁삽입플래그"
	SETBIT TCVAR:ARG:10, 29
CASE "겨드랑이핥기플래그"
	SETBIT TCVAR:ARG:10, 30
CASE "겨드랑이見せ플래그"
	SETBIT TCVAR:ARG:10, 31
CASE "질내욕뇨플래그"
	SETBIT TCVAR:ARG:10, 32
CASE "자궁内욕뇨플래그"
	SETBIT TCVAR:ARG:10, 33
CASE "온천관장플래그"
	SETBIT TCVAR:ARG:10, 34
CASE "유内욕뇨플래그"
	SETBIT TCVAR:ARG:10, 35
CASE "딥스로트플래그"
	SETBIT TCVAR:ARG:10, 36
CASE "삽입前폭발플래그"
	SETBIT TCVAR:ARG:10, 37
CASE "구현化ＯＮ플래그"
	SETBIT TCVAR:ARG:10, 38
CASE "구현化ＯＦＦ플래그"
	SETBIT TCVAR:ARG:10, 39
CASE "요도성감플래그"
	SETBIT TCVAR:ARG:10, 40
CASE "방광内욕뇨플래그"
	SETBIT TCVAR:ARG:10, 41
CASE "추가키스플래그"
	SETBIT TCVAR:ARG:10, 42
;上のほうにある"청소Ａ핥기"内でもONになる
CASE "청소Ａ핥기플래그"
	SETBIT TCVAR:ARG:10, 43
;上のほうにある"청소펠라"内でもONになる
CASE "尿청소펠라플래그"
	SETBIT TCVAR:ARG:10, 44
;上のほうにある"청소컨닐링구스"内でもONになる
CASE "尿청소컨닐링구스플래그"
	SETBIT TCVAR:ARG:10, 45
CASE "치구청소펠라플래그"
	SETBIT TCVAR:ARG:10, 46
;上のほうにある"청소컨닐링구스"内でもONになる
CASE "치구청소컨닐링구스플래그"
	SETBIT TCVAR:ARG:10, 47
CASE "발핥기플래그"
	SETBIT TCVAR:ARG:10, 48
CASE "受精확인플래그"
	SETBIT TCVAR:ARG:10, 49
CASE "몽마化플래그"
	SETBIT TCVAR:ARG:10, 50
CASE "성전환플래그"
	SETBIT TCVAR:ARG:10, 51
CASE "호접지몽플래그"
	SETBIT TCVAR:ARG:10, 52
CASE "締め付け플래그"
	SETBIT TCVAR:ARG:10, 53

;-------------------------------------------------
;이하は조교以外
;-------------------------------------------------
CASE "一文字関数初期化"
	VARSET A
	VARSET B
	VARSET C
	VARSET D
	VARSET E
	VARSET F
	VARSET G
	VARSET H
	VARSET I
	VARSET J
	VARSET K
	VARSET L
	VARSET M
	VARSET N
	VARSET O
	VARSET P
	VARSET Q
	VARSET R
	VARSET S
	VARSET T
	VARSET U
	VARSET V
	VARSET W
	VARSET X
	VARSET Y
	VARSET Z
CASE "요바이아침기습종료"
	CALL RESET_EXP_GAIN, ARG
	CALL GET_EXABL2, ARG
	CALL RESETFLAG_CLO, ARG
	VARSET TCVAR:ARG:0, 0, 0, 30
CASE "속성"
	;一度소질などを再체크
	CALL GET_EXTALENT, ARG
	LOCAL = 0
	SIF COND("유니크", ARG)
		SETBIT LOCAL, 0
	SIF TALENT:ARG:강기
		SETBIT LOCAL, 1
	SIF TALENT:ARG:청초 && TALENT:ARG:음란 == 0
		SETBIT LOCAL, 2
	SIF TALENT:ARG:양기
		SETBIT LOCAL, 3
	SIF TALENT:ARG:솔직
		SETBIT LOCAL, 4
	SIF TALENT:ARG:음기
		SETBIT LOCAL, 5
	SIF TALENT:ARG:내성적
		SETBIT LOCAL, 6
	SIF TALENT:ARG:겁쟁이
		SETBIT LOCAL, 7
	SIF TALENT:ARG:새드
		SETBIT LOCAL, 8
	SIF TALENT:ARG:마조
		SETBIT LOCAL, 9
	SIF TALENT:ARG:교만
		SETBIT LOCAL, 10
	SIF TALENT:ARG:냉정 || TALENT:ARG:무관심 || TALENT:ARG:감정결핍
		SETBIT LOCAL, 11
	SIF TALENT:ARG:부끄럼쟁이
		SETBIT LOCAL, 12
	SIF TALENT:ARG:광기
		SETBIT LOCAL, 13
	SIF TALENT:ARG:헌신 || (TALENT:ARG:양기 && AGE(ARG) >= 3)
		SETBIT LOCAL, 14
	SIF TALENT:ARG:현명함
		SETBIT LOCAL, 15
	SIF TALENT:ARG:미련함
		SETBIT LOCAL, 16
	SIF TALENT:ARG:호색 || TALENT:ARG:음란
		SETBIT LOCAL, 17
	IF TALENT:ARG:남자 == 0
		SELECTCASE AGE(ARG)
		CASE 1
			SETBIT LOCAL, 18
		CASE 2
			IF TALENT:ARG:작은몸집 && (NO:ARG == 16 || NO:ARG == 22 || NO:ARG == 47)
				SETBIT LOCAL, 20
			ELSE
				SETBIT LOCAL, 19
			ENDIF
		CASE 3
			SETBIT LOCAL, 21
		CASEELSE
			SETBIT LOCAL, 22
		ENDSELECT
	ENDIF
	IF TALENT:ARG:빈유
		SETBIT LOCAL, 23
	ELSEIF TALENT:ARG:거유
		SETBIT LOCAL, 24
	ENDIF
	SIF TALENT:ARG:동물귀
		SETBIT LOCAL, 25
	SIF TALENT:ARG:꼬리 == 6
		SETBIT LOCAL, 26
	IF TALENT:ARG:날개 == 12 && TALENT:ARG:구현
		SETBIT LOCAL, 27
	ELSEIF TALENT:ARG:날개 == 12
		SETBIT LOCAL, 28
	ENDIF
	SIF TALENT:ARG:요정
		SETBIT LOCAL, 29
	SIF TALENT:ARG:마법사
		SETBIT LOCAL, 30
	SIF TALENT:ARG:라미아 || TALENT:ARG:머메이드 || TALENT:ARG:하피 || TALENT:ARG:구지배자의자취 || TALENT:ARG:슬라임 || TALENT:ARG:팔많음
		SETBIT LOCAL, 31
	SIF TALENT:ARG:마도인형
		SETBIT LOCAL, 32
	SIF TALENT:ARG:장사
		SETBIT LOCAL, 33
	SIF TALENT:ARG:기품
		SETBIT LOCAL, 34
	SIF TALENT:ARG:조야
		SETBIT LOCAL, 35
	SIF COND("오토코노코", ARG)
		SETBIT LOCAL, 36
	SIF COND("근친", ARG)
		SETBIT LOCAL, 37
	SIF TALENT:ARG:남자 && AGE(ARG) == 1
		SETBIT LOCAL, 38

	SELECTCASE TALENT:ARG:피부색
	CASE 1
		SETBIT LOCAL, 39
	CASE 2
		SETBIT LOCAL, 40
	CASE 3
		SETBIT LOCAL, 41
	ENDSELECT

	;性器ピアス
	SIF TALENT:ARG:클리피어스 || TALENT:ARG:라비아피어스 || TALENT:ARG:니플피어스
		SETBIT LOCAL, 46
	;유두비대と거유륜は保留
	SIF COND("함몰유두", ARG)
		SETBIT LOCAL, 47

	BASE:ARG:속성 = LOCAL
CASE "연모"
	PRINTFORMW %CALLNAME:TARGET%의 이쪽을 보는 시선이 이상하다…
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% %조사처리(CALLNAME:MASTER,"과")%의 행위에 행복을 느끼고 있는 모양이다…
	SETCOLOR DEF_COLOR("하트핑크")
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 【연모】를 얻었다
	TALENT:연모 = 1
	IF TALENT:반항적
		SETCOLOR DEF_COLOR("황색")
		PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 【반항적】이 아니게 되었다
		TALENT:반항적 = 0
	ENDIF
	RESETCOLOR
	;욕망, 순종, 굴복각인の上昇による[억압][저항]の消滅を체크
	CALL YOKUBO_UP_CHECK, ARGS
	;堕とした人数. 既に음란だとなし
	SIF TALENT:음란 == 0
		FLAG:30 += 1
	CALL SETFLAG, "キャラ攻略"
CASE "음란"
	PRINTFORMW %CALLNAME:TARGET%의 이쪽을 보는 시선이 이상하다…
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% %조사처리(CALLNAME:MASTER,"가")% 주는 쾌락에 빠져버린 모양이다…
	SETCOLOR DEF_COLOR("하트핑크")
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 【음란】을 얻었다
	TALENT:음란 = 1
	RESETCOLOR
	;욕망, 순종, 굴복각인の上昇による[억압][저항]の消滅を체크
	CALL YOKUBO_UP_CHECK, ARGS
	;堕とした人数. 既に연모だとなし
	SIF TALENT:연모 == 0
		FLAG:30 += 1
	CALL SETFLAG, "キャラ攻略"
CASE "매각価格"
	LOCAL = TARGET
	TARGET = ARG
	;CFLAG:41に能力による価値が代入される
	CALL CALC, "매각価格：능력"
	;CFLAG:42に殆ど変動のない소질による価値の倍率が代入される
	CALL CALC, "매각価格：基礎"
	;CFLAG:43に獲得or喪失しうる소질による価値の倍率が代入される
	CALL CALC, "매각価格：変動소질"
	;修正前の総合評価ポイント
	CFLAG:44 = CFLAG:41 / 100 * CFLAG:42 / 1000 * CFLAG:43 / 1000 * 100
	;倍々で増えないように価格を調整
	LOCAL:1 = CFLAG:44
	FOR LCOUNT, 0, 10
		LOCAL:2 = 100000 * POWER(10, LCOUNT)
		SIF LOCAL:1 <= LOCAL:2
			BREAK
		LOCAL:1 = (LOCAL:1 - LOCAL:2)/4 + LOCAL:2
	NEXT
	CFLAG:40 = LOCAL:1
	TARGET = LOCAL
CASE "바스트測りなおし"
	FOR LCOUNT, 1, CHARANUM
		IF TALENT:LCOUNT:거유
			BASE:LCOUNT:바스트 = 0
			BASE:LCOUNT:컵 = 0
		ENDIF
	NEXT
CASE "아이템플래그調整"
	VARSET ITEMSALES
	FOR LCOUNT, 0, 100
		SIF ITEMNAME:LCOUNT == "예비" || ITEMPRICE:LCOUNT == 0
			CONTINUE
		IF ITEM:LCOUNT <= 0
			ITEM:LCOUNT = 0
			ITEMSALES:LCOUNT = 1
		ENDIF
	NEXT
	;消耗아이템
	VARSET ITEMSALES, 1, 30, 50
	FOR LCOUNT, 30, 50
		SIF ITEMNAME:LCOUNT == "예비" || ITEMPRICE:LCOUNT == 0 || ITEM:LCOUNT >= 99
			ITEMSALES:LCOUNT = 0
	NEXT
	;보온병
	SIF ITEM:보온병 == 0
		ITEM:정액저축량 = 0
CASE "キャラ攻略"
	;CLEARの記録(상위몽마などにも個別対応)
	LOCAL = NO:TARGET + 1099
	IF !GETBIT(FLAG:LOCAL, CFLAG:8)
		SETBIT FLAG:LOCAL, CFLAG:8
		FLAG:31 += 1
	ENDIF
CASE "일반인상대の성행위初期설정"
	ADDCHARA 80
	PLAYER = CHARANUM-1
	CALL GET_EXABL, PLAYER
	CALL GET_EXTALENT, PLAYER
	SIF RAND:10 == 0
		TALENT:PLAYER:동정 = 0
	;정력セット
	MAXBASE:PLAYER:정력 = 10
	EJAC:PLAYER = 5000
	BASE:PLAYER:정력 = MAXBASE:PLAYER:정력
	BASE:PLAYER:절정 = 0
	ABL:PLAYER:ＬＶ = 1
	TEQUIP:넘어뜨리기 = 1
	;計算開始
	CALL SIMULATE_TRAIN_FIRST
CASE "일반인상대の성행위설정：상대が女"
	TALENT:PLAYER:남자 = 0
	TALENT:PLAYER:후타나리 = 0
	TALENT:PLAYER:여자 = 1

CASE "일반인상대の성행위종료"
	;경험や구슬などの獲得量計算
	CALL SIMULATE_TRAIN_CALC
	PLAYER = -1
	;結果発表
	SIF FLAG:8
		CALL SIMULATE_TRAIN_SHOW
	;表示されていたキャラを하양紙に戻す
	DELCHARA CHARANUM-1
	PLAYER = MASTER
	TEQUIP:넘어뜨리기 = 0
CASE "바스트설정"
	;속옷바스트の値には 신장*0.432 (～20代の平均値)を用いる. ただし, 웨스트이하にはならない. 
	;바스트の値は속옷바스트+바스트컵で算出する. 
	;AAA（5cm）, AA（7.5cm), A（10cm）, B（12.5cm）, C（15cm）, D（17.5cm）, E（20cm）, F（22.5cm）, G（25cm）, 
	;H（27.5cm), I（30cm), J（32.5cm), K（35cm), L（37.5cm), M（40cm), N（42.5cm), O（45cm)…… 
	;とだいたい2.5cm単位で컵が推移するものとする. 
	;ただし, 요정はそれぞれの値を半分とする. 

	;오토코노코の場合はAAAA컵とする
	IF TALENT:ARG:남자
		CALL CALC, "男乳化", ARG
	;초유(：31～38)
	ELSEIF TALENT:ARG:거유 >= 3
		CALL CALC, "초유化", ARG
	;폭유(：24～30)
	ELSEIF TALENT:ARG:거유 == 2
		CALL CALC, "폭유化", ARG
	;거유（E～ForGorH：19～23）
	ELSEIF TALENT:ARG:거유 == 1
		CALL CALC, "거유化", ARG
	;빈유（～A：～10）
	ELSEIF TALENT:ARG:빈유
		CALL CALC, "빈유化", ARG
	;보통（B～D:11～18）
	ELSE
		CALL CALC, "평유化", ARG
	ENDIF
CASE "바스트の소질설정"
	SELECTCASE BASE:ARG:컵
	CASE IS <= NUM("빈유の상한")
		TALENT:ARG:빈유 = 1
		TALENT:ARG:거유 = 0
	CASE IS <= NUM("평유の상한")
		TALENT:ARG:빈유 = 0
		TALENT:ARG:거유 = 0
	CASE IS <= NUM("거유の상한")
		TALENT:ARG:빈유 = 0
		TALENT:ARG:거유 = 1
	CASE IS <= NUM("폭유の상한")
		TALENT:ARG:빈유 = 0
		TALENT:ARG:거유 = 2
	CASEELSE
		TALENT:ARG:빈유 = 0
		TALENT:ARG:거유 = 3
	ENDSELECT
CASE "힙설정"
	TALENT:ARG:작은엉덩이 = 0
	TALENT:ARG:큰엉덩이 = 0
	;엉덩이の大きさ
	SELECTCASE COND("큰엉덩이", ARG)
	CASE IS >= 3
		TALENT:ARG:큰엉덩이 = 3
	CASE 2
		TALENT:ARG:큰엉덩이 = 2
	CASE 1
		TALENT:ARG:큰엉덩이 = 1
	CASEELSE
		SIF COND("작은엉덩이", ARG)
			TALENT:ARG:작은엉덩이 = 1
	ENDSELECT
CASE "페니스상세설정"
	SIF CONFIG("페니스상세설정") == 0
		RETURN 0
	FOR LCOUNT, 1, CHARANUM
		SIF TALENT:LCOUNT:페니스
			CONTINUE

		;부친が判明している場合には父の持ち物に倣う事が多い
		IF COND("부친", LCOUNT) > 0 && RAND:2
			LOCAL = COND("부친", LCOUNT)
			TALENT:LCOUNT:페니스 = TALENT:LOCAL:페니스
			;皮に関しては被り気味になりやすい
			;真性
			IF GETBIT(TALENT:LCOUNT:페니스, 12)
			;仮性
			ELSEIF GETBIT(TALENT:LCOUNT:페니스, 11)
				IF RAND:2
					CLEARBIT TALENT:LCOUNT:페니스, 11
					SETBIT TALENT:LCOUNT:페니스, 12
				ENDIF
			ELSEIF RAND:2
				SETBIT TALENT:LCOUNT:페니스, 11
			ENDIF
		;33%の확률で랜덤決定
		ELSEIF RAND:3 == 0
			;ひとまずは大きさLVをLOCALに入れる
			SELECTCASE RAND:100
			;大きさLV3
			CASE 99
				LOCAL = 3
			;大きさLV2
			CASE IS >= 70
				LOCAL = 2
			;大きさLV1
			CASE IS >= 10
				LOCAL = 1
			;大きさLV0
			CASEELSE
				LOCAL = 0
			ENDSELECT

			;외견연령が1だと1LV小さい
			SIF AGE(LCOUNT) == 1
				LOCAL -= 1
			;용의혈통持ちは大きい
			SIF TALENT:LCOUNT:용의혈통
				LOCAL += 2

			;大きさを対応するbitに変更
			SELECTCASE LOCAL
			CASE IS <= 0
				LOCAL = 1
			CASE 1
				LOCAL = 0
			ENDSELECT

			SETBIT TALENT:LCOUNT:페니스, LOCAL

			SELECTCASE RAND:10 + LOCAL
			CASE IS <= 2
			CASE 3 TO 8
				SETBIT TALENT:LCOUNT:페니스, 11
			CASEELSE
				SETBIT TALENT:LCOUNT:페니스, 12
			ENDSELECT
		ELSE
			IF COND("오토코노코", LCOUNT)
				LOCAL = 20
			ELSEIF TALENT:LCOUNT:남자
				LOCAL = 10
			;여자は후타나리になる가능性を考慮して후타나리の数値で설정しておく
			ELSE
				LOCAL = 0
			ENDIF

			IF GETBIT(FLAG:263, LOCAL + 3)
				IF TALENT:LCOUNT:용의혈통
					SETBIT TALENT:LCOUNT:페니스, 4
				ELSE
					SETBIT TALENT:LCOUNT:페니스, 3
				ENDIF
			ELSEIF GETBIT(FLAG:263, LOCAL + 2)
				IF TALENT:LCOUNT:용의혈통
					SETBIT TALENT:LCOUNT:페니스, 3
				ELSE
					SETBIT TALENT:LCOUNT:페니스, 2
				ENDIF
			ELSEIF GETBIT(FLAG:263, LOCAL + 1)
				IF TALENT:LCOUNT:용의혈통
					SETBIT TALENT:LCOUNT:페니스, 0
				ELSE
					SETBIT TALENT:LCOUNT:페니스, 1
				ENDIF
			ELSE
				IF TALENT:LCOUNT:용의혈통
					SETBIT TALENT:LCOUNT:페니스, 2
				ELSE
					SETBIT TALENT:LCOUNT:페니스, 0
				ENDIF
			ENDIF
			IF GETBIT(FLAG:263, LOCAL + 7)
				SETBIT TALENT:LCOUNT:페니스, 12
			ELSEIF GETBIT(FLAG:263, LOCAL + 6)
				SETBIT TALENT:LCOUNT:페니스, 11
			ENDIF
		ENDIF
	NEXT
CASE "유두の상세설정"
	;既に설정済みなら終了
	SIF TALENT:ARG:유두
		RETURN 0
	;유두の大きさ。基本的にはみんな普通…だけどおっぱい大きい方がでかくなりやすい
	SELECTCASE RANDF(11, BASE:ARG:식별번호) + RANDF(11, BASE:ARG:식별번호 + 1) + TALENT:ARG:거유 - TALENT:ARG:남자*2
	CASE IS >= 20
		SETBIT TALENT:ARG:유두, 2
	CASE IS >= 18
		SETBIT TALENT:ARG:유두, 1
	CASEELSE
		SETBIT TALENT:ARG:유두, 0
	ENDSELECT
	;陥没유두。基本的にはみんな陥没してない…これも거유ほどなりやすい。真性だと可哀そうかもしれないな
	SELECTCASE RANDF(11, BASE:ARG:식별번호 + 2) + RANDF(11, BASE:ARG:식별번호 + 3) + TALENT:ARG:거유*2 - TALENT:ARG:남자*3
	CASE IS >= 20
		;基本的には요정らないが특수な설정をする際の保険
		IF TALENT:ARG:니플피어스
			SETBIT TALENT:ARG:유두, 11
		ELSE
			SETBIT TALENT:ARG:유두, 12
		ENDIF
	CASE IS >= 16
		SETBIT TALENT:ARG:유두, 11
	CASEELSE
		SETBIT TALENT:ARG:유두, 10
	ENDSELECT
	;乳輪の大きさ。これまた基本的にはみんな普通…だけどおっぱい大きい方がでかくなりやすい
	SELECTCASE RANDF(11, BASE:ARG:식별번호 + 4) + RANDF(11, BASE:ARG:식별번호 + 5) + TALENT:ARG:거유*3 - TALENT:ARG:남자*2
	CASE IS >= 24
		SETBIT TALENT:ARG:유두, 23
	CASE IS >= 20
		SETBIT TALENT:ARG:유두, 22
	CASE IS >= 16
		SETBIT TALENT:ARG:유두, 21
	CASEELSE
		SETBIT TALENT:ARG:유두, 20
	ENDSELECT
CASE "음모と겨털"
	;음모の설정(컨피그ONで설정されてないとき)
	SIF CONFIG("음모と겨털") == 0
		RETURN 0
	;컨피그で生えない설정
	IF COND("음모の설정", ARG) == 0
		BASE:ARG:음모 = 100
		SIF CONFIG("겨털")
			BASE:ARG:겨털 = 100
		RETURN 0
	ENDIF
	;음모の初期설정
	IF BASE:ARG:음모 == 0
		;남자ならナチュラル
		IF TALENT:ARG:남자 && COND("오토코노코", ARG) == 0
			BASE:ARG:음모 = 600
		;마도인형or５％でパイパン
		ELSEIF TALENT:ARG:마도인형 || RAND:20 == 0
			BASE:ARG:음모 = 100
		;도착적なら, 稀にツルツル
		ELSEIF TALENT:ARG:도착적 && RAND:20 == 0
			BASE:ARG:음모 = 300
		;아이や小柄
		ELSEIF AGE(ARG) == 1 || (TALENT:ARG:작은몸집 && RAND:3)
			BASE:ARG:음모 = 400
			;小柄なら, 高확률でパイパン
			SIF TALENT:ARG:작은몸집 && RAND:5 == 0
				BASE:ARG:음모 = 100
		;보수적なら, お손入れに저항があったり
		ELSEIF TALENT:ARG:보수적 && RAND:10
			IF RAND:5
				BASE:ARG:음모 = 600
			ELSE
				BASE:ARG:음모 = 700
			ENDIF
		;食い込んでいる衣装の時or호색なら, 高확률でお손入れ済み
		ELSEIF CHECK_CLO("食い込み", ARG)
			BASE:ARG:음모 = 500
		ELSEIF TALENT:ARG:호색 && COND("몽마", ARG) && RAND:10
			BASE:ARG:음모 = 500
		ELSEIF TALENT:ARG:호색 && COND("몽마", ARG) == 0 && RAND:10 == 0
			BASE:ARG:음모 = 500
		ELSE
			BASE:ARG:음모 = 600
		ENDIF
	ENDIF
	;겨털の初期설정
	IF CONFIG("겨털") && BASE:ARG:겨털 == 0
		;남자なら処理しない
		IF TALENT:ARG:남자 && COND("오토코노코", ARG) == 0
			SELECTCASE AGE(ARG)
			CASE IS >= 4
				BASE:ARG:겨털 = 700
			CASE 3
				BASE:ARG:겨털 = 400
			CASEELSE
				BASE:ARG:겨털 = 100
			ENDSELECT
		;음모が無いなら겨털もありません
		ELSEIF BASE:ARG:음모 == 0 || RAND:20 == 0
			BASE:ARG:겨털 = 100
		;아이や소녀なら, 高확률で無毛orつるつる
		ELSEIF AGE(ARG) <= 2 || (TALENT:ARG:작은몸집 && RAND:3)
			SELECTCASE RAND:10 + (AGE(ARG) - 1)*6
			CASE IS <= 7
				BASE:ARG:겨털 = 100
			CASE 8
				BASE:ARG:겨털 = 400
			CASE 9 TO 13
				BASE:ARG:겨털 = 300
			CASE IS >= 14
				BASE:ARG:겨털 = 200
			ENDSELECT
		;보수적なら, お손入れに저항があったり
		ELSEIF TALENT:ARG:보수적 && RAND:10
			BASE:ARG:겨털 = 700
		;だらしない어른
		ELSEIF AGE(ARG) >= 4 && RAND:3 == 0
			BASE:ARG:겨털 = 700
		;보통は剃ります
		ELSE
			BASE:ARG:겨털 = 300
		ENDIF
		;호색or오토코노코なら超高확률で겨드랑이つるつる
		IF TALENT:ARG:호색 || COND("오토코노코", ARG)
			SELECTCASE RAND:100
			CASE IS <= 90
				BASE:ARG:겨털 = MIN(BASE:ARG:겨털, 300)
			CASE 91 TO 98
				BASE:ARG:겨털 = MIN(BASE:ARG:겨털, 200)
			ENDSELECT
		ENDIF
	ENDIF
CASE "음모と겨털の설정初期化"
	CVARSET BASE, 26, 0
	CVARSET BASE, 28, 0
	CVARSET CFLAG, 368, 0
	CVARSET CFLAG, 369, 0
CASE "조교지식선택" ,"조교지식の선택"
	PRINTL 
	PRINTFORM 현재 %조사처리(NAME:ARG,"는")% 
	IF TALENT:ARG:조교지식
		PRINTFORML [%TALENT_NAME(185, TALENT:ARG:조교지식, ARG)%]%조사만처리(TALENT_NAME(185, TALENT:ARG:조교지식, ARG),"를")% 몸에 익히고있습니다
	ELSE
		PRINTFORML 딱히 지식을 몸에 익히고 있지 않습니다.
	ENDIF
	PRINTFORML 어느 지식을 선택합니까?
	PRINTFORML （몸에 익히는 것은 이중 한개뿐. 이미 몸에 익히고 있는 경우에는 덮어씁니다）
	PRINTBUTTON @"%"[ 0] 봉사·애무지식", 24, LEFT%" , 0
    PRINTL 애무와 봉사행위를 할때 효과가 발휘됩니다
	PRINTBUTTON @"%"[ 1] 지도능숙", 24, LEFT%" , 1
    PRINTL 상대의 기술 향상을 도와줍니다
	PRINTBUTTON @"%"[ 2] ＳＭ플레이지식", 24, LEFT%" , 2
    PRINTL ＳＭ플레이 전반을 꿰고있음
	PRINTBUTTON @"%"[ 3] 애널플레이지식", 24, LEFT%" , 3
    PRINTL 애널을 사용한 행위 전반에 강함
	PRINTBUTTON @"%"[ 4] 성기확장지식", 24, LEFT%" , 4
    PRINTL 성기와 애널의 확장방법에 뛰어남
	PRINTBUTTON @"%"[ 5] 어른의장난감지식", 24, LEFT%" , 5
    PRINTL 도구를 사용하는 행위 전반에 뛰어남
	PRINTBUTTON @"%"[ 6] 노출플레이지식", 24, LEFT%" , 6
    PRINTL 부끄러운 모습을 보이는 일 전반에 대한 지식이 풍부함
	PRINTFORML [100] \@ TALENT:ARG:조교지식 ? 변경하지 않는다 # 익히지 않는다 \@
	PRINTFORML [200] 구체적인 설명을 본다
	CALL INPUT_SELECT, 7, 100, 200
	LOCAL = RESULT
	SELECTCASE LOCAL
	CASE 100
		RETURN 0
	CASE 200
		PRINTFORML ～봉사·애무지식～
		PRINTFORML 지식을 가지고 있는 측이 상대에게 봉사나 애무를 해서 주는 쾌감을 5할 증가시켜주고, 공포나 반감 등의 마이너스 패러미터 발생을 반감시켜줍니다.
		PRINTFORML 
		PRINTFORML ～지도능숙～
		PRINTFORML 지식을 갖고있는 측이 봉사받을 때 상대보다 기교 또는 해당하는 ～놀림 LV(컨닐링구스라면 혀놀림)이 높다면, 봉사하는 측이 획득하는 경험치를 １증가시켜 줍니다.
		PRINTFORML (상대가 펠라치오 실행시 플레이어가 지도능숙을 가지고 있고 기교나 혀놀림이 상대보다 높다면, 상대가 획득할 펠라경험이 １ 많아진다）
		PRINTFORML 또한, 상대가 획득할 봉사쾌락경험이 1.5배가 됩니다.
		PRINTFORML 
		PRINTFORML ～ＳＭ플레이지식～
		PRINTFORML 스팽킹 등의 ＳＭ플레이에 속하는 커맨드를 실행할 때 욕정이나 굴복 등의 패러미터를 5할 증가시켜주고, 공포나 반감 등의 마이너스 패러미터 발생을 반감시켜줍니다.
		PRINTFORML 또한, 상대가 획득할 가학쾌락경험과 고통쾌락경험이 1.5배가 됩니다.
		PRINTFORML 
		PRINTFORML ～애널플레이지식～
		PRINTFORML 상대의 애널을 괴롭히는 커맨드 실행시에 쾌Ａ와 욕정 등의 패러미터를 5할 증가시켜주고, 고통이나 반감 등의 마이너스 패러미터 발생을 반감시켜줍니다.
		PRINTFORML 
		PRINTFORML ～성기확장지식～
		PRINTFORML 상대의 성기와 애널에 페니스나 바이브를 삽입시킬때 고통과 공포를 반감시켜주고, 확장경험의 증가량을 조금 늘려줍니다.
		PRINTFORML 
		PRINTFORML ～어른의장난감지식～
		PRINTFORML 바이브 따위의 도구를 사용하는 커맨드를 실행할 때 쾌락이나 욕정 등의 패러미터를 5할 증가시켜주고, 공포나 반감 등의 마이너스 패러미터 발생을 반감시켜줍니다.
		PRINTFORML 단, 채찍과 구속구 등에  관해서는 ＳＭ플레이지식의 보너스보다 떨어집니다.
		PRINTFORML 
		PRINTFORML ～노출플레이지식～
		PRINTFORML 상대의 치정 패러미터를 항상 5할 증가시켜주고, 노출경험과 수치쾌락경험의 획득량을 증가시켜줍니다.
		PRINTFORML 또한, 치정 패러미터가 일정 이상일 때, 욕정이나 굴복 등의 패러미터를 5할 증가시켜주고, 공포나 반감 등의 마이너스 패러미터 발생을 반감시켜줍니다.
		WAIT
		RESTART
	CASEELSE
		IF TALENT_NAME(185, TALENT:ARG:조교지식) == TALENT_NAME(185, POWER(2, LOCAL) )
			PRINTFORMW 변경하지 않았습니다
			RETURN 0
		ELSE
			PRINTFORM ＜%조사처리(NAME:ARG,"는")% 
			SIF TALENT:ARG:조교지식
				PRINTFORM %TALENT_NAME(185, TALENT:ARG:조교지식, ARG)%를 얻었다, 
			TALENT:ARG:조교지식 = 0
			SETBIT TALENT:ARG:조교지식, LOCAL
			PRINTFORMW %TALENT_NAME(185, TALENT:ARG:조교지식, ARG)%를 얻었다＞

			SELECTCASE ARG
			CASE MASTER
				FLAG:240 = 7
			ENDSELECT
		ENDIF
	ENDSELECT
CASE "다방の복장"
	;FLAG:401のbitで제복を管理する
	;0～9は제복の種類
	;10～19は스커트のオプション
	;20～29は바니슈트など보디슈츠タイプのもののオプション
	;30～39はその他色々

	REDRAW 0

	PRINTFORML 다음 중에서 선택해주세요
	PRINTFORML (옵션을 선택하면 ＯＮ/ＯＦＦ가 전환됩니다)
	PRINTFORML 현재의 제복타입：%TEXTS("제복")%
	VARSET LOCALS
	LOCALS:0 = 웨이트리스
	LOCALS:1 = 메이드복
	LOCALS:2 = 무녀풍
	LOCALS:5 = 바니슈트
	SELECTCASE CONDS("다방：제복")
	CASE "웨이트리스", "메이드복"
		LOCALS:10 = 미니스커트
		LOCALS:11 = 롱
		LOCALS:30 = 캣가터
	CASE "무녀풍"
		LOCALS:10 = 미니스커트
		LOCALS:11 = 롱
	CASE "바니"
		LOCALS:20 = 가랑이에 지퍼
		LOCALS:30 = 캣가터
	ENDSELECT
	LOCAL = 0
	FOR LCOUNT, 0, 64
		SIF LOCALS:LCOUNT == ""
			CONTINUE
		SIF GETBIT(FLAG:401, LCOUNT)
			SETCOLOR DEF_COLOR("暗황색")
		PRINTFORMLC [{LCOUNT, 3}] \@ GETBIT(FLAG:401, LCOUNT) ? ○ # － \@ %LOCALS:LCOUNT%
		RESETCOLOR
		SELECTCASE LCOUNT%10
		CASE 2, 5, 8, 9
			PRINTL 
		CASEELSE
			SIF LOCALS:(LCOUNT+1) == ""
				PRINTL 
		ENDSELECT
	NEXT
	PRINTFORMLC [100] 이것으로 좋다

	CALL INPUT_SELECT, 101

	IF RESULT == 100
		IF COND("제복：웨이트리스")
			PRINTFORMW \@ COND("제복：캣가터") ? 허벅지의 캣가터는 물론, 전체적으로  # \@귀여움에 중점을 둔 제복입니다
		ELSEIF COND("제복：메이드복")
			PRINTFORMW 접대를 위한 의상의 결정판, 메이드복\@ COND("제복：캣가터") ? 에 세련된 캣가터을 합친 옷 # \@을 제복으로 합니다
		ELSEIF COND("제복：무녀풍")
			PRINTFORMW 홍백의 무녀복을 어레인지한 제복을 채용합니다
		ELSEIF COND("제복：바니")
			PRINTFORMW 에나멜 소재로 만들어진, 조금 야한 하이레그 바니슈트를 제복으로 정합니다
			PRINTFORMW 토끼귀는 물론, 나비넥타이와 커프스, 망사타이즈\@ COND("제복：캣가터") ? 와 결정타로 캣가터 # \@가 매우 세련된 의상입니다
		ENDIF
		IF COND("제복：미니스커트")
			PRINTFORMW 스커트를 아주 짧게 했습니다. 이건 분명히 팬티가 보일 수 밖에 없을겁니다…
		ELSEIF COND("제복：ロング")
			PRINTFORMW 스커트 부분이 상당히 길어서. 차분한 느낌입니다
		ENDIF
		IF COND("제복：파스너")
			PRINTFORMW 가랑이 부분에 교묘하게 숨겨진 지퍼를 준비했습니다. 여러가지로 편리합니다 
			PRINTFORMW 또한, 지급된 망사타이즈의 가랑이 부분도 틈새가 있습니다
		ENDIF
		REDRAW 1
		RETURN 0
	ELSEIF RESULT == 0
		FLAG:401 = CLEARBITS(FLAG:401, 0, 9)
		SETBIT FLAG:401, 0
		FLAG:401 = CLEARBITS(FLAG:401, 20, 29)
	ELSEIF RESULT == 1
		FLAG:401 = CLEARBITS(FLAG:401, 0, 9)
		SETBIT FLAG:401, 1
		FLAG:401 = CLEARBITS(FLAG:401, 20, 29)
	ELSEIF RESULT == 2
		FLAG:401 = CLEARBITS(FLAG:401, 0, 9)
		SETBIT FLAG:401, 2
		FLAG:401 = CLEARBITS(FLAG:401, 20, 29)
		FLAG:401 = CLEARBITS(FLAG:401, 30, 39)
	ELSEIF RESULT == 5
		FLAG:401 = CLEARBITS(FLAG:401, 0, 9)
		SETBIT FLAG:401, 5
		FLAG:401 = CLEARBITS(FLAG:401, 10, 11)
	ELSEIF RESULT == 10 && LOCALS:RESULT != ""
		INVERTBIT FLAG:401, 10
		SIF GETBIT(FLAG:401, 10)
			CLEARBIT FLAG:401, 11
	ELSEIF RESULT == 11 && LOCALS:RESULT != ""
		INVERTBIT FLAG:401, 11
		SIF GETBIT(FLAG:401, 11)
			CLEARBIT FLAG:401, 10
	ELSEIF RESULT == 20 && LOCALS:RESULT != ""
		INVERTBIT FLAG:401, 20
	ELSEIF RESULT == 30 && LOCALS:RESULT != ""
		INVERTBIT FLAG:401, 30
	ENDIF

	CLEARLINE LINECOUNT - MEMO_LINECOUNT
	RESTART

CASE "임신中：임신発覚直前"
	BASE:ARG:태아 = CLEARBITS(BASE:ARG:태아, 0, 10) + 1p6
CASE "임신中：임신発覚済み"
	BASE:ARG:태아 = CLEARBITS(BASE:ARG:태아, 0, 10) + 1p7
CASE "임신中：臨月"
	BASE:ARG:태아 = CLEARBITS(BASE:ARG:태아, 0, 10) + 1p8
CASE "임신中：分娩直前"
	BASE:ARG:태아 = CLEARBITS(BASE:ARG:태아, 0, 10) + 1p9
CASE "임신中：分娩"
	BASE:ARG:태아 = CLEARBITS(BASE:ARG:태아, 0, 10) + 1p10

CASE "임신中：아들"
	SETBIT BASE:ARG:태아, 20

CASE "육아중：育児종료"
	BASE:ARG:육아중 = CLEARBITS(BASE:ARG:육아중, 0, 10) + 1p6
CASE "육아중：아들"
	SETBIT BASE:ARG:육아중, 20
CASEELSE
	THROW %GAMEBASE_YEAR% Ver.{VER_ERASQN()} BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT


;-------------------------------------------------
;色々と計算する関数(#FUNCTIONではない)
;-------------------------------------------------
@CALC, ARGS, ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7, ARG:8, ARG:9, ARG:10, ARG:11, ARG:12, ARG:13, ARG:14, ARG:15, ARG:16, ARG:17, ARG:18, ARG:19, ARG:20, ARG:21, ARG:22
#DIM LCOUNT

SELECTCASE ARGS
CASE "체력회복"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET
	;상한突破しているときにはそのまま
	SIF BASE:(ARG:1):체력 > MAXBASE:(ARG:1):체력
		RETURN 0

	BASE:(ARG:1):체력 = MIN(BASE:(ARG:1):체력 + ARG, MAXBASE:(ARG:1):체력)
CASE "체력회복상한무시"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET
	BASE:(ARG:1):체력 += ARG
;시간経過の際など
CASE "체력회복상한まで"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET

	BASE:(ARG:1):체력 = MIN(BASE:(ARG:1):체력 + ARG, MAXBASE:(ARG:1):체력)

CASE "기력회복"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET
	;상한突破しているときにはそのまま
	SIF BASE:(ARG:1):기력 > MAXBASE:(ARG:1):기력
		RETURN 0

	BASE:(ARG:1):기력 = MIN(BASE:(ARG:1):기력 + ARG, MAXBASE:(ARG:1):기력)
CASE "기력회복상한무시"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET
	BASE:(ARG:1):기력 += ARG
CASE "기력회복상한まで"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET

	BASE:(ARG:1):기력 = MIN(BASE:(ARG:1):기력 + ARG, MAXBASE:(ARG:1):기력)

CASE "정력회복"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET
	;상한突破しているときにはそのまま
	SIF BASE:(ARG:1):정력 > MAXBASE:(ARG:1):정력
		RETURN 0

	BASE:(ARG:1):정력 = MIN(BASE:(ARG:1):정력 + ARG, MAXBASE:(ARG:1):정력)
;これは面倒なことが起きるので基本封印
CASE "정력회복상한무시"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET
	BASE:(ARG:1):정력 += ARG
CASE "정력회복상한まで"
	SIF ARG:1 < 0
		RETURN 0
	SIF ARG:1 == 0 && TARGET > 0
		ARG:1 = TARGET

	BASE:(ARG:1):정력 = MIN(BASE:(ARG:1):정력 + ARG, MAXBASE:(ARG:1):정력)

CASE "랜덤선택"
	IF ARG == 0
		LOCAL = 0
		LOCAL:1 = 0
	ELSEIF RAND:(LOCAL:1) == 0 || ARG:1
		LOCAL = ARG
	ENDIF
	LOCAL:1 += 1
	RETURN LOCAL
CASE "팬티플래그추가"
	TCVAR:26 = 0
	EQUIP:팬티 |= ARG
CASE "브래지어플래그추가"
	TCVAR:26 = 0
	EQUIP:브래지어 |= ARG
CASE "웃옷플래그추가"
	TCVAR:26 = 0
	EQUIP:웃옷 |= ARG
CASE "스커트플래그추가"
	TCVAR:26 = 0
	EQUIP:스커트 |= ARG
CASE "보디슈츠플래그추가"
	TCVAR:26 = 0
	EQUIP:보디슈츠 |= ARG
CASE "겉옷플래그추가"
	TCVAR:26 = 0
	EQUIP:겉옷 |= ARG
CASE "양말플래그추가"
	TCVAR:26 = 0
	EQUIP:양말 |= ARG
CASE "신발플래그추가"
	TCVAR:26 = 0
	EQUIP:신발 |= ARG
CASE "장갑플래그추가"
	TCVAR:26 = 0
	EQUIP:장갑 |= ARG
CASE "조교소스"
	FOR LCOUNT, 0, 20
		SOURCE:LCOUNT += ARG:LCOUNT * ARG:22 / 100
	NEXT
	DOWNBASE:체력 += ARG:20 * ARG:22 / 100
	DOWNBASE:기력 += ARG:21 * ARG:22 / 100
CASE "경험취득"
	;ARG:1に２이상の数字が代入されている場合には獲得경험をARG:1倍する
	;増加前の경험を記録
	FOR LCOUNT, 0, 100
		LOCAL:LCOUNT = EXP:LCOUNT
		LOCAL:(LCOUNT + 100) = EXP:PLAYER:LCOUNT
	NEXT

	;역조교커맨드
	SELECTCASE ARG
	CASE 106, 107, 120 TO 129
		SWAP TARGET, PLAYER
	CASE 304, 305
		;역용간
		SIF TEQUIP:넘어뜨리기 || TEQUIP:PLAYER:넘어뜨리기
			SWAP TARGET, PLAYER
	ENDSELECT

	SELECTCASE ARG
	CASE 0
		IF CHECK_COM("키스")
			EXP:키스경험 += 1
			EXP:PLAYER:키스경험 += 1
		ENDIF
		EXP:PLAYER:수음경험 += 1
		IF CHECK_COM("로션마사지", ARG)
			EXP:Ａ경험 += 1
			EXP:PLAYER:Ａ자극경험 += 1
		ENDIF
	CASE 1
		EXP:PLAYER:커닐링구스경험 += 1
	CASE 2
		EXP:Ａ경험 += 1
		EXP:PLAYER:수음경험 += 1
		EXP:PLAYER:Ａ자극경험 += 1
	CASE 3
		EXP:자위경험 += 1
		;ビデオ촬영時, 관내노출時, 야외플레이では경험にプラス
		SIF TEQUIP:관내노출플레이 || TEQUIP:비디오카메라 || TEQUIP:야외플레이
			EXP:자위경험 += 1
		;미약
		SIF TEQUIP:미약
			EXP:자위경험 += 1
		;절정したのなら, 경험に보너스
		SIF NOWEX:절정수합계
			EXP:자위경험 += 1
		SIF GETBIT(CHECK_ONANIE(ARG), 1)
			EXP:Ｖ경험 += 1
		SIF GETBIT(CHECK_ONANIE(ARG), 2)
			EXP:Ａ경험 += 1
	CASE 4
		EXP:PLAYER:펠라경험 += 1
		IF TEQUIP:넘어뜨리기
			EXP:PLAYER:목성교경험 += 1
			EXP:허리사용경험 += 1
		ENDIF
	CASE 5
		EXP:PLAYER:수음경험 += 1
	;키스と멜티키스
	CASE 6, 311
		EXP:키스경험 += 1
		EXP:PLAYER:키스경험 += 1
	CASE 7
		IF PREVCOM == 6
			EXP:키스경험 += 1
			EXP:PLAYER:키스경험 += 1
		ENDIF
		EXP:PLAYER:수음경험 += 1
	CASE 8
		EXP:Ｖ경험 += 1
		EXP:PLAYER:수음경험 += 1
	CASE 9
		EXP:Ａ경험 += 1
		EXP:PLAYER:Ａ자극경험 += 1
		EXP:PLAYER:A핥기경험 += 1
	CASE 10
		EXP:PLAYER:수음경험 += 1
		SIF INSERT("요도인서트", TARGET, PLAYER)
			EXP:PLAYER:자위경험 += 1
	CASE 11
		EXP:PLAYER:파이즈리경험 += 1
	CASE 12
		EXP:PLAYER:풋잡경험 += 1
	CASE 13, 14
		EXP:노출경험 += 1
		;ビデオ촬영, 관내노출, 야외플레이は경험等にプラス
		SIF TEQUIP:비디오카메라
			EXP:노출경험 += 1
		SIF TEQUIP:관내노출플레이 || TEQUIP:야외플레이
			EXP:노출경험 += 1
		SIF COND("両穴くぱぁ")
			EXP:노출경험 += 1
	CASE 15
		EXP:요도경험 += 1
		;指を動かしても大丈夫になるサイズまでは拡張
		IF SIZE("손가락の直径", PLAYER) > MIN_STR(CONDS("요도확장度") )
			CALL SETFLAG, "요도확장", SIZE("손가락の直径", PLAYER), TARGET
		ELSEIF SIZE("손가락の直径", PLAYER)*4/3 > MIN_STR(CONDS("요도확장度") )
			CALL SETFLAG, "요도확장", MIN_STR(CONDS("요도확장度") ) + 1, TARGET
		ENDIF
		EXP:PLAYER:요도고문경험 += 1
	CASE 31, 106, 201
		EXP:Ｖ경험 += 1
		IF TEQUIP:바이브
			;大きいと경험보너스
			SIF SIZE("바이브", TARGET) >= 3
				EXP:Ｖ경험 += 1
			IF SIZE("바이브", TARGET) >= MAX(ABL:Ｖ확장 - 1, 2)
				EXP:Ｖ경험 += SIZE("바이브", TARGET) - ABL:Ｖ확장 + 1
				CALL SETFLAG, "Ｖ확장", SIZE("바이브", TARGET), HARD("바이브", TARGET)
			ENDIF
			IF ARG == 201
				CALL SETFLAG, "Ｖ受け入れ바이브", SIZE("바이브", TARGET), TARGET, -5
			ELSE
				CALL SETFLAG, "Ｖ受け入れ바이브", SIZE("바이브", TARGET)
			ENDIF
		ENDIF
	CASE 33, 107, 202
		EXP:PLAYER:Ａ자극경험 += 1
		EXP:Ａ경험 += 1
		IF TEQUIP:애널바이브
			;大きいと경험보너스
			IF SIZE("Ａ바이브", TARGET) >= 3
				EXP:Ａ경험 += 1
				EXP:PLAYER:Ａ자극경험 += 1
			ENDIF
			IF SIZE("Ａ바이브", TARGET) >= MAX(ABL:Ａ확장 - 1, 2)
				EXP:Ａ경험 += SIZE("Ａ바이브", TARGET) - ABL:Ａ확장 + 1
				CALL SETFLAG, "Ａ확장", SIZE("Ａ바이브", TARGET), HARD("Ａ바이브", TARGET)
			ENDIF
			IF ARG == 202
				CALL SETFLAG, "Ａ受け入れ바이브", SIZE("Ａ바이브", TARGET), TARGET, -5
			ELSE
				CALL SETFLAG, "Ａ受け入れ바이브", SIZE("Ａ바이브", TARGET)
			ENDIF
		ENDIF
	CASE 39
		EXP:Ｖ경험 += 1
	CASE 60 TO 69, 177, 120 TO 124
		EXP:Ｖ경험 += 1
		IF PENIS(PLAYER)
			EXP:Ｖ성교경험 += 1
			EXP:PLAYER:Ｖ삽입경험 += 1
			;大きいと경험보너스
			IF SIZE("페니스", PLAYER) >= 2
				EXP:Ｖ경험 += 1
				EXP:Ｖ성교경험 += 1
			ENDIF
		ENDIF
		IF SIZE("페니스", PLAYER) >= MAX(ABL:Ｖ확장 + 1, 2)
			EXP:Ｖ경험 += SIZE("페니스", PLAYER) - ABL:Ｖ확장
			CALL SETFLAG, "Ｖ확장", SIZE("페니스", PLAYER), HARD("페니스", PLAYER)
		ENDIF

		CALL SETFLAG, "Ｖ受け入れ페니스", SIZE("페니스", PLAYER)

		SELECTCASE ARG
		CASE 63
			SIF TALENT:연모 && CHECK_COM("키스")
				EXP:키스경험 += 1
		CASE 65, 122
			EXP:허리사용경험 += 1
		CASE 66
			EXP:Ｖ경험 += 1
			SIF PENIS(PLAYER)
				EXP:Ｖ성교경험 += 1
		CASE 67
			EXP:Ｖ경험 += 1
			EXP:자궁경험 += 1
			SIF PENIS(PLAYER)
				EXP:Ｖ성교경험 += 1
		CASE 68
			EXP:자궁경험 += 2
			EXP:자궁간경험 += 1
		ENDSELECT
		SIF TEQUIP:넘어뜨리기 == 0
			EXP:PLAYER:허리사용경험 += 1
	CASE 70 TO 79, 125 TO 129
		EXP:Ａ경험 += 1
		EXP:PLAYER:Ａ자극경험 += 1
		IF PENIS(PLAYER)
			EXP:Ａ성교경험 += 1
			EXP:PLAYER:Ａ삽입경험 += 1
			;大きいと경험보너스
			IF SIZE("페니스", PLAYER) >= 2
				EXP:Ａ경험 += 1
				EXP:Ａ성교경험 += 1
				EXP:PLAYER:Ａ자극경험 += 1
			ENDIF
		ENDIF
		IF SIZE("페니스", PLAYER) >= MAX(ABL:Ａ확장 + 1, 2)
			EXP:Ａ경험 += SIZE("페니스", PLAYER) - ABL:Ａ확장
			CALL SETFLAG, "Ａ확장", SIZE("페니스", PLAYER), HARD("페니스", PLAYER)
		ENDIF

		CALL SETFLAG, "Ａ受け入れ페니스", SIZE("페니스", PLAYER)

		SELECTCASE ARG
		CASE 73
			SIF TALENT:연모 && CHECK_COM("키스")
				EXP:키스경험 += 1
		CASE 75, 127
			EXP:허리사용경험 += 1
		ENDSELECT

		SIF TEQUIP:넘어뜨리기 == 0
			EXP:PLAYER:허리사용경험 += 1
	CASE 80
		EXP:허리사용경험 += 1
		EXP:PLAYER:허리사용경험 += 1
		IF CHECK_COM("쌍두바이브플레이")
			EXP:Ｖ경험 += 1
			IF SIZE("바이브", TARGET) >= MAX(ABL:Ｖ확장 - 1, 2)
				EXP:Ｖ경험 += SIZE("바이브", TARGET) - ABL:Ｖ확장
				CALL SETFLAG, "Ｖ확장", SIZE("바이브", TARGET), HARD("바이브", TARGET)
			ENDIF
			SWAP TARGET, PLAYER
			EXP:Ｖ경험 += 1
			IF SIZE("바이브", PLAYER) >= MAX(ABL:Ｖ확장 - 1, 2)
				EXP:Ｖ경험 += SIZE("바이브", PLAYER) - ABL:Ｖ확장
				CALL SETFLAG, "Ｖ확장", SIZE("바이브", PLAYER), HARD("바이브", TARGET)
			ENDIF
			SWAP TARGET, PLAYER
		ENDIF
	CASE 81
		EXP:PLAYER:수음경험 += 1
		EXP:PLAYER:허리사용경험 += 1
	CASE 82
		EXP:Ｂ성교경험 += 1
		EXP:PLAYER:Ｂ삽입경험 += 1
		IF TEQUIP:넘어뜨리기
			EXP:파이즈리경험 += 1
		ELSE
			EXP:PLAYER:허리사용경험 += 1
		ENDIF
	CASE 83
		EXP:요도경험 += 1
		EXP:요도성교경험 += 1
		;動かしても大丈夫になるサイズまでは拡張
		IF SIZE("페니스の直径", PLAYER) > MIN_STR(CONDS("요도확장度") )
			CALL SETFLAG, "요도확장", SIZE("페니스の直径", PLAYER), TARGET
		ELSEIF SIZE("페니스の直径", PLAYER)*4/3 > MIN_STR(CONDS("요도확장度") )
			CALL SETFLAG, "요도확장", MIN_STR(CONDS("요도확장度") ) + 1, TARGET
		ENDIF
		EXP:PLAYER:요도삽입경험 += 1
		EXP:PLAYER:요도고문경험 += 1
	CASE 92, 104
		IF CHECK_COM("파이즈리펠라", ARG)
			EXP:펠라경험 += 1
		ELSEIF CHECK_COM("파후파후손훑기", ARG)
			EXP:수음경험 += 1
		ENDIF
		EXP:파이즈리경험 += 1
	CASE 90, 97
		;특수커맨드
		IF CHECK_COM("손훑기펠라", ARG)
			EXP:펠라경험 += 1
		ELSEIF CHECK_COM("Ａ자극손훑기", ARG)
			EXP:Ａ자극경험 += 1
			EXP:A핥기경험 += 1
			EXP:PLAYER:Ａ경험 += 1
		ELSEIF CHECK_COM("파후파후손훑기", ARG)
			EXP:파이즈리경험 += 1
		ENDIF
		EXP:수음경험 += 1
	CASE 91, 208
		;특수커맨드
		IF CHECK_COM("손훑기펠라", ARG)
			EXP:수음경험 += 1
		ELSEIF CHECK_COM("파이즈리펠라", ARG)
			EXP:파이즈리경험 += 1
		ENDIF
		EXP:펠라경험 += 1
		SIF ARG == 208
			EXP:펠라경험 += 1
		SIF TEQUIP:딥스로트
			EXP:목성교경험 += 1
	CASE 93
		EXP:허리사용경험 += 1
	CASE 95
		EXP:풋잡경험 += 1
	CASE 96
		SIF CHECK_COM("Ａ자극손훑기", ARG)
			EXP:수음경험 += 1
		EXP:Ａ자극경험 += 1
		EXP:A핥기경험 += 1
		EXP:PLAYER:Ａ경험 += 1
	CASE 98
		EXP:커닐링구스경험 += 1
	CASE 99
		;@GET_EXP_COMで특수な処理をするため, ここには通常は来ない
		IF PENIS(PLAYER)
			EXP:펠라경험 += 1
		ELSE
			EXP:커닐링구스경험 += 1
		ENDIF
		IF PENIS(TARGET)
			EXP:PLAYER:펠라경험 += 1
		ELSE
			EXP:PLAYER:커닐링구스경험 += 1
		ENDIF
	CASE 133
		SIF TEQUIP:아이마스크
			EXP:긴박경험 += 2
	CASE 134
		SIF TEQUIP:구속
			EXP:긴박경험 += 5
	CASE 135
		SIF TEQUIP:재갈
			EXP:긴박경험 += 2
	CASE 136
		EXP:PLAYER:Ａ자극경험 += 5
		IF TEQUIP:관장
			EXP:Ａ경험 += 2
			EXP:관장경험 += 1
			EXP:긴박경험 += 2
		ENDIF
	CASE 137
		IF TEQUIP:확장벌룬 == 1
			EXP:Ｖ경험 += 2
			EXP:Ｖ확장경험 += 2
			CALL SETFLAG, "Ｖ受け入れ플러그", ABL:Ｖ확장 + 1
		ELSEIF TEQUIP:확장벌룬 == 2
			EXP:PLAYER:Ａ자극경험 += 2
			EXP:Ａ경험 += 2
			EXP:Ａ확장경험 += 2
			CALL SETFLAG, "Ａ受け入れ플러그", ABL:Ａ확장 + 1
		ENDIF
	CASE 138
		EXP:PLAYER:방뇨경험 += 1
		IF CHECK_COM("입内방뇨", ARG)
			SIF PENIS(PLAYER) == 0
				EXP:PLAYER:성수경험 += 1
			EXP:음뇨경험 += 1
		ELSEIF CHECK_COM("자궁内방뇨", ARG)
			EXP:자궁욕뇨경험 += 1
		ELSEIF CHECK_COM("질内방뇨", ARG)
			EXP:질내욕뇨경험 += 1
		ELSEIF CHECK_COM("온천관장", ARG)
			EXP:관장경험 += 1
			EXP:온천관장경험 += 1
			EXP:PLAYER:Ａ자극경험 += 2
		ELSEIF CHECK_COM("유内방뇨", ARG)
			EXP:유내욕뇨경험 += 1
		ELSEIF CHECK_COM("방광内방뇨", ARG)
			EXP:수뇨경험 += 1
		ENDIF
	CASE 140
		EXP:펠라경험 += 1
		EXP:목성교경험 += 1
		SIF TEQUIP:딥스로트
			EXP:목성교경험 += 1
		EXP:PLAYER:허리사용경험 += 1
	CASE 141 TO 143
		IF ARG == 141 || ARG == 143
			EXP:Ｖ경험 += 5
			IF SIZE("피스트", PLAYER) >= ABL:Ｖ확장 - 1
				EXP:Ｖ경험 += SIZE("피스트", TARGET) - ABL:Ｖ확장 + 1
				CALL SETFLAG, "Ｖ확장", SIZE("피스트", PLAYER), HARD("피스트", PLAYER)
			ENDIF
			SIF SIZE("피스트", PLAYER) >= 3
				EXP:Ｖ피스트경험 += 1
			CALL SETFLAG, "Ｖ受け入れ피스트", SIZE("피스트", PLAYER)
		ENDIF
		IF ARG == 142 || ARG == 143
			EXP:PLAYER:Ａ자극경험 += 5
			EXP:Ａ경험 += 5
			IF SIZE("피스트", PLAYER) >= ABL:Ａ확장 - 1
				EXP:Ａ경험 += SIZE("피스트", PLAYER) - ABL:Ａ확장 + 1
				CALL SETFLAG, "Ａ확장", SIZE("피스트", PLAYER), HARD("피스트", PLAYER)
			ENDIF
			SIF SIZE("피스트", PLAYER) >= 3
				EXP:Ａ피스트경험 += 1
			CALL SETFLAG, "Ａ受け入れ피스트", SIZE("피스트", PLAYER)
		ENDIF
		EXP:PLAYER:수음경험 += 1
	CASE 144
		EXP:방뇨경험 += 1
	CASE 145
		EXP:노출경험 += 2
		;ビデオ촬영, 관내노출, 야외플레이は경험等にプラス
		SIF TEQUIP:비디오카메라
			EXP:노출경험 += 1
		SIF TEQUIP:관내노출플레이 || TEQUIP:야외플레이
			EXP:노출경험 += 1
		EXP:제모경험 += 1
	CASE 147
		EXP:정액경험 += TFLAG:16 * 3
		ITEM:정액저축량 -= TFLAG:16
		SIF FLAG:8
			PRINTFORML 보온병안의정액잔량：{ITEM:정액저축량}
	CASE 149
		IF TEQUIP:카테터
			EXP:요도경험 += 1
			EXP:PLAYER:요도고문경험 += 1
		ENDIF
	CASE 150
		IF TEQUIP:딥스로트
			EXP:펠라경험 += 1
			EXP:목성교경험 += 1
		ENDIF
	CASE 151
		IF TEQUIP:요도확장기
			;連続実行（요도확장の方は, 飛んだ後で増加する処理アリ）
			IF PREVCOM == SELECTCOM
				EXP:요도경험 += 1 + (ABL:PLAYER:새드끼 + 1)/2
				EXP:노출경험 += 1 + (ABL:PLAYER:새드끼 + 1)/2
				EXP:PLAYER:요도고문경험 += 1 + (ABL:PLAYER:새드끼 + 1)/2
			ENDIF

			EXP:요도경험 += 1
			CALL SETFLAG, "요도확장", TEQUIP:요도확장기, TARGET
			EXP:PLAYER:요도고문경험 += 1

			EXP:노출경험 += 1
			SIF TEQUIP:비디오카메라
				EXP:노출경험 += 1
		ENDIF
	CASE 160
		EXP:PLAYER:허리사용경험 += 1
		EXP:ASSI:Ｖ경험 += 1
		EXP:ASSI:허리사용경험 += 1
		IF PENIS(PLAYER)
			EXP:PLAYER:Ｖ삽입경험 += 1
			EXP:ASSI:Ｖ성교경험 += 1
		ENDIF
		CALL SETFLAG, "Ｖ受け入れ페니스", SIZE("페니스", PLAYER), ASSI, PLAYER
	CASE 161
		EXP:허리사용경험 += 1
		EXP:ASSI:Ｖ경험 += 1
		IF PENIS(TARGET)
			EXP:Ｖ삽입경험 += 1
			EXP:ASSI:Ｖ성교경험 += 1
		ENDIF
		CALL SETFLAG, "Ｖ受け入れ페니스", SIZE("페니스", TARGET), ASSI, TARGET
	CASE 162
		EXP:ASSI:펠라경험 += 1
	CASE 210
		SIF TEQUIP:촉수구욕
			EXP:펠라경험 += 1
		IF TEQUIP:바이브
			EXP:Ｖ경험 += 1
			;大きいと경험보너스
			SIF SIZE("바이브", TARGET) >= 3
				EXP:Ｖ경험 += 1
			IF SIZE("바이브", TARGET) >= MAX(ABL:Ｖ확장 - 1, 2)
				EXP:Ｖ경험 += SIZE("바이브", TARGET) - ABL:Ｖ확장 + 1
				CALL SETFLAG, "Ｖ확장", SIZE("바이브", TARGET), HARD("바이브", TARGET)
			ENDIF
		ENDIF
		IF TEQUIP:애널바이브
			EXP:Ａ경험 += 1
			;大きいと경험보너스
			SIF SIZE("Ａ바이브", TARGET) >= 3
				EXP:Ａ경험 += 1
			IF SIZE("Ａ바이브", TARGET) >= MAX(ABL:Ａ확장 - 1, 2)
				EXP:Ａ경험 += SIZE("Ａ바이브", TARGET) - ABL:Ａ확장 + 1
				CALL SETFLAG, "Ａ확장", SIZE("Ａ바이브", TARGET), HARD("바이브", TARGET)
			ENDIF
		ENDIF
	CASE 260
		IF CHECK_COM("로션마사지", ARG)
			EXP:PLAYER:수음경험 += 1
			EXP:Ａ경험 += 1
			EXP:PLAYER:Ａ자극경험 += 1
		ENDIF
	CASE 261
		SIF TEQUIP:미약
			EXP:미약경험 += MAX(TEQUIP:미약/100, 1)
		SIF TEQUIP:PLAYER:미약
			EXP:PLAYER:미약경험 += MAX(TEQUIP:PLAYER:미약/100, 1)
	CASE 282
		EXP:PLAYER:자위경험 += 1
	CASE 303
		EXP:긴박경험 += 5
	CASE 304
		EXP:Ｖ경험 += 3
		EXP:Ｖ성교경험 += 3
		IF SIZE("드래곤") >= ABL:Ｖ확장 - 1
			EXP:Ｖ경험 += SIZE("드래곤") - ABL:Ｖ확장 + 1
			CALL SETFLAG, "Ｖ확장", SIZE("드래곤"), HARD("드래곤")
		ENDIF
		EXP:Ｖ용간경험 += 1
		CALL SETFLAG, "Ｖ受け入れ페니스", SIZE("드래곤"), TARGET, -3
	CASE 305
		EXP:Ａ경험 += 3
		EXP:Ａ성교경험 += 3
		IF SIZE("드래곤") >= ABL:Ａ확장 - 1
			EXP:Ａ경험 += SIZE("드래곤") - ABL:Ａ확장 + 1
			CALL SETFLAG, "Ａ확장", SIZE("드래곤"), HARD("드래곤")
		ENDIF
		EXP:Ａ용간경험 += 1
		CALL SETFLAG, "Ａ受け入れ페니스", SIZE("드래곤"), TARGET, -3
	CASE 307
		EXP:Ｖ경험 += 1
		EXP:슬라임경험 += 1
	CASE 308
		EXP:PLAYER:Ａ자극경험 += 1
		EXP:Ａ경험 += 1
		EXP:슬라임경험 += 1
	ENDSELECT

	;역조교커맨드
	SELECTCASE ARG
	CASE 106, 107, 120 TO 129
		SWAP TARGET, PLAYER
	CASE 304, 305
		;역용간
		SIF TEQUIP:넘어뜨리기 || TEQUIP:PLAYER:넘어뜨리기
			SWAP TARGET, PLAYER
	ENDSELECT

	;조교지식による경험獲得の보너스
	IF TEQUIP:넘어뜨리기 == 0 && MARK:반발각인 < 3
		SELECTCASE TALENT_NAME(185, TALENT:PLAYER:조교지식, PLAYER)
		CASE "조교지식(지도능숙)"
			SIF EXP:펠라경험 > LOCAL:22 && (ABL:PLAYER:혀놀림 > ABL:혀놀림 || ABL:PLAYER:기교 > ABL:기교)
				EXP:펠라경험 += 1
			SIF EXP:수음경험 > LOCAL:23 && (ABL:PLAYER:손가락놀림 > ABL:손가락놀림 || ABL:PLAYER:기교 > ABL:기교)
				EXP:수음경험 += 1
			SIF EXP:풋잡경험 > LOCAL:24 && (ABL:PLAYER:발놀림 > ABL:발놀림 || ABL:PLAYER:기교 > ABL:기교)
				EXP:풋잡경험 += 1
			SIF EXP:허리사용경험 > LOCAL:25 && (ABL:PLAYER:허리놀림 > ABL:허리놀림 || ABL:PLAYER:기교 > ABL:기교)
				EXP:허리사용경험 += 1
			SIF EXP:파이즈리경험 > LOCAL:26 && (ABL:PLAYER:마유 > ABL:마유 || ABL:PLAYER:기교 > ABL:기교)
				EXP:파이즈리경험 += 1
			SIF EXP:Ａ자극경험 > LOCAL:27 && ABL:PLAYER:기교 > ABL:기교
				EXP:Ａ자극경험 += 1
			SIF EXP:커닐링구스경험 > LOCAL:28 && (ABL:PLAYER:혀놀림 > ABL:혀놀림 || ABL:PLAYER:기교 > ABL:기교)
				EXP:커닐링구스경험 += 1
			SIF EXP:키스경험 > LOCAL:70 && (ABL:PLAYER:혀놀림 > ABL:혀놀림 || ABL:PLAYER:기교 > ABL:기교)
				EXP:키스경험 += 1
		CASE "조교지식(노출플레이)"
			SIF EXP:노출경험 > LOCAL:34
				EXP:노출경험 += 1
			SIF EXP:PLAYER:노출경험 > LOCAL:134
				EXP:PLAYER:노출경험 += 1
		ENDSELECT

		IF ASSI && PLAYER == MASTER
			SELECTCASE TALENT_NAME(185, TALENT:ASSI:조교지식, ASSI)
			CASE "조교지식(노출플레이)"
				SIF EXP:노출경험 > LOCAL:34
					EXP:노출경험 += 1
			ENDSELECT
		ENDIF

		SELECTCASE TALENT_NAME(185, TALENT:조교지식, TARGET)
		CASE "조교지식(지도능숙)"
			SIF EXP:PLAYER:펠라경험 > LOCAL:122 && (ABL:PLAYER:혀놀림 < ABL:혀놀림 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:펠라경험 += 1
			SIF EXP:PLAYER:수음경험 > LOCAL:123 && (ABL:PLAYER:손가락놀림 < ABL:손가락놀림 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:수음경험 += 1
			SIF EXP:PLAYER:풋잡경험 > LOCAL:124 && (ABL:PLAYER:발놀림 < ABL:발놀림 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:풋잡경험 += 1
			SIF EXP:PLAYER:허리사용경험 > LOCAL:125 && (ABL:PLAYER:허리놀림 < ABL:허리놀림 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:허리사용경험 += 1
			SIF EXP:PLAYER:파이즈리경험 > LOCAL:126 && (ABL:PLAYER:마유 < ABL:마유 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:파이즈리경험 += 1
			SIF EXP:PLAYER:Ａ자극경험 > LOCAL:127 && ABL:PLAYER:기교 < ABL:기교
				EXP:PLAYER:Ａ자극경험 += 1
			SIF EXP:PLAYER:커닐링구스경험 > LOCAL:128 && (ABL:PLAYER:혀놀림 < ABL:혀놀림 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:커닐링구스경험 += 1
			SIF EXP:PLAYER:키스경험 > LOCAL:170 && (ABL:PLAYER:혀놀림 < ABL:혀놀림 || ABL:PLAYER:기교 < ABL:기교)
				EXP:PLAYER:키스경험 += 1
		CASE "조교지식(노출플레이)"
			SIF EXP:노출경험 > LOCAL:34
				EXP:노출경험 += 1
			SIF EXP:PLAYER:노출경험 > LOCAL:134
				EXP:PLAYER:노출경험 += 1
		ENDSELECT
	ENDIF

	;レズ, BL경험増加
	IF TALENT:남자 == 0 && TALENT:PLAYER:남자 == 0
		EXP:레즈경험 += CALCF("レズ・ＢＬ度", ARG)
		EXP:PLAYER:레즈경험 += CALCF("レズ・ＢＬ度", ARG)
	ELSEIF TALENT:남자 && TALENT:PLAYER:남자
		EXP:ＢＬ경험 += CALCF("レズ・ＢＬ度", ARG)
		EXP:PLAYER:ＢＬ경험 += CALCF("レズ・ＢＬ度", ARG)
	ENDIF
	;조교자が소질『구지배자의자취』を所持している場合촉수경험＋1
	SIF TALENT:PLAYER:구지배자의자취
		EXP:촉수경험 += 1

	;ARG:1に２이상の数字が代入されている場合には獲得경험をARG:1倍する
	SELECTCASE ARG:1
	CASE IS >= 2
		FOR LCOUNT, 0, 100
			SELECTCASE LCOUNT
			;増えない경험
			CASE 64, 65
			CASEELSE
				EXP:LCOUNT += (EXP:LCOUNT - LOCAL:LCOUNT) * (ARG:1 - 1)
				EXP:PLAYER:LCOUNT += (EXP:PLAYER:LCOUNT - LOCAL:(LCOUNT + 100) ) * (ARG:1 - 1)
			ENDSELECT
		NEXT
	ENDSELECT
CASE "체력기력減少"
	;고통からくる체력・기력の減少 ABL:마조끼をみる
	LOCAL = MULTIPLY(CUP:고통, 100 - ABL:마조끼*15)
	;마조
	SIF TALENT:마조
		TIMES LOCAL, 0.50

	LOCAL = GETPALAMLV(LOCAL, 9)
	LOCAL = LOCAL * LOCAL * 10

	DOWNBASE:체력 += LOCAL
	DOWNBASE:기력 += LOCAL

	;넘어뜨리기
	IF TEQUIP:넘어뜨리기
		TIMES DOWNBASE:체력, 0.80
		DOWNBASE:기력 /= 2
	ENDIF

	IF STATE("술주정", TARGET)
		TIMES DOWNBASE:체력, 1.50
	ELSEIF STATE("드렁크", TARGET)
		TIMES DOWNBASE:체력, 1.20
	ENDIF

	;입욕제
	IF TEQUIP:MASTER:입욕제 == 2 || TEQUIP:MASTER:입욕제 == 3
		TIMES DOWNBASE:체력, 0.80
		TIMES DOWNBASE:기력, 0.80
	ENDIF
	IF COND("連続実行")
		TIMES DOWNBASE:체력, 1.50
		TIMES DOWNBASE:기력, 1.50
	ENDIF
	;투와이스
	IF STATE("투와이스", PLAYER) && TEQUIP:넘어뜨리기 == 0
		SELECTCASE SELECTCOM
		CASE 3, 13, 90 TO 129, 139, IS >= 170
		CASEELSE
			TIMES DOWNBASE:체력, 2.00
			TIMES DOWNBASE:기력, 2.00
		ENDSELECT
	ENDIF

	;-------------------------------------------------
	;기력０, 정력０による上下の処理
	;-------------------------------------------------
	SIF BASE:기력 <= 0 && DOWNBASE:체력 > 0
		DOWNBASE:체력 += 50
	SIF BASE:정력 <= 0 && DOWNBASE:기력 > 0
		DOWNBASE:기력 += 30

	;손상している場合には１ＬＶにつき50
	DOWNBASE:기력 += (TALENT:Ｖ손상 + TALENT:Ａ손상)*50
	DOWNBASE:체력 += (TALENT:Ｖ손상 + TALENT:Ａ손상)*50

	;BASEからDOWNBASEを引く
	BASE:체력 = MAX(BASE:체력 - DOWNBASE:체력, 0)
	;一方的にむさぼったあとなら
	SIF TEQUIP:넘어뜨리기 && BASE:체력 <= 0
		BASE:체력 = 1
	BASE:기력 = MAX(BASE:기력 - DOWNBASE:기력, 0)
CASE "절정させた処理"
;---------------------------------------------------------
;조교におけるPLAYERが절정したときの処理
;대상と조교자を両方손가락定できるのが望ましいが, PLAYERを상대にしている時固定とする
;ARG:1に일常中かどうかを入れる(조교中でないなら0以外を入力しておく）
;---------------------------------------------------------
	VARSET LOCAL
	;異なる変数を一時的に交換
	IF ARG == TARGET:1 && SELECTCOM:1 >= 0
		SWAP SELECTCOM, SELECTCOM:1
		SWAP PREVCOM, PREVCOM:1
		SWAP TCVAR:PLAYER:5, TCVAR:PLAYER:6
	ENDIF
	;SOURCEの보정
	CALL SETFLAG, "추가のSOURCE", ARG
	;조수커맨드
	IF ARG != ASSI && ASSI && SHOOT("조수")
		IF PENIS(PLAYER)
			IF SHOOT("조수の입")
				LOCAL:1 = 3
				CALL SETFLAG, "정음경험", COND("절정", PLAYER), ASSI
			ELSEIF SHOOT("조수の질内")
				LOCAL:1 = 2
				CALL SETFLAG, "질내정액경험", COND("절정", PLAYER), ASSI
			ENDIF
			IF LOCAL:1
				EXP:ASSI:정액경험 += COND("절정", PLAYER) * LOCAL:1
				SIF FLAG:8
					PRINTFORML 정액경험+{COND("절정", PLAYER) * LOCAL:1}(%TEXTS("조수の명칭")%
			ENDIF
			;PLAYERの페니스に정액汚れを追加
			CALL ADD_STAIN, PLAYER, "Ｐ", "정액"
		ENDIF
		;MASTERを절정시킨횟수＆경험치獲得
		SIF PLAYER == MASTER
			EXP:ASSI:절정시킨횟수 += 1
		CALL GET_EXPERIENCE, COND("절정", PLAYER), ASSI
		;最初の変数交換は発生していないので中断ＯＫ
		RETURN 0
	;PLAYERが사정했다
	ELSEIF PENIS(PLAYER)
		;飲む＞내사정＞정액세례の順で정액경험が高い
		IF SHOOT("입")
			LOCAL = 3
			CALL SETFLAG, "정음경험", COND("절정", PLAYER), ARG
		ELSEIF SHOOT("내사정")
			LOCAL = 2
			IF SHOOT("질内")
				CALL SETFLAG, "질내정액경험", COND("절정", PLAYER), ARG
			ELSEIF SHOOT("애널")
				CALL SETFLAG, "장내정액경험", COND("절정", PLAYER), ARG
			ELSEIF SHOOT("요도")
				CALL SETFLAG, "방광정액경험", COND("절정", PLAYER), ARG
			ENDIF
		ELSEIF SHOOT("ニプル내사정")
			LOCAL = 2
			CALL SETFLAG, "유内정액경험", COND("절정", PLAYER), ARG
		ELSEIF SHOOT("自分以外に내사정")
			LOCAL = 0
		;정액세례
		ELSEIF SHOOT("보온병") == 0
			LOCAL = 1
			CALL SETFLAG, "정액정액세례경험", COND("절정", PLAYER), ARG
			;액체추가のソース
			IF SHOOT("くぱぁ")
				SOURCE:ARG:액체추가 += COND("절정", PLAYER) * LOCAL * 100
			ELSEIF SHOOT("Ａくぱぁ")
				SOURCE:ARG:Ａ액체추가 += COND("절정", PLAYER) * LOCAL * 100
			ELSEIF SHOOT("가랑이")
				SOURCE:ARG:액체추가 += COND("절정", PLAYER) * LOCAL * 50
				SOURCE:ARG:Ａ액체추가 += COND("절정", PLAYER) * LOCAL * 50
			ENDIF
		ENDIF
		;SIF TALENT:PLAYER:일반인
		;	LOCAL = MIN(LOCAL, 1)
		IF LOCAL
			;정음절정。何ってのはないけどフレーバー的な
			IF SHOOT("입") && NOWEX:ARG:절정수합계 && ABL:ARG:정액중독
				SIF FLAG:8
					CALL PRINTL_COLORTEXT, "정음절정（중독충족의 소스에 보너스가 발생합니다）", DEF_COLOR("황색")
				SOURCE:ARG:중독충족 += 3000
			ENDIF
			EXP:ARG:정액경험 += COND("절정", PLAYER) * LOCAL
			SIF FLAG:8
				PRINTFORML 정액경험+{COND("절정", PLAYER) * LOCAL}\@ ARG == ASSI ? (%TEXTS("조수の명칭")%）# \@
			IF TALENT:ARG:몽마 || TALENT:ARG:상위몽마 || TALENT:ARG:흡정체질
				DOWNBASE:ARG:체력 -= COND("절정", PLAYER) * LOCAL * 5
				DOWNBASE:ARG:기력 -= COND("절정", PLAYER) * LOCAL * 5
				;정력も회복
				IF MAXBASE:ARG:정력 - BASE:ARG:정력 > 0
					LOCAL:1 = LIMIT(COND("절정", PLAYER) * LOCAL / 4, 1, MAXBASE:ARG:정력 - BASE:ARG:정력)
					BASE:ARG:정력 += LOCAL:1
					;TCVAR:ARG:109 -= LOCAL:1
					SIF FLAG:8
						PRINTFORML 정력+{LOCAL:1}\@ ARG == ASSI ? (%TEXTS("조수の명칭")%）# \@
				ENDIF
			ENDIF
		ENDIF

		;중독충족のソース
		IF ABL:ARG:정액중독
			SOURCE:ARG:중독충족 += COND("절정", PLAYER) * ABL:ARG:정액중독 * 100

			;정액에약함
			IF SHOOT("입")
				SIF COND("정음에약함", ARG)
					SOURCE:ARG:중독충족 += 3000
			ELSEIF SHOOT("Ｖ내사정")
				SIF COND("질내사정에약함", ARG)
					SOURCE:ARG:중독충족 += 3000
			ELSEIF SHOOT("Ａ내사정")
				SIF COND("장내사정에약함", ARG)
					SOURCE:ARG:중독충족 += 3000
			ELSEIF SHOOT("니플퍽")
				SIF COND("유内사정에약함", ARG)
					SOURCE:ARG:중독충족 += 3000
			ELSEIF SHOOT("요도内사정")
				SIF COND("요도内사정에약함", ARG)
					SOURCE:ARG:중독충족 += 3000
			ENDIF
		ENDIF

		;PLAYERの페니스に정액汚れを追加
		CALL ADD_STAIN, PLAYER, "Ｐ", "정액"
		;정액を出したところに정액汚れを追加
		;입に汚れを追加
		IF SHOOT("입")
			;몽마の입⇔조교자のＰの汚れが移動
			CALL EQ_STAIN, ARG, PLAYER, 0, 2
			CALL ADD_STAIN, ARG, "Ｍ", "정액"
		;가슴に汚れを追加
		ELSEIF SHOOT("가슴")
			CALL ADD_STAIN, ARG, "Ｂ", "정액"
		;Ｖに汚れを追加
		ELSEIF SHOOT("Ｖ내사정") || SHOOT("가랑이")
			;팬티훑기
			IF SELECTCOM == 97
				STAIN:Ｖ = SET_STAIN(STAIN:Ｖ, "정액")
			ELSE
				CALL ADD_STAIN, ARG, "Ｖ", "정액"
			ENDIF
		;Ａに汚れを追加
		ELSEIF SHOOT("Ａ내사정")
			CALL ADD_STAIN, ARG, "Ａ", "정액"
		;손や팬티に汚れを追加
		ELSEIF SHOOT("손")
			;팬티훑기
			IF SELECTCOM == 97
				CALL ADD_STAIN, ARG, "팬티", "정액"
			ELSE
				CALL ADD_STAIN, ARG, "손", "정액"
			ENDIF
		ENDIF
	ENDIF
	;MASTERを절정시킨횟수＆경험치獲得
	SIF PLAYER == MASTER
		EXP:ARG:절정시킨횟수 += 1

	CALL GET_EXPERIENCE, COND("절정", PLAYER), ARG

	IF ARG == TARGET
		;호감도보정
		TFLAG:30 += COND("절정", PLAYER) + ABL:ARG:정액중독
		SIF TALENT:ARG:연모 == 0 && MARK:ARG:반발각인
			TFLAG:30 -= TALENT:ARG:반항적*2 + TALENT:ARG:정조관념*2 + TALENT:ARG:남성혐오*5 + MARK:ARG:반발각인*MARK:ARG:반발각인
	ENDIF
	;変数を戻す
	IF ARG == TARGET:1 && SELECTCOM:1 >= 0
		SWAP SELECTCOM, SELECTCOM:1
		SWAP PREVCOM, PREVCOM:1
		SWAP TCVAR:PLAYER:5, TCVAR:PLAYER:6
	ENDIF
CASE "절정した処理"
	SIF COND("절정", ARG) == 0
		RETURN 0
	;堪えた플래그を初期化
	EX:ARG:가는것을참았다 = 0
	;정력を減少(상대が흡정체질だと필요量増)
	LOCAL = 1 + COND("절정", ARG)*COND("절정", ARG) + MAX(TALENT:흡정체질 - TALENT:ARG:흡정체질, 0)
	SIF SELECTCOM:1 >= 0
		LOCAL += MAX(TALENT:(TARGET:1):흡정체질 - TALENT:ARG:흡정체질, 0)
	;여자は優遇
	SIF TALENT:ARG:여자 && LOCAL >= 6
		LOCAL = 6
	;우르즈군なら、정력があまり減らない
	SIF STATE("우르즈군", ARG)
		TIMES LOCAL, 0.70

	IF PENIS(ARG)
		NOWEX:ARG:사정 = COND("절정", ARG)
		EX:ARG:사정 += NOWEX:ARG:사정
		EXP:ARG:사정경험 += NOWEX:ARG:사정
		IF TALENT:ARG:조루
			TIMES LOCAL, 0.75
		ELSEIF TALENT:ARG:지루
			TIMES LOCAL, 2.00
		ENDIF
	ELSE
		EXP:ARG:절정경험 += COND("절정", ARG)
	ENDIF

	LOCAL = MAX(LOCAL, 1)

	BASE:ARG:정력 = MAX(BASE:ARG:정력 - LOCAL, 0)
	TCVAR:ARG:109 += LOCAL
	IF FLAG:8
		PRINTFORM 정력-{LOCAL}
		IF ARG == MASTER
			PRINTFORM  (%CALLNAME:ARG%)
		ELSEIF ARG == ASSI
			PRINTFORM （%TEXTS("조수の명칭")%）
		ENDIF
		PRINTL 
	ENDIF
	;사정게이지の調整
	BASE:ARG:절정 = MAXBASE:ARG:절정 * (1 + BASE:ARG:스톡) * (1 + MAX(BASE:ARG:정력, 1) )
	BASE:ARG:절정 /= (2 + BASE:ARG:스톡) * (1 + MAXBASE:ARG:정력) * COND("절정", ARG)
	;快感許容値（페니스）の調整
	BASE:ARG:성감허용치남자 = BASE:ARG:절정
CASE "에너지드레인"
	SIF PENIS(PLAYER) == 0 || COND("에너지드레인", PLAYER)
		RETURN 0
	VARSET LOCAL

	FOR LCOUNT, 2, CHARANUM
		SELECTCASE LCOUNT
		CASE TARGET

		CASE TARGET:1
			SIF SELECTCOM:1 < 0 || STATE("撃沈", TARGET:1)
				CONTINUE
		CASEELSE
			CONTINUE
		ENDSELECT

		SIF TALENT:LCOUNT:흡정체질 == 0
			CONTINUE
		SIF NOWEX:LCOUNT:Ｖ내사정 + NOWEX:LCOUNT:Ａ내사정 + NOWEX:LCOUNT:구내사정 + NOWEX:LCOUNT:유내사정 == 0
			CONTINUE
		SIF NOWEX:LCOUNT:폭발 == 0 && COND("절정", PLAYER) == 0
			CONTINUE
		SIF NOWEX:LCOUNT:폭발 == 0 && RAND:(3 + TALENT:LCOUNT:흡정체질 + TALENT:LCOUNT:연모 + TALENT:LCOUNT:음란) < 3 - CONFIG("ＨＡＲＤ")
			CONTINUE

		LOCAL = TALENT:LCOUNT:흡정체질

		SELECTCASE SELECTCOM
		CASE 65, 75
			LOCAL += 1
		CASE 60 TO 79, 82, 91, 140, 150
		CASEELSE
			SIF INSERT("인서트", LCOUNT, PLAYER) == 0 && TEQUIP:LCOUNT:식스나인 != 91
				LOCAL = 0
		ENDSELECT

		SIF TEQUIP:LCOUNT:넘어뜨리기 == 0 && NOWEX:LCOUNT:절정수합계 < 3
			LOCAL = MAX(LOCAL - 1, 0)

		NOWEX:LCOUNT:에너지드레인 = MAX(RAND:(LOCAL + 1), NOWEX:LCOUNT:폭발)

		SIF NOWEX:LCOUNT:에너지드레인 == 0
			CONTINUE

		EX:LCOUNT:에너지드레인 += NOWEX:LCOUNT:에너지드레인

		CALL SETFLAG, "에너지드레인", LCOUNT
		CALL SETFLAG, "에너지드레인", PLAYER
	NEXT

	SIF COND("에너지드레인", PLAYER) == 0
		RETURN 0

	IF COND("에너지드레인", TARGET) && TARGET:1 && COND("에너지드레인", TARGET:1)
		LOCALS = 두사람
	ELSEIF COND("에너지드레인", TARGET)
		LOCALS = %CALLNAME:TARGET%
	ELSEIF COND("에너지드레인", TARGET:1)
		LOCALS = %CALLNAME:(TARGET:1)%
	ENDIF

	PRINTL 
	SETCOLOR DEF_COLOR("하트핑크")
	PRINTFORML ＜에너지드레인! ＞
	RESETCOLOR

	;표기の簡略
	LOCAL = COND("에너지드레인", TARGET) + COND("에너지드레인", TARGET:1)

	PRINTFORML %CALLNAME:PLAYER%의 페니스에서 올라오는 굉장한 쾌감과 함께 정력이 %LOCALS%에게 빨려들어갔다!
	TCVAR:PLAYER:1 = MIN(TCVAR:PLAYER:1 + LOCAL, 5)

	BASE:PLAYER:정력 = MAX(BASE:PLAYER:정력 - LOCAL*2, 0)
	TCVAR:PLAYER:109 += LOCAL*2
	PRINTFORM 정력-{LOCAL*2}
	IF PLAYER == MASTER
		PRINTFORM  (%CALLNAME:PLAYER%)
	ELSEIF PLAYER == ASSI
		PRINTFORM （%TEXTS("조수の명칭")%）
	ENDIF
	PRINTL 

	FOR LCOUNT, 2, CHARANUM
		SIF COND("에너지드레인", LCOUNT) == 0
			CONTINUE

		LOCAL = COND("에너지드레인", LCOUNT)

		EXP:LCOUNT:흡정경험 += 1
		PRINTFORML 흡정경험＋1\@ LCOUNT != TARGET ? （%CALLNAME:LCOUNT%） # \@
		PRINTFORML %CALLNAME:LCOUNT%의 체력과 기력이 {LOCAL*100}만큼 회복되었다! 
		DOWNBASE:LCOUNT:체력 -= LOCAL*100
		DOWNBASE:LCOUNT:기력 -= LOCAL*100
		IF MAXBASE:LCOUNT:정력 > BASE:LCOUNT:정력
			BASE:LCOUNT:정력 += LOCAL*2
			;TCVAR:LCOUNT:109 -= LOCAL*2
			PRINTFORML 더해서 %CALLNAME:LCOUNT%의 정력이 {LOCAL*2} 회복되었다! 
		ENDIF

		;레벨ドレイン
		SETCOLOR DEF_COLOR("노랑")
		SELECTCASE PLAYER
		CASE MASTER
			IF MAX(BASE:MASTER:정력, BASE:MASTER:스톡) <= 0 && CONFIG("ＨＡＲＤ") && FLAG:255 >= 2 && ABL:LCOUNT:ＬＶ < NUM("최대레벨", 90)
				ABL:LCOUNT:ＬＶ += 1
				EXP:LCOUNT:경험치 += MAX(EXP:MASTER:경험치 - EXP_NEXTLV(MASTER, FLAG:255 - 1), 100)
				FLAG:255 -= 1
				ABL:MASTER:ＬＶ = LIMIT(ABL:MASTER:ＬＶ, 1, FLAG:255)
				EXP:MASTER:경험치 = EXP_NEXTLV(MASTER, FLAG:255 - 1)
				PRINTFORML 더욱이 %CALLNAME:PLAYER%의 ＬＶ이 １흡수되었다! 
				CALL SETFLAG, "레벨ドレイン", LCOUNT
				CALL SETFLAG, "레벨ドレイン", PLAYER
			ENDIF
		CASEELSE
			IF BASE:PLAYER:정력 <= 0 && CONFIG("ＨＡＲＤ") && ABL:PLAYER:ＬＶ >= 2 && ABL:LCOUNT:ＬＶ < NUM("최대레벨", 90)
				ABL:LCOUNT:ＬＶ += 1
				EXP:LCOUNT:경험치 += EXP_NEXTLV(PLAYER, ABL:PLAYER:ＬＶ)
				EXP:PLAYER:경험치 = MAX(EXP:PLAYER:경험치 - EXP_NEXTLV(PLAYER, ABL:PLAYER:ＬＶ), 0)
				ABL:PLAYER:ＬＶ -= 1
				PRINTFORML 더욱이 %CALLNAME:PLAYER%의 ＬＶ이 １흡수되었다! 
				CALL SETFLAG, "레벨ドレイン", LCOUNT
				CALL SETFLAG, "레벨ドレイン", PLAYER
			ENDIF
		ENDSELECT
		RESETCOLOR

		IF COND("레벨ドレイン", LCOUNT)
			CALL SELF_KOJO, "레벨ドレイン", LCOUNT
		ELSE
			CALL SELF_KOJO, "에너지드레인", LCOUNT
		ENDIF
		PRINTL 
	NEXT
CASE "동시절정"
	VARSET LOCAL
	;LOCAL PLAYERの절정, LOCAL:1 PLAYER:1の절정, LOCAL:2 TARGETの절정, LOCAL:3 TARGET:1の절정

	LOCAL = COND("절정", PLAYER)
	SIF SELECTCOM:2 >= 0
		LOCAL:1 = COND("절정", PLAYER:1)
	LOCAL:2 = MIN(NOWEX:절정수합계, 2)
	SIF SELECTCOM:1 >= 0
		LOCAL:3 = MIN(NOWEX:(TARGET:1):절정수합계, 2)

	;PLAYER側とTARGET側が両方절정する事が条件
	SIF MAX(LOCAL, LOCAL:1) == 0 || MAX(LOCAL:2, LOCAL:3) == 0
		RETURN 0
	;既に동시절정となっている場合には繰り返さない
	SIF NOWEX:PLAYER:동시절정 || NOWEX:동시절정
		RETURN 0

	NOWEX:PLAYER:동시절정 = LOCAL
	EX:PLAYER:동시절정 += NOWEX:PLAYER:동시절정
	IF LOCAL:1
		NOWEX:(PLAYER:1):동시절정 = LOCAL:1
		EX:(PLAYER:1):동시절정 += NOWEX:(PLAYER:1):동시절정
	ENDIF
	NOWEX:동시절정 = LOCAL:2
	EX:동시절정 += NOWEX:동시절정
	IF LOCAL:3
		NOWEX:ASSI:동시절정 = LOCAL:3
		EX:ASSI:동시절정 += NOWEX:ASSI:동시절정
	ENDIF

	SIF FLAG:8 == 0
		RETURN 0

	IF MAX(LOCAL, LOCAL:1) >= 2 && MAX(LOCAL:2, LOCAL:3) >= 2
		LOCALS = 동시강절정
	ELSE
		LOCALS = 동시절정
	ENDIF

	;PLAYERとTARGETと(PLAYER:1 or TARGET:1)が절정した
	IF LOCAL && LOCAL:2 && (LOCAL:1 || LOCAL:3)
		LOCALS = %LOCALS%（모두）
	;PLAYERと(TARGET or TARGET:1)
	ELSEIF LOCAL
		LOCALS = %LOCALS%（%CALLNAME:PLAYER%＆\@ LOCAL:2 ? %CALLNAME:TARGET% # %CALLNAME:(TARGET:1)% \@）
	ELSEIF LOCAL:1
		LOCALS = %LOCALS%（%CALLNAME:(PLAYER:1)%＆%CALLNAME:TARGET%）
	ENDIF

	CALL PRINTL_COLORTEXT, LOCALS, DEF_COLOR("하트핑크")

	STR:9 = %LOCALS%

CASE "조교소스の計算"
	SELECTCASE SELECTCOM
	CASE 60
		IF CHECK_COM("Ｖ두개삽입")
			CALL SOURCE_COM60, 70
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM60, 70
			SWAP PLAYER, PLAYER:1
		ELSEIF CHECK_COM("양구멍삽입")
			CALL SOURCE_COM60, 120
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM71, 120
			SWAP PLAYER, PLAYER:1
		ELSE
			CALL SOURCE_COM60, 100
		ENDIF
	CASE 71
		IF CHECK_COM("Ａ두개삽입")
			CALL SOURCE_COM71, 70
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM71, 70
			SWAP PLAYER, PLAYER:1
		ELSEIF CHECK_COM("양구멍삽입")
			CALL SOURCE_COM71, 120
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM60, 120
			SWAP PLAYER, PLAYER:1
		ELSE
			CALL SOURCE_COM71, 100
		ENDIF
	CASEELSE
		TRYCALLFORM SOURCE_COM{SELECTCOM}, 100
	ENDSELECT
	;-------------------------------------------------
	;SOURCE計算
	;-------------------------------------------------
	CALL CALC_SOURCE, "조교커맨드"

CASE "조교소스の試算"
	SELECTCASE SELECTCOM
	CASE 60
		IF CHECK_COM("Ｖ두개삽입")
			CALL SOURCE_COM60, 70
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM60, 70
			SWAP PLAYER, PLAYER:1
		ELSEIF CHECK_COM("양구멍삽입")
			CALL SOURCE_COM60, 120
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM71, 120
			SWAP PLAYER, PLAYER:1
		ELSE
			CALL SOURCE_COM60, 100
		ENDIF
	CASE 71
		IF CHECK_COM("Ａ두개삽입")
			CALL SOURCE_COM71, 70
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM71, 70
			SWAP PLAYER, PLAYER:1
		ELSEIF CHECK_COM("양구멍삽입")
			CALL SOURCE_COM71, 120
			SWAP PLAYER, PLAYER:1
			CALL SOURCE_COM60, 120
			SWAP PLAYER, PLAYER:1
		ELSE
			CALL SOURCE_COM71, 100
		ENDIF
	CASEELSE
		TRYCALLFORM SOURCE_COM{SELECTCOM}, 100
	ENDSELECT
	;-------------------------------------------------
	;SOURCE計算
	;-------------------------------------------------
	CALL CALC_SOURCE, "試算"

CASE "조교の플래그취득"
	SELECTCASE SELECTCOM
	CASE 60
		IF CHECK_COM("Ｖ두개삽입")
			CALL FLAG_COM60, 70
			SWAP PLAYER, PLAYER:1
			CALL FLAG_COM60, 70
			SWAP PLAYER, PLAYER:1
		ELSEIF CHECK_COM("양구멍삽입")
			CALL FLAG_COM60, 120
			SWAP PLAYER, PLAYER:1
			CALL FLAG_COM71, 120
			SWAP PLAYER, PLAYER:1
		ELSE
			CALL FLAG_COM60, 100
		ENDIF
	CASE 71
		IF CHECK_COM("Ａ두개삽입")
			CALL FLAG_COM71, 70
			SWAP PLAYER, PLAYER:1
			CALL FLAG_COM71, 70
			SWAP PLAYER, PLAYER:1
		ELSEIF CHECK_COM("양구멍삽입")
			CALL FLAG_COM71, 120
			SWAP PLAYER, PLAYER:1
			CALL FLAG_COM60, 120
			SWAP PLAYER, PLAYER:1
		ELSE
			CALL FLAG_COM71, 100
		ENDIF
	CASEELSE
		TRYCALLFORM FLAG_COM{SELECTCOM}, 100
	ENDSELECT
CASE "조교보정치"
	SIF ARG == PLAYER
		RETURN 0

	;레벨리미터체크
	CALL SETFLAG, "레벨리미터"

	VARSET TCVAR:ARG:0, 0, 600, 649

	;まずはSOURCE보정（下のほうにCUP보정もあり）
	;ＣＶＡＢＭの快感보정
	;～감각ＬＶや淫～系の소질によって상대の기교やＬＶや무드でのマイナス修正が無視されます
	FOR LCOUNT, 0, 5
		VARSET LOCAL
		LOCAL += TALENT:ARG:쾌감에솔직*20 + STATE("시길군", PLAYER)*10
		LOCAL -= TALENT:ARG:냉정*90 + TALENT:ARG:마도인형*50 + STATE("피블", PLAYER)*50 + STATE("술주정", PLAYER)*30

		SELECTCASE CONDS("기분", ARG)
		CASE "의욕없음"
			LOCAL -= 100
		ENDSELECT

		;レズ
		IF TALENT:ARG:남자 == 0 && TALENT:PLAYER:남자 == 0
			LOCAL += ABL:ARG:레즈끼*10 - 30
		;BL
		ELSEIF TALENT:ARG:남자 && TALENT:PLAYER:남자
			LOCAL += ABL:ARG:ＢＬ끼*10 - 30
		ENDIF

		SELECTCASE MARK:ARG:반발각인
		CASE 3
			LOCAL -= 50
		CASE 2
			LOCAL -= 20
		CASE 1
			LOCAL -= 10
		ENDSELECT

		;무드をみる（低いときの修正は"快感上昇の상한措置"で主に行う）
		SELECTCASE MOOD_HEART()
		CASE 0
			LOCAL:1 = -40
		CASE 1
			LOCAL:1 = -20
		CASE 2
			LOCAL:1 = -10
		CASEELSE
			LOCAL:1 = LIMIT(MOOD() - 70, 0, 100)
		ENDSELECT
		;음란な人は무드低くても関係なし
		SIF TALENT:ARG:음란 && LOCAL:1 < 0
			LOCAL:1 = 0
		;호색な人は무드が低くてもエンジンかかりやすい
		SIF TALENT:ARG:호색 && LOCAL:1 < 0
			LOCAL:1 /= 2
		;냉정持ちは무드에약함
		SIF TALENT:ARG:냉정 && LOCAL:1 > 0
			LOCAL:1 += LIMIT(LOCAL:1, 20, 120)

		;조교자とのABL:기교差
		LOCAL:2 = MAX(-50, (ABL:PLAYER:기교 - ABL:ARG:기교)*25)

		;EASY모드
		IF CONFIG("ＥＡＳＹ")
			SIF LOCAL < 0
				LOCAL /= 2
			LOCAL:1 = MAX(LOCAL:1, 0)
			LOCAL:2 = MAX(LOCAL:2, 0)
		ENDIF

		SELECTCASE LCOUNT
		CASE 0
			;페니스は무드等にあまり左右されない
			SIF LOCAL:1 > 0 || (LOCAL:1 < 0 && PENIS(ARG) == 0 && TALENT:ARG:음핵 == 0)
				LOCAL += LOCAL:1
			SIF LOCAL:2 > 0 || (LOCAL:2 < 0 && PENIS(ARG) == 0 && ABL:ARG:Ｃ감각 < 5 && TALENT:ARG:Ｃ민감 == 0)
				LOCAL += LOCAL:2
			TCVAR:ARG:600 += LOCAL + TALENT:ARG:음핵*20
		CASE 1
			SIF LOCAL:1 > 0 || (LOCAL:1 < 0 && TALENT:ARG:음호 == 0)
				LOCAL += LOCAL:1
			SIF LOCAL:2 > 0 || (LOCAL:2 < 0 && ABL:ARG:Ｖ감각 < 5 && TALENT:ARG:Ｖ민감 == 0)
				LOCAL += LOCAL:2
			TCVAR:ARG:601 += LOCAL + TALENT:ARG:음호*20 + MARK:ARG:정액각인*10
		CASE 2
			SIF LOCAL:1 > 0 || (LOCAL:1 < 0 && TALENT:ARG:애널광 == 0)
				LOCAL += LOCAL:1
			SIF LOCAL:2 > 0 || (LOCAL:2 < 0 && ABL:ARG:Ａ감각 < 5 && TALENT:ARG:Ａ민감 == 0)
				LOCAL += LOCAL:2
			TCVAR:ARG:602 += LOCAL + TALENT:ARG:애널광*20
		CASE 3
			SIF LOCAL:1 > 0 || (LOCAL:1 < 0 && TALENT:ARG:음유 == 0)
				LOCAL += LOCAL:1
			SIF LOCAL:2 > 0 || (LOCAL:2 < 0 && ABL:ARG:Ｂ감각 < 5 && TALENT:ARG:Ｂ민감 == 0)
				LOCAL += LOCAL:2
			TCVAR:ARG:617 += LOCAL + TALENT:ARG:음유*20
		CASE 4
			SIF LOCAL:1 > 0 || (LOCAL:1 < 0 && TALENT:ARG:음탕한입술 == 0)
				LOCAL += LOCAL:1
			SIF LOCAL:2 > 0 || (LOCAL:2 < 0 && ABL:ARG:Ｍ감각 < 5 && TALENT:ARG:Ｍ민감 == 0)
				LOCAL += LOCAL:2
			TCVAR:ARG:618 += LOCAL + TALENT:ARG:음탕한입술*20
		ENDSELECT
	NEXT

	SIF TALENT:ARG:모유체질
		TCVAR:ARG:617 += 50
	SIF COND("발정기", ARG)
		TCVAR:ARG:601 += 100
	;ＶＡ손상
	TCVAR:ARG:601 -= 200 * TALENT:ARG:Ｖ손상
	TCVAR:ARG:602 -= 200 * TALENT:ARG:Ａ손상

	;快感以外
	IF TALENT:ARG:마도인형
		TCVAR:ARG:606 -= 50
		TCVAR:ARG:614 -= 50
		TCVAR:ARG:615 -= 90
	ENDIF
	IF TALENT:ARG:슬라임
		TCVAR:ARG:606 -= 200
		TCVAR:ARG:610 += 50
	ENDIF

	SIF TALENT:ARG:부끄럼쟁이
		TCVAR:ARG:612 += 100
	SIF TALENT:ARG:부끄럼없음
		TCVAR:ARG:612 -= 50
	SIF TALENT:ARG:청초
		TCVAR:ARG:612 += 50
	SIF TALENT:ARG:호기심
		TCVAR:ARG:614 -= 30
	SIF TALENT:ARG:보수적
		TCVAR:ARG:614 += 100
	SIF TALENT:ARG:호색
		TCVAR:ARG:614 -= 10
	SIF TALENT:ARG:음란
		TCVAR:ARG:614 -= 50

	;重複前提で計算
	IF TALENT:ARG:연모 && PLAYER == MASTER
		TCVAR:ARG:603 += 20
		IF GETBIT(NOWEX:ARG:처녀상실, 1)
			TCVAR:ARG:603 += 100
			TCVAR:ARG:606 -= 50
			TCVAR:ARG:614 -= 300
			TCVAR:ARG:615 -= 300
		ENDIF
	ENDIF

	;넘어뜨리기보너스
	IF TEQUIP:ARG:넘어뜨리기
		TCVAR:ARG:606 -= 50
		TCVAR:ARG:609 -= 100
		TCVAR:ARG:613 -= 100
		TCVAR:ARG:614 -= 50
		TCVAR:ARG:615 -= 100
	ENDIF

	;生え放題
	IF COND("음모", ARG) == 7 && CHECK_CLO("Ｖ노출", ARG)
		TCVAR:ARG:612 += 30
	;ツルツル
	ELSEIF COND("음모", ARG) >= 2 && COND("음모", ARG) <= 3 && CHECK_CLO("Ｖ노출", ARG)
		TCVAR:ARG:612 += 20
	ENDIF

	;性器ピアス
	SIF CHECK_CLO("Ｖ노출", ARG)
		TCVAR:ARG:612 += TALENT:ARG:클리피어스*20 + TALENT:ARG:라비아피어스*10
	SIF CHECK_CLO("유두노출", ARG)
		TCVAR:ARG:612 += TALENT:ARG:니플피어스*10

	;동시절정
	IF NOWEX:ARG:동시절정
		TCVAR:ARG:603 += NOWEX:ARG:동시절정 * 10
		TCVAR:ARG:605 += NOWEX:ARG:동시절정 * 10
		TCVAR:ARG:609 -= NOWEX:ARG:동시절정 * 20
		TCVAR:ARG:615 -= NOWEX:ARG:동시절정 * 20
	ENDIF

	;이상경험が多いほど, 일탈のSOURCEの増加が(이상경험*3%)少なくなり, 굴복のSOURCEが(이상경험*3%)増加しやすくなる
	TCVAR:ARG:613 += EXP:ARG:이상경험*3
	TCVAR:ARG:614 -= EXP:ARG:이상경험*3

	;LOCALの値で정애,성행위,달성감,중독충족,액체추가,욕정추가,반감추가,순종추가に一斉보정
	VARSET LOCAL

	SELECTCASE CONDS("기분", ARG)
	CASE "상황살핌"
		LOCAL += 100
		TCVAR:ARG:613 -= 100
	CASE "의욕없음"
		LOCAL += 200
		TCVAR:ARG:613 -= 200
	ENDSELECT

	;ＶＡ손상
	LOCAL:1 = EXP_GAIN(64, ARG) + EXP_GAIN(65, ARG) + TALENT:ARG:Ｖ손상 + TALENT:ARG:Ａ손상
	IF LOCAL:1
		LOCAL += LOCAL:1 * 50
		TCVAR:ARG:609 += LOCAL:1 * 50
		TCVAR:ARG:614 += LOCAL:1 * 50
	ENDIF

	;정력０
	SIF BASE:ARG:정력 <= 0
		LOCAL += 50

	TCVAR:ARG:603 -= LOCAL
	TCVAR:ARG:604 -= LOCAL
	TCVAR:ARG:605 -= LOCAL
	TCVAR:ARG:607 -= LOCAL
	TCVAR:ARG:610 -= LOCAL
	TCVAR:ARG:611 -=  LOCAL
	TCVAR:ARG:615 +=  LOCAL
	TCVAR:ARG:616 -=  LOCAL

	SIF TALENT:PLAYER:해방
		TCVAR:ARG:603 += 20
	IF TALENT:PLAYER:매혹
		TCVAR:ARG:614 -= 10
		TCVAR:ARG:615 -= 10
	ENDIF
	IF TALENT:PLAYER:수수께끼의매력
		TCVAR:ARG:603 += 10
		TCVAR:ARG:605 += 10
		TCVAR:ARG:614 -= 10
		TCVAR:ARG:615 -= 10
	ENDIF

	;악세사리効果（매력）
	IF TALENT:PLAYER:매력강화 > 0
		TCVAR:ARG:614 -= TALENT:PLAYER:매력강화
		TCVAR:ARG:615 -= TALENT:PLAYER:매력강화
	ENDIF

	SELECTCASE STATE("시길군", PLAYER)
	CASE 3
		TCVAR:ARG:603 += 10
		TCVAR:ARG:605 += 10
		TCVAR:ARG:614 -= 10
		TCVAR:ARG:615 -= 10
	CASE 2
		TCVAR:ARG:614 -= 10
		TCVAR:ARG:615 -= 10
	ENDSELECT

	SIF TALENT:PLAYER:슬라임
		TCVAR:ARG:610 += 30
	;피블
	IF STATE("피블", PLAYER)
		TCVAR:ARG:603 -= 30
		TCVAR:ARG:604 -= 30
		TCVAR:ARG:605 -= 30
		TCVAR:ARG:611 -= 30
		TCVAR:ARG:613 -= 30
		TCVAR:ARG:616 -= 30
	ENDIF

	;レズ
	IF TALENT:ARG:남자 == 0 && TALENT:PLAYER:남자 == 0
		LOCAL = ABL:ARG:레즈끼*10
		TCVAR:ARG:605 += LOCAL - 30
		TCVAR:ARG:614 += 20 - LOCAL
	ELSEIF TALENT:ARG:남자 && TALENT:PLAYER:남자
		LOCAL = ABL:ARG:ＢＬ끼*10
		TCVAR:ARG:605 += LOCAL - 30
		TCVAR:ARG:614 += 20 - LOCAL
	ENDIF

	TCVAR:ARG:614 -= TEQUIP:ARG:미약/5
	;야외など
	SIF TEQUIP:ARG:관내노출플레이 || TEQUIP:ARG:비디오카메라 || TEQUIP:ARG:야외플레이 || TEQUIP:ARG:수치플레이
		TCVAR:ARG:612 += 20

	;반발각인が無いなら절정보정
	IF NOWEX:ARG:절정수합계 && MARK:ARG:반발각인 == 0
		TCVAR:ARG:612 -= 20
		TCVAR:ARG:614 -= 20
		TCVAR:ARG:615 -= 10
	ENDIF

	;SOURCE:쾌Ｃ(쾌Ｃ)～SOURCE:쾌Ｍ(쾌Ｍ)の보정치の最終結果
	FOR LCOUNT, 600, 620
		;マイナスPALAMのソースは, 最低値が-99. その他は, -80
		SELECTCASE LCOUNT
		CASE 608, 609, 614, 615
			TCVAR:ARG:LCOUNT = MAX(TCVAR:ARG:LCOUNT, -99)
		CASEELSE
			TCVAR:ARG:LCOUNT = MAX(TCVAR:ARG:LCOUNT, -80)
		ENDSELECT
	NEXT

	;이하はCUP보정
	;클리토리스やアヌスの노출具合
	SELECTCASE COND("음모", ARG)
	CASE 1 TO 3
		TCVAR:ARG:620 += 10
	CASE IS >= 6
		TCVAR:ARG:622 -= 10
	ENDSELECT
	;클리토리스や유두の노출, 勃起具合. ピアス優遇. 
	TCVAR:ARG:620 += CALCF("Ｃ발정", ARG)*5
	TCVAR:ARG:634 += CALCF("Ｂ발정", ARG)*5

	IF STATE("미니멈", PLAYER) && TALENT:ARG:요정 == 0
		SIF INSERT("Ｖ인서트")
			TCVAR:ARG:621 -= 30
		SIF INSERT("Ａ인서트")
			TCVAR:ARG:622 -= 30
		SIF INSERT("요도인서트")
			TCVAR:ARG:620 -= 30
	ENDIF
	SIF TALENT:ARG:남자
		TCVAR:ARG:622 += 20
	;악세사리効果（ＣＶＡＢＭ강화）
	SIF TALENT:PLAYER:Ｃ강화 > 0
		TCVAR:ARG:620 += TALENT:PLAYER:Ｃ강화
	SIF TALENT:PLAYER:Ｖ강화 > 0
		TCVAR:ARG:621 += TALENT:PLAYER:Ｖ강화
	SIF TALENT:PLAYER:Ａ강화 > 0
		TCVAR:ARG:622 += TALENT:PLAYER:Ａ강화
	SIF TALENT:PLAYER:Ｂ강화 > 0
		TCVAR:ARG:634 += TALENT:PLAYER:Ｂ강화
	SIF TALENT:PLAYER:Ｍ강화 > 0
		TCVAR:ARG:635 += TALENT:PLAYER:Ｍ강화

	;～감각ＬＶや淫～系の소질によって상대の기교やＬＶなどでのマイナス修正が無視されます
	FOR LCOUNT, 0, 5
		VARSET LOCAL

		LOCAL -= TEQUIP:ARG:이뇨제*30
		LOCAL += TEQUIP:ARG:미약

		SIF TEQUIP:ARG:촉수
			LOCAL += 100
		SIF TALENT:PLAYER:해방
			LOCAL += 20
		SIF TEQUIP:ARG:플라트
			LOCAL += 20
		SIF STATE("흐물흐물", PLAYER)
			LOCAL -= 100

		;-------------------------------------------------
		;악세사리効果（기교）による上下の処理
		;-------------------------------------------------
		SIF TALENT:PLAYER:기교강화 > 0
			LOCAL += TALENT:PLAYER:기교강화
		;-------------------------------------------------
		;상성による上下の処理（快楽系）
		;-------------------------------------------------
		SIF RELATION:ARG:(NO:PLAYER) > 0
			LOCAL += RELATION:ARG:(NO:PLAYER) - 100
		;에올군보정
		LOCAL -= STATE("에올군", ARG)*50

		;-------------------------------------------------
		;LVで快感の보정をする（快楽系）
		;-------------------------------------------------
		LOCAL:1 = MAX(-100, (ABL:PLAYER:ＬＶ - ABL:ARG:ＬＶ)*10)

		;보정がマイナスの時には기교で緩和
		IF LOCAL:1 < 0
			SIF CONFIG("ＥＡＳＹ")
				LOCAL:1 /= 2
			LOCAL:1 = MIN(LOCAL:1 + ABL:PLAYER:기교*10, 0)
		ENDIF

		SELECTCASE LCOUNT
		CASE 0
			;페니스はあまり左右されない
			SIF LOCAL:1 < 0 && (TALENT:ARG:Ｃ민감 || PENIS(ARG) || ABL:ARG:Ｃ감각 >= 5 || TALENT:ARG:음핵)
				LOCAL:1 = 0
			TCVAR:ARG:620 += LOCAL + LOCAL:1
		CASE 1
			SIF LOCAL:1 < 0 && (TALENT:ARG:Ｖ민감 || ABL:ARG:Ｖ감각 >= 5 || TALENT:ARG:음호)
				LOCAL:1 = 0
			TCVAR:ARG:621 += LOCAL + LOCAL:1
		CASE 2
			SIF LOCAL:1 < 0 && (TALENT:ARG:Ａ민감 || ABL:ARG:Ａ감각 >= 5 || TALENT:ARG:애널광)
				LOCAL:1 = 0
			TCVAR:ARG:622 += LOCAL + LOCAL:1
		CASE 3
			SIF LOCAL:1 < 0 && (TALENT:ARG:Ｂ민감 || ABL:ARG:Ｂ감각 >= 5 || TALENT:ARG:음유)
				LOCAL:1 = 0
			TCVAR:ARG:634 += LOCAL + LOCAL:1
		CASE 4
			SIF LOCAL:1 < 0 && (TALENT:ARG:Ｍ민감 || ABL:ARG:Ｍ감각 >= 5 || TALENT:ARG:음탕한입술)
				LOCAL:1 = 0
			TCVAR:ARG:635 += LOCAL + LOCAL:1
		ENDSELECT
	NEXT

	;탄산목욕
	IF TEQUIP:MASTER:입욕제 == 3
		TCVAR:ARG:620 += 10
		TCVAR:ARG:634 += 10
	ENDIF

	IF TALENT:ARG:겁쟁이
		TCVAR:ARG:630 += 100
		TCVAR:ARG:631 -= 30
		TCVAR:ARG:633 -= 75
	ENDIF
	IF TALENT:ARG:반항적
		TCVAR:ARG:624 -= 75
		TCVAR:ARG:625 -= 50
		TCVAR:ARG:631 += 50
	ENDIF
	IF TALENT:ARG:꿋꿋함
		TCVAR:ARG:624 -= 20
		TCVAR:ARG:625 -= 25
		TCVAR:ARG:630 -= 50
		TCVAR:ARG:631 += 50
		TCVAR:ARG:633 += 50
	ENDIF
	IF TALENT:ARG:솔직
		TCVAR:ARG:624 += 100
		TCVAR:ARG:631 -= 20
	ENDIF
	SIF TALENT:ARG:내성적
		TCVAR:ARG:631 -= 50
	IF TALENT:ARG:교만
		TCVAR:ARG:626 -= 50
		TCVAR:ARG:630 -= 40
		TCVAR:ARG:631 += 20
	ENDIF
	IF TALENT:ARG:프라이드낮음
		TCVAR:ARG:626 += 100
		TCVAR:ARG:630 += 50
		TCVAR:ARG:631 -= 20
	ENDIF
	IF TALENT:ARG:강기
		TCVAR:ARG:628 -= 20
		TCVAR:ARG:630 -= 50
	ENDIF
	SIF TALENT:ARG:심술쟁이
		TCVAR:ARG:624 -= 20
	SIF TALENT:ARG:냉정
		TCVAR:ARG:630 -= 50
	IF TALENT:ARG:무관심
		TCVAR:ARG:624 -= 50
		TCVAR:ARG:625 -= 50
		TCVAR:ARG:626 -= 50
		TCVAR:ARG:630 -= 20
		TCVAR:ARG:631 -= 20
	ENDIF
	IF TALENT:ARG:감정결핍
		TCVAR:ARG:624 -= 50
		TCVAR:ARG:625 -= 50
		TCVAR:ARG:626 -= 30
		TCVAR:ARG:628 -= 20
		TCVAR:ARG:630 -= 40
		TCVAR:ARG:631 -= 20
		TCVAR:ARG:633 -= 40
	ENDIF
	SIF TALENT:ARG:호기심
		TCVAR:ARG:627 += 20
	SIF TALENT:ARG:보수적
		TCVAR:ARG:627 -= 20
	SIF TALENT:ARG:양기
		TCVAR:ARG:633 -= 70
	SIF TALENT:ARG:음기
		TCVAR:ARG:633 += 150
	IF TALENT:ARG:억압
		TCVAR:ARG:625 -= 50
		TCVAR:ARG:631 += 50
		TCVAR:ARG:633 += 50
	ENDIF
	SIF TALENT:ARG:해방
		TCVAR:ARG:625 += 50
	IF TALENT:ARG:저항
		TCVAR:ARG:625 -= 50
		TCVAR:ARG:631 += 100
	ENDIF
	IF TALENT:ARG:반하기쉬움
		TCVAR:ARG:624 += 20
		TCVAR:ARG:626 += 10
	ENDIF
	IF TALENT:ARG:청초
		TCVAR:ARG:624 += 20
		TCVAR:ARG:628 += 50
	ENDIF

	SIF TALENT:ARG:장액분비체질
		TCVAR:ARG:632 += 200

	SIF TALENT:ARG:발정체질
		TCVAR:ARG:625 += 50

	SIF TALENT:ARG:현명함
		TCVAR:ARG:627 += 100
	IF TALENT:ARG:미련함
		TCVAR:ARG:627 -= 30
		TCVAR:ARG:627 += TEQUIP:ARG:칭찬하기 * 10
	ENDIF
	IF TALENT:ARG:헌신
		TCVAR:ARG:626 += 50
		TCVAR:ARG:627 += 50
	ENDIF
	SIF TALENT:ARG:쾌감에솔직
		TCVAR:ARG:625 += 50
	SIF TALENT:ARG:쾌감을부정
		TCVAR:ARG:625 -= 50
	IF TALENT:ARG:호색
		TCVAR:ARG:625 += 20
		TCVAR:ARG:628 -= 20
	ENDIF
	IF TALENT:ARG:쾌감에솔직 + TALENT:ARG:호색 && SEXUAL_PLAY()
		TCVAR:ARG:625 += 30
		TCVAR:ARG:630 -= 50
		TCVAR:ARG:631 -= 50
		TCVAR:ARG:633 -= 50
	ENDIF
	IF TALENT:ARG:도착적
		TCVAR:ARG:630 -= 50
		TCVAR:ARG:631 -= 20
		TCVAR:ARG:633 -= 20
		IF ABNORMAL_PLAY()
			TCVAR:ARG:625 += 50
			TCVAR:ARG:631 -= 30
			TCVAR:ARG:633 -= 30
		ENDIF
	ENDIF
	IF TALENT:ARG:연모 && PLAYER == MASTER
		TCVAR:ARG:631 -= 30
	ENDIF
	IF TALENT:ARG:망신 && PLAYER == MASTER
		TCVAR:ARG:626 += 300
		TCVAR:ARG:631 -= 50
	ENDIF

	LOCAL = STATE("드렁크", ARG) + STATE("술주정", ARG)
	;드렁크
	IF LOCAL
		TCVAR:ARG:624 -= LOCAL*20
		TCVAR:ARG:625 += LOCAL*30
		TCVAR:ARG:627 -= LOCAL*50
		TCVAR:ARG:628 -= LOCAL*30
		TCVAR:ARG:629 -= LOCAL*10
		TCVAR:ARG:630 -= LOCAL*10
		TCVAR:ARG:631 -= LOCAL*10
		TCVAR:ARG:633 -= LOCAL*30
	ENDIF
	IF TALENT:ARG:마도인형
		TCVAR:ARG:630 -= 80
		TCVAR:ARG:631 -= 80
		TCVAR:ARG:633 -= 80
	ENDIF
	IF TALENT:ARG:슬라임
		TCVAR:ARG:629 -= 100
	ENDIF
	IF TALENT:ARG:상위몽마
		TCVAR:ARG:624 -= 20
		TCVAR:ARG:625 -= 20
		TCVAR:ARG:626 -= 20
	ENDIF
	IF TCVAR:ARG:28
		;自分からやってる行動に対する不満が少ない人
		IF TALENT:ARG:양기 || TALENT:ARG:현명함
			TCVAR:ARG:630 -= 50 + TCVAR:ARG:28
			TCVAR:ARG:631 -= 50 + TCVAR:ARG:28
		ELSE
			TCVAR:ARG:630 -= 10 + TCVAR:ARG:28
			TCVAR:ARG:631 -= 10 + TCVAR:ARG:28
		ENDIF
	ENDIF
	IF COND("발정기", ARG)
		TCVAR:ARG:625 += 100
		TCVAR:ARG:626 -= 50
		TCVAR:ARG:627 -= 100
		TCVAR:ARG:628 -= 50
		TCVAR:ARG:630 -= 20
		TCVAR:ARG:631 -= 20
		TCVAR:ARG:633 -= 20
	ENDIF

	TCVAR:ARG:631 -= MARK:ARG:고통각인*10

	SELECTCASE MARK:ARG:반발각인
	CASE 3
		TCVAR:ARG:624 -= 40
		TCVAR:ARG:625 -= 40
	CASE 2
		TCVAR:ARG:624 -= 20
		TCVAR:ARG:625 -= 20
	CASE 1
		TCVAR:ARG:624 -= 10
		TCVAR:ARG:625 -= 10
	ENDSELECT

	;ご기분（最低値自体が変わります! ）
	SELECTCASE MARK:ARG:기분
	CASE 1
		SIF TCVAR:ARG:631 < 80
			TCVAR:ARG:631 = 80
		SIF TCVAR:ARG:633 < 80
			TCVAR:ARG:633 = 80
	CASE 2
		SIF TCVAR:ARG:631 < 200
			TCVAR:ARG:631 = 200
		SIF TCVAR:ARG:633 < 200
			TCVAR:ARG:633 = 200
	ENDSELECT

	;넘어뜨리기or칭찬하기보너스
	IF TEQUIP:ARG:넘어뜨리기 || TEQUIP:ARG:칭찬하기커맨드からの派生플래그
		TCVAR:ARG:630 -= 100
		TCVAR:ARG:631 -= 200
		TCVAR:ARG:633 -= 100
	ENDIF

	;식스나인보너스
	IF TEQUIP:ARG:식스나인
		TCVAR:ARG:625 += 50
		TCVAR:ARG:628 += 50
	ENDIF

	;이하ＳＭ系. 마조끼と마조で色々緩和
	LOCAL = ABL:ARG:마조끼*5 + TALENT:ARG:마조*10
	;아이마스크
	IF TEQUIP:ARG:아이마스크
		TCVAR:ARG:624 += LOCAL - 10
		TCVAR:ARG:625 += ABL:ARG:마조끼*5
		TCVAR:ARG:626 += 20
		TCVAR:ARG:627 -= 50
		TCVAR:ARG:630 += 20
	ENDIF
	;밧줄・구속
	IF TEQUIP:ARG:구속
		;고통を伴う
		SIF GETBIT(TEQUIP:ARG:구속, 0)
			TCVAR:ARG:629 += 10
		SIF GETBIT(TEQUIP:ARG:구속, 1)
			TCVAR:ARG:629 += 20
		SIF GETBIT(TEQUIP:ARG:구속, 2)
			TCVAR:ARG:629 += 40
		;羞恥を伴う
		SIF GETBIT(TEQUIP:ARG:구속, 3)
			TCVAR:ARG:628 += 10
		SIF GETBIT(TEQUIP:ARG:구속, 4)
			TCVAR:ARG:628 += 20
		SIF GETBIT(TEQUIP:ARG:구속, 5)
			TCVAR:ARG:628 += 40
		;공포を伴う
		SIF GETBIT(TEQUIP:ARG:구속, 6)
			TCVAR:ARG:630 += 10
		SIF GETBIT(TEQUIP:ARG:구속, 7)
			TCVAR:ARG:630 += 20
		SIF GETBIT(TEQUIP:ARG:구속, 8)
			TCVAR:ARG:630 += 40

		;9bit 손が使えない 10bit 발が使えない 11bit 体勢が変えられない
		LOCAL:1 = 0
		SIF GETBIT(TEQUIP:ARG:구속, 9)
			LOCAL:1 += 20
		SIF GETBIT(TEQUIP:ARG:구속, 10)
			LOCAL:1 += 10
		SIF GETBIT(TEQUIP:ARG:구속, 11)
			LOCAL:1 += 30

		TCVAR:ARG:624 -= 30 + LOCAL:1/2 - LOCAL
		TCVAR:ARG:625 += ABL:ARG:마조끼*5
		TCVAR:ARG:626 += LOCAL:1
		TCVAR:ARG:627 -= LOCAL:1
		TCVAR:ARG:630 += LOCAL:1
		TCVAR:ARG:633 += LOCAL:1 - LOCAL*2
	ENDIF
	;재갈
	IF TEQUIP:ARG:재갈
		TCVAR:ARG:624 -= 20 - LOCAL
		TCVAR:ARG:625 += ABL:ARG:마조끼*5
		TCVAR:ARG:626 += 20
		TCVAR:ARG:627 -= 10
		TCVAR:ARG:630 += 10
	ENDIF
	;관장
	IF TEQUIP:ARG:관장 || SELECTCOM == 136 || NOWEX:ARG:배설
		LOCAL:1 = COND("액체관장", ARG)*10 + 10
		;배설플래그ＯＮ（このターンに漏らした）
		IF NOWEX:ARG:배설
			LOCAL:1 = 200
		;栓無し
		ELSEIF COND("애널栓", ARG) == 0
			LOCAL:1 += 30
		ENDIF
		TCVAR:ARG:624 -= 50 + LOCAL:1 - LOCAL*2
		TCVAR:ARG:626 += 50 + LOCAL:1
		TCVAR:ARG:627 -= 50 + LOCAL:1
		TCVAR:ARG:630 += 50 + LOCAL:1
	ENDIF

	LOCAL = 0
	;주인による조교경험
	IF MARK:ARG:굴복각인 == 3
		LOCAL = 40
	ELSEIF CFLAG:ARG:2 >= 2000 || MARK:ARG:굴복각인 == 2
		LOCAL = 30
	ELSEIF CFLAG:ARG:2 >= 700 || MARK:ARG:굴복각인 == 1
		LOCAL = 20
	ELSEIF CFLAG:ARG:2 >= 100
		LOCAL = 10
	ENDIF
	TCVAR:ARG:631 -= LOCAL

	;조교자のABL:기교によって, 教え方が上手くなる
	SELECTCASE ABL:PLAYER:기교 - ABL:ARG:기교
	CASE IS >= 3
		TCVAR:ARG:627 += 50
	CASE IS >= 2
		TCVAR:ARG:627 += 30
	CASE IS >= 1
		TCVAR:ARG:627 += 10
	ENDSELECT

	IF TEQUIP:ARG:미약
		TCVAR:ARG:624 -= TEQUIP:ARG:미약/2
		TCVAR:ARG:625 += TEQUIP:ARG:미약/2
		TCVAR:ARG:627 -= TEQUIP:ARG:미약/2
		TCVAR:ARG:629 -= TEQUIP:ARG:미약/2
		TCVAR:ARG:630 -= TEQUIP:ARG:미약
		TCVAR:ARG:631 -= TEQUIP:ARG:미약/4
	ENDIF
	IF TEQUIP:ARG:이뇨제
		TCVAR:ARG:624 -= 20
		TCVAR:ARG:625 -= 20
		TCVAR:ARG:626 += 20
		TCVAR:ARG:631 += 50
		TCVAR:ARG:633 += 50
	ENDIF

	SELECTCASE TEQUIP:MASTER:입욕제
	;秘湯の입욕제
	CASE 2
		TCVAR:ARG:625 += 10
		TCVAR:ARG:628 -= 50
	;バラの花びら
	CASE 4
		TCVAR:ARG:625 += 30
	;ひのき
	CASE 6
		TCVAR:ARG:630 -= 20
		TCVAR:ARG:631 -= 20
		TCVAR:ARG:633 -= 20
	;ミステリアス
	CASE 7
		TCVAR:ARG:630 += 20
	ENDSELECT
	;야외플레이…花園、森林、水辺、海はボーナスあり
	IF COND("삼림", ARG) || COND("화원", ARG) || COND("강가", ARG) || COND("바다", ARG)
		SIF COND("삼림", ARG)
			TCVAR:ARG:625 += 20
		SIF COND("화원", ARG)
			TCVAR:ARG:624 += 20
		TCVAR:ARG:631 -= 20
		TCVAR:ARG:633 -= 20
	ENDIF
	;플라트
	IF TEQUIP:ARG:플라트
		TCVAR:ARG:630 -= 10
		TCVAR:ARG:631 -= 10
		TCVAR:ARG:633 -= 10
	ENDIF
	;褒めてご기분取り
	IF TEQUIP:ARG:칭찬하기
		TCVAR:ARG:624 += 10
		TCVAR:ARG:630 -= 10
		TCVAR:ARG:631 -= 10
		TCVAR:ARG:633 -= 10
	ENDIF
	;달콤한말
	IF TEQUIP:ARG:달콤한말 >= 1 && TEQUIP:ARG:달콤한말 <= 8
		TCVAR:ARG:624 += 10
		TCVAR:ARG:625 += 10
		TCVAR:ARG:630 -= 10
		TCVAR:ARG:631 -= 10
		TCVAR:ARG:633 -= 10
	ENDIF
	;무드をみる
	LOCAL = MOOD() / 5
	TCVAR:ARG:624 += LOCAL
	TCVAR:ARG:625 += LOCAL
	TCVAR:ARG:630 -= LOCAL
	TCVAR:ARG:631 -= LOCAL
	TCVAR:ARG:633 -= LOCAL
	;반발각인が無いなら절정보정
	IF NOWEX:ARG:절정수합계 && MARK:ARG:반발각인 == 0
		TCVAR:ARG:630 -= 20
		TCVAR:ARG:631 -= 20
	ENDIF
	;봉사커맨드のやる気보정
	IF TCVAR:ARG:28
		TCVAR:ARG:627 += TCVAR:ARG:28
		TCVAR:ARG:628 -= TCVAR:ARG:28
		TCVAR:ARG:630 -= TCVAR:ARG:28
		TCVAR:ARG:631 -= TCVAR:ARG:28
		TCVAR:ARG:633 -= TCVAR:ARG:28
	ENDIF

	;-------------------------------------------------
	;相性, 권속による上下の処理
	;-------------------------------------------------
	LOCAL = RELATION:ARG:(NO:PLAYER)
	SIF COND("권속", PLAYER) == ARG || COND("권속", ARG) == PLAYER
		LOCAL = MAX(LOCAL + 20, 120)
	IF LOCAL > 0
		LOCAL -= 100
		TCVAR:ARG:624 += LOCAL
		TCVAR:ARG:625 += LOCAL
		TCVAR:ARG:631 -= LOCAL
		TCVAR:ARG:633 -= LOCAL
	ENDIF

	LOCAL = -1
	;이하, ASSI,MASTERの조교していない側の소질
	IF ASSIPLAY
		LOCAL = RELATION:ARG:(NO:MASTER)
	ELSEIF ASSI
		LOCAL = RELATION:ARG:(NO:ASSI)
	ENDIF
	IF LOCAL > 100
		;あくまでSUBなので, 보정をかける
		LOCAL = (LOCAL - 100)/2
		TCVAR:ARG:631 -= LOCAL
		TCVAR:ARG:633 -= LOCAL
	ENDIF

	;-------------------------------------------------
	;同じ커맨드の連続実行による上下の処理
	;-------------------------------------------------
	;連続実行の例外
	LOCAL = 0
	SELECTCASE SELECTCOM
	CASE 31, 201
		SIF TEQUIP:ARG:바이브 == 0
			LOCAL = 1
	CASE 33, 202
		SIF TEQUIP:ARG:애널바이브 == 0
			LOCAL = 1
	CASE 34, 203
		SIF TEQUIP:ARG:클리캡 == 0
			LOCAL = 1
	CASE 35, 204
		SIF TEQUIP:ARG:니플캡 == 0
			LOCAL = 1
	CASE 36, 205
		SIF TEQUIP:ARG:착유기 == 0
			LOCAL = 1
	CASE 38
		SIF TEQUIP:ARG:샤워 == 0
			LOCAL = 1
	CASE 136, 207
		SIF TEQUIP:ARG:관장 == 0
			LOCAL = 1
	CASE 137
		SIF TEQUIP:ARG:확장벌룬 == 0
			LOCAL = 1
	CASE 208
		SIF TEQUIP:ARG:촉수구욕 == 0
			LOCAL = 1
	ENDSELECT

	;同じ커맨드の連続実行
	SIF SELECTCOM == PREVCOM && LOCAL == 0
		TCVAR:ARG:627 += 50
	;-------------------------------------------------
	;기력０による上下の処理
	;-------------------------------------------------
	IF BASE:ARG:기력 <= 0
		TCVAR:ARG:624 -= 90
		TCVAR:ARG:625 -= 90
		TCVAR:ARG:627 -= 90
		TCVAR:ARG:631 += 20
		TCVAR:ARG:633 += 20
	ENDIF

	;Ｖ윤はある程度이상は増えずらい
	SELECTCASE PALAM:ARG:Ｖ윤
	CASE IS <= 10000
	CASE IS <= 30000
		TCVAR:ARG:623 -= 100
	CASE IS <= 60000
		TCVAR:ARG:623 -= 200
	CASE IS <= 100000
		TCVAR:ARG:623 -= 400
	ENDSELECT

	;CUP:쾌Ｃ(쾌Ｃ) ～ CUP:쾌Ｍ(쾌Ｍ)の보정치の最終結果
	FOR LCOUNT, 620, 640
		SELECTCASE LCOUNT
		CASE 630, 631, 633
			TCVAR:ARG:LCOUNT = MAX(TCVAR:ARG:LCOUNT, -99)
		CASEELSE
			TCVAR:ARG:LCOUNT = MAX(TCVAR:ARG:LCOUNT, -80)
		ENDSELECT
	NEXT

CASE "정액에약함"
	;ここは最初に得る時限定の場所なので, 既に소질を持っているならば終了. 정액중독も必須
	SIF TALENT:ARG:정액에약함 || ABL:ARG:정액중독 == 0
		RETURN 0
	;정액を受け止めた경험が필요
	SIF MAX(EXP:ARG:정액경험/10, EXP:ARG:질내정액경험, EXP:ARG:장내정액경험, EXP:ARG:정음경험, EXP:ARG:유내정액경험*10, EXP:ARG:방광정액경험*5) < 20
		RETURN 0
	SIF ABL:ARG:정액중독 + TALENT:ARG:도착적 + (EXP:ARG:질내정액경험 + EXP:ARG:장내정액경험 + EXP:ARG:정음경험 + EXP:ARG:유내정액경험*10 + EXP:ARG:방광정액경험*5)/100 < 3
		RETURN 0

	;이하でどこに사정されるのに弱いかを決める
	LOCAL:0 = EXP:ARG:정음경험 * (ABL:ARG:Ｍ감각 + TALENT:ARG:Ｍ민감 - TALENT:ARG:Ｍ둔감 + TALENT:ARG:음탕한입술*2)
	LOCAL:1 = EXP:ARG:질내정액경험 * (ABL:ARG:Ｖ감각 + TALENT:ARG:Ｖ민감 - TALENT:ARG:Ｖ둔감 + TALENT:ARG:음호*2)
	LOCAL:2 = EXP:ARG:장내정액경험 * (ABL:ARG:Ａ감각 + TALENT:ARG:Ａ민감 - TALENT:ARG:Ａ둔감 + TALENT:ARG:애널광*2)
	;이하は난이도高いのでサービスとして他よりもなりやすい
	LOCAL:3 = EXP:ARG:유내정액경험 * 10 * (ABL:ARG:Ｂ감각 + TALENT:ARG:Ｂ민감 - TALENT:ARG:Ｂ둔감 + TALENT:ARG:음유*2)
	LOCAL:4 = EXP:ARG:방광정액경험 * 5 * TALENT:ARG:요도성감

	;上のパターンのうち최대の値をセット
	LOCAL:9 = MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4)

	;0bit정음에약함 1bit질내사정에약함 2bit장내사정에약함 3bit유내사정에약함 4bit요도내사정에약함
	IF LOCAL:0 >= LOCAL:9
		TALENT:ARG:정액에약함 = 1p0
	ELSEIF LOCAL:1 >= LOCAL:9
		TALENT:ARG:정액에약함 = 1p1
	ELSEIF LOCAL:2 >= LOCAL:9
		TALENT:ARG:정액에약함 = 1p2
	ELSEIF LOCAL:3 >= LOCAL:9
		TALENT:ARG:정액에약함 = 1p3
	ELSEIF LOCAL:4 >= LOCAL:9
		TALENT:ARG:정액에약함 = 1p4
	ENDIF
CASE "정액에약함部位の変化"
	;소질を持って無いならば終了
	SIF TALENT:ARG:정액에약함 == 0
		RETURN 0

	;이하でどこに사정されるのに弱いかを決める
	;ＶＡ以外の部位はサービスとして他よりもなりやすい
	LOCAL:0 = EXP:ARG:정음경험 * 3 * (ABL:ARG:Ｍ감각 + TALENT:ARG:Ｍ민감 - TALENT:ARG:Ｍ둔감 + TALENT:ARG:음탕한입술*2)
	LOCAL:1 = EXP:ARG:질내정액경험 * (ABL:ARG:Ｖ감각 + TALENT:ARG:Ｖ민감 - TALENT:ARG:Ｖ둔감 + TALENT:ARG:음호*2 + MARK:ARG:정액각인)
	LOCAL:2 = EXP:ARG:장내정액경험 * (ABL:ARG:Ａ감각 + TALENT:ARG:Ａ민감 - TALENT:ARG:Ａ둔감 + TALENT:ARG:애널광*2)
	LOCAL:3 = EXP:ARG:유내정액경험 * 10 * (ABL:ARG:Ｂ감각 + TALENT:ARG:Ｂ민감 - TALENT:ARG:Ｂ둔감 + TALENT:ARG:음유*2)
	LOCAL:4 = EXP:ARG:방광정액경험 * 5 * TALENT:ARG:요도성감

	;上のパターンのうち최대の値をセット
	LOCAL:9 = MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4)
	
	;ここで최대の値が50未満なら変化は起きない
	SIF LOCAL:9 < 50
		RETURN 0

	;0bit정음에약함 1bit질내사정에약함 2bit장내사정에약함 3bit유내사정에약함 4bit요도내사정에약함
	;変更する際には１番大きい値が２番目の値よりも500多いか倍なければならないとする
	IF LOCAL:0 >= LOCAL:9
		SIF LOCAL:0 >= MIN(MAX(LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4)*2, MAX(LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4) + 500)
			TALENT:ARG:정액에약함 = 1p0
	ELSEIF LOCAL:1 >= LOCAL:9
		SIF LOCAL:1 >= MIN(MAX(LOCAL:0, LOCAL:2, LOCAL:3, LOCAL:4)*2, MAX(LOCAL:0, LOCAL:2, LOCAL:3, LOCAL:4) + 500)
			TALENT:ARG:정액에약함 = 1p1
	ELSEIF LOCAL:2 >= LOCAL:9
		SIF LOCAL:2 >= MIN(MAX(LOCAL:0, LOCAL:1, LOCAL:3, LOCAL:4)*2, MAX(LOCAL:0, LOCAL:1, LOCAL:3, LOCAL:4) + 500)
			TALENT:ARG:정액에약함 = 1p2
	ELSEIF LOCAL:3 >= LOCAL:9
		SIF LOCAL:3 >= MIN(MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:4)*2, MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:4) + 500)
			TALENT:ARG:정액에약함 = 1p3
	ELSEIF LOCAL:4 >= LOCAL:9
		SIF LOCAL:4 >= MIN(MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3)*2, MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3) + 500)
			TALENT:ARG:정액에약함 = 1p4
	ENDIF
CASE "선호체위"
	IF TALENT:ARG:남자 || ARG == MASTER
		TALENT:ARG:선호체위 = 0
		RETURN 0
	ENDIF
	;bitで管理する
	;0정상위, 1후배위, 2굴곡위, 3대면좌위, 4배면좌위, 5봉사기승위, 6밀어쓰러뜨려기승위, 9特になし
	;10～16はＡ체위, 19에이스오브스페이드, 20～26は체위

	VARSET LOCAL

	;初期설정
	IF TALENT:ARG:선호체위 == 0 && MAX(EXP:ARG:Ｖ성교경험, EXP:ARG:Ａ성교경험, EXP:ARG:허리사용경험) >= 10
		LOCAL:0 = TALENT:ARG:청초 + TALENT:ARG:솔직 + TALENT:ARG:기품
		LOCAL:1 = TALENT:ARG:호색 + TALENT:ARG:조야
		LOCAL:2 = TALENT:ARG:프라이드낮음
		LOCAL:3 = TALENT:ARG:내성적 + TALENT:ARG:겁쟁이
		LOCAL:4 = TALENT:ARG:양기
		LOCAL:5 = TALENT:ARG:심술쟁이 + TALENT:ARG:헌신
		LOCAL:6 = TALENT:ARG:호색 + TALENT:ARG:강기 + TALENT:ARG:새드 + TALENT:ARG:교만
		LOCAL:9 = TALENT:ARG:음기 + TALENT:ARG:냉정
		SIF ABL:ARG:레즈끼 >= 3
			LOCAL:19 = TALENT:ARG:바이 + TALENT:ARG:남성혐오

		LOCAL:90 = MAX(LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5)

		IF LOCAL:9 >= MAX(LOCAL:90, LOCAL:6, LOCAL:19)
			SETBIT TALENT:ARG:선호체위, 9
			RETURN 0
		ENDIF

		SIF ABL:ARG:Ａ감각 > MAX(ABL:ARG:Ｖ감각, 2)
			LOCAL:10 = 10

		SELECTCASE LOCAL:90
		CASE IS < LOCAL:6
		CASE LOCAL:0
			SETBIT TALENT:ARG:선호체위, 0 + LOCAL:10
		CASE LOCAL:1
			SETBIT TALENT:ARG:선호체위, 1 + LOCAL:10
		CASE LOCAL:2
			SETBIT TALENT:ARG:선호체위, 2 + LOCAL:10
		CASE LOCAL:3
			SETBIT TALENT:ARG:선호체위, 3 + LOCAL:10
		CASE LOCAL:4
			SETBIT TALENT:ARG:선호체위, 4 + LOCAL:10
		CASE LOCAL:5
			SETBIT TALENT:ARG:선호체위, 5 + LOCAL:10
		ENDSELECT
		SIF LOCAL:6 >= LOCAL:90
			SETBIT TALENT:ARG:선호체위, 6 + LOCAL:10
	ELSEIF TALENT:ARG:선호체위 == 0
		SETBIT TALENT:ARG:선호체위, 9
	ELSE
		LOCAL:0 = NUM_STR(CSTR:ARG:2, "정상위")
		LOCAL:1 = NUM_STR(CSTR:ARG:2, "후배위")
		LOCAL:2 = NUM_STR(CSTR:ARG:2, "굴곡위")
		LOCAL:3 = NUM_STR(CSTR:ARG:2, "대면좌위")
		LOCAL:4 = NUM_STR(CSTR:ARG:2, "배면좌위")
		LOCAL:5 = NUM_STR(CSTR:ARG:2, "기승위")
		LOCAL:6 = NUM_STR(CSTR:ARG:2, "넘어뜨리기기승위")

		LOCAL:10 = NUM_STR(CSTR:ARG:2, "애널정상위")
		LOCAL:11 = NUM_STR(CSTR:ARG:2, "애널후배위")
		LOCAL:12 = NUM_STR(CSTR:ARG:2, "애널굴곡위")
		LOCAL:13 = NUM_STR(CSTR:ARG:2, "애널대면좌위")
		LOCAL:14 = NUM_STR(CSTR:ARG:2, "애널배면좌위")
		LOCAL:15 = NUM_STR(CSTR:ARG:2, "애널기승위")
		LOCAL:16 = NUM_STR(CSTR:ARG:2, "넘어뜨리기애널기승위")

		LOCAL:19 = NUM_STR(CSTR:ARG:2, "에이스오브스페이드")

		LOCAL:20 = NUM_STR(CSTR:ARG:2, "요도삽입")
		;LOCAL:21 = NUM_STR(CSTR:ARG:2, "요도후배위")
		;LOCAL:22 = NUM_STR(CSTR:ARG:2, "요도굴곡위")
		;LOCAL:23 = NUM_STR(CSTR:ARG:2, "요도대면좌위")
		;LOCAL:24 = NUM_STR(CSTR:ARG:2, "요도배면좌위")
		;LOCAL:25 = NUM_STR(CSTR:ARG:2, "요도기승위")
		LOCAL:26 = NUM_STR(CSTR:ARG:2, "넘어뜨리기요도기승위")

		;今までの선호체위のポイントは？
		FOR LCOUNT, 0, 30
			;PRINTFORML LOCAL:{LCOUNT} = {LOCAL:LCOUNT}
			SIF GETBIT(TALENT:ARG:선호체위, LCOUNT) == 0
				CONTINUE
			LOCAL:30 = MAX(LOCAL:LCOUNT, LOCAL:30)
		NEXT

		;ポイント上位二つを選ぶ. LOCAL:40が１位, LOCAL:41が２位とする
		FOR LCOUNT, 0, 30
			;２位未満
			SIF LOCAL:LCOUNT < LOCAL:(LOCAL:41)
				CONTINUE
			SELECTCASE LOCAL:LCOUNT
			CASE IS >= LOCAL:(LOCAL:40)
				LOCAL:41 = LOCAL:40
				LOCAL:40 = LCOUNT
			CASE IS >= LOCAL:(LOCAL:41)
				LOCAL:41 = LCOUNT
			ENDSELECT
		NEXT

		;PRINTFORML LOCAL:30 = {LOCAL:30}, LOCAL:40 = {LOCAL:40}, LOCAL:41 = {LOCAL:41}, 
		;10이상, 今までの선호체위のポイントの최대치を上回っていると선호체위が変化する
		IF LOCAL:(LOCAL:40) - 10 >= LOCAL:30
			;(정상위～기승위), 밀어쓰러뜨려기승위, (Ａ정상위～Ａ기승위), 넘어뜨리기Ａ기승위, 조개맞대기 の中から上位二つを選ぶ
			TALENT:ARG:선호체위 = 0
			SETBIT TALENT:ARG:선호체위, LOCAL:40

			;基本は１つだけだが, １位と２位の差が３倍以内, かつ, ２位のポイントが10이상ならば２位も선호체위となる
			SIF LOCAL:(LOCAL:41)*3 >= LOCAL:(LOCAL:40) && LOCAL:(LOCAL:41) >= 10
				SETBIT TALENT:ARG:선호체위, LOCAL:41
		ENDIF
	ENDIF
CASE "일々の음모＆겨털処理"
	SIF COND("음모", ARG) <= 1 || TALENT:ARG:마도인형
		RETURN 0

	;일数経過とともに음모が伸びます. 若いとあんま生えない
	IF BASE:ARG:음모%100 < 90
		SELECTCASE AGE(ARG)
		CASE 1, 2
			BASE:ARG:음모 += 1
		CASE 3
			BASE:ARG:음모 += 2
		CASE IS >= 4
			BASE:ARG:음모 += 3
		ENDSELECT
	ENDIF
	LOCAL = BASE:ARG:음모%100

	SELECTCASE COND("음모", ARG)
	;脱毛状態→ツルツル
	CASE 2
		SIF LOCAL >= LIMIT(30 * (AGE(ARG) - 1), 30, 60)
			BASE:ARG:음모 = 300
	;ツルツル→生えかけ（어른は아침になると…）
	CASE 3
		SIF LOCAL >= 6 || AGE(ARG) >= 4
			BASE:ARG:음모 = 400
	;生えかけ→ナチュラル
	CASE 4
		SIF LOCAL >= 20 + RAND:20 && AGE(ARG) >= 2
			BASE:ARG:음모 = 600
	;お손入れ→ナチュラル
	CASE 5
		IF LOCAL >= 30 + RAND:20
			BASE:ARG:음모 = 600
			;아이なら, 生えかけになる
			SIF AGE(ARG) == 1
				BASE:ARG:음모 = 400
		ENDIF
	;언니이상はナチュラル→生え放題
	CASE 6
		SIF LOCAL >= 40 + RAND:40 && AGE(ARG) >= 3
			BASE:ARG:음모 = 700
	ENDSELECT

	;몽마によるお손入れ
	IF COND("身嗜み：음모", ARG)
		SELECTCASE COND("身嗜み：음모", ARG)
		CASE 3, 5
			SIF COND("身嗜み：음모", ARG) <= COND("음모", ARG)
				BASE:ARG:음모 = COND("身嗜み：음모", ARG)*100
		ENDSELECT
	;剃るなと지시されていない
	ELSE
		;마조ッ気や노출벽が高いと, たま～にツルツルにします
		IF COND("음모", ARG) >= 4 && RAND:30 == 0 && MAX(ABL:ARG:노출벽 - 1, ABL:ARG:마조끼) >= 3
			BASE:ARG:음모 = 300
			;PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 그곳의 털을 반질반질하게 깎아본 것같다…
		;食い込んでいる衣装の時には剃り整えます
		ELSEIF COND("음모", ARG) >= 6 && CHECK_CLO("食い込み", ARG)
			BASE:ARG:음모 = 500
		;生え放題状態は, ほぼ確実に避けます
		ELSEIF COND("음모", ARG) == 7 && RAND:100
			;부끄럼쟁이+호색でない 몽마は, 剃ったと悟られるのが嫌なので, ナチュラルになるよう頑張ります
			IF (TALENT:ARG:보수적 + TALENT:ARG:부끄럼쟁이 && TALENT:ARG:호색 == 0) || RAND:10
				BASE:ARG:음모 = 600
			ELSE
				BASE:ARG:음모 = 500
				;PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 그곳의 털을 깎아서 정리했다…
			ENDIF
		;ナチュラルは, たま～に剃ります. 호색だったり, 여름が近いと, 高확률で剃り整えます
		ELSEIF COND("음모", ARG) == 6 && (!RAND:500 || (FLAG:871 + 1 >= 20 + RAND:20 && FLAG:871 + 1 < 60 && !RAND:3) || (TALENT:ARG:호색 && COND("몽마", ARG) && RAND:2) )
			BASE:ARG:음모 = 500
			;PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 그곳의 털을 깎아서 정리했다…
		ENDIF
	ENDIF

	;次いで겨털の処理
	SIF CONFIG("겨털") == 0
		RETURN 0

	;일数経過とともに겨털が伸びます. 若いとあんま生えない
	SIF BASE:ARG:겨털%100 < 90
		BASE:ARG:겨털 += 1 + (AGE(ARG) - 1)/2

	LOCAL = BASE:ARG:음모%100

	SELECTCASE COND("겨털", ARG)
	;脱毛状態→ツルツル
	CASE 2
		SIF LOCAL >= LIMIT(30 * (AGE(ARG) - 1), 30, 60)
			BASE:ARG:겨털 = 300
	;ツルツル→生えかけ
	CASE 3
		SIF LOCAL >= 6
			BASE:ARG:겨털 = 400
	;生えかけ→生え放題
	CASE 4
		SIF LOCAL >= 20 + RAND:20 && AGE(ARG) >= 2
			BASE:ARG:겨털 = 700
	ENDSELECT

	;몽마によるお손入れ
	IF COND("身嗜み：겨털", ARG)
		SELECTCASE COND("身嗜み：겨털", ARG)
		CASE 3
			SIF COND("身嗜み：겨털", ARG) <= COND("겨털", ARG)
				BASE:ARG:겨털 = COND("身嗜み：겨털", ARG)*100
		ENDSELECT
	;剃るなと지시されていない
	ELSE
		;겨털に関しては, 皆かなりまめに剃ります…보수적な人以外は! 
		;호색or오토코노코なら超高확률で겨드랑이つるつる
		IF TALENT:ARG:호색 || COND("오토코노코", ARG)
			SIF COND("음모", ARG) >= 4 && RAND:100
				BASE:ARG:겨털 = 300
		ELSEIF TALENT:ARG:보수적 && RAND:100
		ELSEIF COND("음모", ARG) == 4
			SIF RAND:10 == 0 || CHECK_CLO("겨드랑이노출", ARG)
				BASE:ARG:겨털 = 300
		;生え放題状態は, ほぼ確実に避けます
		ELSEIF COND("음모", ARG) > 4 && RAND:100
			BASE:ARG:겨털 = 300
		ENDIF
	ENDIF
CASE "장난감이되어버려라"
	;オモチャ判定
	SIF TALENT:장난감이되어버려라 == 0
		RETURN 0
	;基本実行度. 初期状態は10％で, 순종と호기심で확률ＵＰ. 
	LOCAL = 10 + ABL:순종*5 + TALENT:호기심*20

	LOCAL:1 = -1
	SELECTCASE SELECTCOM
	CASE 30
		LOCAL += ABL:욕망 * 7
		SIF TALENT:연모
			LOCAL = 100
		LOCAL:1 = 0
	CASE 31
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:바이브
			LOCAL = 100
		LOCAL:1 = 1
	CASE 32
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		LOCAL:1 = 2
	CASE 33
		LOCAL += ABL:Ａ감각 * 9
		SIF TALENT:연모 && LOCAL < 80
			LOCAL = 80
		;外す時は100％
		SIF TEQUIP:애널바이브
			LOCAL = 100
		LOCAL:1 = 3
	CASE 34
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:클리캡
			LOCAL = 100
		LOCAL:1 = 7
	CASE 35
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:니플캡
			LOCAL = 100
		LOCAL:1 = 8
	CASE 36
		LOCAL += TALENT:부끄럼없음 * 10
		LOCAL -= TALENT:부끄럼쟁이 * 10
		LOCAL += ABL:노출벽 * 5
		SIF TALENT:연모
			LOCAL = 100
		;外す時は100％
		SIF TEQUIP:착유기
			LOCAL = 100
		LOCAL:1 = 17
	CASE 37
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:오나홀
			LOCAL = 100
		LOCAL:1 = 12
	CASE 39
		LOCAL += ABL:욕망 * 7
		SIF TALENT:연모
			LOCAL = 100
		LOCAL:1 = 0
	CASE 131
		LOCAL += ABL:마조끼 * 10
		SIF TALENT:연모 && LOCAL < 80
			LOCAL = 80
		LOCAL:1 = 10
	CASE 132
		LOCAL += ABL:마조끼 * 10
		SIF TALENT:연모 && LOCAL < 75
			LOCAL = 75
		LOCAL:1 = 11
	CASE 133
		LOCAL += ABL:마조끼 * 10
		SIF TALENT:연모 && LOCAL < 90
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:아이마스크
			LOCAL = 100
		LOCAL:1 = 5
	CASE 134
		LOCAL += ABL:마조끼 * 10
		SIF TALENT:연모 && LOCAL < 90
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:구속
			LOCAL = 100
		LOCAL:1 = 14
	CASE 135
		LOCAL += ABL:마조끼 * 10
		SIF TALENT:연모 && LOCAL < 90
			LOCAL = 90
		;外す時は100％
		SIF TEQUIP:재갈
			LOCAL = 100
		LOCAL:1 = 9
	CASE 136
		LOCAL += ABL:Ａ감각 * 8
		SIF TALENT:연모 && LOCAL < 70
			LOCAL = 70
		;外す時は100％
		SIF TEQUIP:관장
			LOCAL = 100
		LOCAL:1 = 15
	CASE 137
		LOCAL += ABL:Ａ감각 * 8
		SIF TALENT:연모 && LOCAL < 70
			LOCAL = 70
		;外す時は100％
		SIF TEQUIP:확장벌룬
			LOCAL = 100
		LOCAL:1 = 23
	CASE 149
		LOCAL += ABL:마조끼 * 7
		SIF TALENT:연모
			LOCAL = 100
		LOCAL:1 = 24
	CASE 170
		;눈에띄고싶어함
		LOCAL += TALENT:눈에띄고싶어함 * 10
		;부끄럼쟁이
		LOCAL += TALENT:부끄럼없음 * 10
		LOCAL -= TALENT:부끄럼쟁이 * 10
		LOCAL += ABL:노출벽 * 5
		SIF TALENT:연모
			LOCAL = 100
		;終了時は100％
		SIF TEQUIP:비디오카메라
			LOCAL = 100
		LOCAL:1 = 6
	CASE 260
		LOCAL += ABL:욕망 * 7
		SIF TALENT:연모
			LOCAL = 100
		LOCAL:1 = 30
	CASE 261
		LOCAL += ABL:욕망 * 7
		SIF TALENT:연모
			LOCAL = 100
		LOCAL:1 = 31
	CASE 262
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		LOCAL:1 = 32
	CASE 263
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 90
		LOCAL:1 = 34
	CASE 264
		LOCAL += ABL:욕망 * 5
		SIF TALENT:연모
			LOCAL = 100
		LOCAL:1 = 35
	ENDSELECT

	SIF LOCAL:1 < 0
		RETURN 0

	;調整
	LOCAL = LIMIT(LOCAL, 0, 100)
	PRINTFORMW 성공률{LOCAL}％
	IF RAND:100 >= LOCAL
		TFLAG:18 = LOCAL:1
		SELECTCOM = 309
	ENDIF
CASE "매각価格：능력"
	VARSET LOCAL
	CFLAG:41 = 0

	SELECTCASE ABL:순종
	CASE IS >= 5
		LOCAL:0 = 5000
	CASE 4
		LOCAL:0 = 3000
	CASEELSE
		LOCAL:0 = ABL:순종 * 500
	ENDSELECT

	SELECTCASE ABL:욕망
	CASE IS >= 5
		LOCAL:1 = 3000
	CASE 4
		LOCAL:1 = 2000
	CASEELSE
		LOCAL:1 = ABL:욕망 * 300
	ENDSELECT

	SELECTCASE ABL:기교
	CASE IS >= 10
		LOCAL:2 = 8000
	CASE 9
		LOCAL:2 = 6000
	CASE IS >= 6
		LOCAL:2 = ABL:기교 * 500
	CASE IS >= 4
		LOCAL:2 = ABL:기교 * 400
	CASEELSE
		LOCAL:2 = ABL:기교 * 300
	ENDSELECT

	SELECTCASE ABL:봉사정신
	CASE IS >= 5
		LOCAL:6 = 4000
	CASE 4
		LOCAL:6 = 2500
	CASEELSE
		LOCAL:6 = ABL:봉사정신 * 400
	ENDSELECT

	SELECTCASE ABL:노출벽
	CASE IS >= 5
		LOCAL:7 = 2000
	CASE 4
		LOCAL:7 = 1000
	CASEELSE
		LOCAL:7 = ABL:봉사정신 * 200
	ENDSELECT

	SELECTCASE ABL:자위중독
	CASE IS >= 5
		LOCAL:10 = 2000
	CASE 4
		LOCAL:10 = 1000
	CASEELSE
		LOCAL:10 = ABL:자위중독 * 200
	ENDSELECT

	SELECTCASE ABL:정액중독
	CASE IS >= 5
		LOCAL:11 = 3000
	CASE 4
		LOCAL:11 = 2000
	CASEELSE
		LOCAL:11 = ABL:정액중독 * 300
	ENDSELECT

	FOR LCOUNT, 0, 12
		SIF LOCAL:LCOUNT && ARG == 2
			PRINTFORML %TEXT_RJ(ABLNAME:LCOUNT, 10)%{ABL:LCOUNT, 2}LV ＋{LOCAL:LCOUNT}
		CFLAG:41 += LOCAL:LCOUNT
	NEXT
	FOR LCOUNT, 0, 35
		SELECTCASE LCOUNT
		CASE 3 TO 5, 14, 16
			LOCAL:LCOUNT = 90 + ABL:LCOUNT*5
		CASE 9, 13
			LOCAL:LCOUNT = 90 + ABL:LCOUNT*5
		CASE 8, 15
			LOCAL:LCOUNT = 80 + ABL:LCOUNT*10
		CASE 20
			LOCAL:LCOUNT = 110 + ABL:LCOUNT*10
		CASE 23, 26
			LOCAL:LCOUNT = 20 + ABL:LCOUNT*20
		CASE 24, 27
			LOCAL:LCOUNT = 50 + ABL:LCOUNT
		CASE 30 TO 34
			LOCAL:LCOUNT = 90 + ABL:LCOUNT*5
		CASE 0 TO 2, 6, 7, 10 TO 12, 17 TO 29
			CONTINUE
		ENDSELECT
		SIF LOCAL:LCOUNT <= 100
			CONTINUE
		IF ARG == 2
			SELECTCASE LCOUNT
			CASE 24, 27
				PRINTFORML %TEXT_RJ(ABLNAME:LCOUNT, 10)%{ABL:LCOUNT, 3}P ×{LOCAL:LCOUNT / 100}.{LOCAL:LCOUNT % 100 / 10}{LOCAL:LCOUNT % 10}
			CASEELSE
				PRINTFORML %TEXT_RJ(ABLNAME:LCOUNT, 10)%{ABL:LCOUNT, 2}LV ×{LOCAL:LCOUNT / 100}.{LOCAL:LCOUNT % 100 / 10}{LOCAL:LCOUNT % 10}
			ENDSELECT
		ENDIF
		CFLAG:41 = MULTIPLY(CFLAG:41, LOCAL:LCOUNT)
	NEXT
	CFLAG:41 = (CFLAG:41 + 50)/100*100
CASE "매각価格：基礎"
	CFLAG:42 = 1000
	VARSET LOCAL, 100
	;TALENT:해방をみる
	LOCAL:33 = 110 * TALENT:해방
	;TALENT:부끄럼쟁이をみる
	LOCAL:35 = 120 * TALENT:부끄럼쟁이
	;TALENT:반하기쉬움をみる
	LOCAL:38 = 110 * TALENT:반하기쉬움
	;TALENT:청초をみる
	LOCAL:39 = 120 * TALENT:청초
	;TALENT:젖기쉬움をみる
	LOCAL:42 = 110 * TALENT:젖기쉬움
	;TALENT:기품をみる
	LOCAL:46 = 120 * TALENT:기품
	;TALENT:조야をみる
	LOCAL:47 = 80 * TALENT:조야
	;TALENT:현명함
	LOCAL:50 = 110 * TALENT:현명함
	;TALENT:헌신的をみる
	LOCAL:63 = 120 * TALENT:헌신
	;TALENT:발정체질をみる
	LOCAL:69 = 110 * TALENT:발정체질
	;TALENT:妖孤をみる
	LOCAL:90 = 110 * TALENT:요호
	;TALENT:매혹をみる
	LOCAL:91 = 120 * TALENT:매혹
	;TALENT:수수께끼의매력をみる
	LOCAL:92 = 150 * TALENT:수수께끼의매력
	;TALENT:Ｍ민감をみる
	LOCAL:97 = 110 * TALENT:Ｍ민감
	;TALENT:Ｃ민감をみる
	LOCAL:102 = 110 * TALENT:Ｃ민감
	;TALENT:Ｖ민감をみる
	LOCAL:104 = 110 * TALENT:Ｖ민감
	;TALENT:Ａ민감をみる
	LOCAL:106 = 110 * TALENT:Ａ민감
	;TALENT:Ｂ민감をみる
	LOCAL:108 = 110 * TALENT:Ｂ민감
	;TALENT:빈유をみる
	SIF TALENT:빈유 && TALENT:작은몸집 == 0
		LOCAL:109 = 90
	;TALENT:거유, 폭유をみる
	SIF TALENT:거유
		LOCAL:110 = 100 + TALENT:거유*25
	;TALENT:회복빠름をみる
	LOCAL:111 = 110 * TALENT:회복빠름
	;TALENT:동물귀をみる
	SIF TALENT:동물귀
		LOCAL:124 = 120
	;TALENT:매력をみる
	LOCAL:113 = 150 * TALENT:매력
	;TALENT:흡혈귀をみる
	LOCAL:114 = 120 * TALENT:흡혈귀
	;TALENT:후타나리をみる
	IF TALENT:후타나리 == 1
		LOCAL:121 = 200
	ELSEIF TALENT:후타나리
		LOCAL:121 = 110
	ENDIF
	;TALENT:남자をみる TALENT:매력 が無いなら減額
	IF TALENT:남자 && TALENT:매력 == 0
		IF ABL:순종 < 2 || ABL:욕망 < 2 || ABL:ＢＬ끼 < 1
			LOCAL:122 = 20
		ELSEIF ABL:순종 < 3 || ABL:욕망 < 3 || ABL:ＢＬ끼 < 2
			LOCAL:122 = 40
		ELSEIF ABL:순종 < 4 || ABL:욕망 < 4 || ABL:ＢＬ끼 < 3
			LOCAL:122 = 70
		ENDIF
	ENDIF
	;TALENT:금단의지식をみる
	LOCAL:125 = 150 * TALENT:금단의지식
	;TALENT:구현をみる
	LOCAL:127 = 120 * TALENT:구현

	;TALENT:요도성감をみる
	LOCAL:142 = 110 * TALENT:요도성감

	;TALENT:요정をみる
	LOCAL:150 = 150 * TALENT:요정
	;TALENT:마법사をみる
	SIF TALENT:마법사
		LOCAL:151 = 100 + 50 * TALENT:마법사
	;TALENT:라미아をみる
	LOCAL:152 = 120 * TALENT:라미아
	;TALENT:머메이드をみる
	LOCAL:153 = 150 * TALENT:머메이드
	;TALENT:인간형をみる
	LOCAL:154 = 80 * TALENT:마도인형
	;TALENT:하피をみる
	LOCAL:155 = 120 * TALENT:하피
	;TALENT:구지배자의자취をみる
	LOCAL:156 = 150 * TALENT:구지배자의자취
	;TALENT:드라군をみる
	LOCAL:157 = 150 * TALENT:드라군
	;TALENT:슬라임をみる
	LOCAL:158 = 120 * TALENT:슬라임
	;TALENT:팔많음をみる
	LOCAL:159 = 100 + 10 * TALENT:팔많음
	;TALENT:가창기능をみる
	SIF TALENT:가창기능
		LOCAL:193 = 150
	;TALENT:마왕의조각をみる
	LOCAL:203 = 150 * TALENT:마왕의조각

	FOR LCOUNT, 1, 230
		SIF LOCAL:LCOUNT == 0 || LOCAL:LCOUNT == 100
			CONTINUE
		SIF ARG == 2
			PRINTFORML %TEXT_RJ(TALENTNAME:LCOUNT, 14)% ×{LOCAL:LCOUNT / 100}.{LOCAL:LCOUNT % 100 / 10}{LOCAL:LCOUNT % 10}
		CFLAG:42 = MULTIPLY(CFLAG:42, LOCAL:LCOUNT)
	NEXT
	;TALENT:광기をみる
	IF TALENT:광기
		IF ABL:순종 < 5 || TALENT:음란 == 0
			LOCAL:123 = 10
			SIF ARG == 2
				PRINTFORML 운송시에 파괴폭주하고 실종 ×{LOCAL:123 / 100}.{LOCAL:123 % 100 / 10}{LOCAL:123 % 10}
		ELSE
			LOCAL:123 = 50
			SIF ARG == 2
				PRINTFORML %TEXT_RJ("광기", 14)% ×{LOCAL:123 / 100}.{LOCAL:123 % 100 / 10}{LOCAL:123 % 10}
		ENDIF
		CFLAG:42 = MULTIPLY(CFLAG:42, LOCAL:123)
	ENDIF
CASE "매각価格：変動소질"
	CFLAG:43 = 1000
	VARSET LOCAL, 100
	;TALENT:처녀をみる
	IF TALENT:처녀 == 1
		LOCAL:0 = 200
		SIF TALENT:Ａ처녀 == 1
			LOCAL:0 = 300
	ELSEIF TALENT:처녀
		LOCAL:0 = 110
	ENDIF
	;TALENT:꿋꿋함をみる
	SIF TALENT:꿋꿋함 && ABL:순종 > 2
		LOCAL:12 = 110
	;TALENT:교만をみる
	SIF TALENT:교만 && ABL:순종 > 2
		LOCAL:15 = 120
	;TALENT:自制心をみる
	SIF TALENT:냉정 && ABL:욕망 < 4
		LOCAL:20 = 80
	;TALENT:무관심をみる
	SIF TALENT:무관심 && ABL:욕망 < 4
		LOCAL:21 = 80
	;TALENT:감정결핍をみる
	SIF TALENT:감정결핍 && ABL:욕망 < 4
		LOCAL:22 = 80
	;TALENT:보수적をみる
	SIF TALENT:보수적 && ABL:욕망 < 4
		LOCAL:24 = 50
	;TALENT:일선을넘지않음をみる
	SIF TALENT:일선을넘지않음 && ABL:순종 < 5
		LOCAL:27 = 70
	;TALENT:Ｖ손상をみる
	IF TALENT:Ｖ손상
		LOCAL:44 = 30
	;Ｖ손상경험をみる
	ELSEIF EXP:Ｖ손상경험
		LOCAL:44 = MAX(100 - EXP:Ｖ손상경험 * 20, 30)
	ENDIF
	;TALENT:Ａ손상をみる
	IF TALENT:Ａ손상
		LOCAL:45 = 30
	;Ａ손상경험をみる
	ELSEIF EXP:Ａ손상경험
		LOCAL:45 = MAX(100 - EXP:Ａ손상경험 * 20, 30)
	ENDIF
	;TALENT:조합지식
	LOCAL:55 = 110 * TALENT:조합지식
	;TALENT:쾌감에솔직をみる
	SIF TALENT:쾌감에솔직 && ABL:욕망 > 2
		LOCAL:70 = 120
	;TALENT:쾌감을부정をみる
	SIF TALENT:쾌감을부정 && ABL:욕망 < 4
		LOCAL:71 = 50
	;TALENT:음호をみる
	LOCAL:74 = 150 * TALENT:음호
	;TALENT:음란をみる
	LOCAL:76 = 150 * TALENT:음란
	;TALENT:애널광をみる
	LOCAL:77 = 150 * TALENT:애널광
	;TALENT:음유をみる
	LOCAL:78 = 150 * TALENT:음유
	;TALENT:음핵をみる
	LOCAL:79 = 150 * TALENT:음핵
	;TALENT:도착적をみる
	SIF TALENT:도착적 && ABL:욕망 > 2
		LOCAL:80 = 120
	;TALENT:새드をみる
	LOCAL:83 = 120 * TALENT:새드
	;TALENT:마조をみる
	LOCAL:88 = 120 * TALENT:마조
	;TALENT:음탕한입술をみる
	LOCAL:89 = 150 * TALENT:음탕한입술
	;TALENT:Ｍ둔감をみる
	LOCAL:96 = 80 * TALENT:Ｍ둔감
	;TALENT:Ｃ둔감をみる
	LOCAL:101 = 80 * TALENT:Ｃ둔감
	;TALENT:Ｖ둔감をみる
	LOCAL:103 = 80 * TALENT:Ｖ둔감
	;TALENT:Ａ둔감をみる
	LOCAL:105 = 80 * TALENT:Ａ둔감
	;TALENT:Ｂ둔감をみる
	LOCAL:107 = 80 * TALENT:Ｂ둔감
	;TALENT:인기をみる
	SELECTCASE GETBIT(TALENT:인기, 0) + GETBIT(TALENT:인기, 1) + GETBIT(TALENT:인기, 2)
	CASE 1
		LOCAL:126 = 150
	CASE 2
		LOCAL:126 = 200
	CASE 3
		LOCAL:126 = 300
	ENDSELECT
	;TALENT:모유체질をみる
	IF TALENT:모유체질 == 1
		LOCAL:130 = 150
	ELSEIF TALENT:모유체질
		LOCAL:130 = 110
	ENDIF
	;TALENT:임신をみる
	SIF TALENT:임신
		LOCAL:135 = 50
	;TALENT:출산경험をみる
	SIF TALENT:출산경험
		LOCAL:136 = 50

	;TALENT:요도광をみる
	LOCAL:143 = 150 * TALENT:요도광

	;TALENT:상위몽마をみる
	SIF TALENT:상위몽마
		LOCAL:201 = 100 + 25 * TALENT:상위몽마

	IF ARG == 2 && LOCAL:0 > 100
		IF TALENT:처녀 == 1 && TALENT:Ａ처녀 == 1
			PRINTFORML %BL(6)%양구멍처녀 ×{LOCAL:0 / 100}.{LOCAL:0 % 100 / 10}{LOCAL:0 % 10}
		ELSE
			PRINTFORML %TEXT_RJ("처녀", 14)% ×{LOCAL:0 / 100}.{LOCAL:0 % 100 / 10}{LOCAL:0 % 10}
		ENDIF
	ENDIF
	SIF LOCAL:0
		CFLAG:43 = MULTIPLY(CFLAG:43, LOCAL:0)
	FOR LCOUNT, 1, 230
		SIF LOCAL:LCOUNT == 0 || LOCAL:LCOUNT == 100
			CONTINUE
		SIF ARG == 2
			PRINTFORML %TEXT_RJ(TALENTNAME:LCOUNT, 14)% ×{LOCAL:LCOUNT / 100}.{LOCAL:LCOUNT % 100 / 10}{LOCAL:LCOUNT % 10}
		CFLAG:43 = MULTIPLY(CFLAG:43, LOCAL:LCOUNT)
	NEXT
CASE "욕구불만解消"
	BASE:ARG:욕구불만 = LIMIT(BASE:ARG:욕구불만 - ARG:1, 0, 30)
CASE "소모품の自動購入"
	SIF CONFIG("自動購入") == 0
		RETURN 0

	CALL SALEITEM_CHECK, "표시なし"
	VARSET LOCAL
	SIF GETBIT(FLAG:9, 0) && ITEMSALES:비디오테이프 && ITEM:비디오테이프 == 0
		LOCAL:33 = 1
	SIF GETBIT(FLAG:9, 1) && ITEMSALES:로션 && ITEM:로션 == 0
		LOCAL:30 = 1
	SIF GETBIT(FLAG:9, 2) && ITEMSALES:미약 && ITEM:미약 == 0
		LOCAL:31 = 1
	SIF GETBIT(FLAG:9, 3) && ITEMSALES:이뇨제 && ITEM:이뇨제 == 0
		LOCAL:32 = 1
	SIF GETBIT(FLAG:9, 4) && ITEMSALES:진정제 && ITEM:진정제 == 0
		LOCAL:34 = 1
	SIF GETBIT(FLAG:9, 5) && ITEMSALES:배란유발제 && ITEM:배란유발제 == 0
		LOCAL:35 = 1
	SIF GETBIT(FLAG:9, 6) && ITEMSALES:재스민 && ITEM:재스민 == 0
		LOCAL:40 = 1
	SIF GETBIT(FLAG:9, 7) && ITEMSALES:라벤더 && ITEM:라벤더 == 0
		LOCAL:41 = 1
	SIF GETBIT(FLAG:9, 8) && ITEMSALES:머스크 && ITEM:머스크 == 0
		LOCAL:42 = 1
	SIF GETBIT(FLAG:9, 9) && ITEMSALES:샌들우드 && ITEM:샌들우드 == 0
		LOCAL:43 = 1
	SIF GETBIT(FLAG:9, 10) && ITEMSALES:로즈마리 && ITEM:로즈마리 == 0
		LOCAL:44 = 1
	SIF GETBIT(FLAG:9, 11) && ITEMSALES:입욕제 && ITEM:입욕제 == 0
		LOCAL:36 = 1
	SIF GETBIT(FLAG:9, 12) && ITEMSALES:근육이완제 && ITEM:근육이완제 == 0
		LOCAL:37 = 1
	FOR LCOUNT, 30, 50
		IF LOCAL:LCOUNT
			IF MONEY >= ITEMPRICE:LCOUNT
				MONEY -= ITEMPRICE:LCOUNT
				ITEM:LCOUNT += 1
				PRINTFORML %조사처리(ITEMNAME:LCOUNT,"를")% 구입했습니다.
			ELSE
				PRINTFORML %조사처리(ITEMNAME:LCOUNT,"를")% 구입할 수 없습니다. 
			ENDIF
			LOCAL:100 = 1
		ENDIF
	NEXT
	SIF LOCAL:100
		WAIT
CASE "요정化"
	BASE:ARG:신장 = 45 + RAND:11 + RAND:11 + RAND:11
	TALENT:ARG:장신 = 0
	TALENT:ARG:작은몸집 = 1
	TALENT:ARG:요정 = 1
	CALL CALC, "ＢＷＨ計測", ARG
CASE "小柄化", "작은몸집化"
	LOCAL = 125 + RAND:10 + RAND:6 + RAND:6
	SIF TALENT:ARG:유치
		LOCAL -= RAND:11
	SELECTCASE BASE:ARG:신장
	CASE IS > NUM("小柄の상한")
		BASE:ARG:신장 = MIN(LOCAL, BASE:ARG:신장 - 10)
	CASEELSE
		BASE:ARG:신장 = LOCAL
	ENDSELECT
	TALENT:ARG:장신 = 0
	TALENT:ARG:작은몸집 = 1
	TALENT:ARG:요정 = 0
	CALL CALC, "ＢＷＨ計測", ARG
CASE "보통体型化"
	LOCAL = 145 + RAND:11 + RAND:5 + RAND:5
	SELECTCASE BASE:ARG:신장
	CASE IS <= NUM("小柄の상한")
		BASE:ARG:신장 = MAX(LOCAL, BASE:ARG:신장 + 10)
	CASE IS > NUM("보통の상한")
		BASE:ARG:신장 = MIN(LOCAL, BASE:ARG:신장 - 10)
	CASEELSE
		BASE:ARG:신장 = LOCAL
	ENDSELECT
	TALENT:ARG:장신 = 0
	TALENT:ARG:작은몸집 = 0
	TALENT:ARG:요정 = 0
	CALL CALC, "ＢＷＨ計測", ARG
CASE "장신化"
	BASE:ARG:신장 = MAX(164 + RAND:9 + RAND:9, BASE:ARG:신장 + 10)
	TALENT:ARG:장신 = 1
	TALENT:ARG:작은몸집 = 0
	TALENT:ARG:요정 = 0
	CALL CALC, "ＢＷＨ計測", ARG
CASE "ＢＷＨ計測"
	VARSET LOCAL
	;ゴールデンカノン (바스트 = 신장*0.54, 웨스트 = 신장*0.38, 힙 = 신장*0.54)を参考
	;ちなみに, ゴールデンカノン比は当然ながら”웨스트は가늘음で힙は大きめ”である
	;LOCALが웨스트보정, LOCAL:1が힙보정
	LOCAL = 380
	LOCAL:1 = 540
	;소녀이하は体のラインがそれほど際立たない
	IF AGE(ARG) == 1 || TALENT:ARG:작은몸집
		LOCAL = 390
		LOCAL:1 = 510
	ELSE
		;潜在的な슬렌더or글래머値の加味
		SELECTCASE BASE:ARG:종족
		;슬렌더
		CASE 5, 8, 9, 11, 12, 18, 20, 21, 24, 30, 39, 40, 41, 46, 52, 57
			LOCAL = 360
			LOCAL:1 = 520
		;글래머
		CASE 10, 14, 26, 34, 35, 48
			LOCAL:1 = 550
		CASEELSE
			LOCAL = 385
			LOCAL:1 = 535
		ENDSELECT

		SELECTCASE AGE(ARG)
		;어른
		CASE IS >= 4
			LOCAL += 20
			LOCAL:1 += 30
		;언니
		CASE 3
			LOCAL += 10
			LOCAL:1 += 15
		ENDSELECT
		SIF COND("몽마", ARG) == 0
			LOCAL += RAND:6
	ENDIF

	;허리놀림による腰のくびれ＆大きな엉덩이
	LOCAL -= MIN(RAND:(1 + TALENT:ARG:허리놀림*10), 30)
	LOCAL:1 += MIN(RAND:(1 + TALENT:ARG:허리놀림*5), 30)
	;장사は筋肉がつくので腰が가늘음で尻がちょっとだけ大きい
	IF TALENT:ARG:장사
		LOCAL -= 20
		LOCAL:1 += 5
	ENDIF

	;랜덤変化
	LOCAL:3 = RAND:26
	LOCAL:4 = LIMIT(RAND:31, LOCAL:3 - 10, LOCAL:3 + 10)
	LOCAL = MULTIPLY(LOCAL, 90 + LOCAL:3)
	LOCAL:1 = MULTIPLY(LOCAL:1, 90 + LOCAL:4)

	;誤差は95～120%+α(理想値よりもちょっと太めが平均)
	BASE:ARG:웨스트 = LIMIT(BASE:ARG:신장*LOCAL/1000, BASE:ARG:신장*34/100, BASE:ARG:신장*(45 + AGE(ARG))/100)
	BASE:ARG:힙 = LIMIT(BASE:ARG:신장*LOCAL:1/1000, BASE:ARG:웨스트*130/100, BASE:ARG:웨스트*(160 + AGE(ARG)*10)/100)

	;매력持ちの場合は, 웨스트＆힙を理想値にする
	IF TALENT:ARG:매력
		BASE:ARG:웨스트 = LIMIT(BASE:ARG:웨스트, BASE:ARG:신장*35/100, BASE:ARG:신장*39/100)
		BASE:ARG:힙 = LIMIT(BASE:ARG:힙, BASE:ARG:신장*52/100, BASE:ARG:신장*60/100)
	;언니や어른は부주의したりするのも良いよね…
	ELSEIF AGE(ARG) >= 3
		SELECTCASE RAND:20 + (AGE(ARG) == 3) * RAND:10
		CASE 0
			BASE:ARG:웨스트 += BASE:ARG:신장*5/100
			BASE:ARG:힙 += BASE:ARG:신장*15/200
		CASE 1, 2
			BASE:ARG:웨스트 += BASE:ARG:신장*4/100
			BASE:ARG:힙 += BASE:ARG:신장*6/100
		CASE 3, 4
			BASE:ARG:웨스트 += BASE:ARG:신장*3/100
			BASE:ARG:힙 += BASE:ARG:신장*9/200
		CASE 5, 6
			BASE:ARG:웨스트 += BASE:ARG:신장*2/100
			BASE:ARG:힙 += BASE:ARG:신장*3/100
		ENDSELECT
	ENDIF

	;컵数に合わせて바스트変更
	IF TALENT:ARG:남자
		BASE:ARG:바스트 = CALCF("トップ바스트と속옷の差", BASE:ARG:컵) + MAX(BASE:ARG:신장*470/1000, BASE:ARG:웨스트)
	ELSE
		BASE:ARG:바스트 = CALCF("トップ바스트と속옷の差", BASE:ARG:컵) + MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	ENDIF

	;웨스트と힙に応じて작은엉덩이か큰엉덩이か判定
	CALL SETFLAG, "힙설정", ARG
CASE "男乳化"
	;AAA（5cm)未満
	BASE:ARG:바스트 = CALCF("바스트사이즈보정", 1 + RAND:4, ARG) + MAX(BASE:ARG:신장*470/1000, BASE:ARG:웨스트)
	BASE:ARG:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", ARG) )
	TALENT:ARG:빈유 = 0
	TALENT:ARG:거유 = 0
CASE "빈유化"
	;AAA（5cm）, AA（7.5cm), A（10cm）, B（12.5cm）
	;AAA（5cm）이상, B（13cm）未満
	BASE:ARG:바스트 = CALCF("바스트사이즈보정", 5 + RAND:8, ARG) + MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	BASE:ARG:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", ARG) )
	TALENT:ARG:빈유 = 1
	TALENT:ARG:거유 = 0
CASE "평유化"
	;B（12.5cm）, C（15cm）, D（17.5cm）, E（20cm）
	;B（13cm）이상, E（20cm）未満
	BASE:ARG:바스트 = CALCF("바스트사이즈보정", 13 + RAND:7, ARG) + MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	BASE:ARG:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", ARG) )
	TALENT:ARG:빈유 = 0
	TALENT:ARG:거유 = 0
CASE "거유化"
	;E（20cm）, F（22.5cm）, G（25cm）, H（27.5cm), I（30cm)
	;E（20cm）이상, G～I（25～30cm）のどれか未満
	BASE:ARG:바스트 = CALCF("바스트사이즈보정", 20 + RAND:(CONFIG("거유보정") + 5), ARG) + MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	BASE:ARG:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", ARG) )
	TALENT:ARG:빈유 = 0
	TALENT:ARG:거유 = 1
CASE "폭유化"
	;G（25cm）, H（27.5cm), I（30cm), J（32.5cm), K（35cm), L（37.5cm), M（40cm), N（42.5cm)
	;ここのみ장신の場合にはCONFIG("거유보정")…値は0or2or5 が２回かかる事となるため振れ幅がとても大きい
	;条件			最小		최대
	;거유はＦまで		25…G(25cm)	32…I(30cm), つまりJ(32.5cm)未満
	;거유はＧまで		27…G(25cm)	34…J(32.5cm), つまりK(35cm)未満
	;거유はＨまで		30…I(30cm)	37…K(35cm), つまりL(37.5cm)未満
	;거유はＧまで＆장신	27…G(25cm)	36…K(35cm), つまりL(37.5cm)未満
	;거유はＨまで＆장신	30…I(30cm)	42…M(40cm), つまりN(42.5cm)未満

	LOCAL = 25 + CONFIG("거유보정") + RAND:8
	SIF TALENT:ARG:장신
		LOCAL += RAND:(CONFIG("거유보정") + 1)
	LOCAL = MAX(LOCAL, CONFIG("거유보정") + 25)
	BASE:ARG:바스트 = CALCF("바스트사이즈보정", LOCAL, ARG) + MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	BASE:ARG:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", ARG) )
	TALENT:ARG:빈유 = 0
	TALENT:ARG:거유 = 2
CASE "초유化"
	;J（32.5cm), K（35cm), L（37.5cm), M（40cm), N（42.5cm), O（45cm)…… 
	;J～L（30～35cm）이상
	LOCAL = 33 + CONFIG("거유보정") + RAND:7
	SIF TALENT:ARG:장신
		LOCAL += CONFIG("거유보정")
	LOCAL = MAX(LOCAL, CONFIG("거유보정") + 33)
	BASE:ARG:바스트 = CALCF("바스트사이즈보정", LOCAL, ARG)  + MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	BASE:ARG:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", ARG) )
	TALENT:ARG:빈유 = 0
	TALENT:ARG:거유 = 3
CASE "바스트UP"
	;남자や장래성無い人はダメ
	SIF CONFIG("임신패치：딸の가슴の성장あり") == 0 || TALENT:남자 || TALENT:장래성 == 0
		RETURN 0

	VARSET LOCAL
	LOCAL:2 = CALCF("바스트컵", CALCF("바스트컵計算値", TARGET) )
	;今回得た쾌Ｂ의 구슬の量で成果が決まる
	LOCAL = GOTJUEL:쾌Ｂ * TALENT:장래성 / 100
	SELECTCASE LOCAL
	CASE 0
		RETURN 0
	CASE 1 TO 9
		SIF RAND:(LOCAL + 10) >= 10
			LOCAL:1 = 1 + RAND:2
	CASE 10 TO 99
		SIF RAND:(LOCAL + 100) >= 100
			LOCAL:1 = LIMIT(RAND:(1 + LOCAL/20), 1, 3) + RAND:2
	CASEELSE
		SIF RAND:2
			LOCAL:1 = LIMIT(RAND:10, 1, 5) + RAND:2
	ENDSELECT
	SIF TALENT:요정
		LOCAL:1 /= 2

	BASE:바스트의성장 += LOCAL:1
	BASE:컵 = CALCF("바스트컵", CALCF("바스트컵計算値", TARGET) )

	;大きくなってきた？
	IF BASE:컵 > LOCAL:2
		PRINTFORML 어라…？
		PRINTFORML %CALLNAME:TARGET%의 가슴을 계속 주무른 탓이려나?
		PRINTFORMW 조금 커진 모양이다……
		;장래성判定
		IF TALENT:장래성 && TALENT:거유
			SIF RAND:5 || TALENT:거유 >= 2
				TALENT:장래성 = 0
		ELSEIF TALENT:장래성 == 1 && TALENT:빈유 == 0
			SIF RAND:3
				TALENT:장래성 = 0
		ENDIF
	ENDIF
;CASE "왕엉덩이化"
;	BASE:ARG:힙 = MAX(BASE:ARG:신장 * (57 + RAND:4) / 100, BASE:ARG:웨스트 * (154 + RAND:6) /100)
;CASE "큰엉덩이化"
;	BASE:ARG:힙 = MAX(BASE:ARG:신장 * (54 + RAND:3) / 100, BASE:ARG:웨스트 * (145 + RAND:8) /100, 82)
;CASE "보통엉덩이化"
;	BASE:ARG:힙 = (BASE:ARG:신장 * (51 + RAND:3) + BASE:ARG:웨스트 * (137+ RAND:7) )/200
;CASE "작은엉덩이化"
;	BASE:ARG:힙 = MIN(BASE:ARG:신장 * (48 + RAND:3) / 100, BASE:ARG:웨스트 * (130 + RAND:5) /100, 91)

CASE "아이の성장"
	;딸の状態を変化させる関数
	;딸固有の소질を解除し, 記憶した소질へ戻す. そして成長済み플래그を立てる. 
	SIF ARG <= 0 || !COND("子孫", ARG)
		RETURN 0

	;成長済み플래그ＯＮ
	SETBIT CFLAG:ARG:484, 1

	VARSET RESULTS
	FOR LCOUNT, 2, 10
		IF GETBIT(ARG:1, LCOUNT) && !TALENT:ARG:CALCF("성장後に変化する소질", LCOUNT)
			TALENT:ARG:CALCF("성장後に変化する소질", LCOUNT) = 1
			SIF RESULTS:0 != ""
				RESULTS:0 += ", "
			RESULTS:0 += @"【%TALENTNAME:CALCF("성장後に変化する소질", LCOUNT)%】"
		ELSEIF !GETBIT(ARG:1, LCOUNT) && TALENT:ARG:CALCF("성장後に変化する소질", LCOUNT)
			TALENT:ARG:CALCF("성장後に変化する소질", LCOUNT) = 0
			SIF RESULTS:1 != ""
				RESULTS:1 += ", "
			RESULTS:1 += @"【%TALENTNAME:CALCF("성장後に変化する소질", LCOUNT)%】"
		ENDIF
	NEXT
CASEELSE
	THROW %GAMEBASE_YEAR% Ver.{VER_ERASQN()} BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT

;-------------------------------------------------
;色々と計算する関数(#FUNCTION)
;ARGは変更しない事. また, CALCF内の別のものを参照することは禁止
;-------------------------------------------------
@CALCF(ARGS, ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5)
#FUNCTION
#DIM LCOUNT
#DIM DYNAMIC MEMO, 10
#DIMS DYNAMIC MEMOS, 10

VARSET LOCAL
SELECTCASE ARGS
CASE "一言이벤트の상대"
	RETURNF GETBITS(FLAG:23, 0, 9)
CASE "１番好きな성희롱", "２番目に好きな성희롱", "３番目に好きな성희롱", "４番目に好きな성희롱"
	VARSET MEMO, -1
	FOR LCOUNT, 0, NUM("성희롱")
		SELECTCASE STRCOUNT(CSTR:MASTER:성희롱이력, NAMES("성희롱", LCOUNT) )
		CASE IS > LOCAL:1
			MEMO:4 = MEMO:3
			MEMO:3 = MEMO:2
			MEMO:2 = MEMO:1
			MEMO:1 = LCOUNT
			LOCAL:4 = LOCAL:3
			LOCAL:3 = LOCAL:2
			LOCAL:2 = LOCAL:1
			LOCAL:1 = STRCOUNT(CSTR:MASTER:성희롱이력, NAMES("성희롱", LCOUNT) )
		CASE IS > LOCAL:2
			MEMO:4 = MEMO:3
			MEMO:3 = MEMO:2
			MEMO:2 = LCOUNT
			LOCAL:4 = LOCAL:3
			LOCAL:3 = LOCAL:2
			LOCAL:2 = STRCOUNT(CSTR:MASTER:성희롱이력, NAMES("성희롱", LCOUNT) )
		CASE IS > LOCAL:3
			MEMO:4 = MEMO:3
			MEMO:3 = LCOUNT
			LOCAL:4 = LOCAL:3
			LOCAL:3 = STRCOUNT(CSTR:MASTER:성희롱이력, NAMES("성희롱", LCOUNT) )
		CASE IS > LOCAL:4
			MEMO:4 = LCOUNT
			LOCAL:4 = STRCOUNT(CSTR:MASTER:성희롱이력, NAMES("성희롱", LCOUNT) )
		ENDSELECT
	NEXT

	SELECTCASE ARGS
	CASE "１番好きな성희롱"
		RETURNF MEMO:1
	CASE "２番目に好きな성희롱"
		RETURNF MEMO:2
	CASE "３番目に好きな성희롱"
		RETURNF MEMO:3
	CASE "４番目に好きな성희롱"
		RETURNF MEMO:4
	ENDSELECT
;ARGがARG:1の페니스の形を覚えている度合い
CASE "Ｖ이력：Ｐ기억", "Ａ이력：Ｐ기억"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	SIF ARG:1 == 0 && PLAYER
		ARG:1 = PLAYER
	VARSET LOCALS
	;記録を分解する。LOCALS:XX = 受け入れたもの：{大きさ}＠入れた人＃{날짜}＊{回数} となる
	SELECTCASE ARGS
	CASE "Ｖ이력：Ｐ기억"
		SPLIT CSTR:ARG:V수용이력, "/", LOCALS
	CASE "Ａ이력：Ｐ기억"
		SPLIT CSTR:ARG:A수용이력, "/", LOCALS
	ENDSELECT

	;入れた人を文字列に直してMEMOSで記録
	SELECTCASE ARG:1
	CASE -3
		MEMOS = ＠드래곤＃
	CASE -4
		MEMOS = ＠일반인＃
	CASE -5
		MEMOS = ＠촉수＃
	;未설정
	CASE IS < 0
		RETURNF 0
	CASEELSE
		IF BASE:(ARG:1):식별번호
			MEMOS = ＠%TOSTR(BASE:(ARG:1):식별번호)%＃
		ELSE
			MEMOS = ＠일반인＃
		ENDIF
	ENDSELECT

	;記録は최대80種程度。
	FOR LCOUNT, 0, 80
		SIF LOCALS:LCOUNT == ""
			BREAK
		;カウントは前日まで
		SIF TOINT(EXTSTR(LOCALS:LCOUNT, "＃", "＊") ) >= DAY
			CONTINUE
		;ARG:1の페니스の記録か判別
		SIF STRCOUNT(LOCALS:LCOUNT, "페니스：") == 0 || STRCOUNT(LOCALS:LCOUNT, MEMOS) == 0
			CONTINUE
		;({大きさ}*2 + 1)*{回数}の和で、날짜は関係ない
		LOCAL += (TOINT(EXTSTR(LOCALS:LCOUNT, "：", "＠") )*2 + 1)*TOINT(EXTSTR(LOCALS:LCOUNT, "＊") )
	NEXT
	RETURNF LOCAL
;ARGがＶ等で受け入れたものに対する形状記憶の母数
CASE "Ｖ이력：기억母数", "Ａ이력：기억母数"
	SIF ARG == 0 && TARGET
		ARG = TARGET

	VARSET LOCALS
	;記録を分解する。LOCALS:XX = 受け入れたもの：{大きさ}＠入れた人＃{날짜}＊{回数} となる
	SELECTCASE ARGS
	CASE "Ｖ이력：기억母数"
		SPLIT CSTR:ARG:V수용이력, "/", LOCALS
	CASE "Ａ이력：기억母数"
		SPLIT CSTR:ARG:A수용이력, "/", LOCALS
	ENDSELECT

	;記録は최대80種程度。
	FOR LCOUNT, 0, 80
		SIF LOCALS:LCOUNT == ""
			BREAK
		;カウントは前日まで
		SIF TOINT(EXTSTR(LOCALS:LCOUNT, "＃", "＊") ) >= DAY
			CONTINUE
		;({大きさ}*2 + 1)*{回数}の和で、날짜は関係ない
		LOCAL += (TOINT(EXTSTR(LOCALS:LCOUNT, "：", "＠") )*2 + 1)*TOINT(EXTSTR(LOCALS:LCOUNT, "＊") )
	NEXT
	RETURNF LOCAL
;ARGが前回ARG:1の페니스を受け入れてからの経過日数
CASE "Ｖ이력：Ｐ何日ぶり", "Ａ이력：Ｐ何日ぶり"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	SIF ARG:1 == 0 && PLAYER
		ARG:1 = PLAYER

	VARSET LOCALS
	;記録を分解する。LOCALS:XX = 受け入れたもの：{大きさ}＠入れた人＃{날짜}＊{回数} となる
	SELECTCASE ARGS
	CASE "Ｖ이력：Ｐ何日ぶり"
		SPLIT CSTR:ARG:V수용이력, "/", LOCALS
	CASE "Ａ이력：Ｐ何日ぶり"
		SPLIT CSTR:ARG:A수용이력, "/", LOCALS
	ENDSELECT

	;入れた人を文字列に直してMEMOSで記録
	SELECTCASE ARG:1
	CASE -3
		MEMOS = ＠드래곤＃
	CASE -4
		MEMOS = ＠일반인＃
	CASE -5
		MEMOS = ＠촉수＃
	;未설정
	CASE IS < 0
		RETURNF 0
	CASEELSE
		IF BASE:(ARG:1):식별번호
			MEMOS = ＠%TOSTR(BASE:(ARG:1):식별번호)%＃
		ELSE
			MEMOS = ＠일반인＃
		ENDIF
	ENDSELECT

	;記録は최대80種程度。
	FOR LCOUNT, 0, 80
		;受け入れたことが無い場合は-1とする
		SIF LOCALS:LCOUNT == ""
			RETURNF -1
		;ARG:1の페니스の記録か判別
		SIF STRCOUNT(LOCALS:LCOUNT, "페니스：") == 0 || STRCOUNT(LOCALS:LCOUNT, MEMOS) == 0
			CONTINUE
		;V수용이력は左から날짜順に並ぶようになっているため、最初にヒットしたものが最新の날짜となる
		RETURNF DAY - TOINT(EXTSTR(LOCALS:LCOUNT, "＃", "＊") ) - 1
	NEXT

CASE "몇번째？"
	SIF ARG == ARG:1
		RETURNF 1
	SIF ARG == ARG:2
		RETURNF 2
	SIF ARG == ARG:3
		RETURNF 3
	SIF ARG == ARG:4
		RETURNF 4
	SIF ARG == ARG:5
		RETURNF 5
	RETURNF 0
;ARGがARG:1に注がれた量を返す. 손가락定無しならARG=TARGET, ARG:1=PLAYER
CASE "질내정액경험", "장내정액경험", "정음경험", "유内정액경험", "방광정액경험"
	SIF ARG < 0
		RETURNF 0
	SIF ARG == 0 && TARGET
		ARG = TARGET
	SIF ARG:1 == 0 && PLAYER
		ARG:1 = PLAYER

	SELECTCASE ARG:1
	CASE -3
		MEMOS = 드래곤：
	CASE -4
		MEMOS = 일반인：
	CASE -5
		MEMOS = 촉수：
	CASE IS < 0
		RETURNF 0
	CASEELSE
		IF BASE:(ARG:1):식별번호
			MEMOS = %TOSTR(BASE:(ARG:1):식별번호)%：
		ELSE
			MEMOS = 일반인：
		ENDIF
	ENDSELECT

	VARSET LOCALS

	SELECTCASE ARGS
	CASE "질내정액경험"
		SPLIT CSTR:ARG:11, "/", LOCALS
	CASE "장내정액경험"
		SPLIT CSTR:ARG:12, "/", LOCALS
	CASE "정음경험"
		SPLIT CSTR:ARG:13, "/", LOCALS
	CASE "유内정액경험"
		SPLIT CSTR:ARG:14, "/", LOCALS
	CASE "방광정액경험"
		SPLIT CSTR:ARG:15, "/", LOCALS
	ENDSELECT

	FOR LCOUNT, 0, 30
		SIF LOCALS:LCOUNT == ""
			BREAK
		;대상を探す
		SIF MEMOS != SUBSTRING(LOCALS:LCOUNT, 0, STRLENS(MEMOS) )
			CONTINUE

		;상대：量 となっているので"量"部分を抜き出して, 数に戻す
		MEMOS:1 = %SUBSTRING(LOCALS:LCOUNT, STRLENS(MEMOS), -1)%

		LOCAL = TOINT(MEMOS:1)

		RETURNF LOCAL
	NEXT
	RETURNF 0

;これは아픔が無い최대径
CASE "요도径"
	SIF ARG < 0
		RETURNF 0
	SIF ARG == 0 && TARGET
		ARG = TARGET

	;CSTR:3orCSTR:4の値の平均が基本的な요도の太さ
	IF PENIS(ARG)
		LOCAL = SUM_STR(CSTR:ARG:4)
	ELSE
		LOCAL = SUM_STR(CSTR:ARG:3)
	ENDIF

	;四捨五入する
	LOCAL = (LOCAL + 5)/10

	RETURNF LOCAL
CASE "요도확장の壁"
	SIF ARG < 0
		RETURNF 0
	SIF ARG == 0 && TARGET
		ARG = TARGET

	;だいたいＰ요도は15mm, Ｖ요도は30mmぐらいが壁
	IF PENIS(ARG)
		LOCAL = (2 + TALENT:ARG:확장적정) * MIN_STR(CONDS("Ｐ요도の初期확장度", ARG) ) + SIZE("基本페니스사이즈", ARG)*3
	ELSE
		LOCAL = (2 + TALENT:ARG:확장적정) * MIN_STR(CONDS("Ｖ요도の初期확장度", ARG) ) + BASE:ARG:신장/30
	ENDIF

	;몽마なら보너스
	IF TALENT:ARG:상위몽마
		LOCAL += 10
	ELSEIF TALENT:ARG:몽마
		LOCAL += 5
	ENDIF

	RETURNF LOCAL
CASE "요도확장の限界"
	SIF ARG < 0
		RETURNF 0
	SIF ARG == 0 && TARGET
		ARG = TARGET

	;だいたいＰは25mm、Ｖは40mmぐらいが壁
	IF PENIS(ARG)
		LOCAL = (3 + TALENT:ARG:확장적정*2) * MIN_STR(CONDS("Ｐ요도の初期확장度", ARG) ) + SIZE("基本페니스사이즈", ARG)*6
	ELSE
		LOCAL = (3 + TALENT:ARG:확장적정*2) * MIN_STR(CONDS("Ｖ요도の初期확장度", ARG) ) + BASE:ARG:신장/15
	ENDIF

	;몽마なら보너스
	IF TALENT:ARG:상위몽마
		LOCAL += 10
	ELSEIF TALENT:ARG:몽마
		LOCAL += 5
	ENDIF

	RETURNF LOCAL
CASE "페니스観察"
	SIF ARG < 0 || ARG:1 < 0
		RETURNF 0
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET

	VARSET LOCALS
	;すでにARGの페니스を観察済みかを調べる
	SPLIT CSTR:(ARG:1):1, "/", LOCALS

	FOR LCOUNT, 0, 100
		SIF LOCALS:LCOUNT == ""
			BREAK

		;観察済みだった
		SIF TOINT(LOCALS:LCOUNT) == BASE:ARG:식별번호
			RETURNF 1
	NEXT
	RETURNF 0
CASE "レズ・ＢＬ度"
	SELECTCASE ARG
	CASE 0 TO 29
		RETURNF 3
	CASE 30 TO 59
		RETURNF 2
	CASE 60 TO 69
		IF TALENT:남자 == 0 && TALENT:PLAYER:남자 == 0
			RETURNF 7
		ELSE
			RETURNF 4
		ENDIF
	CASE 70 TO 79
		IF TALENT:남자 && TALENT:PLAYER:남자
			RETURNF 10
		ELSE
			RETURNF 4
		ENDIF
	CASE 80 TO 89
		RETURNF 8
	CASE 90 TO 119
		RETURNF 7
	CASE 120 TO 129
		RETURNF 10
	;피스트
	CASE 141 TO 143
		RETURNF 10
	;SM
	CASE 130 TO 149
		RETURNF 2
	CASE 161, 504
		RETURNF 7
	ENDSELECT
CASE "Ｖ확장の상한"
	SIF ARG < 0
		RETURNF 0
	SIF ARG == 0 && TARGET
		ARG = TARGET

	;처녀や男
	SIF TALENT:ARG:남자 || TALENT:ARG:처녀
		RETURNF 0

	;Ｖ확장경험, Ｖ破壊경험, 小柄でない, 출산경험などで判定. 
	;Ｖ活用LVの方も同時に用いることが多い. 

	LOCAL = 1 + MIN(GET_EXP_LV(EXP:ARG:Ｖ확장경험), 6)
	;小柄なら-1
	SIF TALENT:ARG:작은몸집 && AGE(ARG) == 1 && TALENT:ARG:확장적정 == 0
		LOCAL -= 1
	SIF EXP:ARG:Ｖ확장경험 >= 100
		LOCAL += 1
	SIF EXP:ARG:Ｖ확장경험 >= 200 && TALENT:ARG:장신
		LOCAL += 1

	;음호
	SIF TALENT:ARG:음호
		LOCAL += 1
	SIF TALENT:ARG:슬라임
		LOCAL += 2
	;손상したばかりでは질の容量は増えない
	SIF EXP:ARG:Ｖ손상경험 - TALENT:ARG:Ｖ손상 > 0
		LOCAL += 1 + MIN(2, (EXP:ARG:Ｖ손상경험 - TALENT:ARG:Ｖ손상)/3)
	;출산경험があるなら, Ｖ확장LVが４未満なら+1
	SIF TALENT:ARG:출산경험 && LOCAL < 4
		LOCAL += 1
	;호색
	SIF TALENT:ARG:호색 && LOCAL < 2
		LOCAL += 1
	;Ｖ경험が多くて, Ｖ확장LVが２未満なら+1
	SIF EXP:ARG:Ｖ경험 + EXP:ARG:Ｖ성교경험 >= 100 && LOCAL < 2
		LOCAL += 1
	SIF EXP:ARG:Ｖ경험 + EXP:ARG:Ｖ성교경험 >= 300 && LOCAL < 2
		LOCAL += 1
	SIF EXP:ARG:Ｖ경험 >= 50 && LOCAL <= 0
		LOCAL += 1
	;요정は半分
	SIF TALENT:ARG:요정
		LOCAL /= 2
	;확장적정
	SIF TALENT:ARG:확장적정 && LOCAL < 3
		LOCAL += 1

CASE "Ａ확장の상한"
	SIF ARG < 0
		RETURNF 0
	SIF ARG == 0 && TARGET
		ARG = TARGET

	LOCAL = LIMIT(GET_EXP_LV(EXP:ARG:Ａ확장경험) - 1, 0, 6)

	;Ａ경험が多いと, 확장경험無しでもＡ확장LVが２まで獲得가능
	SIF EXP:ARG:Ａ경험 >= 50
		LOCAL += 1
	SIF EXP:ARG:Ａ경험 >= 150 || EXP:ARG:Ａ확장경험 >= 5
		LOCAL += 1
	SIF EXP:ARG:Ａ확장경험 >= 100
		LOCAL += 1
	SIF EXP:ARG:Ａ확장경험 >= 200 && TALENT:ARG:장신
		LOCAL += 1

	SIF TALENT:ARG:애널광
		LOCAL += 1
	SIF TALENT:ARG:슬라임
		LOCAL += 2
	;호색
	SIF TALENT:ARG:호색 && LOCAL < 2
		LOCAL += 1
	SIF EXP:ARG:Ａ손상경험 - TALENT:ARG:Ａ손상 > 0
		LOCAL += 1 + MIN(2, (EXP:ARG:Ａ손상경험 - TALENT:ARG:Ａ손상)/3)
	;小柄なら확장が停滞する
	IF TALENT:ARG:작은몸집 && AGE(ARG) == 1 && TALENT:ARG:확장적정 == 0
		SIF LOCAL >= 3
			LOCAL -= 1
	ENDIF
	SIF (TALENT:ARG:Ａ민감 || TALENT:ARG:Ａ명기 >= 2) && LOCAL < 1
		LOCAL += 1

	;요정は半分
	SIF TALENT:ARG:요정
		LOCAL /= 2
	;확장적정
	SIF TALENT:ARG:확장적정 && LOCAL < 3
		LOCAL += 1

CASE "요도刺激"
	;Ｃ감각で代用
	SELECTCASE ABL:Ｃ감각
	CASE 0
		LOCAL = 50
	CASE 1 TO 2
		LOCAL = 100*ABL:Ｃ감각
	CASE 3 TO 5
		LOCAL = 150*ABL:Ｃ감각
	CASE 6 TO 8
		LOCAL = 200*ABL:Ｃ감각
	CASE 9
		LOCAL = 2000
	CASEELSE
		LOCAL = 2500
	ENDSELECT
	SIF CONFIG("ＥＡＳＹ")
		LOCAL += 200
	SIF TALENT:Ｃ민감
		LOCAL += 200
	SIF TALENT:요도성감 == 0
		LOCAL /= 10
	SIF TALENT:요도광
		LOCAL *= 2

	SELECTCASE ARG
	;도구の使用（基本値）
	CASE 0
	;舌や손가락などで刺激(緩やかな上昇)
	CASE 1
		LOCAL = MULTIPLY(LOCAL, 30 + ABL:Ｃ감각*10)
	;섹스や바이브など(急激な上昇)
	CASE 2
		LOCAL = MULTIPLY(LOCAL, 20 + ABL:Ｃ감각*20)
	;피스트, 용간など上級者向け(極端な上昇)
	CASE 3
		LOCAL = MULTIPLY(LOCAL, MAX(ABL:Ｃ감각*30 - 100, (ABL:Ｃ감각 + 1)*5) )
	ENDSELECT
	SIF ARG:1
		LOCAL = LOCAL * ARG:1 / 100
CASE "Ｃ刺激"
	SELECTCASE ABL:Ｃ감각
	CASE 0
		LOCAL = 100
	CASE 1 TO 2
		LOCAL = 300*ABL:Ｃ감각
	CASE 3 TO 5
		LOCAL = 500*ABL:Ｃ감각
	CASE 6 TO 8
		LOCAL = 600*ABL:Ｃ감각
	CASE 9
		LOCAL = 6000
	CASEELSE
		LOCAL = 8000
	ENDSELECT
	SIF CONFIG("ＥＡＳＹ")
		LOCAL += 500
	SIF TALENT:Ｃ민감
		LOCAL += 500
	SELECTCASE ARG
	;도구の使用（基本値）
	CASE 0
	;舌や손가락などで刺激(緩やかな上昇)
	CASE 1
		LOCAL = MULTIPLY(LOCAL, 30 + ABL:Ｃ감각*5)
	;스마타系(刺激は副産物. 弱め)
	CASE 2
		LOCAL = MULTIPLY(LOCAL, 30)
	;逆섹스系(強め)
	CASE 3
		LOCAL = MULTIPLY(LOCAL, 100 + ABL:PLAYER:Ｖ명기도)
	;역애널系(強め)
	CASE 4
		LOCAL = MULTIPLY(LOCAL, 100 + ABL:PLAYER:Ａ명기도)
	ENDSELECT
	SIF ARG:1
		LOCAL = LOCAL * ARG:1 / 100
CASE "Ｖ刺激"
	SELECTCASE ABL:Ｖ감각
	CASE 0
		LOCAL = 100
	CASE 1 TO 2
		LOCAL = 300*ABL:Ｖ감각
	CASE 3 TO 5
		LOCAL = 500*ABL:Ｖ감각
	CASE 6 TO 8
		LOCAL = 600*ABL:Ｖ감각
	CASE 9
		LOCAL = 6000
	CASEELSE
		LOCAL = 8000
	ENDSELECT
	SIF CONFIG("ＥＡＳＹ")
		LOCAL += 500
	SIF TALENT:Ｖ민감
		LOCAL += 500
	SELECTCASE ARG
	;도구の使用（基本値）
	CASE 0
	;舌や손가락などで刺激(緩やかな上昇)
	CASE 1
		LOCAL = MULTIPLY(LOCAL, 30 + ABL:Ｖ감각*10)
	;섹스や바이브など(急激な上昇)
	CASE 2
		LOCAL = MULTIPLY(LOCAL, 20 + ABL:Ｖ감각*20)
	;피스트, 용간など上級者向け(極端な上昇)
	CASE 3
		LOCAL = MULTIPLY(LOCAL, MAX(ABL:Ｖ감각*30 - 100, (ABL:Ｖ감각 + 1)*5) )
	ENDSELECT
	SIF ARG:1
		LOCAL = LOCAL * ARG:1 / 100
CASE "Ａ刺激"
	SELECTCASE ABL:Ａ감각
	CASE 0
		LOCAL = 100
	CASE 1 TO 2
		LOCAL = 300*ABL:Ａ감각
	CASE 3 TO 5
		LOCAL = 500*ABL:Ａ감각
	CASE 6 TO 8
		LOCAL = 600*ABL:Ａ감각
	CASE 9
		LOCAL = 6000
	CASEELSE
		LOCAL = 8000
	ENDSELECT
	SIF CONFIG("ＥＡＳＹ")
		LOCAL += 500
	SIF TALENT:Ａ민감
		LOCAL += 500
	SELECTCASE ARG
	;도구の使用（基本値）
	CASE 0
	;舌や손가락などで刺激(緩やかな上昇)
	CASE 1
		LOCAL = MULTIPLY(LOCAL, 30 + ABL:Ａ감각*10)
	;섹스や바이브など(急激な上昇)
	CASE 2
		LOCAL = MULTIPLY(LOCAL, 20 + ABL:Ａ감각*20)
	;피스트, 용간など上級者向け(極端な上昇)
	CASE 3
		LOCAL = MULTIPLY(LOCAL, MAX(ABL:Ａ감각*30 - 100, (ABL:Ａ감각 + 1)*5) )
	ENDSELECT
	SIF ARG:1
		LOCAL = LOCAL * ARG:1 / 100
CASE "Ｂ刺激"
	SELECTCASE ABL:Ｂ감각
	CASE 0
		LOCAL = 100
	CASE 1 TO 2
		LOCAL = 300*ABL:Ｂ감각
	CASE 3 TO 5
		LOCAL = 500*ABL:Ｂ감각
	CASE 6 TO 8
		LOCAL = 600*ABL:Ｂ감각
	CASE 9
		LOCAL = 6000
	CASEELSE
		LOCAL = 8000
	ENDSELECT
	SIF CONFIG("ＥＡＳＹ")
		LOCAL += 500
	SIF TALENT:Ｂ민감
		LOCAL += 500
	SELECTCASE ARG
	;도구の使用（基本値）
	CASE 0
	;舌や손가락などで刺激(緩やかな上昇)
	CASE 1
		LOCAL = MULTIPLY(LOCAL, 30 + ABL:Ｂ감각*10)
	;파이즈리など(刺激は副産物. 弱め)
	CASE 2
		LOCAL = MULTIPLY(LOCAL, 30)
	;섹스や바이브など(急激な上昇)
	CASE 3
		LOCAL = MULTIPLY(LOCAL, 20 + ABL:Ｂ감각*20)
	ENDSELECT
	SIF ARG:1
		LOCAL = LOCAL * ARG:1 / 100
CASE "Ｍ刺激"
	SELECTCASE ABL:Ｍ감각
	CASE 0
		LOCAL = 100
	CASE 1 TO 2
		LOCAL = 300*ABL:Ｍ감각
	CASE 3 TO 5
		LOCAL = 500*ABL:Ｍ감각
	CASE 6 TO 8
		LOCAL = 600*ABL:Ｍ감각
	CASE 9
		LOCAL = 6000
	CASEELSE
		LOCAL = 8000
	ENDSELECT
	SIF CONFIG("ＥＡＳＹ")
		LOCAL += 500
	SIF TALENT:Ｍ민감
		LOCAL += 500
	SELECTCASE ARG
	;도구の使用（基本値）
	CASE 0
	;키스(緩やかな上昇)
	CASE 1
		LOCAL = MULTIPLY(LOCAL, 30 + ABL:Ｍ감각*10)
	;펠라치오など(刺激は副産物. 弱め)
	CASE 2
		LOCAL = MULTIPLY(LOCAL, 30)
	ENDSELECT
	SIF ARG:1
		LOCAL = LOCAL * ARG:1 / 100
CASE "快感上昇の상한措置"
	;ARG=보정前の快感, ARG:1=대상部位の感度,ARG:2=민감-둔감
	SIF ARG <= 0
		RETURNF 0

	;욕정と무드が両方高くないと得られる快感の상한が下がる
	;욕정によるペナルティ
	SELECTCASE PALAM:욕정
	CASE IS < 100
		ARG:1 = 0
	CASE IS < 3000
		ARG:1 = MIN(1, ARG:1)
	CASE IS < 10000
		ARG:1 = MIN(2, ARG:1)
	CASE IS < 30000
		ARG:1 = MIN(3, ARG:1)
	ENDSELECT

	;민감,둔감,特化소질보정
	ARG:1 = MAX(ARG:1 + ARG:2, 0)

	;미약보너스
	IF TEQUIP:미약
		ARG:1 += MAX(TEQUIP:미약/100, 1)
		ARG:2 += TEQUIP:미약/300
	ENDIF

	;상대の성감대をついている場合は, ＬＶが５이상違っていれば보너스! 
	SIF ABL:PLAYER:ＬＶ - ABL:ＬＶ >= 5 && ARG:2 > 0
		ARG:1 += (ABL:PLAYER:ＬＶ - ABL:ＬＶ)/5

	;성감대突いている場合には절정보정보너스
	IF ARG:1 <= 0 && ARG:2 > 0
		ARG:1 = 0
		SIF EX:절정수합계
			ARG:1 = 1
	ENDIF

	;무드による下方보정
	SELECTCASE MOOD_HEART()
	;ハート無し
	CASE 0
		ARG:1 = MAX(ARG:1 - 3, 0)
	;ハート一個
	CASE 1
		ARG:1 = MAX(ARG:1 - 2, 0)
	;ハート２個
	CASE 2
		ARG:1 = MAX(ARG:1 - 1, 0)
	ENDSELECT

	;LOCAL:1は得られる快感に보정がかかり始める値（大体PALAM_LVに沿っている）
	;LOCAL:2が상한のような役割となっている
	;PALAM_LVの値は, 順に1:100,2:500,3:3000,4:1万,5:3万,6:6万,7:10万,8:15万,9:25万
	SELECTCASE ARG:1
	CASE 0
		LOCAL:1 = 100
		LOCAL:2 = 500
	CASE 1
		LOCAL:1 = 500
		LOCAL:2 = 3000
	CASE 2
		LOCAL:1 = 3000
		LOCAL:2 = 6000
	CASE 3
		LOCAL:1 = 6000
		LOCAL:2 = 10000
	CASE 4
		LOCAL:1 = 10000
		LOCAL:2 = 20000
	CASEELSE
		LOCAL:1 = 20000*(ARG:1 - 4)
		LOCAL:2 = 20000*(ARG:1 - 3)
	ENDSELECT

	SELECTCASE ARG
	CASE IS <= LOCAL:1
		LOCAL = ARG
	CASEELSE
		;LOCAL:1を越えた分の快感については보정で減らされる
		LOCAL = LOCAL:1 + (ARG - LOCAL:1)/5
		SIF LOCAL > LOCAL:2
			LOCAL = LOCAL:2 + (LOCAL - LOCAL:2)/20
	ENDSELECT
	;PRINTFORML ARG = {ARG}, ARG:1 = {ARG:1}, LOCAL = {LOCAL}, LOCAL:1 = {LOCAL:1}, LOCAL:2 = {LOCAL:2}
	RETURNF LOCAL

CASE "快楽보정"
	;同性보정(후타나리は無視)
	IF TALENT:남자 && TALENT:PLAYER:남자
		;ABL:ＢＬ끼をみる
		SELECTCASE ABL:PLAYER:ＢＬ끼
		CASE 0
			TIMES ARG, 0.10
		CASE 1
			TIMES ARG, 0.30
		CASE 2
			TIMES ARG, 0.70
		CASE 3
			TIMES ARG, 1.00
		CASE 4
			TIMES ARG, 1.20
		CASEELSE
			TIMES ARG, 1.50
		ENDSELECT
	ELSEIF TALENT:여자 && TALENT:PLAYER:여자
		;ABL:레즈끼をみる
		SELECTCASE ABL:PLAYER:레즈끼
		CASE 0
			TIMES ARG, 0.30
		CASE 1
			TIMES ARG, 0.50
		CASE 2
			TIMES ARG, 0.80
		CASE 3
			TIMES ARG, 1.00
		CASE 4
			TIMES ARG, 1.20
		CASEELSE
			TIMES ARG, 1.50
		ENDSELECT
	ENDIF
	;PALAM:욕정をみる
	ARG = MULTIPLY(ARG, LIMIT(80 + GET_PALAMLV(PALAM:욕정)*10, 100, 150) )

	;ABL:봉사정신とEXP:봉사쾌락경험をみる
	LOCAL:1 = MIN(ABL:봉사정신*10 + EXP:봉사쾌락경험/20 + TALENT:헌신*30, 100)
	SELECTCASE SELECTCOM
	CASE 6, 140
		ARG = MULTIPLY(ARG, 100 + LOCAL:1)
	CASE 65, 75, 90 TO 94, 96 TO 119
		SIF TEQUIP:넘어뜨리기 == 0
			ARG = MULTIPLY(ARG, 100 + LOCAL:1/2)
	ENDSELECT

	;ABL:새드끼とEXP:가학쾌락경험をみる
	LOCAL:1 = MIN(ABL:새드끼*10 + EXP:가학쾌락경험/20 + TALENT:새드*30, 100)
	SELECTCASE SELECTCOM
	CASE 95, 105
		ARG = MULTIPLY(ARG, 100 + LOCAL:1)
	CASE 1, 9, 96, 120, 126, 304, 305
		SIF TEQUIP:넘어뜨리기
			ARG = MULTIPLY(ARG, 100 + LOCAL:1/2)
	CASEELSE
		SIF TEQUIP:안면기승
			ARG = MULTIPLY(ARG, 100 + LOCAL:1/2)
	ENDSELECT

	;ここまでで得た보정が２倍이상の場合には, ２のn乗 < 보정倍率 < ２の(n+1)乗 →　(n+1)倍 < 보정倍率 < (n+2)倍　となるように. 
	FOR LOCAL:1, 0, 10
		LOCAL:2 = 10 - LOCAL:1
		LOCAL:3 = POWER(2, LOCAL:2)
		IF ARG > LOCAL:3 * 1000
			ARG = (LOCAL:2 + 1)*1000 + (ARG - LOCAL:3*1000)/LOCAL:3
			BREAK
		ENDIF
	NEXT

	RETURNF ARG
CASE "基礎보정"
	LOCAL = 0
	;기교の差などによる보정
	IF ABL:기교 + (TEQUIP:넘어뜨리기 > 0) > ABL:PLAYER:기교
		LOCAL += (ABL:기교 + (TEQUIP:넘어뜨리기 > 0) - ABL:PLAYER:기교)*50
		SIF ABL:기교 > ABL:PLAYER:기교
			LOCAL += ABL:기교*10
	ELSE
		LOCAL += (ABL:기교 + (TEQUIP:넘어뜨리기 > 0) - ABL:PLAYER:기교)*20
	ENDIF
	;LVの差などによる보정
	IF ABL:ＬＶ > ABL:PLAYER:ＬＶ
		LOCAL += (ABL:ＬＶ - ABL:PLAYER:ＬＶ)*10
	ELSE
		LOCAL += (ABL:ＬＶ - ABL:PLAYER:ＬＶ)*5
	ENDIF

	SIF LOCAL > 0 && CONFIG("ＥＡＳＹ")
		LOCAL /= 3

	;미약
	LOCAL += TEQUIP:PLAYER:미약

	;最悪でも3割は与える
	LOCAL = MAX(LOCAL, -70)
	ARG = MULTIPLY(ARG, 100 + LOCAL)

	;마음에듬や상사상애, 성벽など
	;매력
	SIF TALENT:매력
		TIMES ARG, 1.10
	;褒められてるとがんばる
	SIF TEQUIP:칭찬하기
		TIMES ARG, 1.20
	;피블
	SIF STATE("피블", PLAYER)
		TIMES ARG, 1.50
	;前のターンに손대중されている（このターンで손대중解除の予定）
	SIF TEQUIP:PLAYER:손대중 == 1
		TIMES ARG, 1.50
	;溜まっている
	SIF BASE:PLAYER:정력 >= MAXBASE:PLAYER:정력 && BASE:PLAYER:스톡 >= MAXBASE:PLAYER:스톡 && PENIS(PLAYER)
		TIMES ARG, 2.00

	IF PLAYER == MASTER
		SIF TALENT:첫사람
			TIMES ARG, 1.20
		
		IF TALENT:상사상애
			TIMES ARG, 2.00
			;３分の一にも達していないなら, さらに보너스
			SIF ARG*3 < MAXBASE:PLAYER:절정
				ARG += MAXBASE:PLAYER:절정 / 5
		ELSEIF TALENT:마음에듬
			SIF TALENT:마음에듬
				TIMES ARG, 1.20
			;５分の一にも達していないなら, さらに보너스
			SIF ARG*5 < MAXBASE:PLAYER:절정
				ARG += MAXBASE:PLAYER:절정 / 8
		ENDIF
		;성벽
		IF TALENT:MASTER:성벽
			LOCAL = 0
			;TARGET自身の속성
			FOR LCOUNT, 0, NUM("속성")
				SIF GETBIT(BASE:속성, LCOUNT) && GETBIT(TALENT:MASTER:성벽, LCOUNT)
					LOCAL += 1
			NEXT
			;커맨드に応じた성벽ヒット
			SELECTCASE SELECTCOM
			CASE 83
				;요도が好き
				SIF COND("성벽：요도", MASTER)
					LOCAL += 1
			ENDSELECT
			;ヒット数に応じて보너스
			SELECTCASE LOCAL
			CASE 1
				ARG += (ARG*10)/100 + 2000
			CASE 2 TO 5
				ARG += (LOCAL + 1)*(ARG*5/100 + 1000)
			CASE IS >= 6
				ARG += (LOCAL + 7)*(ARG*25/1000 + 500)
			ENDSELECT
		ENDIF
	ENDIF

	SELECTCASE SELECTCOM
	CASE 60 TO 80, 177
		ARG = MULTIPLY(ARG, 100 + STATE("우르즈군")*20)
	ENDSELECT

	ARG = MULTIPLY(ARG, 100 + STATE("시길군")*10)

	SIF STATE("투와이스")
		TIMES ARG, 1.50

	;-------------------------------------------------
	;ここから下はマイナス보정
	;-------------------------------------------------
	;目隠しされてると, 기교減少
	SIF TEQUIP:아이마스크
		TIMES ARG, 0.80
	;이뇨제を使われてると, 기교減少
	SIF TEQUIP:이뇨제
		TIMES ARG, 0.80
	;구속されてると, 기교減少
	SIF TEQUIP:구속
		TIMES ARG, 0.80
	;드렁크
	IF STATE("술주정", TARGET)
		TIMES ARG, 0.40
	ELSEIF STATE("드렁크", TARGET)
		TIMES ARG, 0.80
	ENDIF
	;하드스킨
	SIF STATE("하드스킨", PLAYER)
		TIMES ARG, 0.30
	;정력０
	SIF BASE:정력 <= 0
		TIMES ARG, 0.50

	SELECTCASE STATE("에올군", PLAYER)
	CASE 1
		TIMES ARG, 0.80
	CASE 2
		TIMES ARG, 0.65
	CASE IS >= 3
		TIMES ARG, 0.50
	ENDSELECT

	SELECTCASE CONDS("기분")
	CASE "상황살핌"
		TIMES ARG, 0.50
	CASE "의욕없음"
		TIMES ARG, 0.25
	ENDSELECT

	;악세사리効果（정신력）
	ARG = DIVIDE(ARG, 100 + TALENT:PLAYER:정신력강화*2)
	;악세사리効果（받는쾌감UP）
	ARG = MULTIPLY(ARG, 100 + TALENT:PLAYER:받는쾌감)
	RETURNF ARG
CASE "실행치による욕정추가"
	;TCVAR:29の値によって봉사or嗜虐快楽が決められている
	;0bit弱봉사, 1bit봉사, 2bit弱嗜虐, 3bit嗜虐

	;봉사中心
	IF GETBIT(TCVAR:29, 1)
		LOCALS = 봉사정신
	;嗜虐中心
	ELSEIF GETBIT(TCVAR:29, 3)
		LOCALS = 새드끼
	ELSEIF GETBIT(TCVAR:29, 0) && GETBIT(TCVAR:29, 2)
		LOCALS = 봉사정신
		SIF ABL:새드끼 > ABL:봉사정신
			LOCALS = 새드끼
	ELSEIF GETBIT(TCVAR:29, 0)
		LOCALS = 봉사정신
	ELSEIF GETBIT(TCVAR:29, 2)
		LOCALS = 새드끼
	ELSE
		RETURNF 0
	ENDIF

	SELECTCASE ABL:LOCALS
	CASE 0
		LOCAL = 50
	CASE 1
		LOCAL = 150
	CASE 2
		LOCAL = 250
	CASE 3
		LOCAL = 450
	CASE 4
		LOCAL = 600
	CASEELSE
		LOCAL = 750
	ENDSELECT

	;弱봉사or弱嗜虐なら25％
	SIF GETBIT(TCVAR:29, 1) == 0 && GETBIT(TCVAR:29, 3) == 0
		TIMES LOCAL, 0.25

	;TARGETとPLAYERの性別により参照するABLが変わる. PLAYERに페니스ありなら정액중독. 
	IF PENIS(PLAYER)
		LOCALS:1 = 정액중독
	;여성に男が봉사なら마조ッ気
	ELSEIF TALENT:남자
		LOCALS:1 = 마조끼
	;女同士ならレズッ気
	ELSE
		LOCALS:1 = 레즈끼
	ENDIF
	SELECTCASE ABL:(LOCALS:1)
	CASE 0
		TIMES LOCAL, 0.20
	CASE 1
	CASE 2
		TIMES LOCAL, 1.50
	CASE 3
		TIMES LOCAL, 2.00
	CASE 4
		TIMES LOCAL, 3.00
	CASEELSE
		TIMES LOCAL, 4.00
	ENDSELECT
	;실행치の量で効果増
	LOCAL = MULTIPLY(LOCAL, 100 + TCVAR:28)
CASE "페니스好き度"
	;おちんちんが好きかどうか. この値が高いと, 페니스にフィットする
	;연모
	SIF PLAYER == MASTER && TALENT:ARG:연모
		LOCAL += 1
	;남성혐오
	SIF TALENT:ARG:남성혐오
		RETURNF LOCAL
	IF TALENT:ARG:몽마
		LOCAL += 1
	ELSEIF TALENT:ARG:상위몽마
		LOCAL += TALENT:ARG:상위몽마 + 1
	ENDIF
	;쾌감에솔직or호색
	SIF TALENT:ARG:쾌감에솔직 || TALENT:ARG:호색
		LOCAL += 1
	SIF TALENT:ARG:음호 || TALENT:ARG:애널광
		LOCAL += 1
CASE "Ｃ발정"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	;0通常 1皮の下で勃起 2얼굴を出す 3ギンギン
	SIF TALENT:ARG:음핵
		LOCAL += 1
	;욕정(미약)
	SIF PALAM:ARG:욕정 >= 10000 || TEQUIP:ARG:미약
		LOCAL += 1
	SIF (ABL:ARG:Ｃ감각 >= 3 && PALAM:ARG:욕정 >= 3000) || ABL:ARG:Ｃ감각 >= 5
		LOCAL += 1
	SIF TALENT:ARG:클리피어스
		LOCAL = MAX(LOCAL + 1, 2)
CASE "Ｖ발정"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	;0通常 1発情 2ビショビショ 3愛液駄々漏れ
	SIF TALENT:ARG:음호
		LOCAL += 1
	;욕정(미약)
	SIF PALAM:ARG:욕정 >= 10000 || TEQUIP:ARG:미약
		LOCAL += 1
	SIF ABL:ARG:Ｖ감각 >= 3 && PALAM:ARG:욕정 >= 3000
		LOCAL += 1
	;절정
	SIF EX:ARG:Ｖ절정 || EX:ARG:절정수합계 >= 3
		LOCAL += 1
	SIF EX:ARG:Ｖ절정 >= 3 || EX:ARG:절정수합계 >= 10
		LOCAL += 1
CASE "Ｂ발정"
	SIF ARG == 0 && TARGET
		ARG = TARGET
	;0陥没 1通常 2しこりかけ 3勃起 4ギンギン
	SIF COND("진성함몰유두", ARG)
		RETURNF 0
	LOCAL = 1
	SIF (ABL:ARG:Ｂ감각 >= 5 && PALAM:ARG:욕정 >= 3000) || PALAM:ARG:욕정 >= 10000 || EX:ARG:Ｂ절정
		LOCAL += 1
	SIF PALAM:ARG:욕정 >= 30000
		LOCAL += 1
	SIF EX:ARG:Ｂ절정 >= 5
		LOCAL += 1
	IF COND("가성함몰유두", ARG)
		;수유경험増加
		SIF LOCAL <= 2 && EXP_GAIN(73, ARG)
			LOCAL += 1
		SIF LOCAL <= 2
			RETURNF 0
	ENDIF
	SIF TALENT:ARG:음유
		LOCAL += 1
	SIF COND("유두비대", ARG)
		LOCAL += 1

CASE "절정"
	;사정条件を満たしているか？
	SELECTCASE BASE:ARG:절정
	CASE IS < MAXBASE:ARG:절정
		RETURNF 0
	CASE IS < MAXBASE:ARG:절정*2
		SIF COND("절정許可", PLAYER) == 0 && TEQUIP:ARG:역조교 == 0
			RETURNF 0
	ENDSELECT

	;念のため
	SIF EJAC:ARG <= 0
		EJAC:ARG = 10000

	IF CONFIG("우르즈군없이도대량사정") || TALENT:ARG:일반인
		SELECTCASE BASE:ARG:절정
		CASE IS >= EJAC:ARG*4
			LOCAL = BASE:ARG:절정/(EJAC:ARG*3) + 2
		CASE IS >= EJAC:ARG*2
			LOCAL = 2
		CASE IS >= EJAC:ARG
			LOCAL = 1
		CASEELSE
			RETURNF 0
		ENDSELECT
	ELSE
		SELECTCASE BASE:ARG:절정
		CASE IS >= EJAC:ARG*2
			LOCAL = MIN(2 + (STATE("우르즈군", ARG) + 1)/2, 5)
		CASE IS >= EJAC:ARG
			LOCAL = 1
		CASEELSE
			RETURNF 0
		ENDSELECT
	ENDIF
	;정력次第で最低사정量が増える試み
	SIF STATE("우르즈군", ARG) || CONFIG("우르즈군없이도대량사정")
		LOCAL = MAX(LOCAL, 1 + MAXBASE:ARG:정력/50)

	;사정かつ우르즈군なら段階があがる
	SIF STATE("우르즈군", ARG)
		LOCAL += 1
	SIF TALENT:ARG:용의혈통
		LOCAL += 1
	;相手が마음에듬
	SIF ARG == MASTER && (TALENT:마음에듬 || TALENT:상사상애)
		LOCAL += 1

	;現状はMAX5(ためしに限定解除)
	LOCAL = MIN(LOCAL, BASE:ARG:정력/2 + 1)
	SIF TALENT:ARG:일반인
		LOCAL = (LOCAL + 2)/3
CASE "절정の原因"
	;ARGはキャラ, ARG:1はSELECTCOM
	SIF ARG < 0
		RETURNF 0
	;PLAYERに페니스がない時の절정플래그（暫定）
	IF PENIS(PLAYER) == 0
		LOCAL = 30

		;조교자Ｖ인서트
		IF INSERT("Ｖ인서트", PLAYER, ARG)
			LOCAL = 32
		;조교자Ａ인서트
		ELSEIF INSERT("Ａ인서트", PLAYER, ARG)
			LOCAL = 35
		;조교자インサート
		ELSEIF INSERT("요도인서트", PLAYER, ARG)
			LOCAL = 38
		;자위한다
		ELSEIF TEQUIP:PLAYER:자위한다
			LOCAL = 39
		ELSE
			SELECTCASE ARG:1
			;키스, 컨닐링구스, 애널핥기など, 입への刺激
			CASE 1, 4, 6, 9, 104
				LOCAL = 31
			;컨닐링구스強制や역레이프など, 보지への刺激
			CASE 80, 98, 120 TO 124
				LOCAL = 32
			;풋잡系
			CASE 95
				LOCAL = 33
			;거품춤や身体系
			CASE 94
				LOCAL = 34
			;역애널
			CASE 96, 125 TO 129
				LOCAL = 35
			;역용간
			CASE 304
				SIF TEQUIP:ARG:넘어뜨리기
					LOCAL = 36
			;역Ａ용간
			CASE 305
				SIF TEQUIP:ARG:넘어뜨리기
					LOCAL = 37
			;자위한다
			CASE 282
				LOCAL = 39
			ENDSELECT
		ENDIF
	ELSEIF PENIS(PLAYER)
		;不慮の사정の場合は스마타(身体)で사정となるようにする
		LOCAL = 7

		;Ｖ인서트
		IF INSERT("Ｖ인서트", ARG, PLAYER)
			LOCAL = 3
		;Ａ인서트
		ELSEIF INSERT("Ａ인서트", ARG, PLAYER)
			LOCAL = 4
		;インサート
		ELSEIF INSERT("요도인서트", ARG, PLAYER)
			LOCAL = 19
		;조교자Ｖ인서트
		ELSEIF INSERT("Ｖ인서트", PLAYER, ARG)
			LOCAL = 10
		;조교자Ａ인서트
		ELSEIF INSERT("Ａ인서트", PLAYER, ARG)
			LOCAL = 11
		;자위한다
		ELSEIF TEQUIP:PLAYER:자위한다
			LOCAL = 20
		;식스나인
		ELSEIF TEQUIP:ARG:식스나인
			SELECTCASE TEQUIP:ARG:식스나인
			CASE 90, 97, 105
				LOCAL = 2
			CASE 91, 150
				LOCAL = 1
			CASE 92
				LOCAL = 5
			CASE 98
				LOCAL = 9
			CASEELSE
				LOCAL = 8
			ENDSELECT
		ELSE
			SELECTCASE ARG:1
			CASE 3
				SIF CHECK_COM("펠라자위")
					LOCAL = 1
			;펠라系
			CASE 91, 99, 140, 150
				LOCAL = 1
			;손훑기系
			CASE 90, 97, 105
				LOCAL = 2
				SIF CHECK_COM("Ａ자극손훑기", ARG:1)
					LOCAL = 15
			;섹스
			CASE 60 TO 69, 177
				LOCAL = 3
			;Ａ섹스
			CASE 70 TO 79
				LOCAL = 4
			;가슴系
			CASE 81, 92
				LOCAL = 5
				SIF CHECK_COM("파이즈리펠라", ARG:1)
					LOCAL = 1
			;니플퍽
			CASE 82
				LOCAL = 18
			;요도삽입
			CASE 83
				LOCAL = 19
			;풋잡系
			CASE 95
				LOCAL = 6
			;스마타や身体系
			CASE 16, 93, 94, 100
				LOCAL = 7
			;키스, 컨닐링구스, 애널핥기など, 입への刺激
			CASE 1, 9
				LOCAL = 16
				SIF TEQUIP:ARG:넘어뜨리기
					LOCAL = 14
			CASE 4, 6
				LOCAL = 8
			;역컨닐링구스
			CASE 98
				LOCAL = 9
			;조교자Ｖ인서트
			CASE 120 TO 124
				LOCAL = 10
			;조교자Ａ인서트
			CASE 125 TO 129
				LOCAL = 11
			;역용간
			CASE 304
				SIF TEQUIP:ARG:넘어뜨리기
					LOCAL = 12
			;역Ａ용간
			CASE 305
				SIF TEQUIP:ARG:넘어뜨리기
					LOCAL = 13
			;애널봉사
			CASE 96
				LOCAL = 15
			;파후파후
			CASE 104
				LOCAL = 17
				SIF CHECK_COM("파후파후손훑기", ARG:1)
					LOCAL = 2
			;자위한다
			CASE 282
				LOCAL = 20
			;조수를범한다
			CASE 160
				LOCAL = 50
			;조수펠라
			CASE 162
				LOCAL = 52
			ENDSELECT
		ENDIF
	ENDIF

CASE "自由な손"
	;손を구속
	SIF GETBIT(TEQUIP:구속, 20)
		RETURNF 0
	;オナニーに使える손の数. 팔많음なら, その分追加. 
	LOCAL = 2 + TALENT:팔많음
	;ARGでSELECTCOMを管理. ARGに入力が無いなら, SELECTCOMが代入される. 
	SIF ARG == 0
		ARG = SELECTCOM
	SELECTCASE ARG
	CASE 3
		RETURNF LOCAL
	CASE 13, 14, 90, 92 TO 94, 97 TO 99, 104 TO 107
		LOCAL -= 2
	CASE 91, 96
		IF CHECK_COM("파이즈리펠라") || CHECK_COM("Ａ자극손훑기")
			LOCAL -= 2
		ELSE
			LOCAL -= 1
		ENDIF
	ENDSELECT
	;인서트中
	IF INSERT("인서트")
		IF INSERT("배면좌위")
		ELSEIF INSERT("후배위")
			LOCAL -= 2
		ELSEIF INSERT("대면좌위") || INSERT("와일드스윙")
			LOCAL = 0
		ELSE
			LOCAL -= 1
		ENDIF
	ENDIF
CASE "好みの자위"
	;好きな場所決定(優先度はＣ＞Ｖ＞Ｂ＞Ａ＞)
	;ARGは実行中のSEELCTCOMに相当する値が代入されている（커맨드선택時ではARG == 3）
	;ただし, 인서트されている時に弄れないであろう場所等は選べない
	LOCAL:1 = ABL:Ｃ감각 + TALENT:음핵*2

	LOCAL:2 = ABL:Ｖ감각 + TALENT:음호*2
	SIF TEQUIP:바이브 && CHECK("바이브")
		LOCAL:2 += 3
	SIF TALENT:하피 || USE_V(TARGET, 11) == 0
		LOCAL:2 = 0
	SIF TALENT:처녀
		LOCAL:2 = -1

	LOCAL:3 = ABL:Ａ감각 + TALENT:애널광*2
	SIF TEQUIP:애널바이브 && CHECK("Ａ바이브")
		LOCAL:3 += 3
	SIF ABL:Ａ감각 < 3 || TALENT:하피 || USE_A(TARGET, 13) == 0
		LOCAL:3 = 0

	LOCAL:4 = ABL:Ｂ감각 + TALENT:음유*2
	SIF ARG == 92 || ARG == 104 || CHECK_COM("파이즈리펠라") || CHECK_COM("파후파후손훑기")
		LOCAL:4 = 0
	SIF CHECK_SHIRT("갑옷") && CHECK_CLO("가슴골노출") + CHECK_CLO("유두노출") + CHECK_CLO("はだけ可") == 0
		LOCAL:4 = 0

	LOCAL:5 = ABL:Ｃ감각 + TALENT:요도광*2
	SIF TALENT:요도성감 == 0
		LOCAL:5 = 0

	;まだ未整備
	LOCAL:5 = 0

	;Ｃと
	SELECTCASE ARG
	CASE 60 TO 69, 70, 73, 177
		LOCAL:2 = 0
		SIF PENIS(TARGET) == 0
			LOCAL:5 = 0
	CASEELSE
		IF INSERT("Ｖ인서트") || INSERT("정상위") || INSERT("대면좌위")
			LOCAL:2 = 0
			SIF PENIS(TARGET) == 0
				LOCAL:5 = 0
		ENDIF
	ENDSELECT
	;Ａ
	SELECTCASE ARG
	CASE 60 TO 62, 64, 70 TO 79, 177
		LOCAL:3 = 0
	CASEELSE
		SIF INSERT("Ａ인서트") || INSERT("정상위") || INSERT("후배위") || INSERT("굴곡위") || INSERT("배면좌위")
			LOCAL:3 = 0
	ENDSELECT

	;好きな場所決定(優先度はＣ＞Ｖ＞Ｂ＞Ａ＞)
	IF LOCAL:1 >= MAX(LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5)
		;Ｃ자위
		SETBIT LOCAL, 0
	ELSEIF LOCAL:2 >= MAX(LOCAL:3, LOCAL:4, LOCAL:5)
		;Ｖ자위
		SETBIT LOCAL, 1
	ELSEIF LOCAL:4 >= MAX(LOCAL:3, LOCAL:5)
		;Ｂ자위
		SETBIT LOCAL, 3
	ELSEIF LOCAL:3 >= LOCAL:5
		;Ａ자위
		SETBIT LOCAL, 2
	ELSE
		;자위
		SETBIT LOCAL, 4
	ENDIF
CASE "정액好き度"
	LOCAL = (TCVAR:28 + 30) / 20
CASE "실금"
	;だいたい, 値が5이상だと실금してしまう
	;사정했다or절정して無いor요의が無いor남자orＶ확장벌룬
	SIF NOWEX:ARG:사정 || NOWEX:ARG:절정수합계 == 0 || BASE:ARG:요의 < 1000 || TALENT:ARG:남자 || TEQUIP:ARG:확장벌룬 == 1 || COND("요도사용中", ARG)
		RETURNF 0
	SIF GETBIT(TEQUIP:ARG:근육이완제, 1) == 0 && ABL:ARG:요도확장 < 0 && TALENT:ARG:오줌싸개버릇 == 0 && BASE:ARG:요의 < 10000
		RETURNF 0
	LOCAL = BASE:ARG:요의 / 5000

	;Gスポ刺激
	IF CHECK_COM("Ｇ스팟자극") || SELECTCOM == 66
		LOCAL += 1
		;前のターンからしつこく責めている
		SIF PREVPLAY("Ｇ스팟자극")
			LOCAL += 3
	ENDIF
	SIF BASE:ARG:기력 <= 0
		LOCAL += 1
	SIF MAX(EX:ARG:Ｃ절정, EX:ARG:Ｖ절정, EX:ARG:Ａ절정, EX:ARG:요도절정) >= 20
		LOCAL += 1
	SIF PALAM:ARG:연속절정COMBO수 >= 5
		LOCAL += PALAM:ARG:연속절정COMBO수 / 5
	IF NOWEX:ARG:절정수합계 >= 5
		LOCAL += 2
	ELSEIF NOWEX:ARG:절정수합계 >= 3
		LOCAL += 1
	ENDIF
	SIF GETBIT(TEQUIP:ARG:근육이완제, 1)
		LOCAL += 2
	;年齢層보정
	SIF AGE(ARG) >= 3 && LOCAL >= 1
		LOCAL -= 1
	SIF TALENT:ARG:오줌싸개버릇
		LOCAL += 3
	;요도확장…初期値が-2なのでそれを考慮
	IF ABL:ARG:요도확장 >= 0
		LOCAL += ABL:ARG:요도확장 + 1
		SIF BASE:ARG:요의 >= MAXBASE:ARG:요의
			LOCAL += 2
	ELSEIF EXP:ARG:요도확장경험 >= 20
		LOCAL += 1
	ENDIF
CASE "랜덤사정"
	IF RAND:2 == 0
		LOCAL = 0
	ELSEIF RAND:3
		;입→얼굴
		IF SHOOT("입")
			LOCAL = 2
		;손か가슴→입
		ELSEIF SHOOT("손") || SHOOT("가슴")
			LOCAL = 3
		;삽입系→お腹か엉덩이
		ELSEIF SHOOT("질内") || SHOOT("애널")
			IF INSERT("후배위") || INSERT("배면좌위")
				LOCAL = 7
			ELSE
				LOCAL = 6
			ENDIF
		;→가랑이
		ELSE
			LOCAL = 5
		ENDIF
	ELSE
		;입→머리카락얼굴가슴가랑이
		IF SHOOT("입")
			LOCAL = 1 + RAND:2 + 3*RAND:2
		;손or삽입系→머리카락얼굴입가슴가랑이
		ELSEIF SHOOT("손") || SHOOT("질内") || SHOOT("애널")
			LOCAL = 1 + RAND:5
		;가슴→머리카락얼굴입가랑이
		ELSEIF SHOOT("가슴")
			LOCAL = LIMIT(1 + RAND:3 + 5*(RAND:4 == 0), 1, 5)
		;その他
		ELSE
			LOCAL = LIMIT(1 + RAND:2 + 5*(RAND:3 == 0), 1, 5)
		ENDIF
	ENDIF
CASE "칭찬하기"
	;基本は호감도+前回절정と절정回수합계
	LOCAL = MIN(CFLAG:2/50, 50)
	;前回절정した
	SIF PREVEX("절정수합계")
		LOCAL += 20
	;호색
	LOCAL += 30 * TALENT:호색
	;부끄럼쟁이
	LOCAL += 5 * TALENT:부끄럼쟁이
	;겁쟁이
	LOCAL += 5 * TALENT:겁쟁이
	;헌신的
	LOCAL += 15 * TALENT:헌신
	;유치
	LOCAL += 20 * TALENT:유치
	;솔직
	LOCAL += 5 * TALENT:솔직
	;호기심
	LOCAL += 5 * TALENT:호기심
	;楽観的
	LOCAL += 30 * TALENT:양기
	;눈에띄고싶어함
	LOCAL += 10 * TALENT:눈에띄고싶어함
	;해방
	LOCAL += 5 * TALENT:해방
	;미련함
	LOCAL += 20 * TALENT:미련함
	;음란
	LOCAL += 5 * TALENT:음란
	;연모
	LOCAL += 10 * TALENT:연모
	;망신
	LOCAL += 10 * TALENT:망신
	;서약
	SIF TALENT:서약
		LOCAL += 2
	;상사상애
	SIF TALENT:상사상애
		LOCAL += 10
	;ABL순종
	LOCAL += ABL:순종 * 8
	SELECTCASE TFLAG:16
	CASE 1
		LOCAL += (ABL:봉사정신 + ABL:정액중독) * 5
	CASE 2
		LOCAL += ABL:Ｖ감각 * 5
		;처녀상실時に굴복각인Lv1未満
		SIF PREVEX("처녀상실") && MARK:굴복각인 <= 1
			LOCAL -= 25
	CASE 3
		LOCAL += ABL:Ａ감각 * 5
	CASE 4
		LOCAL += ABL:마조끼 * 10
		;SM系実行時で, 마조끼3未満である
		SIF ABL:마조끼 < 3
			LOCAL -= 45
	CASE 5, 6
		LOCAL += ABL:노출벽 * 10
		;부끄럼쟁이+노출벽5未満＆羞恥系実行
		SIF TALENT:부끄럼쟁이 && ABL:노출벽 < 5
			LOCAL -= 35
		;羞恥系実行時で, 노출벽5未満である
		SIF TFLAG:16 == 5 && ABL:노출벽 < 5
			LOCAL -= 15
		SIF TFLAG:16 == 6 && ABL:노출벽 < 5
			LOCAL -= 50
	ENDSELECT
	;굴복각인
	LOCAL += MARK:굴복각인 * 10
	;ABL기교
	LOCAL += ABL:PLAYER:기교 * 5
	;なぜか詩集の持ってる数も影響
	LOCAL += ITEM:로즈닐의시집

	;成功率Down보정
	;반발각인
	LOCAL -= MARK:반발각인 * 10
	;바이브삽입中
	SIF TEQUIP:바이브
		LOCAL -= 2
	;애널바이브삽입中
	SIF TEQUIP:애널바이브
		LOCAL -= 3
	;클리캡, 니플캡, 착유기, 오나홀のいずれか사용중
	SIF TEQUIP:클리캡 || TEQUIP:니플캡 || TEQUIP:착유기 || TEQUIP:오나홀
		LOCAL -= 2
	;이뇨제사용중
	SIF TEQUIP:이뇨제
		LOCAL -= 5
	;縄사용중
	SIF TEQUIP:구속
		LOCAL -= 5
	;볼개그사용중
	SIF TEQUIP:재갈
		LOCAL -= 3
	;관장, 공기관장, 확장벌룬のいずれか사용중
	SIF TEQUIP:관장 || TEQUIP:확장벌룬
		LOCAL -= 10
CASE "달콤한말"
	LOCAL = MAX(CFLAG:269*20 + 500, 1800)
	;겁쟁이
	SIF TALENT:겁쟁이
		TIMES LOCAL, 1.25
	;반항적
	SIF TALENT:반항적
		TIMES LOCAL, 1.50
	;꿋꿋함
	SIF TALENT:꿋꿋함
		TIMES LOCAL, 2.00
	;건방짐
	SIF TALENT:건방짐
		TIMES LOCAL, 1.50
	;自制心
	SIF TALENT:냉정
		TIMES LOCAL, 1.25
	;무관심
	SIF TALENT:무관심
		TIMES LOCAL, 1.50
	;감정결핍
	SIF TALENT:감정결핍
		TIMES LOCAL, 1.50
	;보수적
	SIF TALENT:보수적
		TIMES LOCAL, 1.25
	;悲観的
	SIF TALENT:음기
		TIMES LOCAL, 1.25
	;일선을넘지않음
	SIF TALENT:일선을넘지않음
		TIMES LOCAL, 1.50
	;저항
	SIF TALENT:저항
		TIMES LOCAL, 2.00
	;부끄럼쟁이
	SIF TALENT:부끄럼쟁이
		TIMES LOCAL, 1.25
	;남성혐오
	SIF TALENT:남성혐오 && TALENT:PLAYER:남자
		TIMES LOCAL, 1.50
	;광기
	SIF TALENT:광기
		TIMES LOCAL, 2.00
CASE "성감대突かれ"
	SELECTCASE ARG
	CASE 90, 97
		SIF GETBIT(TALENT:PLAYER:성감대, 0)
			LOCAL += 5
	CASE 91, 99, 140, 150
		SIF GETBIT(TALENT:PLAYER:성감대, 1)
			LOCAL += 5
	CASE 5, 81, 92, 94, 104
		SIF GETBIT(TALENT:PLAYER:성감대, 2)
			LOCAL += 5
	CASE 95
		SIF GETBIT(TALENT:PLAYER:성감대, 3)
			LOCAL += 5
	CASE 1, 60 TO 69
		SIF GETBIT(TALENT:PLAYER:성감대, 4)
			LOCAL += 5
		SIF GETBIT(TALENT:PLAYER:성감대, 4) && TEQUIP:넘어뜨리기 && SELECTCOM == 1
			LOCAL += 5
		SIF GETBIT(TALENT:PLAYER:성감대, 5) && ARG == 63
			LOCAL += 5
	CASE 6
		SIF GETBIT(TALENT:PLAYER:성감대, 5)
			LOCAL += 5
	CASE 2, 9, 70 TO 79
		SIF GETBIT(TALENT:PLAYER:성감대, 6)
			LOCAL += 5
		SIF GETBIT(TALENT:PLAYER:성감대, 5) && ARG == 73
			LOCAL += 5
	ENDSELECT
	FOR LCOUNT, 0, NUM("속성")
		SIF GETBIT(BASE:속성, LCOUNT) && GETBIT(TALENT:MASTER:성벽, LCOUNT)
			LOCAL += 3
	NEXT
CASE "고통각인획득"
	SIF TEQUIP:ARG:넘어뜨리기 || SELECTCOM == 280
		RETURNF 0
	SELECTCASE CUP:ARG:고통
	CASE IS >= 30000
		SIF MARK:ARG:고통각인 < 3
			RETURNF 3
	CASE IS >= 10000
		SIF MARK:ARG:고통각인 < 2
			RETURNF 2
	CASE IS >= 3000
		SIF MARK:ARG:고통각인 < 1
			RETURNF 1
	ENDSELECT
	RETURNF 0
CASE "반발각인획득"
	SIF TEQUIP:ARG:넘어뜨리기 || TCVAR:ARG:28 > 10 || SELECTCOM == 280
		RETURNF 0
	LOCAL = CUP:ARG:반감
	SELECTCASE MARK:ARG:고통각인
	CASE 1
		LOCAL -= 500
	CASE 2
		LOCAL -= 1500
	CASE 3
		LOCAL -= 4000
	ENDSELECT
	SELECTCASE MARK:ARG:쾌락각인
	CASE 1
		LOCAL -= 100
	CASE 2
		LOCAL -= 500
	CASE 3
		LOCAL -= 1000
	ENDSELECT
	SELECTCASE MARK:ARG:굴복각인
	CASE 1
		LOCAL -= 500
	CASE 2
		LOCAL -= 1000
	CASE 3
		LOCAL -= 2000
	ENDSELECT
	SELECTCASE LOCAL
	CASE IS >= 10000
		SIF MARK:ARG:반발각인 < 3
			RETURNF 3
	CASE IS >= 3000
		SIF MARK:ARG:반발각인 < 2
			RETURNF 2
	CASE IS >= 500
		SIF MARK:ARG:반발각인 < 1
			RETURNF 1
	ENDSELECT
	RETURNF 0
CASE "경험치획득"
	;今回イかせた＆사정させた
	IF ARG == TARGET
		;何かやった
		SIF PREVCOM >= 0
			LOCAL += 1
		SIF EXP_GAIN(2, ARG) + EXP_GAIN(3, ARG)
			LOCAL += (EXP_GAIN(2, ARG) + EXP_GAIN(3, ARG) ) / 5 + 1
		;성욕대만족（탐색での경험보너스もこれ）
		IF BASE:성욕 >= MAXBASE:성욕*2
			LOCAL += MAX(MAXBASE:성욕, 10)
		;성욕만족
		ELSEIF BASE:성욕 >= MAXBASE:성욕
			LOCAL += MAX(MAXBASE:성욕/2, 5)
		ENDIF

		;상대の方がＬＶが高い
		IF ABL:ARG:ＬＶ - FLAG:255 > 0
			SIF EXP_GAIN(2, MASTER) + EXP_GAIN(3, MASTER)
				LOCAL += (EXP_GAIN(2, MASTER) + EXP_GAIN(3, MASTER) ) / 3 + 1
			;搾り取られてしまった
			SIF STATE("撃沈", MASTER)
				LOCAL += LIMIT( (ABL:ARG:ＬＶ - FLAG:255)/2, 5, 10)
		ENDIF
	ENDIF
	;굴복각인
	IF MARK:ARG:굴복각인 && GETBIT(CFLAG:ARG:33, 0) == 0
		LOCAL += 30
		SETBIT CFLAG:ARG:33, 0
	ENDIF
	IF MARK:ARG:굴복각인 >= 2 && GETBIT(CFLAG:ARG:33, 1) == 0
		LOCAL += 30
		SETBIT CFLAG:ARG:33, 1
	ENDIF
	IF MARK:ARG:굴복각인 == 3 && GETBIT(CFLAG:ARG:33, 2) == 0
		LOCAL += 50
		SETBIT CFLAG:ARG:33, 2
	ENDIF
	;연모음란
	IF TALENT:ARG:음란 && GETBIT(CFLAG:ARG:33, 3) == 0
		LOCAL += 60
		SETBIT CFLAG:ARG:33, 3
	ENDIF
	IF TALENT:ARG:연모 && GETBIT(CFLAG:ARG:33, 4) == 0
		LOCAL += 60
		SETBIT CFLAG:ARG:33, 4
	ENDIF

	;与えた절정경험or사정경험の大きい値を見る
	LOCAL:1 = EXP:ARG:절정경험 - CSVEXP(NO:ARG, 2, 0)
	LOCAL:2 = MAX(EXP:ARG:사정경험 - CSVEXP(NO:ARG, 3, 0), LOCAL:1)

	;절정or사정경험
	IF LOCAL:2 > 0 && GETBIT(CFLAG:ARG:33, 5) == 0
		LOCAL += 10
		SETBIT CFLAG:ARG:33, 5
	ENDIF
	IF LOCAL:2 >= 50 && GETBIT(CFLAG:ARG:33, 6) == 0
		LOCAL += 20
		SETBIT CFLAG:ARG:33, 6
	ENDIF
	IF LOCAL:2 >= 200 && GETBIT(CFLAG:ARG:33, 7) == 0
		LOCAL += 40
		SETBIT CFLAG:ARG:33, 7
	ENDIF

	;음호など
	IF TALENT:ARG:음호+TALENT:ARG:애널광+TALENT:ARG:음유+TALENT:ARG:음핵+TALENT:ARG:음탕한입술 && GETBIT(CFLAG:ARG:33, 8) == 0
		LOCAL += 30
		SETBIT CFLAG:ARG:33, 8
	ENDIF

	;상대の方がLVが高い
	IF ABL:ARG:ＬＶ - FLAG:255 > 0
		LOCAL = MULTIPLY(LOCAL, 100 + (ABL:ARG:ＬＶ - FLAG:255)*10 + TALENT:ARG:상위몽마*20)
	;상대のLVが低い
	ELSEIF FLAG:255 - ABL:ARG:ＬＶ > 0
		TIMES LOCAL, 0.50
	ENDIF
	;악세사리効果（取得경험치）
	SIF TALENT:MASTER:습득경험치율 > 0
		LOCAL = MULTIPLY(LOCAL, 100 + TALENT:MASTER:습득경험치율)

	;EASY모드
	SIF CONFIG("ＥＡＳＹ")
		TIMES LOCAL, 2.00
CASE "바스트사이즈보정"
	SIF ARG:1 == 0 && TARGET
		ARG:1 = TARGET
	;요정なら値は半分, 小柄ならちょっと寸胴
	IF TALENT:(ARG:1):요정
		ARG /= 2
	ELSEIF TALENT:(ARG:1):작은몸집
		ARG -= 3
	ENDIF
	RETURNF ARG
CASE "トップ바스트と속옷の差"
	;0, 5, 8, 10, 13, 15, 18, 20, …
	SIF ARG == 0
		RETURNF 0
	RETURNF (ARG + 1)/2*5 + (ARG + 1)%2*3
CASE "바스트컵"
	;(0, 0-4), (1, 5-7), (2, 8-9), …
	RETURNF MAX(ARG/5*2 + ARG%5/3 - 1, 0)
CASE "바스트컵計算値"
	IF COND("오토코노코", ARG)
		RETURNF 0
	ELSEIF TALENT:ARG:요정
		RETURNF (BASE:ARG:바스트 + BASE:ARG:바스트의성장/10 - MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트) ) * 2
	ELSEIF TALENT:ARG:작은몸집
		RETURNF MAX(BASE:ARG:바스트 + BASE:ARG:바스트의성장/10 - MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트), 5)
	ELSE
		RETURNF BASE:ARG:바스트 + BASE:ARG:바스트의성장/10 - MAX(BASE:ARG:신장*432/1000, BASE:ARG:웨스트)
	ENDIF
CASE "남자特有の소질"
	SELECTCASE ARG
	CASE 58, 65, 98, 133, 134
		RETURNF 1
	CASEELSE
		RETURNF 0
	ENDSELECT
CASE "여자特有の소질"
	SELECTCASE ARG
	CASE 0, 44, 74, 103, 104, 109, 110, 130, 135, 137, 197, 221, 225
		RETURNF 1
	CASEELSE
		RETURNF 0
	ENDSELECT
CASE "逆の소질"
	SELECTCASE ARG
	CASE 10
		RETURNF 12
	CASE 12
		RETURNF 10
	CASE 11
		RETURNF 63
	CASE 63
		RETURNF 11
	CASE 13
		RETURNF 16
	CASE 16
		RETURNF 13
	CASE 14
		RETURNF 18
	CASE 18
		RETURNF 14
	CASE 15
		RETURNF 17
	CASE 17
		RETURNF 15
	CASE 20
		RETURNF 28
	CASE 28
		RETURNF 20
	CASE 23
		RETURNF 24
	CASE 24
		RETURNF 23
	CASE 25
		RETURNF 26
	CASE 26
		RETURNF 25
	CASE 27
		RETURNF 38
	CASE 38
		RETURNF 27
	CASE 30
		RETURNF 31
	CASE 31
		RETURNF 30
	CASE 32
		RETURNF 33
	CASE 33
		RETURNF 32
	CASE 35
		RETURNF 36
	CASE 36
		RETURNF 35
	CASE 40
		RETURNF 41
	CASE 41
		RETURNF 40
	CASE 42
		RETURNF 43
	CASE 43
		RETURNF 42
	CASE 46
		RETURNF 47
	CASE 47
		RETURNF 46
	CASE 50
		RETURNF 51
	CASE 51
		RETURNF 50
	CASE 58
		RETURNF 133
	CASE 133
		RETURNF 58
	CASE 61
		RETURNF 62
	CASE 62
		RETURNF 61
	CASE 70
		RETURNF 71
	CASE 71
		RETURNF 70
	CASE 81
		RETURNF 82
	CASE 82
		RETURNF 81
	CASE 96
		RETURNF 97
	CASE 97
		RETURNF 96
	CASE 99
		RETURNF 100
	CASE 100
		RETURNF 99
	CASE 101
		RETURNF 102
	CASE 102
		RETURNF 101
	CASE 103
		RETURNF 104
	CASE 104
		RETURNF 103
	CASE 105
		RETURNF 106
	CASE 106
		RETURNF 105
	CASE 107
		RETURNF 108
	CASE 108
		RETURNF 107
	CASE 109
		RETURNF 110
	CASE 110
		RETURNF 109
	CASE 111
		RETURNF 112
	CASE 112
		RETURNF 111
	CASE 115
		RETURNF 116
	CASE 116
		RETURNF 115
	ENDSELECT
	RETURNF 0
CASE "遺伝가능な소질"
	;一部遺伝しない소질がある. 遺伝できないなら0, 遺伝できるなら1を返す. 
	;딸に必ずついている소질と矛盾するため打ち消される소질はここでは判定せず, 
	;そもそも遺伝できないようなもののみ判定する
	;また, 빈유,거유,광기は특수なためここでは判定しない. 
	SELECTCASE ARG
	;知識がない(바늘다루기などは才能、허리놀림などは종족の血とする)
	;조합지식,금단의지식,달콤한말,손대중,미니멈,센시브,우르즈군
	;시길군,에올군,스톡,로긴,투와이스,이사군,아르스이사
	CASE 55, 125, 185, 191, 192, 230 TO 259
		RETURNF 0
	;条件で何もしなくても消えるもの
	;억압,저항
	CASE 32, 24
		RETURNF 0
	;後天的なもの(오줌싸개버릇は幼児なので除く)
	;弱み,Ｖ손상,Ａ손상,백발백중,소환천재（天才）,소환천재（天災）,음호,음란,애널광,음유,음핵
	;새드,질투,연모,망신,마조,음탕한입술,마음에듬,첫사람,후타나리,모유체질,임신
	;출산경험,피임中,서약,상사상애,클리피어스,라비아피어스,니플피어스,배꼽피어스
	CASE 37, 44, 45, 65 TO 67, 74, 76 TO 79, 83 TO 86, 88, 89, 93, 94, 121, 126, 130, 135 TO 137, 210, 211, 220 TO 223
		RETURNF 0
	;男関係・당신専用のもの
	;지루,오토코노코,남자,조루,동정,성감대,성벽
	CASE 58, 98, 122, 133, 134, 194, 195
		RETURNF 0
	;その他
	CASE 140 TO 149, 170 TO 179, 196 TO 199, 212 TO 219, 224 TO 229
		RETURNF 0
	ENDSELECT
	RETURNF 1
CASE "성격소질"
	;딸の성격変化に関係する소질なら1, そうでなければ0を返す. 
	;겁쟁이,반항적,꿋꿋함,솔직,내성적,교만,건방짐,프라이드낮음,강기,심술쟁이,냉정,무관심,감정결핍
	;호기심,보수적,양기,음기,눈에띄고싶어함,부끄럼쟁이,부끄럼없음,반하기쉬움,청초,헌신,호색,소악마
	SELECTCASE ARG
		CASE 10 TO 26, 28, 35, 36, 38, 39, 63, 75, 87
			RETURNF 1
	ENDSELECT
	RETURNF 0
CASE "성장後に変化する소질"
	;CFLAG:484のビット番号を引数に, 소질への対応を返す. 
	;BIT演算で, 2=무관심(21), 3=호기심(23), 4=보수적(24), 5=아픔에약함(40), 6=아픔에강함(41), 7=장신(99), 8=小柄体系(100), 9=유치(132)
	SELECTCASE ARG
	CASE 2
		RETURNF 21
	CASE 3
		RETURNF 23
	CASE 4
		RETURNF 24
	CASE 5
		RETURNF 40
	CASE 6
		RETURNF 41
	CASE 7
		RETURNF 99
	CASE 8
		RETURNF 100
	CASE 9
		RETURNF 132
	ENDSELECT
	RETURNF 0

CASE "最愛の상대"
	SIF TALENT:MASTER:상사상애 == 0
		RETURNF 0
	FOR LCOUNT, 2, CHARANUM
		SIF TALENT:LCOUNT:연모 == 0 || TALENT:LCOUNT:상사상애 == 0
			CONTINUE
		SIF LOCAL == 0 || CFLAG:LCOUNT:2 > CFLAG:LOCAL:2
			LOCAL = LCOUNT
	NEXT
CASE "다방の給금"
	;다방のバイトで稼ぐ額. 100万までは100分の一. 
	LOCAL:1 = CFLAG:ARG:40 / 100
	SELECTCASE LOCAL:1
	CASE IS < 10000
		LOCAL = LOCAL:1
	CASE IS < 100000
		LOCAL = LOCAL:1/9 + 9000
	CASE IS < 1000000
		LOCAL = LOCAL:1/90 + 19000
	CASEELSE
		LOCAL = 30000
	ENDSELECT
CASEELSE
	THROW %GAMEBASE_YEAR% Ver.{VER_ERASQN()} BUG : "%ARGS%" 를 찾을 수 없습니다.
ENDSELECT
RETURNF LOCAL

