;--------------------------------------------------------
;청소컨닐링구스
;--------------------------------------------------------
@OSOUJI_V
PRINTFORM %조사처리(CALLNAME:TARGET,"는")% %CALLNAME:PLAYER%의 그곳을 벌리고, 
IF ABL:레즈끼 >= 3 && RAND:2 == 0
	PRINTFORMW 질구를 훌쩍이며 빨아서 확실히 안쪽까지 깨끗하게했다…
ELSE
	PRINTFORMW 더러운 것을 혀로 세심하게 핥았다…
ENDIF

;経験や汚れなどの処理は全部ここで行う
CALL SETFLAG, "청소컨닐링구스", TARGET

PRINTFORML 커닐링구스경험＋１
PRINTFORML 청소쿤니경험＋１
PRINTL 

;CALL SELF_KOJO, "청소컨닐링구스"

;--------------------------------------------------------
;청소펠라
;--------------------------------------------------------
@OSOUJI_F
CALL CHECK_BASEPLAYER2
LOCAL = (ABL:봉사정신 * 5) + ABL:기교

;애널汚れ
IF CHECK_STAIN(STAIN:PLAYER:Ｐ, "Ａ")
	LOCAL -= 10
	;A감각
	SIF ABL:Ａ감각 >= 3
		LOCAL += 2
	SIF ABL:Ａ감각 >= 5
		LOCAL += 5
	;애널광
	SIF TALENT:애널광
		LOCAL += 10
	;악취둔감
	SIF TALENT:악취둔감
		LOCAL += 5
	;악취민감
	SIF TALENT:악취민감
		LOCAL -= 5
ENDIF
;솔직
SIF TALENT:솔직
	LOCAL += 5
;プライド高い
SIF TALENT:교만
	LOCAL -= 10
;프라이드낮음
SIF TALENT:프라이드낮음
	LOCAL += 5
;헌신的
SIF TALENT:헌신
	LOCAL += 10
;음란
SIF TALENT:음란
	LOCAL += 5
;남성혐오
SIF TALENT:남성혐오
	LOCAL -= 10
;연모
SIF TALENT:연모
	LOCAL += 10
;반발각인
IF MARK:반발각인 == 1
	LOCAL -= 5
ELSEIF MARK:반발각인 == 2
	LOCAL -= 15
ELSEIF MARK:반발각인 == 3
	LOCAL = 30
ENDIF

;焦らし中はこんなことする余裕はありません
SIF (NOWEX:Ｍ절정직전멈춤 && CUP:쾌Ｃ) || (NOWEX:Ｃ절정직전멈춤 + NOWEX:요도절정직전멈춤 && CUP:쾌Ｃ) || (NOWEX:Ｖ절정직전멈춤 && CUP:쾌Ｖ) || (NOWEX:Ａ절정직전멈춤 && CUP:쾌Ａ) || (NOWEX:Ｂ절정직전멈춤 && CUP:쾌Ｂ)
	LOCAL -= 20
;러브트랩, 아이마스크, 밧줄・구속, 볼개그ではしません
SIF TEQUIP:러브트랩 || TEQUIP:아이마스크 || TEQUIP:구속 || TEQUIP:재갈 || LOCAL < 0
	RETURN 0

SIF LOCAL > RAND:100
	CALL OSOUJI


@OSOUJI

PRINTL 
;お청소前구상
TFLAG:47 = 0
CALL SELF_KOJO, "청소펠라"

IF RAND:3 == 0 || SHOOT("내사정") == 0
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 사정한 %CALLNAME:PLAYER%의 페니스를 정중하게 빨고, 물어서 구석구석까지 닦기 시작했다……
ELSEIF RAND:2 == 0
	IF INSERT("Ｖ인서트")
		PRINT 균열로부터 뽑아내진 질척질척한 페니스를,
	ELSEIF INSERT("Ａ인서트")
		PRINT 애널로부터 뽑아내진 질척질척한 페니스를,
	ELSEIF INSERT("요도인서트")
		IF PENIS(TARGET)
			PRINT 스스로의 페니스로부터 뽑아내진 질척질척한 그것을,
		ELSE
			PRINT 로부터 뽑아내진 질척질척한 페니스를,
		ENDIF
	ENDIF
	PRINTFORMW %CALLNAME:TARGET%는 사랑스러운 듯이 입에 물었다……
ELSE
	IF INSERT("Ｖ인서트")
		PRINT 균열로부터 뽑아낸 정액투성이의 페니스를 보면,
	ELSEIF INSERT("Ａ인서트")
		PRINT 애널로부터 뽑아낸 정액투성이의 페니스를 보면,
	ELSEIF INSERT("요도인서트")
		IF PENIS(TARGET)
			PRINT 스스로의 페니스로부터 뽑아낸 정액투성이의 그것을 보면,
		ELSE
			PRINT 로부터 뽑아낸 정액투성이의 페니스를 보면,
		ENDIF
	ENDIF
	PRINTFORMW %CALLNAME:TARGET%는 입맛을 다시며 천천히 입술을 접근해 왔다……
ENDIF

;お청소中구상
TFLAG:47 = 1
CALL SELF_KOJO, "청소펠라"

IF RAND:3 == 0
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 귀두를 할짝할짝 핥으며, 뒤쪽을 혀끝으로 부드럽게 칠해, 안에 아직 남아있는 정액을 부드럽게 몇번이고 빨아들였다. 
	PRINTFORMW 부드러운 쾌감이 하반신을 감싸지만, %CALLNAME:TARGET%의 입안은 너무나 부드럽고 뜨거웠다. 
	PRINTFORMW %CALLNAME:PLAYER%의 깊은 속에서, 소리를 낼듯한 기세로 정액이 모이는 것이 느껴진다……
ELSEIF RAND:2 == 0
	PRINTFORMW 상태를 세심하게 살피면서 페니스를 계속 빨자, %CALLNAME:PLAYER%의 하반신에 달콤한 저림이 퍼져간다……
ELSE
	PRINTFORMW 페니스 안에 한방울도 정액을 남기지 않겠다는 듯한 엄청난 흡입력에, 여전히 지나치게 민감한 상태인 %CALLNAME:PLAYER%의 페니스는 농락당했다……
ENDIF

;사정게이지
LOCAL = (ABL:기교 + (ABL:봉사정신 + 1)/2 + ABL:혀놀림) * 2000 * (RAND:5 + (ABL:봉사정신 + 1)/2 + 1)

SIF ABL:PLAYER:기교
	LOCAL /= ABL:PLAYER:기교
;LVの差による보정
LOCAL = MULTIPLY(LOCAL, LIMIT(5*(ABL:ＬＶ - ABL:PLAYER:ＬＶ), -30, 100) + 100)

SIF COND("입에약함", PLAYER)
	TIMES LOCAL, 2.00
BASE:PLAYER:절정 += LOCAL

;사정게이지増加の一時保存
TCVAR:PLAYER:101 += LOCAL

PRINTL 

;페니스を抜く処理
CALL RESET_INSERT, TARGET, PLAYER

;お청소で사정しなかった
IF BASE:PLAYER:절정 < MAXBASE:PLAYER:절정
	;청소で사정しなかった
	TFLAG:47 = 2
	CALL SELF_KOJO, "청소펠라"

	IF RAND:2 == 0
		PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% %조사처리(CALLNAME:PLAYER,"를")% 슬그머니 쳐다보고, 정성스럽게 혀를 사용하기시작했다. 
		PRINTFORMW 황홀하고, 적당한 쾌감이 %CALLNAME:PLAYER%의 몸을 감싸간다……
	ELSE
		PRINTFORMW %CALLNAME:TARGET%의 입에서 천천히 떨어지자, 부족한 느낌이 근질근질 기어올라온다……
	ENDIF
	PRINTL 

;お청소で사정しそう？
ELSE
	;청소で사정しそう？
	TFLAG:47 = 3
	CALL SELF_KOJO, "청소펠라"

	IF RAND:3 == 0
		PRINTFORMW 완전히 가라앉아있어야할 페니스가 다시 팽팽하게 긴장되고, 허리가 떨릴정도의 쾌감이 등골을 잇달아 달려올라갔다. 
	ELSEIF RAND:2 == 0
		PRINTFORMW %조사처리(CALLNAME:TARGET,"는")%, 다시천천히 당신의 페니스에 입을 가져갔다……
	ELSE
		PRINTFORMW %조사처리(CALLNAME:TARGET,"는")%, 진지한얼굴로 다시 페니스를 입에 물고 괴롭히기시작했다. 
		PRINTFORMW 갓 사정한 페니스를 정성스럽게 빨리며, 도를 넘은 강렬한 쾌감에 농락당하는 %조사처리(CALLNAME:PLAYER,"는")% 정신을 차리지 못했다……
	ENDIF
	PRINTL 

	;사정した
	TFLAG:47 = 4
	CALL SELF_KOJO, "청소펠라"

	IF RAND:3 == 0
		PRINTFORMW 억지로 쥐어짜여진 정액이 페니스를 통과한 순간, 최초의 사정 이상의 쾌감이 전신을 튀게했다……
	ELSEIF RAND:2 == 0
		PRINTFORMW %조사처리(CALLNAME:TARGET,"가")% 강렬하게 귀두를 빨아들인 순간, 다시금 정액이 폭발했다. 
		PRINTFORMW 시야가 하얗게 될 정도의 쾌감이 %조사처리(CALLNAME:PLAYER,"를")% 휩쓴다……
	ELSE
		PRINTFORMW 몇번이나 함숨을 쉬면서, 기습적으로 목 안쪽까지 단번에 집어넣자, 한순간도 버티지 못하고 %조사처리(CALLNAME:PLAYER,"는")% 절정에 몸을 튕겼다……
	ENDIF
	PRINTL 

	CALL BOUHATSU, "청소펠라"

	;お청소で사정後
	TFLAG:47 = 5
	CALL SELF_KOJO, "청소펠라"

	IF NO:TARGET == 20
		PRINTFORMW 이번에야말로 「사악한 기운」을 마지막까지 깨끗하게 하려는 듯 요도안까지 계속 빨아들이는 %CALLNAME:TARGET%에게, %조사처리(CALLNAME:PLAYER,"는")% 저항할 힘도 없이 몸을 맡길 수 밖에 없었다……
	ELSE
		PRINTFORMW 분출하는 정액을 얼굴에 받으면서, %조사처리(CALLNAME:TARGET,"는")% 행복한듯이 웃고있었다……
	ENDIF
	PRINTL 
	;ダウン判定
	CALL COUNTER_DOWN
ENDIF

;経験や汚れなどの処理は全部ここで行う
CALL SETFLAG, "청소펠라", TARGET

PRINTFORML 펠라경험＋１
PRINTFORML 청소펠라경험＋１
PRINTL 

RETURN 1

;-------------------------------------------------
;※폭발判定
;-------------------------------------------------
@BOUHATSU, ARGS
CALL CHECK_BASEPLAYER2
;정력が既にないなら終了
SIF BASE:PLAYER:정력 < 0
	RETURN 0

;절정許可
TCVAR:PLAYER:2 = 1

;사정ＬＶの計算
LOCAL = CALCF("절정", PLAYER)

;사정してないなら終了
SIF LOCAL == 0
	RETURN 0

;女はMAX3
;SIF PENIS(PLAYER) == 0 && LOCAL >= 4
;	LOCAL = 3

PRINTL 

;퀸메이브専用焦らし모드
IF CFLAG:459 > 0 && NO:TARGET == 17
	LOCAL = MIN(LOCAL, BASE:PLAYER:정력 - 1)
	CFLAG:459 = 0
ENDIF

;페니스あり
IF PENIS(PLAYER)
	;삽입前に폭발
	IF COND("삽입前폭발플래그", PLAYER)
		CALL SELF_KOJO, "삽입前폭발"
		PRINTFORMW …일 것이었던 것이지만
		PRINTFORMW 흥분의 별로, 삽입하기 전에%CALLNAME:TARGET%의 가랑이에정액를 흩뿌려 버렸다…
	ELSE
		PRINTFORMW %조사처리(CALLNAME:PLAYER,"는")% 견디지 않고사정해 버렸다……
	ENDIF
	
	NOWEX:PLAYER:사정 = LOCAL
	EX:PLAYER:사정 += NOWEX:PLAYER:사정
	EXP:PLAYER:사정경험 += NOWEX:PLAYER:사정
	EXP:정액경험 += LOCAL * 2
	IF LOCAL >= 3
		PRINTFORM 초대량
	ELSEIF LOCAL == 2
		PRINTFORM 대량
	ENDIF
	PRINTL 사정
	PRINTFORML 정액경험＋{LOCAL * 2}

	;PLAYERの페니스に정액汚れを追加
	CALL ADD_STAIN, PLAYER, "Ｐ", "정액"
	;정액を出したところに정액汚れを追加
	IF COND("삽입前폭발플래그", PLAYER)
		CALL ADD_STAIN, TARGET, "Ｖ", "정액"
	;입に汚れを追加
	ELSEIF SELECTCOM == 91 || SELECTCOM == 99 || SELECTCOM == 140 || ARGS == "청소펠라"
		;몽마の입⇔조교자のＰの汚れが移動
		CALL EQ_STAIN, TARGET, PLAYER, 0, 2
		CALL SETFLAG, "정음경험", LOCAL
	;가슴に汚れを追加
	ELSEIF SELECTCOM == 81 || SELECTCOM == 92
		CALL ADD_STAIN, TARGET, "Ｂ", "정액"
	;Ｖに汚れを追加
	ELSEIF (SELECTCOM >= 60 && SELECTCOM <= 69) || INSERT("Ｖ인서트")
		CALL SETFLAG, "질내정액경험", LOCAL
	;Ａに汚れを追加
	ELSEIF (SELECTCOM >= 70 && SELECTCOM <= 79) || INSERT("Ａ인서트")
		CALL SETFLAG, "장내정액경험", LOCAL
	;ＶかＰに汚れを追加
	ELSEIF SELECTCOM == 83 || INSERT("요도인서트")
		CALL SETFLAG, "방광정액경험", LOCAL
	;손に汚れを追加
	ELSEIF SELECTCOM == 90 || SELECTCOM == 97
		CALL ADD_STAIN, TARGET, "손", "정액"
	ENDIF
ELSE
	PRINTFORMW %조사처리(CALLNAME:PLAYER,"는")% 견디지 못하고 가버렸다……
	EXP:PLAYER:절정경험 += LOCAL
	IF LOCAL >= 3
		PRINTFORM 초절
	ELSEIF LOCAL == 2
		PRINTFORM 강
	ENDIF
	PRINTFORML 절정
	PRINTFORML 절정경험＋{LOCAL}
ENDIF

;폭발回数
NOWEX:폭발 = LOCAL
EX:폭발 += LOCAL

;절정시킨횟수
EXP:절정시킨횟수 += 1

;堪えた플래그を初期化
EX:PLAYER:가는것을참았다 = 0

CALL GET_EXPERIENCE, LOCAL, TARGET
IF TEQUIP:Ｗ넘어뜨리기
	EXP:(TARGET:1):절정시킨횟수 += 1
	CALL GET_EXPERIENCE, LOCAL, TARGET:1
ENDIF

;정력減少
LOCAL:1 = MAX(LOCAL * 2, 1)

TCVAR:PLAYER:109 += LOCAL:1
BASE:PLAYER:정력 -= LOCAL:1
PRINTFORMW 정력-{LOCAL:1}

;사정게이지対応
BASE:PLAYER:절정 = MAXBASE:PLAYER:절정 * (1 + BASE:스톡) * BASE:정력 * (100 + STATE("우르즈군", PLAYER) * 20)
BASE:PLAYER:절정 /= (2 + BASE:스톡) * MAXBASE:정력 * LOCAL:1 * 100

BASE:PLAYER:절정 = LIMIT(BASE:PLAYER:절정, 0, MAXBASE:PLAYER:절정 - 1)

BASE:PLAYER:성감허용치남자 = BASE:PLAYER:절정

PRINTL 

RETURN 1
