@COM60
;정상위
CALL PRINT_TRAIN_NAME(SELECTCOM)

CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:0 = %STR:2%

;-------------------------------------------------
;사정체크
;-------------------------------------------------
CALL SAMEN_CHECK

RETURN 1

@FLAG_COM60, ARG
CALL FLAG_INSERTION, "Ｖ인서트", ARG, 100

@SOURCE_COM60, ARG
CALL SOURCE_INSERTION, "Ｖ인서트", ARG, 100

VARSET LOCAL

LOCAL:12 = 200

;根元まで受け入れられる場合にはクリを擦られてしまう
IF ABL:Ｖ확장 > SIZE("페니스", PLAYER) && PENIS(TARGET) == 0
	;ABL:Ｃ감각をみる
	LOCAL:0 = CALCF("Ｃ刺激", 2, 30)
	;조교자の허리놀림をみる
	LOCAL:0 = SOURCE_EXABL(LOCAL:0, 33, PLAYER)
ENDIF

;ABL:Ｖ감각をみる
SELECTCASE ABL:Ｖ감각
CASE 0
	LOCAL:3 = 150
CASE 1
	LOCAL:3 = 250
CASE 2
	LOCAL:3 = 350
CASE 3
	LOCAL:3 = 500
CASE 4
	LOCAL:3 = 700
CASEELSE
	LOCAL:3 = 1000
ENDSELECT

;PALAM:욕정をみる
SELECTCASE PALAM:욕정
CASE IS < PALAMLV:1
	TIMES LOCAL:3, 0.30
CASE IS < PALAMLV:2
	TIMES LOCAL:3, 0.60
CASE IS < PALAMLV:3
	TIMES LOCAL:3, 1.00
CASE IS < PALAMLV:4
	TIMES LOCAL:3, 1.50
CASE IS >= PALAMLV:4
	TIMES LOCAL:3, 1.80
ENDSELECT

CALL CALC, "조교소스", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@FLAG_INSERTION, ARGS, ARG, ARG:1
SELECTCASE ARGS
CASE "Ｖ인서트", "자궁삽입", "자궁구자극"
	SIF !CHECK_CLO("Ｖ노출") && CHECK_CLO("Ｖ노출可")
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET

	IF TALENT:PLAYER:동정
		CALL SETFLAG, "동정狩り플래그", TARGET
		CALL SETFLAG, "동정喪失플래그", PLAYER
	ENDIF
	;대상のＶ⇔조교자のＰの汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 3, 2
	IF PLAYER == MASTER
		IF ABL:Ｖ감각 >= 3
			TFLAG:30 += 2
		ELSE
			TFLAG:30 += 1
		ENDIF
	ENDIF
	;PLAYERの페니스のＰ윤とＶ윤の相互干渉
	IF PENIS(PLAYER)
		IF PALAM:PLAYER:Ｐ윤 >= PALAM:Ｖ윤
			CUP:Ｖ윤 += (PALAM:PLAYER:Ｐ윤 - PALAM:Ｖ윤)/2
		ELSE
			CUP:PLAYER:Ｐ윤 += (PALAM:Ｖ윤 - PALAM:PLAYER:Ｐ윤)/2
		ENDIF
	ENDIF
CASE "손가락넣기"
	;대상のＶ⇔조교자の손가락の汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 3, 1
CASE "바이브"
	SIF !CHECK_CLO("Ｖ노출") && CHECK_CLO("Ｖ노출可")
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET
CASE "Ｖ피스트"
	SIF !CHECK_CLO("Ｖ노출") && CHECK_CLO("Ｖ노출可")
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET

	;대상のＶ⇔조교자の손の汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 3, 1
CASE "Ａ인서트"
	SIF !CHECK_CLO("Ａ노출") && CHECK_CLO("Ａ노출可")
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET

	;대상のＡ⇔조교자のＰの汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 4, 2
	IF PLAYER == MASTER
		IF ABL:Ａ감각 >= 3
			TFLAG:30 += 2
		ELSE
			TFLAG:30 += 1
		ENDIF
	ENDIF
	;정액관장中は배설욕が5%上昇
	IF COND("정액관장")
		BASE:배설욕 += MULTIPLY(MAXBASE:배설욕, 5 + BASE:배설물) * ARG:1 / 100
	ELSEIF BASE:배설물 && BASE:배설욕 < MAXBASE:배설욕 - 1
		BASE:배설욕 = MIN(BASE:배설욕 + MULTIPLY(MAXBASE:배설욕, (5 + BASE:배설물)/3) * ARG:1 / 100, MAXBASE:배설욕 - 1)
	ENDIF
	;PLAYERの페니스のＰ윤とＡ윤の相互干渉
	IF PENIS(PLAYER)
		IF PALAM:PLAYER:Ｐ윤 >= PALAM:Ａ윤
			CUP:Ａ윤 += (PALAM:PLAYER:Ｐ윤 - PALAM:Ａ윤)/2
		ELSE
			CUP:PLAYER:Ｐ윤 += (PALAM:Ａ윤 - PALAM:PLAYER:Ｐ윤)/2
		ENDIF
	ENDIF
CASE "Ａ손가락넣기"
	IF TEQUIP:촉수
		;대상のＡに촉수の汚れがつく
		CALL ADD_STAIN, TARGET, "Ａ", "촉수"
	ELSE
		;대상のＡ⇔조교자の손가락の汚れが移動
		CALL EQ_STAIN, TARGET, PLAYER, 4, 1
	ENDIF
	;정액관장中は배설욕が1%上昇
	IF COND("정액관장")
		BASE:배설욕 += MULTIPLY(MAXBASE:배설욕, 1 + BASE:배설물) * ARG:1 / 100
	ELSEIF BASE:배설물 && BASE:배설욕 < MAXBASE:배설욕 - 1
		BASE:배설욕 = MIN(BASE:배설욕 + MULTIPLY(MAXBASE:배설욕, 1) * ARG:1 / 100, MAXBASE:배설욕 - 1)
	ENDIF
CASE "Ａ바이브"
	SIF !CHECK_CLO("Ａ노출") && CHECK_CLO("Ａ노출可")
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET

	;정액관장中は배설욕が5%上昇
	IF COND("정액관장")
		BASE:배설욕 += MULTIPLY(MAXBASE:배설욕, 5 + BASE:배설물) * ARG:1 / 100
	ELSEIF BASE:배설물 && BASE:배설욕 < MAXBASE:배설욕 - 1
		BASE:배설욕 = MIN(BASE:배설욕 + MULTIPLY(MAXBASE:배설욕, (5 + BASE:배설물)/3) * ARG:1 / 100, MAXBASE:배설욕 - 1)
	ENDIF
CASE "Ａ피스트"
	SIF !CHECK_CLO("Ａ노출") && CHECK_CLO("Ａ노출可")
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET

	;대상のＡ⇔조교자の손の汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 4, 1
	;정액관장中は배설욕が20%上昇
	IF COND("정액관장")
		BASE:배설욕 += MULTIPLY(MAXBASE:배설욕, 20 + BASE:배설물) * ARG:1 / 100
	ELSEIF BASE:배설물 && BASE:배설욕 < MAXBASE:배설욕 - 1
		BASE:배설욕 = MIN(BASE:배설욕 + MULTIPLY(MAXBASE:배설욕, (20 + BASE:배설물)/3) * ARG:1 / 100, MAXBASE:배설욕 - 1)
	ENDIF
CASE "Ｖ역인서트"
	IF TALENT:동정
		CALL SETFLAG, "동정狩り플래그", PLAYER
		CALL SETFLAG, "동정喪失플래그", TARGET
	ENDIF
	CALL SETFLAG, "下半身を脱がす", PLAYER
	SIF PENIS(TARGET)
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET
	;대상のＰ⇔조교자のＶの汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 2, 3
CASE "Ａ역인서트"
	CALL SETFLAG, "下半身を脱がす", PLAYER
	SIF PENIS(TARGET)
		CALL SETFLAG, "바텀을노출：텍스트없음", TARGET
	;대상のＰ⇔조교자のＡの汚れが移動
	CALL EQ_STAIN, TARGET, PLAYER, 2, 4
ENDSELECT

;처녀でも삽입する커맨드など, 특수な分岐
SELECTCASE ARGS
CASE "자궁삽입"
	CALL SETFLAG, "자궁責め플래그", TARGET
	CALL SETFLAG, "자궁삽입플래그", TARGET
CASE "자궁구자극"
	CALL SETFLAG, "자궁責め플래그", TARGET
	IF TALENT:처녀
		CALL SETFLAG, "처녀상실플래그", TARGET
		CALL SETFLAG, "처녀탈취플래그", PLAYER
	ENDIF
CASE "Ｖ인서트", "바이브", "Ｖ피스트", "Ｖ용간"
	IF TALENT:처녀
		CALL SETFLAG, "처녀상실플래그", TARGET
		CALL SETFLAG, "처녀탈취플래그", PLAYER
	ENDIF
CASE "Ｖ역인서트"
	IF TALENT:PLAYER:처녀
		CALL SETFLAG, "처녀상실플래그", PLAYER
		CALL SETFLAG, "처녀탈취플래그", TARGET
	ENDIF
CASE "Ａ인서트", "Ａ용간"
	IF TALENT:Ａ처녀
		CALL SETFLAG, "Ａ처녀상실플래그", TARGET
		CALL SETFLAG, "Ａ처녀탈취플래그", PLAYER
	ENDIF
	IF COND("마음에 드는 체위中")
		TFLAG:30 += (3 + RAND:3) * ARG:1 / 100
		TFLAG:33 += (3 + RAND:3) * ARG:1 / 100
	ENDIF
CASE "Ａ역인서트"
	IF TALENT:PLAYER:Ａ처녀
		CALL SETFLAG, "Ａ처녀상실플래그", PLAYER
		CALL SETFLAG, "Ａ처녀탈취플래그", TARGET
	ENDIF
ENDSELECT

@SOURCE_INSERTION, ARGS, ARG, ARG:1
#DIM SIZE_DEF
#DIM PALAM_RES
#DIM EXP_REQ
#DIM DAMAGE

;Ｖ인서트等の激しさのSOURCE. @SOURCE_COM60等で呼ばれる
;ARG:1は主に인서트플레이の激しさで, 아픔と快楽が両方増える（바이브や피스트などは通常100のまま）
VARSET LOCAL
VARSET LOCALS

;LOCALSは삽입するもの
SELECTCASE ARGS
;자궁삽입の일탈のソースは下で決定
CASE "자궁삽입"
	LOCALS = 페니스
	LOCAL:20 += 300
	LOCAL:21 += 200
	LOCAL:8 = COM_ORDER_STAIN("Ｐ", "Ｖ")*500 + 100
	LOCAL:1 = CALCF("Ｖ刺激", 2)
	SIF STATE("우르즈군", PLAYER)
		LOCAL:1 = MULTIPLY(LOCAL:1, 100 + STATE("우르즈군", PLAYER)*10)
	;조교자の허리놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 33, PLAYER)
	;자궁성감がないと気持ちよくない
	IF TALENT:자궁성감
		TIMES LOCAL:1, 1.25
	ELSE
		TIMES LOCAL:1, 0.25
		LOCAL:9 = 1000
	ENDIF
CASE "자궁구자극"
	LOCALS = 페니스
	LOCAL:20 += 50
	LOCAL:21 += 100
	LOCAL:8 = COM_ORDER_STAIN("Ｐ", "Ｖ")*300 + 100
	LOCAL:1 = CALCF("Ｖ刺激", 2)
	SIF STATE("우르즈군", PLAYER)
		LOCAL:1 = MULTIPLY(LOCAL:1, 100 + STATE("우르즈군", PLAYER)*10)
	;조교자の허리놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 33, PLAYER)
	;자궁성감がないと気持ちよくない
	IF TALENT:자궁성감
		TIMES LOCAL:1, 1.25
	ELSE
		TIMES LOCAL:1, 0.25
		LOCAL:9 = 500
	ENDIF
CASE "Ｖ인서트"
	LOCALS = 페니스
	LOCAL:20 += 50
	LOCAL:21 += 100
	LOCAL:8 = COM_ORDER_STAIN("Ｐ", "Ｖ")*100 + 100
	LOCAL:1 = CALCF("Ｖ刺激", 2)
	SIF STATE("우르즈군", PLAYER)
		LOCAL:1 = MULTIPLY(LOCAL:1, 100 + STATE("우르즈군", PLAYER)*10)
	;조교자の허리놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 33, PLAYER)
CASE "쌍두바이브플레이"
	LOCALS = 바이브
	LOCAL:20 += 100
	LOCAL:21 += 100
	LOCAL:14 = 1000
	LOCAL:1 = CALCF("Ｖ刺激", 2)
	;조교자の허리놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 33, PLAYER)
CASE "손가락넣기"
	LOCALS = 바이브
	LOCAL:20 += 30
	LOCAL:21 += 80
	LOCAL:8 = COM_ORDER_STAIN("손", "Ｖ")*100 + 100
	LOCAL:12 = 300
	LOCAL:13 = 200 + ABL:Ｖ감각*200
	LOCAL:1 = CALCF("Ｖ刺激", 1)
	;Gスポット
	IF CHECK_COM("Ｇ스팟자극")
		LOCAL:20 += 20
		LOCAL:21 += 50
		SIF ABL:Ｖ감각 >= 3
			LOCAL:1 += 500
		LOCAL:14 += 500
		LOCAL:15 += 50
	ENDIF
	;조교자の손가락놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 31, PLAYER)
CASE "바이브"
	LOCALS = 바이브
	;抜いた時
	IF TEQUIP:바이브 == 0
		LOCAL:20 += 10
		LOCAL:21 += 30
	ELSE
		LOCAL:20 += 30
		LOCAL:21 += 100
	ENDIF
	LOCAL:14 = 500
	LOCAL:1 = CALCF("Ｖ刺激", 2)
	;조교자の손가락놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 31, PLAYER)
CASE "Ｖ피스트"
	LOCALS = 피스트
	LOCAL:20 += 400
	LOCAL:21 += 200
	LOCAL:8 = COM_ORDER_STAIN("손", "Ｖ")*150 + 100
	LOCAL:12 = 1200
	LOCAL:13 = 2000
	LOCAL:14 = 10000
	LOCAL:1 = CALCF("Ｖ刺激", 3)
	;조교자の손가락놀림をみる
	LOCAL:1 = SOURCE_EXABL(LOCAL:1, 31, PLAYER)
CASE "Ｖ용간"
	LOCALS = 드래곤
	LOCAL:20 += 500
	LOCAL:21 += 200
	LOCAL:8 = 2000
	LOCAL:12 = 1200
	LOCAL:13 = 5000
	LOCAL:14 = 30000
	LOCAL:1 = CALCF("Ｖ刺激", 3)
CASE "Ａ인서트"
	LOCALS = 페니스
	LOCAL:20 += 100
	LOCAL:21 += 150
	LOCAL:8 = COM_ORDER_STAIN("Ｐ", "Ａ")*100 + 800
	LOCAL:13 = 3000
	LOCAL:14 = 6000
	LOCAL:2 = CALCF("Ａ刺激", 2)
	SIF STATE("우르즈군", PLAYER)
		LOCAL:2 = MULTIPLY(LOCAL:2, 100 + STATE("우르즈군", PLAYER)*10)
	;조교자の허리놀림をみる
	LOCAL:2 = SOURCE_EXABL(LOCAL:2, 33, PLAYER)
CASE "Ａ손가락넣기"
	LOCALS = Ａ바이브
	LOCAL:20 += 20
	LOCAL:21 += 100
	LOCAL:8 = COM_ORDER_STAIN("손", "Ａ")*100 + 100
	LOCAL:12 = 500
	LOCAL:13 = 500
	LOCAL:14 = 1000
	LOCAL:2 = CALCF("Ａ刺激", 1)
	;조교자の손가락놀림をみる
	LOCAL:2 = SOURCE_EXABL(LOCAL:2, 31, PLAYER)
CASE "Ａ바이브"
	LOCALS = Ａ바이브
	IF TEQUIP:애널바이브 == 0
		LOCAL:20 += 10
		LOCAL:21 += 30
	ELSE
		LOCAL:20 += 60
		LOCAL:21 += 150
	ENDIF
	LOCAL:2 = CALCF("Ａ刺激", 2)
	;조교자の손가락놀림をみる
	LOCAL:2 = SOURCE_EXABL(LOCAL:2, 31, PLAYER)
	LOCAL:8 = 1000
	LOCAL:9 = 100
	LOCAL:13 = 1500
	LOCAL:14 = 3000
CASE "Ａ피스트"
	LOCALS = 피스트
	LOCAL:20 += 400
	LOCAL:21 += 200
	LOCAL:8 = COM_ORDER_STAIN("손", "Ａ")*150 + 800
	LOCAL:12 = 1200
	LOCAL:13 = 2000
	LOCAL:14 = 20000
	LOCAL:2 = CALCF("Ａ刺激", 3)
	;조교자の손가락놀림をみる
	LOCAL:2 = SOURCE_EXABL(LOCAL:2, 31, PLAYER)
CASE "Ａ용간"
	LOCALS = 드래곤
	LOCAL:20 += 500
	LOCAL:21 += 200
	LOCAL:8 = 3000
	LOCAL:12 = 1200
	LOCAL:13 = 5000
	LOCAL:14 = 30000
	LOCAL:2 = CALCF("Ａ刺激", 3)
ENDSELECT

;SIZE_DEFは삽입しているもののSIZEから확장度を引いた値で저항を表している. トントンなら０で大きいほど痛い
SELECTCASE ARGS
CASE "자궁삽입"
	SIZE_DEF = 1 + TALENT:작은몸집 - TALENT:음호
	SELECTCASE GET_EXP_LV(EXP:자궁간경험) + TALENT:자궁성감
	CASE 2
		SIZE_DEF -= 1
	CASE IS >= 3
		SIZE_DEF -= 2
	ENDSELECT
	SIF TALENT:임신 || MARK:정액각인 >= 4
		SIZE_DEF -= 1
	SIF SIZE(LOCALS) >= 3
		SIZE_DEF += SIZE(LOCALS)/2
	SIZE_DEF = MAX(SIZE_DEF, -1)
CASE "Ｖ인서트", "자궁구자극"
	IF INSERT("Ｖ두개삽입") || CHECK_COM("Ｖ두개삽입")
		SIZE_DEF = SIZE("Ｗ페니스") - ABL:Ｖ확장
	ELSEIF INSERT("양구멍삽입") || CHECK_COM("양구멍삽입")
		SIZE_DEF = SIZE(LOCALS) - ABL:Ｖ확장 + 1
	ELSE
		SIZE_DEF = SIZE(LOCALS) - ABL:Ｖ확장
	ENDIF
	SIF ABL:Ｖ놀림/2 > SIZE(LOCALS) && SIZE_DEF >= 0
		SIZE_DEF -= 1
CASE "손가락넣기", "바이브", "Ｖ피스트", "Ｖ용간", "쌍두바이브플레이"
	SIZE_DEF = SIZE(LOCALS) - ABL:Ｖ확장
	SIF ABL:Ｖ놀림/2 > SIZE(LOCALS) && SIZE_DEF >= 0
		SIZE_DEF -= 1
CASE "Ａ인서트"
	IF INSERT("Ａ두개삽입") || CHECK_COM("Ａ두개삽입")
		SIZE_DEF = SIZE("Ｗ페니스") - ABL:Ａ확장
	ELSEIF INSERT("양구멍삽입") || CHECK_COM("양구멍삽입")
		SIZE_DEF = SIZE(LOCALS) - ABL:Ａ확장 + 1
	ELSE
		SIZE_DEF = SIZE(LOCALS) - ABL:Ａ확장
	ENDIF
	;애널は저항がある
	SIF (TALENT:Ａ민감 == 0 || ABL:Ａ감각 == 0) && EXP:Ａ경험 < EXP_LV(SIZE(LOCALS) + 1)
		SIZE_DEF += 1
	SIF ABL:Ａ놀림 > SIZE(LOCALS) && SIZE_DEF >= 0
		SIZE_DEF -= 1
CASE "Ａ손가락넣기", "Ａ바이브", "Ａ피스트", "Ａ용간"
	SIZE_DEF = SIZE(LOCALS) - ABL:Ａ확장
	;애널は저항がある
	SIF (TALENT:Ａ민감 == 0 || ABL:Ａ감각 == 0) && EXP:Ａ경험 < EXP_LV(SIZE(LOCALS) + 1)
		SIZE_DEF += 1
	SIF ABL:Ａ놀림/2 > SIZE(LOCALS) && SIZE_DEF >= 0
		SIZE_DEF -= 1
ENDSELECT

SIF TALENT:확장적정 && SIZE_DEF >= 0
	SIZE_DEF -= 1

;余裕あり
IF SIZE_DEF < 0
	;ジャスト
	IF SIZE_DEF == -1
		TIMES LOCAL:1, 1.20
		TIMES LOCAL:2, 1.20
	;緩い
	ELSE
		LOCAL:1 = MULTIPLY(LOCAL:1, MAX(120 + SIZE_DEF*20, 50) )
		LOCAL:2 = MULTIPLY(LOCAL:2, MAX(120 + SIZE_DEF*20, 50) )
	ENDIF
	;余裕がある場合に限り, 大きく硬い方が悦ばれることにする
	LOCAL:1 = MULTIPLY(LOCAL:1, HARD(LOCALS)*10 + 80)
	LOCAL:1 = MULTIPLY(LOCAL:1, SIZE(LOCALS)*10 + 90)
	;질に大きなものを삽입する場合には자궁성감の有無で少々보너스あり
	SIF TALENT:자궁성감 && SIZE(LOCALS) + TALENT:요정 >= 2
		TIMES LOCAL:1, 1.20

	LOCAL:2 = MULTIPLY(LOCAL:2, HARD(LOCALS)*10 + 80)
	LOCAL:2 = MULTIPLY(LOCAL:2, SIZE(LOCALS)*10 + 90)

	;大きいものを納められると달성감
	SIF SIZE(LOCALS) >= 2
		LOCAL:5 += SIZE(LOCALS) * SIZE(LOCALS) * 500
;余裕無し
ELSE
	LOCAL:1 /= MAX(SIZE_DEF*2, 1)
	LOCAL:2 /= MAX(SIZE_DEF*2, 1)
ENDIF

;PALAMLVの値は, 順に1:100,2:500,3:3000,4:1万,5:3万,6:6万,7:10万,8:15万,9:25万
;HARDの基本値は페니스なら１, 바이브や拳なら３
LOCAL:6 += PALAM_LV(SIZE_DEF + (HARD(LOCALS) + 1)/2 )
LOCAL:9 += PALAM_LV(SIZE_DEF + (HARD(LOCALS) + 1)/2 )
LOCAL:14 += PALAM_LV(SIZE_DEF)

;前か後ろかで分岐
SELECTCASE ARGS
CASE "자궁삽입"
	;정액각인持ちは중독충족のソースも得る
	SIF MARK:정액각인
		LOCAL:7 += MARK:정액각인 * 300

	IF TALENT:연모
	ELSEIF TALENT:정조관념
		LOCAL:15 += 5000
	ELSEIF TALENT:정조관결여
		LOCAL:15 += 1000
	ENDIF
	SELECTCASE GET_EXP_LV(EXP:자궁간경험) + TALENT:자궁성감
	CASE 0
		TIMES LOCAL:1, 0.20
		LOCAL:6 += 1000
		LOCAL:9 += 3000
		LOCAL:14 += 30000
	CASE 1
		TIMES LOCAL:1, 0.40
		LOCAL:6 += 500
		LOCAL:9 += 1000
		LOCAL:14 += 6000
	CASE 2
		TIMES LOCAL:1, 0.70
		LOCAL:6 += 100
		LOCAL:9 += 500
		LOCAL:14 += 2000
	ENDSELECT
	IF TALENT:음호 || TALENT:슬라임 || MARK:정액각인 >= 4
		LOCAL:6 /= 3
		LOCAL:9 /= 3
		LOCAL:14 /= 3
		LOCAL:15 /= 3
	ELSEIF MARK:정액각인
		LOCAL:6 = MULTIPLY(LOCAL:6, 100 - MARK:정액각인*15)
		LOCAL:9 = MULTIPLY(LOCAL:9, 100 - MARK:정액각인*15)
		LOCAL:14 = MULTIPLY(LOCAL:14, 100 - MARK:정액각인*15)
		LOCAL:15 = MULTIPLY(LOCAL:15, 100 - MARK:정액각인*15)
	ENDIF

	;PALAM_RESは入れてるものの大きさを加味した윤활具合
	PALAM_RES = GET_PALAMLV(PALAM:Ｖ윤 + PALAM:PLAYER:Ｐ윤) - MAX(SIZE_DEF, 0) - 1

	;経験は발りている？（HARDによって상한あり）
	EXP_REQ = MIN(GET_EXP_LV(EXP:자궁경험) - SIZE(LOCALS) - 1 - MAX(SIZE_DEF, 0), 5 - HARD(LOCALS) )

	;손상あり？
	DAMAGE = TALENT:Ｖ손상
CASE "Ｖ인서트", "자궁구자극", "손가락넣기", "바이브", "Ｖ피스트", "Ｖ용간", "쌍두바이브플레이"
	;정액각인持ちは중독충족のソースも得る
	SIF MARK:정액각인
		LOCAL:7 += MARK:정액각인 * 300

	SIF TALENT:처녀
		LOCAL:6 += 1000
	IF TALENT:연모
	ELSEIF TALENT:정조관념
		IF TALENT:처녀 == 1
			LOCAL:15 += 10000
		ELSE
			LOCAL:15 += 1000
		ENDIF
	ELSEIF TALENT:정조관결여
		SIF TALENT:처녀 == 1
			LOCAL:15 += 300
	ELSEIF TALENT:처녀 == 1
		LOCAL:15 += 3000
	ENDIF

	IF TALENT:음호 || TALENT:슬라임 || MARK:정액각인 >= 4
		LOCAL:6 /= 3
		LOCAL:9 /= 3
		LOCAL:14 /= 3
		LOCAL:15 /= 3
	ELSEIF MARK:정액각인
		LOCAL:6 = MULTIPLY(LOCAL:6, 100 - MARK:정액각인*15)
		LOCAL:9 = MULTIPLY(LOCAL:9, 100 - MARK:정액각인*15)
		LOCAL:14 = MULTIPLY(LOCAL:14, 100 - MARK:정액각인*15)
		LOCAL:15 = MULTIPLY(LOCAL:15, 100 - MARK:정액각인*15)
	ENDIF
	;보지に근육이완제
	IF GETBIT(TEQUIP:근육이완제, 2)
		TIMES LOCAL:1, 0.70
		TIMES LOCAL:6, 0.50
	ENDIF

	;PALAM_RESは入れてるものの大きさを加味した윤활具合
	SELECTCASE ARGS
	CASE "Ｖ인서트"
		PALAM_RES = GET_PALAMLV(PALAM:Ｖ윤 + PALAM:PLAYER:Ｐ윤) - MAX(SIZE_DEF, 0)
	CASEELSE
		IF TEQUIP:촉수
			LOCAL:10 += 1000
			PALAM_RES = GET_PALAMLV(PALAM:Ｖ윤 + 1000) - MAX(SIZE_DEF, 0)
		ELSE
			;ここでの최대は３
			PALAM_RES = MIN(GET_PALAMLV(PALAM:Ｖ윤) - MAX(SIZE_DEF, 0), 3)
		ENDIF
	ENDSELECT

	;経験は발りている？（HARDによって상한あり）
	EXP_REQ = MIN(GET_EXP_LV(EXP:Ｖ경험) - SIZE(LOCALS) - 1 - MAX(SIZE_DEF, 0), 5 - HARD(LOCALS) )

	;常時삽입による아픔の軽減
	IF TALENT:상시바이브 >= 4
		SIF ABL:Ｖ확장 >= MAX(SIZE(LOCALS), 1)
			TIMES LOCAL:6, 0.10
	ELSE
		SIF TALENT:상시바이브 >= MAX(SIZE(LOCALS), 1)
			TIMES LOCAL:6, 0.10
	ENDIF

	;손상あり？
	DAMAGE = TALENT:Ｖ손상
CASE "Ａ인서트", "Ａ손가락넣기", "Ａ바이브", "Ａ피스트", "Ａ용간"
	;처녀で정조관념or엉덩이許可플래그
	SIF (TALENT:처녀 == 1 && TALENT:정조관념) || CFLAG:100
		LOCAL:14 /= 3

	IF TALENT:애널광 || TALENT:슬라임
		LOCAL:6 /= 3
		LOCAL:9 /= 3
		LOCAL:14 /= 3
		LOCAL:15 /= 3
	ENDIF
	;애널に근육이완제
	IF GETBIT(TEQUIP:근육이완제, 0)
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:6, 0.50
	ENDIF

	;PALAM_RESは入れてるものの大きさを加味した윤활具合
	SELECTCASE ARGS
	CASE "Ａ인서트"
		PALAM_RES = GET_PALAMLV(PALAM:Ａ윤 + PALAM:PLAYER:Ｐ윤) - MAX(SIZE_DEF, 0)
	CASEELSE
		IF TEQUIP:촉수
			LOCAL:19 += 1000
			PALAM_RES = GET_PALAMLV(PALAM:Ａ윤 + 1000) - MAX(SIZE_DEF, 0)
		ELSE
			;ここでの최대は３
			PALAM_RES = MIN(GET_PALAMLV(PALAM:Ａ윤) - MAX(SIZE_DEF, 0), 3)
		ENDIF
	ENDSELECT

	;経験は발りている？（HARDによって상한あり）
	EXP_REQ = MIN(GET_EXP_LV(EXP:Ａ경험) - SIZE(LOCALS) - 1 - MAX(SIZE_DEF, 0), 5 - HARD(LOCALS) )

	;常時삽입による아픔の軽減
	IF TALENT:상시Ａ플러그 >= 4
		SIF ABL:Ａ확장 >= MAX(SIZE(LOCALS), 1)
			TIMES LOCAL:6, 0.10
	ELSE
		SIF TALENT:상시Ａ플러그 >= MAX(SIZE(LOCALS), 1)
			TIMES LOCAL:6, 0.10
	ENDIF

	;손상あり？
	DAMAGE = TALENT:Ａ손상
ENDSELECT

;PRINTFORMW SIZE_DEF = {SIZE_DEF}, PALAM_RES = {PALAM_RES}, EXP_REQ = {EXP_REQ}, LOCAL:6 = {LOCAL:6}

;인서트かどうか等で分岐
SELECTCASE ARGS
CASE "자궁삽입"
	IF CALCF("페니스好き度", TARGET) > 0 && PENIS(PLAYER) && 1 + TALENT:상위몽마 >= SIZE(LOCALS)
		LOCAL:13 += LOCAL:9 * CALCF("페니스好き度", TARGET)
		LOCAL:6 /= CALCF("페니스好き度", TARGET) + 1
		LOCAL:9 /= CALCF("페니스好き度", TARGET) + 1
	ENDIF
	IF COND("마음에 드는 체위中")
		TIMES LOCAL:1, 1.20
		TIMES LOCAL:2, 1.20
		TIMES LOCAL:6, 0.80
		TIMES LOCAL:9, 0.80
		TIMES LOCAL:14, 0.80
	ENDIF
CASE "Ｖ인서트", "자궁구자극", "Ｖ용간"
	IF CALCF("페니스好き度", TARGET) > 0 && PENIS(PLAYER) && ABL:Ｖ확장 + TALENT:상위몽마 >= SIZE(LOCALS)
		LOCAL:13 += LOCAL:9 * CALCF("페니스好き度", TARGET)
		LOCAL:6 /= CALCF("페니스好き度", TARGET) + 1
		LOCAL:9 /= CALCF("페니스好き度", TARGET) + 1
	ENDIF
	IF COND("마음에 드는 체위中")
		TIMES LOCAL:1, 1.20
		TIMES LOCAL:2, 1.20
		TIMES LOCAL:6, 0.80
		TIMES LOCAL:9, 0.80
		TIMES LOCAL:14, 0.80
	ENDIF
CASE "Ａ인서트", "Ａ용간"
	IF CALCF("페니스好き度", TARGET) > 0 && PENIS(PLAYER) && ABL:Ａ확장 + TALENT:상위몽마 >= SIZE(LOCALS)
		LOCAL:13 += LOCAL:9 * CALCF("페니스好き度", TARGET)
		LOCAL:6 /= CALCF("페니스好き度", TARGET) + 1
		LOCAL:9 /= CALCF("페니스好き度", TARGET) + 1
	ENDIF
	IF COND("마음에 드는 체위中")
		TIMES LOCAL:1, 1.20
		TIMES LOCAL:2, 1.20
		TIMES LOCAL:6, 0.80
		TIMES LOCAL:9, 0.80
		TIMES LOCAL:14, 0.80
	ENDIF

CASE "쌍두바이브플레이"
	;締まり対決. 値が大きいほどTARGET有利（受ける快楽等が少なく, 与える快楽が大きい）
	;全部の値に作用するのでARG:1を増減させる
	SELECTCASE ABL:Ｖ놀림 - ABL:Ｖ확장 - (ABL:PLAYER:Ｖ놀림 - ABL:PLAYER:Ｖ확장)
	CASE IS >= 3
		TIMES ARG:1, 0.30
	CASE 2
		TIMES ARG:1, 0.50
	CASE 1
		TIMES ARG:1, 0.80
	CASE -1
		TIMES ARG:1, 1.20
	CASE -2
		TIMES ARG:1, 1.50
	CASE IS <= -3
		TIMES ARG:1, 2.00
	ENDSELECT
CASE "바이브"
	IF TEQUIP:바이브 == 0
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.50
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:14, 0.50
		TIMES LOCAL:15, 0.50
	ENDIF
CASE "Ａ바이브"
	IF TEQUIP:애널바이브 == 0
		TIMES LOCAL:2, 0.50
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:14, 0.50
		TIMES LOCAL:15, 0.50
		TIMES LOCAL:13, 0.50
		TIMES LOCAL:9, 0.50
	ENDIF
CASE "손가락넣기", "Ａ손가락넣기"
	SELECTCASE ABL:PLAYER:손가락놀림
	CASE 1
		TIMES LOCAL:6, 0.80
	CASE 2
		TIMES LOCAL:6, 0.50
	CASE IS >= 3
		LOCAL:6 = MIN(LOCAL:6/5, 500)
	ENDSELECT
ENDSELECT

IF TEQUIP:넘어뜨리기 == 0
	SELECTCASE TALENT_NAME(185, TALENT:PLAYER:조교지식, PLAYER)
	CASE "조교지식(성기확장)"
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:9, 0.50
	ENDSELECT
ENDIF

;삽입するものの大きさが該当箇所の확장ＬＶ+１이하の場合
IF SIZE_DEF <= 1 && TALENT:호색 + TALENT:음란 + TALENT:확장적정
	TIMES LOCAL:6, 0.50
	TIMES LOCAL:9, 0.50
	TIMES LOCAL:13, 0.50

	;今までの절정具合による脱力などで아픔軽減措置（とりあえずは暫定）
	SELECTCASE EX:절정수합계 + TEQUIP:미약/25
	CASE IS >= MAX(20, MAXBASE:성욕*2)
		TIMES LOCAL:6, 0.20
	CASE IS >= MAX(10, MAXBASE:성욕)
		TIMES LOCAL:6, 0.50
	CASE IS >= MAX(5, MAXBASE:성욕/2)
		TIMES LOCAL:6, 0.80
	ENDSELECT
ENDIF

IF TALENT:음란
	TIMES LOCAL:14, 0.20
ELSEIF TALENT:호색
	TIMES LOCAL:14, 0.50
ENDIF


;潤滑増加の処理。その後に、場所ごとに鈍感と敏感の보정とJUST FIT
SELECTCASE ARGS
;질を使っている플레이は아픔に比例して愛液増加
CASE "자궁삽입", "Ｖ인서트", "자궁구責め"
	LOCAL:10 += 100*MIN(PALAM_LV(LOCAL:6), 5)
	IF TALENT:Ｖ둔감
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:11, 0.50
		TIMES LOCAL:13, 0.50
		TIMES LOCAL:14, 0.50
	ELSEIF TALENT:Ｖ민감
		TIMES LOCAL:6, 1.50
		TIMES LOCAL:11, 1.50
		TIMES LOCAL:13, 1.50
		TIMES LOCAL:14, 1.50
	ENDIF
	;JUST FITは全部の値に作用するのでARG:1を増減させる
	SELECTCASE CHECK("ＶJUST FIT")
	CASE IS >= 100
		TIMES ARG:1, 3.00
	CASE IS >= 90
		TIMES ARG:1, 2.50
	CASE IS >= 80
		TIMES ARG:1, 2.25
	CASE IS >= 70
		TIMES ARG:1, 2.00
	CASE IS >= 60
		TIMES ARG:1, 1.75
	CASE IS >= 50
		TIMES ARG:1, 1.50
	ENDSELECT
CASE "손가락넣기", "바이브", "Ｖ피스트", "Ｖ용간", "쌍두바이브플레이"
	LOCAL:10 += 100*MIN(PALAM_LV(LOCAL:6), 5)
	IF TALENT:Ｖ둔감
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:11, 0.50
		TIMES LOCAL:13, 0.50
		TIMES LOCAL:14, 0.50
	ELSEIF TALENT:Ｖ민감
		TIMES LOCAL:6, 1.50
		TIMES LOCAL:11, 1.50
		TIMES LOCAL:13, 1.50
		TIMES LOCAL:14, 1.50
	ENDIF
;애널플레이なら아픔や異物の大きさなどによって장液分泌
CASE "Ａ인서트"
	LOCAL:19 += MAX((GET_PALAMLV(LOCAL:6) + SIZE(LOCALS))*100, 100)
	IF TALENT:Ａ둔감
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:11, 0.50
		TIMES LOCAL:13, 0.50
		TIMES LOCAL:14, 0.50
	ELSEIF TALENT:Ａ민감
		TIMES LOCAL:6, 1.50
		TIMES LOCAL:11, 1.50
		TIMES LOCAL:13, 1.50
		TIMES LOCAL:14, 1.50
	ENDIF
	;JUST FITは全部の値に作用するのでARG:1を増減させる
	SELECTCASE CHECK("ＡJUST FIT")
	CASE IS >= 100
		TIMES ARG:1, 3.00
	CASE IS >= 90
		TIMES ARG:1, 2.50
	CASE IS >= 80
		TIMES ARG:1, 2.25
	CASE IS >= 70
		TIMES ARG:1, 2.00
	CASE IS >= 60
		TIMES ARG:1, 1.75
	CASE IS >= 50
		TIMES ARG:1, 1.50
	ENDSELECT
CASE "Ａ손가락넣기", "Ａ바이브", "Ａ피스트", "Ａ용간"
	LOCAL:19 += MAX((GET_PALAMLV(LOCAL:6) + SIZE(LOCALS))*100, 100)
	IF TALENT:Ａ둔감
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:11, 0.50
		TIMES LOCAL:13, 0.50
		TIMES LOCAL:14, 0.50
	ELSEIF TALENT:Ａ민감
		TIMES LOCAL:6, 1.50
		TIMES LOCAL:11, 1.50
		TIMES LOCAL:13, 1.50
		TIMES LOCAL:14, 1.50
	ENDIF
ENDSELECT

;経験は발りている？
SELECTCASE EXP_REQ
CASE IS >= 3
	TIMES LOCAL:6, 0.05
	TIMES LOCAL:9, 0.05
	TIMES LOCAL:14, 0.05
CASE 2
	TIMES LOCAL:6, 0.30
	TIMES LOCAL:9, 0.30
	TIMES LOCAL:14, 0.30
CASE 1
	TIMES LOCAL:6, 0.70
	TIMES LOCAL:9, 0.70
	TIMES LOCAL:14, 0.70
CASE 0
	TIMES LOCAL:9, 0.70
CASE -1
	TIMES LOCAL:6, 1.50
	TIMES LOCAL:14, 1.20
CASE -2
	TIMES LOCAL:6, 2.00
	TIMES LOCAL:9, 1.50
	TIMES LOCAL:14, 2.00
CASEELSE
	TIMES LOCAL:6, 3.00
	TIMES LOCAL:9, 3.00
	TIMES LOCAL:14, 3.00
ENDSELECT

;PALAM:Ｖ윤orＡ윤をみる
;삽입されているもののサイズとか확장度は既に加味されている
;だいたい, 삽입されているもののSIZEと확장度が等しいときに対応した윤활のLVが２あれば問題ない
SELECTCASE PALAM_RES
CASE IS >= 4
	TIMES LOCAL:6, 0.20
CASE 3
	TIMES LOCAL:6, 0.50
CASE 2
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:6, 0.80
CASE 1
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 0.40
	LOCAL:6 += 100
CASEELSE
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.10
	LOCAL:6 += 500
ENDSELECT

;손상あり？
IF DAMAGE
	TIMES LOCAL:6, 2.00
	TIMES LOCAL:9, 2.00
	TIMES LOCAL:14, 2.00
	LOCAL:6 += PALAM_LV(SIZE(LOCALS) + 2)
	LOCAL:9 += PALAM_LV(SIZE(LOCALS) + 2)
	LOCAL:14 += PALAM_LV(SIZE(LOCALS) + 1)
ENDIF

;巨根は굴복と순종추가のソースにボーナス
IF PLAYER == MASTER && LOCALS == "페니스" && SIZE(LOCALS) >= 2
	LOCAL:13 += 1000 * SIZE(LOCALS)
	LOCAL:16 += 500 * SIZE(LOCALS)
ENDIF

ARG = ARG * ARG:1 / 100

CALL CALC, "조교소스", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@TRAIN_MESSAGE_COM60
IF CHECK_COM("Ｖ두개삽입")
	IF INSERT("Ｖ두개삽입")
		PRINTFORMW %CALLNAME:TARGET%의 질구를 동시에 범하고잇다…
	ELSE
		IF INSERT("배면좌위")
			PRINTFORM 결합부가 훤히 보이는 자세로 %CALLNAME:(PLAYER:1)%에게 범해지고 있는%CALLNAME:TARGET%의 가랑이를 밀어 열어, 
		ELSEIF INSERT("기승위")
			PRINTFORM %CALLNAME:(PLAYER:1)%에게 올라타 허리를 흔들고있는 %조사처리(CALLNAME:TARGET,"를")% 앞으로 몸을 기울이게 해, 
		ELSE
			PRINTFORM %CALLNAME:(PLAYER:1)%에게 배면좌위 자세를 취하게하고, 범해지고있는 %CALLNAME:TARGET%의 가랑이를 밀어 열어, 
		ENDIF
		PRINTFORMW 여유있어 보이는 질구에 %조사처리(NAMES("페니스", PLAYER),"를")% 비틀어 넣었다…
	ENDIF
ELSEIF CHECK_COM("양구멍삽입")
	IF INSERT("양구멍삽입")
		PRINTFORM %CALLNAME:PLAYER%과 %조사처리(CALLNAME:(PLAYER:1),"는")% 
		IF RAND:4 == 0
			PRINTFORM 육벽을 문질러올리면서 
		ELSEIF RAND:3 == 0
			PRINTFORM \@ RAND:2 ? 격렬한 # 느긋한  \@ 허리움직임으로 
		ELSEIF RAND:2
			PRINTFORM 긴 스트로크로 
		ELSE
			PRINTFORM 타이밍을 %TEXTR("맞춰서", "다르게")%
		ENDIF
		PRINTFORM %CALLNAME:TARGET%의 %TEXTR("양쪽", "앞뒤")%의 구멍을
		IF RAND:3 == 0
			PRINTW 범했다…
		ELSEIF RAND:2
			PRINTW 휘저었다…
		ELSE
			PRINTW 찔러올렸다…
		ENDIF
	ELSEIF SELECTCOM >= 60 && SELECTCOM <= 69
		PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% %CALLNAME:(PLAYER:1)%
		IF INSERT("배면좌위")
			PRINTFORM 에게 기대어있는 자세로 범해지고 있던 %CALLNAME:TARGET%의 다리사이에 몸을 끼워넣고, 질구에 %조사처리(NAMES("페니스", PLAYER),"를")% 
		ELSEIF INSERT("기승위")
			PRINTFORM 의 위에 올라타 허리를 흘들고 있는 %조사처리(CALLNAME:TARGET,"를")% 밀어넘어뜨리고, 무방비한 그곳에 %조사처리(NAMES("페니스", PLAYER),"를")% 
		ELSE
			PRINTFORM 에게 체위를 바꾸게하고, 이미 뒷구멍으로 물건을 물고 있는 %CALLNAME:TARGET%의 그곳에 %조사처리(NAMES("페니스", PLAYER),"를")% 
		ENDIF
		IF RAND:2 && ABL:Ｖ확장 > SIZE("페니스", PLAYER)
			PRINT 뿌리끝까지 
		ELSE
			PRINT 깊숙히 
		ENDIF
		PRINTW 삽입했다…
	ELSEIF SELECTCOM >= 70 && SELECTCOM <= 79
		PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% %CALLNAME:(PLAYER:1)%
		IF INSERT("대면좌위")
			PRINTFORM 에게 안겨있는 체위로 범해지고 있는 %CALLNAME:TARGET%의 애널에 %조사처리(NAMES("페니스", PLAYER),"를")% 눌러붙이고, 
		ELSEIF INSERT("기승위")
			PRINTFORM 의 위에 올라타 허리를 흔들고 있는 %조사처리(CALLNAME:TARGET,"를")% 몸을 앞으로 기울이게 해, 손으로 벌려진 애널에 %조사처리(NAMES("페니스", PLAYER),"를")% 
		ELSE
			PRINTFORM 에게 체위를 바꾸게 하고, 이미 앞구멍으로 물건을 물고있는 %CALLNAME:TARGET%의 애널에 %조사처리(NAMES("페니스", PLAYER),"를")% 
		ENDIF
		IF RAND:2 && ABL:Ａ확장 > SIZE("페니스", PLAYER)
			PRINT 뿌리끝까지 
		ELSE
			PRINT 깊숙히  
		ENDIF
		PRINTW 삽입했다…
	ENDIF
ELSEIF CHECK_COM("３Ｐ봉사")
	CALL TRAIN_MESSAGE_3P
;러브트랩
ELSEIF TEQUIP:러브트랩
	;前回と今回の조교자が同じで, 抜かない플래그がある場合
	IF INSERT("인서트") && COND("前Ｔ조교자") == PLAYER
		IF INSERT("정상위")
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 질 안에 있는 페니스의 감촉을 맛보면서, 다시 허리를 움직이기 시작했다…
		ELSE
			PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 위를 향해 드러누운 %조사처리(CALLNAME:PLAYER,"를")% 받아들이고, 다시 허리를 움직이기 시작했다…
		ENDIF
	ELSE
		PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 위를 향해 드러누운 %조사처리(CALLNAME:PLAYER,"를")% 받아들이고, 허리를 움직이기 시작했다…
	ENDIF
;それ以外
ELSE
	;前回と今回の조교자が同じで, 抜かない플래그がある場合
	IF INSERT("Ｖ인서트") && COND("前Ｔ조교자") == PLAYER
		IF INSERT("정상위") || INSERT("굴곡위")
			IF TEQUIP:키스
				PRINTFORMW %조사처리(CALLNAME:PLAYER,"는")%%CALLNAME:TARGET%%TEXTS("키스継続助詞付き")%, 다시 허리를 움직이기 시작했다…
				CALL SETFLAG, "추가키스플래그", TARGET
			ELSEIF PENIS(PLAYER)
				PRINTFORMW %CALLNAME:TARGET%의 질안의 감촉을 맛보면서, 다시 허리를 움직이기 시작했다…
			ELSE
				PRINTFORMW %CALLNAME:TARGET%의 질내에서 뽑지않고, 다시 허리를 움직이기 시작했다…
			ENDIF
		ELSEIF INSERT("후배위")
			PRINTFORMW 서로 연결된 채로 %조사처리(CALLNAME:TARGET,"를")% 위를 향해 드러눕게 해, 다시 허리를 움직이기 시작했다…
		ELSEIF INSERT("대면좌위")
			PRINTFORMW 서로 껴안은 채로 %조사처리(CALLNAME:TARGET,"를")% 밀어넘어뜨리듯이 눕히고, 다시 허리를 움직이기 시작했다…
		ELSEIF INSERT("배면좌위")
			PRINTFORMW 질내에서 뽑지않고 %조사처리(CALLNAME:TARGET,"를")% 위를 향하게 드러눕히고, 다시 허리를 움직이기 시작했다…
		ELSEIF INSERT("기승위")
			PRINTFORMW %조사처리(CALLNAME:TARGET,"과")% 몸을 바꿔 위를 향하게 밀어넘어뜨리고, 다시 허리를 움직이기 시작했다…
		ENDIF
	ELSEIF INSERT("Ａ인서트") && COND("前Ｔ조교자") == PLAYER
		IF INSERT("정상위") || INSERT("대면좌위")
			PRINTFORM %조사처리(NAMES("페니스", PLAYER),"를")% 애널에서 뽑아내고, 
			IF INSERT("대면좌위") && RAND:2
				PRINTFORM %조사처리(CALLNAME:TARGET,"를")% 꼭 껴안은 채, 이번엔 
			ELSE
				PRINTFORM 그 기세 그대로 %CALLNAME:TARGET%의 
			ENDIF
		ELSEIF INSERT("굴곡위")
			PRINTFORM 다리를 쪽 벌린 부끄러운 체위인 채로, 이번엔 %CALLNAME:TARGET%의 
		ELSE
			PRINTFORM %조사처리(CALLNAME:TARGET,"를")% 위로 드러눕게 해, 
			IF RAND:2
				PRINTFORM 애널을 범하고 있던 %조사처리(NAMES("페니스", PLAYER),"로")% 
			ELSE
				PRINTFORM 항문을 범하고있던 %조사처리(NAMES("페니스", PLAYER),"로")% 
			ENDIF
		ENDIF
		PRINTFORMW %조사처리(TEXTS("Ｖ삽입前"),"를")% 범하기 시작했다…
	ELSE
		;前回, 삽입前に폭발してしまった
		IF PREVCOM == 511 && COND("前Ｔ조교자") == PLAYER
			PRINTFORM 기분을 고쳤다%조사처리(CALLNAME:PLAYER,"는")% , 
		ELSE
			PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 
		ENDIF
		IF COND("前Ｔから대상のみ변경") && PREVCOM:1 >= 60 && PREVCOM:1 <= 79
			CALL TEXT, "추가地の文：穴から穴へ"
			PRINTFORM %CALLNAME:TARGET%의 %조사처리(TEXTS("Ｖ삽입前"),"를")% 
		;穴開きでない팬티をはいていて, ずらされていないなら, 必ずずらす
		ELSEIF !CHECK_CLO("Ｖ노출") && CHECK_CLO("Ｖ노출可")
			PRINTFORM %CALLNAME:TARGET%의 
			CALL SETFLAG, "바텀을노출：텍스트有り", TARGET
			PRINTFORM , %조사처리(TEXTS("Ｖ삽입前"),"를")% 
		ELSE
			PRINTFORM %CALLNAME:TARGET%의 %조사처리(TEXTS("Ｖ삽입前"),"를")% 
		ENDIF

		IF TEQUIP:키스
			PRINTFORM 입술을 빼앗으면서
			CALL SETFLAG, "추가키스플래그", TARGET
		ELSE
			SIF PREVCOM == 13
				PRINT 손가락으로 벌린 자세인 채
			SIF PALAM:Ｖ윤 < PALAMLV:4 && (PREVCOM == 91 || PREVCOM == 99 || PREVCOM == 140) && COND("前Ｔ조교자") == PLAYER && RAND:2 == 0
				PRINT 빨아 준비시킨 페니스로
		ENDIF
		IF CHOSECOM(SELECTCOM) == 0 && CHOSECOMS("삽입") && SIZE("페니스", PLAYER) >= 2 && (TALENT:작은몸집 || SIZE("페니스", PLAYER) >= 3)
			PRINTFORMW 깊숙히 관철해, 자궁을 위치가 바뀔 정도로 밀어 올렸다…
		ELSE
			PRINTFORMW 관철했다…
		ENDIF
	ENDIF
ENDIF


@INSERTION, ARG
#DIM MEMO_SELECTCOM

;強度（通常は20）
LOCAL = 20

SELECTCASE SELECTCOM
CASE 60 TO 89, 120 TO 129
	RETURN 0
;아무것도하지않는다
CASE 139
	LOCAL = 5
	;기승위の場合はあんまり変わらない
	IF INSERT("기승위")
		LOCAL = 20
	;PLAYERが기승위している側
	ELSEIF INSERT("기승위")
		LOCAL = 5
	;PLAYERが犯されている時
	ELSEIF INSERT("삽입中")
		LOCAL = 20
	ENDIF
ENDSELECT

;ARGに値が代入されてるならその強度
SIF ARG
	LOCAL = ARG

MEMO_SELECTCOM = SELECTCOM


IF INSERT("Ｖ인서트")
	IF INSERT("Ｖ인서트", TARGET, PLAYER)
		SELECTCOM = INSERT("Ｖ対応커맨드")
		CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
		CALLFORM FLAG_COM{SELECTCOM}, LOCAL
		CALL SAMEN_CHECK, LOCAL
	ENDIF
	IF INSERT("Ｖ인서트", TARGET, PLAYER:1)
		SWAP PLAYER, PLAYER:1
		SELECTCOM = INSERT("Ｖ対応커맨드")
		CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
		CALLFORM FLAG_COM{SELECTCOM}, LOCAL
		CALL SAMEN_CHECK, LOCAL
		SWAP PLAYER, PLAYER:1
	ENDIF
ENDIF
IF INSERT("Ａ인서트")
	IF INSERT("Ａ인서트", TARGET, PLAYER)
		SELECTCOM = INSERT("Ａ対応커맨드")
		CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
		CALLFORM FLAG_COM{SELECTCOM}, LOCAL
		CALL SAMEN_CHECK, LOCAL
	ENDIF
	IF INSERT("Ａ인서트", TARGET, PLAYER:1)
		SWAP PLAYER, PLAYER:1
		SELECTCOM = INSERT("Ａ対応커맨드")
		CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
		CALLFORM FLAG_COM{SELECTCOM}, LOCAL
		CALL SAMEN_CHECK, LOCAL
		SWAP PLAYER, PLAYER:1
	ENDIF
ENDIF
IF INSERT("요도인서트")
	IF INSERT("요도인서트", TARGET, PLAYER)
		SELECTCOM = INSERT("요도対応커맨드")
		CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
		CALLFORM FLAG_COM{SELECTCOM}, LOCAL
		CALL SAMEN_CHECK, LOCAL
	ENDIF
	IF INSERT("요도인서트", TARGET, PLAYER:1)
		SWAP PLAYER, PLAYER:1
		SELECTCOM = INSERT("요도対応커맨드")
		CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
		CALLFORM FLAG_COM{SELECTCOM}, LOCAL
		CALL SAMEN_CHECK, LOCAL
		SWAP PLAYER, PLAYER:1
	ENDIF
ENDIF
IF INSERT("Ｖ인서트", PLAYER, TARGET)
	SELECTCOM = INSERT("Ｖ対応커맨드", PLAYER)
	CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
	CALLFORM FLAG_COM{SELECTCOM}, LOCAL
	CALL SAMEN_CHECK, LOCAL
ENDIF
IF INSERT("Ａ인서트", PLAYER, TARGET)
	SELECTCOM = INSERT("Ａ対応커맨드", PLAYER)
	CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
	CALLFORM FLAG_COM{SELECTCOM}, LOCAL
	CALL SAMEN_CHECK, LOCAL
ENDIF
IF INSERT("요도인서트", PLAYER, TARGET)
	SELECTCOM = INSERT("요도対応커맨드", PLAYER)
	CALLFORM SOURCE_COM{SELECTCOM}, LOCAL
	CALLFORM FLAG_COM{SELECTCOM}, LOCAL
	CALL SAMEN_CHECK, LOCAL
ENDIF

SELECTCOM = MEMO_SELECTCOM

RETURN 1

@INSERTION_2
#DIM A_JUST
#DIM V_JUST

V_JUST = 0
A_JUST = 0

;３ＰなどがあるのでTARGETとPLAYERを省略せずに記入（A_JUSTとJ_JUSTは片方しか1이상にはならない）
SIF INSERT("Ｖ인서트", TARGET, PLAYER) && CHOSECOMS("Ｖ삽입") == 0
	V_JUST = CHECK("ＶJUST FIT")
SIF INSERT("Ａ인서트", TARGET, PLAYER) && CHOSECOMS("Ａ삽입") == 0
	A_JUST = CHECK("ＡJUST FIT")

IF V_JUST || A_JUST
	CALL PRINT_STR, "하트핑크_＜JUST FIT！＞_L"

	SELECTCASE MAX(V_JUST, A_JUST)
	CASE IS >= 90
		PRINT 완전하게
	CASE IS >= 75
		PRINT 거듭된다삽입그래서
	CASEELSE
		PRINT 완전히
	ENDSELECT
	PRINTFORM %CALLNAME:PLAYER%의페니스%TEXTR("の形にされて", "を覚えて", "専用になって")%큰일났다
	IF A_JUST
		PRINTFORM %CALLNAME:TARGET%의애널하지만
	ELSE
		PRINTFORM %CALLNAME:TARGET%의 질이
	ENDIF
	PRINTFORML %TEXTR("得も言われぬ快感を与えて", "隙間なく絡みついて", "動きに맞춰서吸い付いて")%온다！
	;CALL PRINT_STR, "하트핑크_H_お互いの快楽にボーナスが発生しています_하트핑크_H_L"
ENDIF

VARSET LOCALS
IF INSERT("인서트") || SELECTCOM == 80
	IF COND("마음에 드는 체위中")
		SETCOLOR DEF_COLOR("하트핑크")
		LOCALS = 마음에 드는 체위
	ENDIF

	SELECTCASE SELECTCOM
	CASE 60 TO 89
	CASEELSE
		SIF LOCALS != ""
			LOCALS = 마음에 드는 체위로 
		IF INSERT("양구멍삽입")
			LOCALS = %LOCALS% 양구멍 삽입中
			EXP:Ｖ경험 += 1
			LOCALS:1 = Ｖ경험＋１
			EXP:Ａ경험 += 1
			LOCALS:2 = Ａ경험＋１
		ELSEIF INSERT("Ｖ인서트")
			LOCALS = %LOCALS% 인서트중
			EXP:Ｖ경험 += 1
			LOCALS:1 = Ｖ경험＋１
		ELSEIF INSERT("Ａ인서트")
			LOCALS = %LOCALS% Ａ인서트중
			EXP:Ａ경험 += 1
			LOCALS:2 = Ａ경험＋１
		ELSEIF INSERT("요도인서트")
			LOCALS = %LOCALS%インサート中
			EXP:요도경험 += 1
			LOCALS:2 = 요도경험＋１

		ENDIF
	ENDSELECT
ENDIF

SELECTCASE SELECTCOM
CASE 120 TO 129
CASEELSE
	IF INSERT("Ｖ인서트", PLAYER, TARGET)
		LOCALS = 역인서트중
		EXP:PLAYER:Ｖ경험 += 1
	ELSEIF INSERT("Ａ인서트", PLAYER, TARGET)
		LOCALS = 역Ａ인서트중
		EXP:PLAYER:Ａ경험 += 1
	ENDIF
ENDSELECT

SIF LOCALS != ""
	PRINTFORML ＜%LOCALS%＞
RESETCOLOR
SIF LOCALS:1 != ""
	PRINTFORML %LOCALS:1%
SIF LOCALS:2 != ""
	PRINTFORML %LOCALS:2%

RETURN 1
