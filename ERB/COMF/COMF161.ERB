@COM161
;조수를범하게한다
CALL PRINT_TRAIN_NAME(SELECTCOM)

;-------------------------------------------------
;実行できるかの判定
;-------------------------------------------------
CALL SHOW_COM_ORDER_COM, 161

;実行できない
SIF TCVAR:28 == 0
	RETURN 0
;-------------------------------------------------
;実行決定
;-------------------------------------------------
CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:0 = %STR:2%

RETURN 1

@FLAG_COM161, ARG
IF TALENT:ASSI:처녀
	CALL SETFLAG, "처녀상실플래그", ASSI
	CALL SETFLAG, "처녀탈취플래그", TARGET
ENDIF
IF TALENT:동정
	CALL SETFLAG, "동정狩り플래그", ASSI
	CALL SETFLAG, "동정喪失플래그", TARGET
ENDIF
;대상のＰ⇔조수のＶの汚れが移動
CALL EQ_STAIN, TARGET, ASSI, 2, 3

@SOURCE_COM161, ARG
VARSET LOCAL

LOCAL:20 += 40
LOCAL:21 += 220

LOCAL:13 = 1500
LOCAL:14 = 800

;ABL:봉사정신をみる
SELECTCASE ABL:봉사정신
CASE 0
	LOCAL:5 = 400
CASE 1
	LOCAL:4 = 50
	LOCAL:5 = 800
CASE 2
	LOCAL:4 = 100
	LOCAL:5 = 1500
CASE 3
	LOCAL:4 = 200
	LOCAL:5 = 2300
CASE 4
	LOCAL:4 = 400
	LOCAL:5 = 3500
CASEELSE
	LOCAL:4 = 700
	LOCAL:5 = 5000
ENDSELECT

;ABL:기교をみる
SELECTCASE ABL:기교
CASE 0
	TIMES LOCAL:4 , 0.50
	TIMES LOCAL:5 , 0.50
CASE 1
	TIMES LOCAL:4 , 0.80
	TIMES LOCAL:5 , 0.80
CASE 2
CASE 3
	TIMES LOCAL:4 , 1.50
	TIMES LOCAL:5 , 1.50
CASE 4
	TIMES LOCAL:4 , 2.50
	TIMES LOCAL:5 , 2.50
CASEELSE
	TIMES LOCAL:4 , 4.00
	TIMES LOCAL:5 , 4.00
ENDSELECT


;남자か후타나리
IF PENIS(TARGET)
	SWAP ASSI, PLAYER
	;ABL:Ｃ감각をみる
	LOCAL:0 = CALCF("Ｃ刺激", 3)
	LOCAL:0 = SOURCE_EXABL(LOCAL:0, 33, PLAYER)
	SWAP ASSI, PLAYER
ENDIF

CALL CALC, "조교소스", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@TRAIN_MESSAGE_COM161
PRINTFORMW %CALLNAME:TARGET%에게 %조사처리(CALLNAME:PLAYER,"를")% 안도록 시켰다…


@COM_ORDER_COM161, ARG
VARSET LOCAL
LOCALS = 

;すべての命令に共通の요정素を考慮
;(순종が高いと命令に従いやすいなど)
CALL COM_ORDER, ARG

LOCAL = RESULT

;ABL:봉사정신
IF ABL:봉사정신
	LOCAL += ABL:봉사정신 * 4
	LOCALS = %LOCALS% + %ABLNAME:6%LV{ABL:봉사정신}({ABL:봉사정신 * 4})
ENDIF
;부끄럼쟁이
IF TALENT:부끄럼쟁이
	LOCAL -= 10
	LOCALS = %LOCALS% - %TALENTNAME:35%(10)
ENDIF
;헌신的
IF TALENT:헌신
	LOCAL += 6
	LOCALS = %LOCALS% + %TALENTNAME:63%(6)
ENDIF
;쾌감을부정
IF TALENT:쾌감을부정
	LOCAL -= 1
	LOCALS = %LOCALS% - %TALENTNAME:71%(1)
ENDIF

;조수가처녀
IF EXP:ASSI:Ｖ경험 == 0
	LOCAL -= 15
	LOCALS = %LOCALS% - %조사처리(TEXTS("조수の명칭"),"가")% 처녀(15)
ENDIF

;合計を表示(40이상で実行)
CALL PRINT_COM_ORDER_COM, LOCALS, ARG, LOCAL, 40

RETURN RESULT
