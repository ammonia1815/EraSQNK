@COM147
;정음
PRINTL 정음
;-------------------------------------------------
;実行できるかの判定
;-------------------------------------------------
CALL SHOW_COM_ORDER_COM, 147

;実行できない
SIF TCVAR:28 == 0
	RETURN 0
;-------------------------------------------------
;実行決定
;-------------------------------------------------
CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:0 = 정음

RETURN 1

@FLAG_COM147, ARG
;몽마の입に정액汚れ追加
CALL ADD_STAIN, TARGET, "Ｍ", "정액"

@SOURCE_COM147, ARG
VARSET LOCAL

;関係するのは, 욕망+봉사정신と정액중독と, EXP:정액경험 정액경험. 

LOCAL:20 += 10
LOCAL:21 += 50

LOCAL:8 = TFLAG:16 * 200
LOCAL:7 = TFLAG:16 * 300
LOCAL:13 = TFLAG:16 * 500
LOCAL:14 = TFLAG:16 * 300

SIF CALCF("정액好き度") > TFLAG:16
	TIMES LOCAL:13 , 1.50

;정액경험をみる
SELECTCASE EXP:정액경험
CASE IS < 5
	TIMES LOCAL:14 , 4.00
CASE IS < 20
	TIMES LOCAL:14 , 2.00
CASE IS < 50
	TIMES LOCAL:14 , 1.50
CASE IS < 100
	TIMES LOCAL:14 , 1.20
CASE IS < 300
	TIMES LOCAL:14 , 1.00
CASEELSE
	TIMES LOCAL:14 , 0.50
ENDSELECT

;ABL:정액중독をみる
SELECTCASE ABL:정액중독
CASE 0
	TIMES LOCAL:7 , 0.10
	TIMES LOCAL:13 , 0.50
CASE 1
	TIMES LOCAL:7 , 1.00
	TIMES LOCAL:13 , 1.00
CASE 2
	TIMES LOCAL:7 , 1.20
	TIMES LOCAL:13 , 1.30
CASE 3
	TIMES LOCAL:7 , 1.40
	TIMES LOCAL:13 , 1.60
CASE 4
	TIMES LOCAL:7 , 1.80
	TIMES LOCAL:13 , 2.00
CASEELSE
	TIMES LOCAL:7 , 2.00
	TIMES LOCAL:13 , 3.00
ENDSELECT

;몽마
IF TALENT:몽마 || TALENT:상위몽마
	LOCAL:8 = 0
	TIMES LOCAL:7 , 2.00
	TIMES LOCAL:13 , 1.50
	TIMES LOCAL:14 , 0.10
ENDIF

CALL SOURCE_SMPLAY, "정음", ARG

CALL CALC, "조교소스", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@TRAIN_MESSAGE_COM147
;飲む量をTFLAG:16で管理
IF ITEM:정액저축량 >= 6 && CALCF("정액好き度") >= 4
	CALL LOOP_DRINK147
ELSE
	IF CHECK_SHIRT("일본전통옷") + CHECK_SHIRT("무녀복")
		PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 노송나무 향기가 나는 됫박에 정액을 
	ELSE
		PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 와인글라스에 정액을 
	ENDIF
	TFLAG:16 = 3
ENDIF

IF CALCF("정액好き度") >= TFLAG:16 + 2 && ITEM:정액저축량 >= TFLAG:16 + 2
	PRINT 흘러넘치게 
	TFLAG:16 += 2
;ELSEIF CALCF("정액好き度") <= TFLAG:16 - 2
;	PRINT たっぷりと
;	TFLAG:16 -= 2
ENDIF

;보온병の中の量がＭＡＸ
SIF ITEM:정액저축량 <= TFLAG:16
	TFLAG:16 = ITEM:정액저축량
SIF TFLAG:16 >= CALCF("정액好き度")
	TFLAG:16 = CALCF("정액好き度")
PRINTFORMW 붓고, %CALLNAME:TARGET%에게 주었다. 
PRINTFORM %조사처리(CALLNAME:TARGET,"는")% 
IF ABL:정액중독 == 0
	PRINT 입안에 모은 타액을 이용해서, 가까스로 
ELSEIF ABL:정액중독 < 3
	PRINT 
ELSEIF ABL:정액중독 < 5
	IF RAND:3 && CALCF("정액好き度") > TFLAG:16
		PRINT 아무렇지도 않은 얼굴로 
	ELSE
		PRINT 벌컥벌컥 목을 울리면서 
	ENDIF
ELSE
	IF RAND:3 && CALCF("정액好き度") > TFLAG:16
		PRINT 정말 맛있는 듯이 
	ELSE
		PRINT 맛보면서 
	ENDIF
ENDIF
PRINTFORMW 정액을 남김없이 마시고있다…


@LOOP_DRINK147
PRINTFORML 어디에 담습니까? 
IF CHECK_SHIRT("일본전통옷") + CHECK_SHIRT("무녀복")
	PRINTL [0] 됫박
ELSE
	PRINTL [0] 와인글라스
ENDIF
SIF ITEM:정액저축량 >= 6 && CALCF("정액好き度") >= 4
	PRINTL [1] 맥주 보관함
IF ITEM:정액저축량 >= 10 && CALCF("정액好き度") >= 8
	PRINTL [2] PET병
	CALL INPUT_SELECT, 3
ELSE
	CALL INPUT_SELECT, 2
ENDIF

IF RESULT == 0
	IF CHECK_SHIRT("일본전통옷") + CHECK_SHIRT("무녀복")
		PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 노송나무 향기가 나는 됫박에 정액을 
	ELSE
		PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 와인글라스에 정액을 
	ENDIF
	TFLAG:16 = 3
ELSEIF RESULT == 1
	PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 커다란 보관함에 정액을 
	TFLAG:16 = 6
ELSEIF RESULT == 2
	PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% PET병에 정액을 
	TFLAG:16 = 10
ENDIF


@COM_ORDER_COM147, ARG
VARSET LOCAL
LOCALS = 

;すべての命令に共通の요정素を考慮
;(순종が高いと命令に従いやすいなど)
CALL COM_ORDER, ARG

LOCAL = RESULT

;ABL:봉사정신
IF ABL:봉사정신
	LOCAL += ABL:봉사정신 * 4
	LOCALS = %LOCALS% + %ABLNAME:6%LV{ABL:봉사정신}({ABL:봉사정신 * 4})
ENDIF
;ABL:정액중독
IF ABL:정액중독
	LOCAL += ABL:정액중독 * 3
	LOCALS = %LOCALS% + %ABLNAME:11%LV{ABL:정액중독}({ABL:정액중독 * 3})
ENDIF
;부끄럼쟁이
IF TALENT:부끄럼쟁이
	LOCAL -= 3
	LOCALS = %LOCALS% - %TALENTNAME:35%(3)
ENDIF
;헌신的
IF TALENT:헌신
	LOCAL += 6
	LOCALS = %LOCALS% + %TALENTNAME:63%(6)
ENDIF
;쾌감을부정
IF TALENT:쾌감을부정
	LOCAL -= 1
	LOCALS = %LOCALS% - %TALENTNAME:71%(1)
ENDIF

;合計を表示(30이상で実行)
CALL PRINT_COM_ORDER_COM, LOCALS, ARG, LOCAL, 30

RETURN RESULT
